# sgp22.cnf

#.MODULE_IMPORT
PKIX1Explicit88 pkix1explicit
PKIX1Implicit88 pkix1implicit

#.INCLUDE ../pkix1explicit/pkix1explicit_exp.cnf
#.INCLUDE ../pkix1implicit/pkix1implicit-exp.cnf

#.OMIT_ASSIGNMENT
Octet2
CertificateInfo
SegmentedCrlList

#.EXPORTS
AuthenticateResponseError
BoundProfilePackage
CancelSessionReason
CancelSessionResponseOk
CertificationDataObject
CtxParams1
DeviceInfo
DpProprietaryData
EUICCInfo1
ErrorResult
EuiccSignPIR
Iccid
IconType
ISDRProprietaryApplicationTemplate_PDU
NotificationConfigurationInformation
NotificationEvent
NotificationMetadata
Octet1
Octet16
Octet32
OctetTo16
OperatorId
OtherSignedNotification
PprIds
PrepareDownloadResponseError
PrepareDownloadResponseOk
ProfileClass
ProfileInfoListRequest
ProfileInstallationResultData
ProfileState
RspCapability
ServerSigned1
SmdpSigned2
TransactionId
UICCCapability
VendorSpecificExtension
VersionType
RulesAuthorisationTable

#.TYPE_ATTR
Iccid/_untag TYPE = FT_STRING
VersionType TYPE = FT_STRING

#.FN_BODY Iccid/_untag VAL_PTR = &next_tvb HF_INDEX = -1
  tvbuff_t *next_tvb = NULL;

%(DEFAULT_BODY)s
  if (next_tvb) {
    actx->created_item = proto_tree_add_item(tree, hf_index, next_tvb, 0, -1, ENC_BCD_DIGITS_0_9|ENC_LITTLE_ENDIAN);
  }

#.FN_BODY VersionType VAL_PTR = &next_tvb HF_INDEX = -1
  tvbuff_t *next_tvb = NULL;

%(DEFAULT_BODY)s
  if (next_tvb) {
    wmem_strbuf_t *version_str = wmem_strbuf_create(NULL);
    for (unsigned i = 0; i < %(MAX_VAL)s; i++) {
      uint8_t value = tvb_get_uint8(next_tvb, i);
      if (i < (%(MAX_VAL)s - 1) || value > 0) {
        /* Do not show last value if this is 0, according to spec */
        wmem_strbuf_append_printf(version_str, "%%c%%u", (i == 0 ? 'v' : '.'), value);
      }
    }
    actx->created_item = proto_tree_add_string(tree, hf_index, next_tvb, 0, -1, wmem_strbuf_finalize(version_str));
  }

#.PDU
RemoteProfileProvisioningRequest
RemoteProfileProvisioningResponse
ISDRProprietaryApplicationTemplate

#.FN_PARS
RemoteProfileProvisioningRequest/_untag VAL_PTR = &choice
RemoteProfileProvisioningResponse/_untag VAL_PTR = &choice

#.FN_HDR RemoteProfileProvisioningRequest/_untag
  int choice;

#.FN_FTR RemoteProfileProvisioningRequest/_untag
  if (choice != -1) {
    col_append_str(actx->pinfo->cinfo, COL_INFO, val_to_str_const(RemoteProfileProvisioningRequest_U_choice[choice].value, sgp22_RemoteProfileProvisioningRequest_U_vals, "Unknown"));
  }

#.FN_HDR RemoteProfileProvisioningResponse/_untag
  int choice;

#.FN_FTR RemoteProfileProvisioningResponse/_untag
  if (choice != -1) {
    col_append_str(actx->pinfo->cinfo, COL_INFO, val_to_str_const(RemoteProfileProvisioningResponse_U_choice[choice].value, sgp22_RemoteProfileProvisioningResponse_U_vals, "Unknown"));
  }

#.REGISTER
ExpirationDate                 B "2.23.146.1.2.0.1"  "id-rsp-expDate"
TotalPartialCrlNumber          B "2.23.146.1.2.0.2"  "id-rsp-totalPartialCrlNumber"
PartialCrlNumber               B "2.23.146.1.2.0.3"  "id-rsp-partialCrlNumber"
ActivationCodeRetrievalInfo    B "2.23.146.1.3.1.1"  "id-rsp-metadata-activationCodeRetrievalInfo"

ProfileInfo                        N sgp22.request   0xE3
GetEuiccInfo1Request               N sgp22.request   0xBF20
EUICCInfo1                         N sgp22.response  0xBF20
PrepareDownloadRequest             N sgp22.request   0xBF21
PrepareDownloadResponse            N sgp22.response  0xBF21
GetEuiccInfo2Request               N sgp22.request   0xBF22
EUICCInfo2                         N sgp22.response  0xBF22
InitialiseSecureChannelRequest     N sgp22.request   0xBF23
ConfigureISDPRequest               N sgp22.request   0xBF24
StoreMetadataRequest               N sgp22.request   0xBF25
ReplaceSessionKeysRequest          N sgp22.request   0xBF26
ListNotificationRequest            N sgp22.request   0xBF28
ListNotificationResponse           N sgp22.response  0xBF28
SetNicknameRequest                 N sgp22.request   0xBF29
SetNicknameResponse                N sgp22.response  0xBF29
UpdateMetadataRequest              N sgp22.request   0xBF2A
RetrieveNotificationsListRequest   N sgp22.request   0xBF2B
RetrieveNotificationsListResponse  N sgp22.response  0xBF2B
ProfileInfoListRequest             N sgp22.request   0xBF2D
ProfileInfoListResponse            N sgp22.response  0xBF2D
GetEuiccChallengeRequest           N sgp22.request   0xBF2E
GetEuiccChallengeResponse          N sgp22.response  0xBF2E
NotificationMetadata               N sgp22.request   0xBF2F
NotificationSentRequest            N sgp22.request   0xBF30
NotificationSentResponse           N sgp22.response  0xBF30
EnableProfileRequest               N sgp22.request   0xBF31
EnableProfileResponse              N sgp22.response  0xBF31
DisableProfileRequest              N sgp22.request   0xBF32
DisableProfileResponse             N sgp22.response  0xBF32
DeleteProfileRequest               N sgp22.request   0xBF33
DeleteProfileResponse              N sgp22.response  0xBF33
EuiccMemoryResetRequest            N sgp22.request   0xBF34
EuiccMemoryResetResponse           N sgp22.response  0xBF34
LoadCRLRequest                     N sgp22.request   0xBF35
LoadCRLResponse                    N sgp22.response  0xBF35
BoundProfilePackage                N sgp22.request   0xBF36
ProfileInstallationResult          N sgp22.response  0xBF37
AuthenticateServerRequest          N sgp22.request   0xBF38
AuthenticateServerResponse         N sgp22.response  0xBF38
InitiateAuthenticationRequest      N sgp22.request   0xBF39
InitiateAuthenticationResponse     N sgp22.response  0xBF39
GetBoundProfilePackageRequest      N sgp22.request   0xBF3A
GetBoundProfilePackageResponse     N sgp22.response  0xBF3A
AuthenticateClientRequest          N sgp22.request   0xBF3B
AuthenticateClientResponseEs9      N sgp22.response  0xBF3B
EuiccConfiguredAddressesRequest    N sgp22.request   0xBF3C
EuiccConfiguredAddressesResponse   N sgp22.response  0xBF3C
HandleNotification                 N sgp22.request   0xBF3D
GetEuiccDataRequest                N sgp22.request   0xBF3E
GetEuiccDataResponse               N sgp22.response  0xBF3E
SetDefaultDpAddressRequest         N sgp22.request   0xBF3F
SetDefaultDpAddressResponse        N sgp22.response  0xBF3F
AuthenticateClientResponseEs11     N sgp22.response  0xBF40
CancelSessionRequest               N sgp22.request   0xBF41
CancelSessionResponse              N sgp22.response  0xBF41
LpaeActivationRequest              N sgp22.request   0xBF42
LpaeActivationResponse             N sgp22.response  0xBF42
GetRatRequest                      N sgp22.request   0xBF43
GetRatResponse                     N sgp22.response  0xBF43

#.CLASS OPENTYPE
&typeId    ObjectIdentifierType
&Type
#.END

#.FN_PARS VendorSpecificExtension/_item/vendorOid
  FN_VARIANT = _str  HF_INDEX = hf_sgp22_vendorOid  VAL_PTR = &actx->external.direct_reference

#.FN_BODY VendorSpecificExtension/_item/vendorSpecificData
offset=call_ber_oid_callback(actx->external.direct_reference, tvb, offset, actx->pinfo, tree, NULL);

#.END
