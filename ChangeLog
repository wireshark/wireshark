commit 987fb23
Author: Peter Wu <peter@lekensteyn.nl>
Date:   Wed Aug 31 16:51:16 2016 +0200

    autotools: really disable warnings by default
    
    The v2.2.0rc1 release tarball accidentally enables warnings as errors,
    this led to build failures due to warnings that occur on 32-bit builds.
    
    Change-Id: Ib12f5762e9b30a681b193014ed78dc73bc794b0f
    Reviewed-on: https://code.wireshark.org/review/17420
    Reviewed-by: Gerald Combs <gerald@wireshark.org>

commit 50c51c8
Author: Peter Wu <peter@lekensteyn.nl>
Date:   Wed Aug 31 00:04:38 2016 +0200

    ipv6: fix build with old 32-bit glib headers
    
    glib versions before 2.31.2 expand GUINT_TO_POINTER(x) as (gpointer)x
    instead of (gpointer)(guint)x, resulting in these errors:
    
        packet-ipv6.c:2129: error: cast to pointer from integer of different size
        packet-ipv6.c:2185: error: cast to pointer from integer of different size
    
    Change-Id: I1b25060ed329ce05e4f1ab75e32a56feda8e3435
    Reviewed-on: https://code.wireshark.org/review/17401
    Reviewed-by: Michael Mann <mmann78@netscape.net>
    Petri-Dish: Michael Mann <mmann78@netscape.net>
    Tested-by: Petri Dish Buildbot <buildbot-no-reply@wireshark.org>
    Reviewed-by: João Valverde <j@v6e.pt>

commit 8b7444e
Author: Guy Harris <guy@alum.mit.edu>
Date:   Tue Aug 30 17:59:59 2016 -0700

    Use "ecatf" as the protocol name, to parallel everything else.
    
    The fields have names beginning with "ecatf.", the dissector is called
    "ecatf", and it's only the frame layer of EtherCAT anyway, so just call
    it "ecatf".
    
    Change-Id: I2f127363fd115c307f0525f612fe184a30d46c55
    Reviewed-on: https://code.wireshark.org/review/17406
    Reviewed-by: Guy Harris <guy@alum.mit.edu>
    (cherry picked from commit d78197955050f0ddf4a91379018f41b58923c56b)
    Reviewed-on: https://code.wireshark.org/review/17407

commit 6b6cf99
Author: Guy Harris <guy@alum.mit.edu>
Date:   Tue Aug 30 15:51:54 2016 -0700

    Don't do any Decode As stuff for dissector tables not used with Decode As.
    
    Have all dissector tables have a "supports Decode As" flag, which
    defaults to FALSE, and which is set to TRUE if a register_decode_as()
    refers to it.
    
    When adding a dissector to a dissector table with a given key, only add
    it for Decode As if the dissector table supports it.
    
    For non-FT_STRING dissector tables, always check for multiple entries
    for the same protocol with different dissectors, and report an error if
    we found them.
    
    This means there's no need for the creator of a dissector table to
    specify whether duplicates of that sort should be allowed - we always do
    the check when registering something for "Decode As" (in a non-FT_STRING
    dissector table), and just don't bother registering anything for "Decode
    As" if the dissector table doesn't support "Decode As", so there's no
    check done for those dissector tables.
    
    Change-Id: I4e98bfe0061f1014cd7ffdf4c51d9b6e8a2a5689
    Reviewed-on: https://code.wireshark.org/review/17405
    Reviewed-by: Guy Harris <guy@alum.mit.edu>

commit 0158d62
Author: Guy Harris <guy@alum.mit.edu>
Date:   Tue Aug 30 13:38:03 2016 -0700

    Support Decode As for {SSL,TLS}-over-TCP.
    
    We register dissectors for "Decode As" for {SSL,TLS}-over-TCP, so we
    should actually set up the "Decode As" stuff for it.
    
    Change-Id: I2a738667efdec1007069df74885a4fe8fc3fcbab
    Reviewed-on: https://code.wireshark.org/review/17400
    Reviewed-by: Guy Harris <guy@alum.mit.edu>
    (cherry picked from commit afa2605e4359509a8e188f3d7ae118246e9e0ac7)
    Reviewed-on: https://code.wireshark.org/review/17404

commit 1ba7176
Author: Juanjo Martin <juanjo@rti.com>
Date:   Tue Aug 30 01:57:32 2016 +0200

    RTPS: Allowing duplicates in the rtps.type_name table
    
    Change-Id: Ie7a35b0bb3275a0895fad646bf9a81406eadf37c
    Reviewed-on: https://code.wireshark.org/review/17393
    Reviewed-by: Guy Harris <guy@alum.mit.edu>
    (cherry picked from commit 1dbd2216edfe34e3dbb1f8967d325e7fa00ecb51)
    Reviewed-on: https://code.wireshark.org/review/17403

commit 7968175
Author: Peter Wu <peter@lekensteyn.nl>
Date:   Tue Aug 30 11:12:44 2016 +0200

    time_util: fix -Wshadow issue
    
    time_util.c was already fixed, but the header was missing the change,
    breaking the build on a very old compiler.
    
    Change-Id: I95685c9a3e25dcb7567f2551b92f20c8792a6e47
    Reviewed-on: https://code.wireshark.org/review/17384
    Petri-Dish: Dario Lombardo <lomato@gmail.com>
    Tested-by: Petri Dish Buildbot <buildbot-no-reply@wireshark.org>
    Reviewed-by: Dario Lombardo <lomato@gmail.com>
    Reviewed-by: Peter Wu <peter@lekensteyn.nl>
    (cherry picked from commit a892c90367a9f1b1d3d962cfe958174b8fefcaee)
    Reviewed-on: https://code.wireshark.org/review/17390

commit a9e19bc
Author: Guy Harris <guy@alum.mit.edu>
Date:   Sat Aug 6 20:07:04 2016 -0700

    Avoid colliding with the (old) UNIX stime() system call.
    
    Rename "stime" to "sys_time", and, for consistency, do the same with
    "utime".  This failed when I tried a build on an Ubuntu 12.04 LTS
    machine.
    
    Change-Id: Ib955b723506346aa742db0de4d26dc157bcd4fc8
    Reviewed-on: https://code.wireshark.org/review/16935
    Reviewed-by: Guy Harris <guy@alum.mit.edu>
    (cherry picked from commit 66711eb2612ddc7f523b7cc5990e1674a755cb00)
    Reviewed-on: https://code.wireshark.org/review/17389
    Reviewed-by: Peter Wu <peter@lekensteyn.nl>

commit 5f59439
Author: Guy Harris <guy@alum.mit.edu>
Date:   Sat Jul 30 13:50:04 2016 -0700

    Use correct relative path.
    
    The build is done in epan/wmem, so libwsutil.la is in ../../wsutil.
    
    Change-Id: I053f6b925829e9c5e9ded014fbc716abc527b46a
    Reviewed-on: https://code.wireshark.org/review/16790
    Reviewed-by: Guy Harris <guy@alum.mit.edu>
    (cherry picked from commit c2ac9c5c0316a27f54830fae0b70cf7825c6d99c)
    Reviewed-on: https://code.wireshark.org/review/17388
    Reviewed-by: Peter Wu <peter@lekensteyn.nl>

commit b25ce3d
Author: Guy Harris <guy@alum.mit.edu>
Date:   Sat Jul 30 13:37:03 2016 -0700

    ifdef out a variable used only on Windows.
    
    Also, fix identation - tab stops are set every 8 spaces, not every 4
    spaces, in UN*X, which is why the mode lines specify that.
    
    Change-Id: If7cfc2cdae26feb2d5c13e31a32ed950354fb15b
    Reviewed-on: https://code.wireshark.org/review/16789
    Reviewed-by: Guy Harris <guy@alum.mit.edu>
    (cherry picked from commit f6322a4977181103431637703f11649e5023d6b0)
    Reviewed-on: https://code.wireshark.org/review/17387
    Reviewed-by: Peter Wu <peter@lekensteyn.nl>

commit 1eb6828
Author: Gerald Combs <gerald@wireshark.org>
Date:   Thu Apr 7 15:31:21 2016 -0700

    Add string function times to wmem_test.
    
    The system, GLib, and wmem string functions can perform differently,
    particularly on Windows. Start adding performance tests to wmem_test so
    that we can see the differences.
    
    With this change applied "wmem_test --verbose" prints out the following
    on a Windows 7 x64 VM here. wmem_test is linked against GLib 2.4.20.
    
    (MINPERF:g_printf_string_upper_bound (via g_snprintf) 1 string: u 327.602 ms s 0
    .000 ms)
    (MINPERF:g_printf_string_upper_bound (via g_snprintf) 5 strings: u 1419.609 ms s
     0.000 ms)
    (MINPERF:g_printf_string_upper_bound (via g_snprintf) mixed args: u 1606.810 ms
    s 0.000 ms)
    (MINPERF:_snprintf_s upper bound 1 string: u 124.801 ms s 0.000 ms)
    (MINPERF:_snprintf_s upper bound 5 strings: u 140.401 ms s 0.000 ms)
    (MINPERF:_snprintf_s upper bound mixed args: u 124.801 ms s 0.000 ms)
    (MINPERF:g_strdup_printf 2 strings: u 702.005 ms s 0.156 ms)
    (MINPERF:g_strconcat 2 strings: u 78.000 ms s 0.000 ms)
    (MINPERF:g_strdup_printf 5 strings: u 1419.609 ms s 0.156 ms)
    (MINPERF:g_strconcat 5 strings: u 93.601 ms s 0.156 ms)
    (MINPERF:wmem_strdup_printf 2 strings: u 343.202 ms s 0.312 ms)
    (MINPERF:wmem_strconcat 2 strings: u 93.601 ms s 0.468 ms)
    (MINPERF:wmem_strdup_printf 5 strings: u 327.602 ms s 8.268 ms)
    (MINPERF:wmem_strconcat 5 strings: u 62.400 ms s 3.432 ms)
    
    Change-Id: Id9b23918829db1719d141e7f830b9eba6245a25b
    Reviewed-on: https://code.wireshark.org/review/14857
    Reviewed-by: Gerald Combs <gerald@wireshark.org>
    Petri-Dish: Gerald Combs <gerald@wireshark.org>
    Tested-by: Petri Dish Buildbot <buildbot-no-reply@wireshark.org>
    Reviewed-by: Michael Mann <mmann78@netscape.net>
    (cherry picked from commit 183d7f3b78de30581390244a72c6ab328e6338f0)
    Reviewed-on: https://code.wireshark.org/review/17386
    Reviewed-by: Peter Wu <peter@lekensteyn.nl>

commit f3a5b33
Author: Roland Knall <roland.knall@br-automation.com>
Date:   Mon Aug 1 16:57:51 2016 +0200

    extcap: Remove g_spawn_check_exit_status
    
    This function is not supported in the min GLIB version, therefore
    the code is to be removed
    
    Change-Id: Ie39170bfc0662e5a477cbc45d7eadebcf2c70d4e
    Reviewed-on: https://code.wireshark.org/review/16827
    Petri-Dish: Roland Knall <rknall@gmail.com>
    Reviewed-by: Dario Lombardo <lomato@gmail.com>
    Tested-by: Petri Dish Buildbot <buildbot-no-reply@wireshark.org>
    Reviewed-by: Roland Knall <rknall@gmail.com>
    (cherry picked from commit d62ad9dd47d368f7545c3cc91f44ecc07476d2e1)
    Reviewed-on: https://code.wireshark.org/review/17383
    Reviewed-by: Anthony Coddington <anthony.coddington@endace.com>

commit 0962de8
Author: Guy Harris <guy@alum.mit.edu>
Date:   Mon Aug 29 19:49:58 2016 -0700

    Don't use a no-longer-extant variable.
    
    Change-Id: I41c1a37248335d983da58b0b657a28ec521be290
    Reviewed-on: https://code.wireshark.org/review/17378
    Reviewed-by: Guy Harris <guy@alum.mit.edu>
    (cherry picked from commit 8e9b6f4abe06a32bb5c8e8842403c4cf8dccd765)
    Reviewed-on: https://code.wireshark.org/review/17379

commit 5d9f67f
Author: Pascal Quantin <pascal.quantin@gmail.com>
Date:   Mon Aug 29 11:31:11 2016 +0200

    tap-iostat.c: ensure that interval is set to its maximum value when using 0
    
    Otherwise the statistics will be wrong if the capture duration is greater
    than G_MAXINT32 and it the user specifies an interval of 0
    
    Bug: 12778
    Change-Id: I83a0f627ec0bb7c535446c17afa486835091ab8b
    Reviewed-on: https://code.wireshark.org/review/17367
    Reviewed-by: Pascal Quantin <pascal.quantin@gmail.com>
    Petri-Dish: Pascal Quantin <pascal.quantin@gmail.com>
    Tested-by: Petri Dish Buildbot <buildbot-no-reply@wireshark.org>
    Reviewed-by: Michael Mann <mmann78@netscape.net>
    (cherry picked from commit 24fd16d86553279ca3fe8f651d85cace14edfc6c)
    Reviewed-on: https://code.wireshark.org/review/17369

commit 6deac90
Author: Gerald Combs <gerald@wireshark.org>
Date:   Sun Aug 28 08:22:26 2016 -0700

    [Automatic update for 2016-08-28]
    
    Update manuf, services enterprise-numbers, translations, and other items.
    
    Change-Id: I582a41fbd6f895572b3c5822cf04fb3c5fb03c2b
    Reviewed-on: https://code.wireshark.org/review/17359
    Reviewed-by: Gerald Combs <gerald@wireshark.org>

commit 0180c29
Author: Mirko Parthey <mirko.parthey@web.de>
Date:   Sun Aug 28 14:49:52 2016 +0200

    ISAKMP: fix # of SPIs field name in Delete payload
    
    Fix the "Number of SPIs" field name in the Delete payload.
    References: RFC 2408, RFC 7296
    
    Change-Id: I205fb830275fc011e6605fdae53c6b9141e1628b
    Reviewed-on: https://code.wireshark.org/review/17353
    Petri-Dish: Pascal Quantin <pascal.quantin@gmail.com>
    Tested-by: Petri Dish Buildbot <buildbot-no-reply@wireshark.org>
    Reviewed-by: Pascal Quantin <pascal.quantin@gmail.com>
    (cherry picked from commit 294fcd11bfc2a76306e0c6ea8e8f53445df940cf)
    Reviewed-on: https://code.wireshark.org/review/17356

commit c66deb9
Author: Stig Bjørlykke <stig@bjorlykke.org>
Date:   Sat Aug 27 11:53:29 2016 +0200

    Qt: Support "Resolve Names" with multiple custom column fields
    
    Make "Resolve Names" enabled if at least one of the custom column
    fields can be resolved.
    
    Change-Id: I702471be5d90c91f71209923e6abcc6921dca850
    Reviewed-on: https://code.wireshark.org/review/17350
    Reviewed-by: Stig Bjørlykke <stig@bjorlykke.org>
    (cherry picked from commit 5fe3e6af39fc55650ff9563906d016aa7becbaf1)
    Reviewed-on: https://code.wireshark.org/review/17351

commit 4229951
Author: Alexis La Goutte <alexis.lagoutte@gmail.com>
Date:   Fri Aug 26 10:41:45 2016 +0200

    QUIC: Fix some typo (copy/paste error) on GOAWAY/CONNECTION_CLOSE Frame
    
    Issue reported by Lucas Perdue
    
    Change-Id: I9c4ede6ba2fb0303aab05f1d59835e5a8b386a3e
    Reviewed-on: https://code.wireshark.org/review/17340
    Reviewed-by: Lucas Pardue <lucas.pardue@bbc.co.uk>
    Reviewed-by: Michael Mann <mmann78@netscape.net>
    (cherry picked from commit df28c8266ff9ebc404fd53408050c507a442ac04)
    Reviewed-on: https://code.wireshark.org/review/17349
    Reviewed-by: Alexis La Goutte <alexis.lagoutte@gmail.com>

commit c71ac83
Author: Peter Wu <peter@lekensteyn.nl>
Date:   Thu Aug 25 18:03:35 2016 +0200

    qt: fix crash on Search Packet while redissecting
    
    Before redissection, PacketList::freeze() is called which clears the
    model. This results in a NULL-deref when pressing Ctrl-F (Packet
    Search) or Ctrl-G (Go To Packet). Reproducer: in a large capture file,
    enter some display filter (e.g. "udp") and immediately press Ctrl-F.
    
    Thanks to Github user SNAPESNATCH for the initial report via IRC that
    included a helpful stack trace on Windows.
    
    Change-Id: If7334d6df4e9591fb1f2a52e3e2f837285b2959f
    Reviewed-on: https://code.wireshark.org/review/17326
    Petri-Dish: Peter Wu <peter@lekensteyn.nl>
    Tested-by: Petri Dish Buildbot <buildbot-no-reply@wireshark.org>
    Reviewed-by: Peter Wu <peter@lekensteyn.nl>
    (cherry picked from commit 09be46361bab677842cc598405cbc7a44b974f1f)
    Reviewed-on: https://code.wireshark.org/review/17342

commit 608befb
Author: Stig Bjørlykke <stig@bjorlykke.org>
Date:   Thu Aug 25 15:39:40 2016 +0200

    xmpp/xml: Store item length in xml_frame.
    
    The created XML proto_item can be faked (if not visible and not referenced),
    so ensure we store the correct item length to be used in XMPP.
    
    This will avoid an invalid "Malformed Packet" for some XMPP packets.
    
    Change-Id: I79d805b725dbeb93f26a38b72bdcc84187aee16f
    Reviewed-on: https://code.wireshark.org/review/17324
    Petri-Dish: Stig Bjørlykke <stig@bjorlykke.org>
    Tested-by: Petri Dish Buildbot <buildbot-no-reply@wireshark.org>
    Reviewed-by: Alexis La Goutte <alexis.lagoutte@gmail.com>
    (cherry picked from commit ce9a4b212ec7b75985cef3b9ab362808e6fd25c5)
    Reviewed-on: https://code.wireshark.org/review/17338
    Reviewed-by: Stig Bjørlykke <stig@bjorlykke.org>

commit c84ce03
Author: Guy Harris <guy@alum.mit.edu>
Date:   Thu Aug 25 16:58:25 2016 -0700

    Handle ETH_P_CANFD as well as ETH_P_CAN.
    
    Both of them need to have the CAN ID/flags field of the header
    byte-swapped as necessary to make sure it's in the *reading* host's byte
    order, not the *writing* host's byte order, if the two are different.
    
    Change-Id: Iac1589fdd9fe4d9ee6fbac8d821b48694d68919b
    Reviewed-on: https://code.wireshark.org/review/17333
    Reviewed-by: Guy Harris <guy@alum.mit.edu>
    (cherry picked from commit 17f977ec5695259ec02c7e6e4cd24e3e2ed263c1)
    Reviewed-on: https://code.wireshark.org/review/17334

commit ddbae1c
Author: Guy Harris <guy@alum.mit.edu>
Date:   Thu Aug 25 14:39:42 2016 -0700

    One more change for the removal of LINKTYPE_SOCKETCAN_HOSTENDIAN.
    
    Change-Id: If1615e23efa30119fff5eb2935335c2cde34b89e
    Reviewed-on: https://code.wireshark.org/review/17330
    Reviewed-by: Guy Harris <guy@alum.mit.edu>
    (cherry picked from commit 27372ca7379b3ff5cccf1488d96a72d06dfba0d1)
    Reviewed-on: https://code.wireshark.org/review/17331

commit 6d074ae
Author: Guy Harris <guy@alum.mit.edu>
Date:   Thu Aug 25 14:14:11 2016 -0700

    Go back to having only one SocketCAN LINKTYPE_ value.
    
    Libpcap just backed out the "host-endian" SocketCAN LINKTYPE_ value; we
    don't need it any more.
    
    Change-Id: I33a7dc21207a0009e20b4abaefe1119eb649c39a
    Reviewed-on: https://code.wireshark.org/review/17327
    Reviewed-by: Guy Harris <guy@alum.mit.edu>
    (cherry picked from commit c8157aa6b4afdbc2f84779ffbeea4f8d3bdc8666)
    Reviewed-on: https://code.wireshark.org/review/17328

commit 2e3c898
Author: Balint Reczey <balint@balintreczey.hu>
Date:   Tue Aug 23 13:53:23 2016 +0200

    Documentation with unset license is under project's license (GPL-2+)
    
    doc/idl2deb.pod is licensed explicitly under GPL-2+ it is just
    not recognized by the check.
    
    Change-Id: Iabc7ee6bd6fe9080d6cdd28a29bb4c5f97b0ece9
    Reviewed-on: https://code.wireshark.org/review/17268
    Reviewed-by: Balint Reczey <balint@balintreczey.hu>
    Petri-Dish: Balint Reczey <balint@balintreczey.hu>
    Reviewed-by: Dario Lombardo <lomato@gmail.com>
    Tested-by: Petri Dish Buildbot <buildbot-no-reply@wireshark.org>
    (cherry picked from commit 40ac3c86825d4a15e585035fbae6e9a86424ee4e)
    Reviewed-on: https://code.wireshark.org/review/17283
    Reviewed-by: Michael Mann <mmann78@netscape.net>

commit 1c16105
Author: Gerald Combs <gerald@wireshark.org>
Date:   Tue Aug 23 16:55:16 2016 -0700

    Fuzz test: Make Valgrind error detection more verbose.
    
    When we set VG_ERR_CNT=1 print the reason.
    
    Change-Id: Icb8f2a1e7074044521873b116fc891cc4be4b204
    Reviewed-on: https://code.wireshark.org/review/17286
    Reviewed-by: Gerald Combs <gerald@wireshark.org>

commit e8d5252
Author: Michał Skalski <mskalski13@gmail.com>
Date:   Tue Aug 23 01:12:59 2016 +0200

    isakmp Fix IKEv2 modification UAT crash
    
    Problem is that not all fields of UAT are updated on change (only those
    defined in UAT definition with ikev2_uat_flds, specifically pointers to
    encr_spec and auth_spec in ike2_decr_data_t were set to NULL.
    
    Fixed by re-setting pointers after update table callback was called.
    
    Also fixed memory leaks after UAT modification.
    
    Bug was partially resolved with change
    Ibdab979b5959eb561635cbcb446e17138baca87b
    https://code.wireshark.org/review/17078
    
    which eliminated crash, but decryption still didn't work after UAT
    modification (DISSECTOR BUG was displayed).
    
    Bug: 12748
    Change-Id: I8209edd8e214d62e34b641fdd2e046b9ff4c95eb
    Reviewed-on: https://code.wireshark.org/review/17249
    Reviewed-by: Jaap Keuter <jaap.keuter@xs4all.nl>
    Petri-Dish: Jaap Keuter <jaap.keuter@xs4all.nl>
    Tested-by: Petri Dish Buildbot <buildbot-no-reply@wireshark.org>
    Reviewed-by: Pascal Quantin <pascal.quantin@gmail.com>
    (cherry picked from commit 505bcefd20501ae0811f6074f2113b52788d78c5)
    Conflicts:
    	epan/dissectors/packet-isakmp.c
    Reviewed-on: https://code.wireshark.org/review/17299
    Reviewed-by: Michał Skalski <mskalski13@gmail.com>
    Petri-Dish: Pascal Quantin <pascal.quantin@gmail.com>

commit fb6b0e6
Author: Pascal Quantin <pascal.quantin@gmail.com>
Date:   Mon Aug 15 18:55:45 2016 +0200

    ISAKMP: Fix Result of operation is garbage or undefined found by Clang Analyzer
    
    Change-Id: I47233968dfc87494b3c959896622db5cd31244a7
    Reviewed-on: https://code.wireshark.org/review/17065
    Reviewed-by: Pascal Quantin <pascal.quantin@gmail.com>
    Petri-Dish: Pascal Quantin <pascal.quantin@gmail.com>
    Tested-by: Petri Dish Buildbot <buildbot-no-reply@wireshark.org>
    Reviewed-by: Mirko Parthey <mirko.parthey@web.de>
    Reviewed-by: Anders Broman <a.broman58@gmail.com>
    (cherry picked from commit 3c8f657e01f1548fbf9cc5740374552aa8c6fdc6)
    Reviewed-on: https://code.wireshark.org/review/17267
    Reviewed-by: Peter Wu <peter@lekensteyn.nl>

commit 5c07723
Author: Mirko Parthey <mirko.parthey@web.de>
Date:   Tue Jul 19 00:43:19 2016 +0200

    Fix IKEv1 decryption and initialization vectors
    
    Generate initialization vectors during Wireshark's first pass,
    in order to improve reliability and efficiency. (bug #12699)
    Remove a dissection shortcut in first pass to allow early analysis
    of the transform payloads, which is needed to find out the crypto
    algorithms.
    
    Introduce a hash table to store an IV per message ID. (bug #12610)
    Fix handling of the initial phase 1 IV. (bug #12620)
    Cache IVs as per-packet data instead of a list.
    
    Use the wmem allocator to avoid memory leaks.
    Ensure libgcrypt resource cleanup on error paths.
    
    Rely only on IKE attributes to find the decryption algorithm,
    do not consider the length of the user-configured secret at this point.
    
    Split code into small functions.
    
    Ping-Bug: 12610
    Ping-Bug: 12620
    Ping-Bug: 12699
    Change-Id: I7137943da42d54816808312cd1716a7e05478cbb
    Reviewed-on: https://code.wireshark.org/review/16846
    Reviewed-by: Peter Wu <peter@lekensteyn.nl>
    Petri-Dish: Peter Wu <peter@lekensteyn.nl>
    Tested-by: Petri Dish Buildbot <buildbot-no-reply@wireshark.org>
    Reviewed-by: Anders Broman <a.broman58@gmail.com>
    (cherry picked from commit 561a2f056bd76bfcb4f89a05542ffce32eed5049)
    Reviewed-on: https://code.wireshark.org/review/17198
    Reviewed-by: Mirko Parthey <mirko.parthey@web.de>

commit fef8471
Author: Mirko Parthey <mirko.parthey@web.de>
Date:   Tue Aug 23 16:29:57 2016 +0200

    ISAKMP: fix DOI field read size
    
    Read 4 bytes from the packet instead of 1 because that is the
    correct size of the DOI field.
    Reference: RFC 2408
    
    Change-Id: I5745363811bb46af307a925d688ec36cfb29984b
    Reviewed-on: https://code.wireshark.org/review/17271
    Reviewed-by: Alexis La Goutte <alexis.lagoutte@gmail.com>
    Petri-Dish: Alexis La Goutte <alexis.lagoutte@gmail.com>
    Tested-by: Petri Dish Buildbot <buildbot-no-reply@wireshark.org>
    Reviewed-by: Anders Broman <a.broman58@gmail.com>
    (cherry picked from commit 0fcca6f0c8392b16ebfefdc69086d02e1dba2c7e)
    Reviewed-on: https://code.wireshark.org/review/17295

commit 7dc3d01
Author: Pascal Quantin <pascal.quantin@gmail.com>
Date:   Tue Aug 23 22:10:08 2016 +0200

    call_heur_dissector_direct: do not trigger an assert if heuristic dissector rejects packet
    
    This can happen for example is the heuristics changed between the Wireshark
    version used to export PDUs, and the one used to open the file.
    Instead, call data dissector.
    
    Change-Id: I29f7754f883fd710c3557a610583ef988ca13e43
    Reviewed-on: https://code.wireshark.org/review/17280
    Reviewed-by: Anders Broman <a.broman58@gmail.com>
    (cherry picked from commit 2095b325998f1da06a4e80efeb186ec99d6e39ed)
    Reviewed-on: https://code.wireshark.org/review/17294
    Reviewed-by: Pascal Quantin <pascal.quantin@gmail.com>

commit a7e78b4
Author: Alexis La Goutte <alexis.lagoutte@gmail.com>
Date:   Tue Aug 23 19:41:46 2016 +0200

    SCSI: Mode Sense 10: Wrong block descriptor length
    
    Issue reported by Sharon Samuel Enoch
    
    Bug:12780
    Change-Id: I94ad5355cdfa4d8cd3915c9e261931ff56dc765b
    Reviewed-on: https://code.wireshark.org/review/17272
    Reviewed-by: Alexis La Goutte <alexis.lagoutte@gmail.com>
    Petri-Dish: Alexis La Goutte <alexis.lagoutte@gmail.com>
    Tested-by: Petri Dish Buildbot <buildbot-no-reply@wireshark.org>
    Reviewed-by: Anders Broman <a.broman58@gmail.com>
    (cherry picked from commit 20908f55f6c93fb79fbd39e60affa2d4428b4951)
    Reviewed-on: https://code.wireshark.org/review/17292

commit 2a4150a
Author: Chris Bontje <cbontje@gmail.com>
Date:   Tue Aug 23 08:42:59 2016 -0600

    [lg8979] - Fix dissection of 'Analog Group Change Report' Responses (FC2)
    
    They follow the same dissection as normal 'Analog Change Report' Responses (FC0)
    
    Change-Id: I854084f43fd0cc52ba02b6f1e760a63033ab48dd
    Reviewed-on: https://code.wireshark.org/review/17270
    Reviewed-by: Alexis La Goutte <alexis.lagoutte@gmail.com>
    Petri-Dish: Alexis La Goutte <alexis.lagoutte@gmail.com>
    Tested-by: Petri Dish Buildbot <buildbot-no-reply@wireshark.org>
    Reviewed-by: Jaap Keuter <jaap.keuter@xs4all.nl>
    (cherry picked from commit e11d4a891373c0f47062dd526a1f5ff6baa09ba6)
    Reviewed-on: https://code.wireshark.org/review/17281

commit f9598b8
Author: Pascal Quantin <pascal.quantin@gmail.com>
Date:   Wed Aug 24 08:10:27 2016 +0200

    IPMI: do not use col_set_str with non const strings
    
    Bug: 12782
    Change-Id: Ia082ccf5355d7f8dd6073861c59c804fecc96266
    Reviewed-on: https://code.wireshark.org/review/17289
    Reviewed-by: Pascal Quantin <pascal.quantin@gmail.com>
    (cherry picked from commit 5213496250aceff086404c568e3718ebc0060934)
    Reviewed-on: https://code.wireshark.org/review/17290

commit 96e712f
Author: Gerald Combs <gerald@wireshark.org>
Date:   Tue Aug 23 10:44:32 2016 -0700

    Update the release notes.
    
    Add missing new protocols, move a "what's new item", add a bug.
    
    Change-Id: I84e4cf36591a503d96032c6be9ba14bdc0dc016c
    Reviewed-on: https://code.wireshark.org/review/17273
    Petri-Dish: Gerald Combs <gerald@wireshark.org>
    Tested-by: Petri Dish Buildbot <buildbot-no-reply@wireshark.org>
    Reviewed-by: Gerald Combs <gerald@wireshark.org>

commit 02f6c94
Author: Pascal Quantin <pascal.quantin@gmail.com>
Date:   Tue Aug 23 19:41:48 2016 +0200

    MAC LTE: fix dissection of CE Mode A RAR message
    
    The Msg3 PUSCH narrowband index parameter depends on the UL bandwidth
    
    Change-Id: Ib57c85ffbd4c108e9c8f3d14fa53a48f0df1b0e6
    Reviewed-on: https://code.wireshark.org/review/17274
    Petri-Dish: Pascal Quantin <pascal.quantin@gmail.com>
    Tested-by: Petri Dish Buildbot <buildbot-no-reply@wireshark.org>
    Reviewed-by: Pascal Quantin <pascal.quantin@gmail.com>
    (cherry picked from commit 12cae9dc80a09ba0ed75b421d328143ac98a298b)
    Reviewed-on: https://code.wireshark.org/review/17276

commit 934bcae
Author: João Valverde <joao.valverde@tecnico.ulisboa.pt>
Date:   Mon Aug 8 16:48:14 2016 +0100

    checklicenses: Fix a FIXME
    
    We do not whitelist GPLv2 only code because of the
    incompatibility with GPLv3.
    
    Move the path exception to its proper place. These files are
    dual-licensed in the sense of "choose one or the other", not
    "both licenses are in use".
    
    If the exception becomes unnecessary later it can be removed,
    but let's get rid of the FIXME until then.
    
    Change-Id: Ia040284b72c2ff6588b0544896cc37ae19a61613
    Reviewed-on: https://code.wireshark.org/review/16957
    Reviewed-by: João Valverde <j@v6e.pt>
    (cherry picked from commit e3009b0b1c78b25337c915fb66232314f769688c)
    Reviewed-on: https://code.wireshark.org/review/17264
    Petri-Dish: Pascal Quantin <pascal.quantin@gmail.com>
    Reviewed-by: Peter Wu <peter@lekensteyn.nl>
    Reviewed-by: Pascal Quantin <pascal.quantin@gmail.com>

commit ac1b8b3
Author: Michael Mann <mmann78@netscape.net>
Date:   Tue Jul 26 09:27:07 2016 -0400

    Move airpdcap's print_debug_line() to airpdcap_debug.h
    
    It saves a little on file pollution and the g_warning call isn't
    bothered in the header file.
    
    Change-Id: Ia9bdd96d9d93bbba6811769c4e6e1ed9124c2e5a
    Reviewed-on: https://code.wireshark.org/review/16698
    Reviewed-by: Michael Mann <mmann78@netscape.net>
    Petri-Dish: Michael Mann <mmann78@netscape.net>
    Tested-by: Petri Dish Buildbot <buildbot-no-reply@wireshark.org>
    Reviewed-by: Anders Broman <a.broman58@gmail.com>
    (cherry picked from commit 9a73978ba5bbb78026721500aaf332f53e19d0cd)
    Reviewed-on: https://code.wireshark.org/review/17266
    Petri-Dish: Pascal Quantin <pascal.quantin@gmail.com>
    Reviewed-by: Peter Wu <peter@lekensteyn.nl>
    Reviewed-by: Pascal Quantin <pascal.quantin@gmail.com>

commit 562457a
Author: Peter Wu <peter@lekensteyn.nl>
Date:   Mon Aug 22 22:29:21 2016 +0200

    isakmp: fix type confusion
    
    Caught by ASAN with WIRESHARK_DEBUG_WMEM_OVERRIDE=simple set.
    
    Manually inspection of all type casts to decrypt_data_t and
    ikev2_decrypt_data_t showed no other users that do not check
    isakmp_version first.
    
    Change-Id: If889afff85a20e31222d33cbea8db3a91a77f389
    Reviewed-on: https://code.wireshark.org/review/17246
    Petri-Dish: Peter Wu <peter@lekensteyn.nl>
    Tested-by: Petri Dish Buildbot <buildbot-no-reply@wireshark.org>
    Reviewed-by: Michał Skalski <mskalski13@gmail.com>
    Reviewed-by: Anders Broman <a.broman58@gmail.com>
    (cherry picked from commit 52910f4e3fa7d771a671cd30bd5320d70aee3eec)
    Reviewed-on: https://code.wireshark.org/review/17260
    Petri-Dish: Pascal Quantin <pascal.quantin@gmail.com>
    Reviewed-by: Peter Wu <peter@lekensteyn.nl>
    Reviewed-by: Pascal Quantin <pascal.quantin@gmail.com>

commit f60c4b2
Author: Balint Reczey <balint@balintreczey.hu>
Date:   Tue Aug 23 03:01:32 2016 +0200

    debian: Fix libwscodecs' symbols file
    
    Change-Id: I168a630643fc7a6cbc27d7879006d31acca30e37
    Reviewed-on: https://code.wireshark.org/review/17263
    Petri-Dish: Balint Reczey <balint@balintreczey.hu>
    Reviewed-by: Balint Reczey <balint@balintreczey.hu>
    Tested-by: Balint Reczey <balint@balintreczey.hu>

commit 5a1c9a0
Author: Balint Reczey <balint@balintreczey.hu>
Date:   Tue Aug 23 02:49:34 2016 +0200

    debian: Refresh patches
    
    Change-Id: I7b756f3f88e664687602be6ced77f0d9a29a1238
    Reviewed-on: https://code.wireshark.org/review/17262
    Reviewed-by: Balint Reczey <balint@balintreczey.hu>

commit dba08c5
Author: Balint Reczey <balint@balintreczey.hu>
Date:   Tue Aug 23 02:25:17 2016 +0200

    debian: Make wireshark-common depend on proper libwiretap package
    
    Change-Id: I251f4807732fc091629899b6c792bc53a43d3e64
    Reviewed-on: https://code.wireshark.org/review/17261
    Reviewed-by: Balint Reczey <balint@balintreczey.hu>

commit 2697dbb
Author: Guy Harris <guy@alum.mit.edu>
Date:   Mon Aug 22 20:36:24 2016 -0700

    See if *this* convinces the compiler that valuelen and value will be set.
    
    Change-Id: I2a7715ac3255502f244a0d0a7e588b3a44c34f11
    Reviewed-on: https://code.wireshark.org/review/17258
    Reviewed-by: Guy Harris <guy@alum.mit.edu>
    (cherry picked from commit bee0cd776219fc3cd6ac6a932a1d25b944c299a0)
    Reviewed-on: https://code.wireshark.org/review/17259

commit e23a7d0
Author: Guy Harris <guy@alum.mit.edu>
Date:   Mon Aug 22 19:28:24 2016 -0700

    Fix handling of parameters with no value.
    
    Return a value length of 0 if there's no parameter value.
    
    (And don't return anything if the pointers through which we return them
    are null.)
    
    If no value is present, return NULL from ws_find_media_type_parameter().
    
    Change-Id: I32b57623d7651bcf065af5b81f2390a600988b21
    Reviewed-on: https://code.wireshark.org/review/17255
    Reviewed-by: Guy Harris <guy@alum.mit.edu>
    (cherry picked from commit ff00166a96d887e03899577caae3a355c26b0837)
    Reviewed-on: https://code.wireshark.org/review/17256

commit 1c167f8
Author: Guy Harris <guy@alum.mit.edu>
Date:   Mon Aug 22 18:25:33 2016 -0700

    Add cast to squelch "building with a C++ compiler" warnings.
    
    Change-Id: Ia95c40096018479aec99fafd93d7b95d31ba4723
    Reviewed-on: https://code.wireshark.org/review/17253
    Reviewed-by: Guy Harris <guy@alum.mit.edu>
    (cherry picked from commit 4458c48cf4b94da8626361499a044d7c8c096538)
    Reviewed-on: https://code.wireshark.org/review/17254

commit d6f83a3
Author: Guy Harris <guy@alum.mit.edu>
Date:   Mon Aug 22 17:53:10 2016 -0700

    Handle quoted-pairs in quoted-strings correctly.
    
    Backslash, in a quoted-string, escapes quotes (and any other characters,
    although the only ones that *need* escaping are a double-quote and a
    backslash).
    
    This means that the value of a parameter isn't just the raw characters
    from the parameters string; for a quoted string, it needs to be
    un-escaped, and for a *non*-quoted string, it has to stop at the first
    non-token character (you can put comments in).  So
    ws_find_media_type_parameter() must return an allocated string with the
    actual value.
    
    Get rid of index_of_char(); it doesn't do anything that strchr() does.
    
    Change-Id: I36328ea71c28fe6ac4918a8e73c281a25f6be844
    Reviewed-on: https://code.wireshark.org/review/17251
    Reviewed-by: Guy Harris <guy@alum.mit.edu>
    (cherry picked from commit 0b3a96222b39ea4df1fdc899a950c50ec56a1077)
    Reviewed-on: https://code.wireshark.org/review/17252

commit d24bf49
Author: Gerald Combs <gerald@wireshark.org>
Date:   Mon Aug 22 15:54:41 2016 -0700

    2.2.0rc1 → 2.2.0rc2.
    
    Change-Id: I8272c2a8eb05fd5215999657728f56cf09950920
    Reviewed-on: https://code.wireshark.org/review/17248
    Reviewed-by: Gerald Combs <gerald@wireshark.org>
