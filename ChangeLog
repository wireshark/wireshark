$Id: ChangeLog,v 1.31 2003/11/03 02:50:10 gerald Exp $

NOTE:  The format of this file has changed from previous versions.  

2003-09-10 05:35  guy

	* pcap-util.c, pcap-util.h, tethereal.c, gtk/Makefile.am,
	  gtk/Makefile.nmake, gtk/capture_combo_utils.c,
	  gtk/capture_combo_utils.h, gtk/capture_dlg.c,
	  gtk/capture_prefs.c, gtk/main.c:

	  Have "get_interface_list()" return a list of "if_info_t"
	  structures containing a pointer to an interface name and possibly
	  a pointer to an interface description (although that pointer
	  might be null if no description is available), rather than having
	  the Windows version glue together the name and description into a
	  single string.

	  Supply for the Linux "any" device the same description that
	  libpcap's "pcap_findalldevs()" returns.

2003-09-10 06:47  guy

	* pcap-util.c:

	  Fix a compile error on Windows.

2003-09-10 06:48  guy

	* epan/osi-utils.c:

	  Void functions don't return values.

2003-09-10 06:55  guy

	* gtk/: capture_dlg.c, capture_prefs.c:

	  If we have no interfaces, don't set the popdown list for
	  interface combo boxes.

2003-09-10 07:02  guy

	* gtk/capture_dlg.c:

	  If there's no saved interface name, set the interface name in the
	  Capture Options dialog box to the first string in the combo box,
	  not to the first interface name in the list, so we get the
	  description.

2003-09-10 07:17  jmayer

	* AUTHORS, Makefile.am, configure.in, gtk/Makefile.am:

	  Albert Chin:	  - AM_PROC_LIBTOOL is just an alias for
	  AC_PROG_LIBTOOL, which is	     called earlier.	   - Use
	  AM_CPPFLAGS instead of CFLAGS and CPPFLAGS to add inlude
	    directories

2003-09-10 09:49  sahlberg

	* packet-dcerpc-netlogon.c:

	  NETLOGON/DsrDeregisterDNSHostRecords : The dns_host field is a
	  REF pointer to a unicode string.  NOT a Unique pointer.

	  Update iethereal so that this packet is dissected properly

2003-09-10 19:23  guy

	* packet-teredo.c:

	  From Albert Chin: fix yet another C++-comment problem.

2003-09-10 19:27  guy

	* packet-gprs-ns.c:

	  Use the *correct* value_string for the IE Type field.

2003-09-10 20:07  guy

	* packet-lwapp.c:

	  Don't use "alloca()", and don't use "match_strval()", just use
	  "val_to_str()".

2003-09-10 21:19  gerald

	* epan/tvbuff.c:

	  Make tvb_find_tvb() return -1 if either tvb length is 0.
	  Otherwise, an assertion happens 'xxxx contains ""'.

2003-09-10 22:23  guy

	* file.c, print.h, tethereal.c, gtk/print_dlg.c:

	  When saving packets, we have a "Save only marked packets" option;
	  label the option to print only marked packets similarly, rather
	  than as "Suppress unmarked packets" (for consistency, and because
	  the latter isn't unlike a double negative).

2003-09-10 22:33  guy

	* doc/ethereal.pod.template:

	  Document the "Print only marked packets" option in the "Print"
	  dialog, and document that you can now search for packets with
	  particular text in the Info column or protocol tree.

2003-09-10 23:55  guy

	* prefs.c, prefs.h:

	  Don't export MAX_VAR_LEN - nobody uses it.

2003-09-11 00:08  guy

	* AUTHORS, packet-isup.c, doc/ethereal.pod.template:

	  From Anders Broman: add support for BICC dissection.

	  Change his e-mail address.

2003-09-11 10:31  sahlberg

	* packet-dcerpc.c:

	  Do not take the pointer to a stack object and pass it to the tap
	  system.  The tap listener will try to parse this pointer at a
	  much later stage where the stack frame where this object lived
	  will have dissapeared and possible got overwritten.

	  best that can happen is that service response times for dcerpc
	  interfaces is screwed up more probable is that we get a coredump

2003-09-11 13:24  sahlberg

	* AUTHORS, packet-dcerpc-netlogon.c:

	  From Jean-Baptiste Marchand

	  update of the type of pointer used for DsrGetSiteName reply
	  packets

2003-09-11 13:36  sahlberg

	* AUTHORS, Makefile.am, Makefile.nmake, packet-t38.c:

	  From Hans Viens : T38 dissector

2003-09-11 13:37  sahlberg

	* doc/ethereal.pod.template:

	  From hans Viens: T38 dissector

2003-09-12 02:48  sahlberg

	* file.c, file.h, packet-frame.c, doc/ethereal.pod.template,
	  epan/column-utils.c, epan/frame_data.h, gtk/main.c, gtk/main.h,
	  gtk/menu.c:

	  Added TimeReference frames.

	  One can now select a packet and mark it as a TimeReference packet
	  using the menu.  A TimeReference packet will be indicated by
	  having all timestamp related column entries replaced by the
	  string *REF* A TimeReference packet will always be displayed in
	  the packet pane, and overrides any display filters.

	  When a frame is a TimeReference frame, all later frames will
	  calculate the TimeRelativeToFirstPacket  relative to the
	  timestamp of the TimeReference frame instead of the first frame
	  of the capture.

	  You can have any number of TimeReference frames you like.

2003-09-12 04:52  sahlberg

	* packet-frame.c:

	  Attempt to prettify frame.time_relative and some other fields

2003-09-12 05:52  sahlberg

	* packet-tcp.c, packet-tcp.h:

	  Enhancement to the TCP dissector: Track window scaling and
	  display the window field after it has been scaled to its real
	  value

	  If we have seen a SYN packet with a WindowScalingOption then if
	  the option to use RelativeSequence numbers has been enabled, then
	  ethereal will change the presented window field to be the window
	  after it has been scaled to the real value.

	  This obviously only works if we have seen the SYN packet and if
	  the SYN packet contained a window scaling option

2003-09-12 10:32  sahlberg

	* AUTHORS, packet-dcerpc-netlogon.c, packet-dcerpc-netlogon.h:

	  upadtes to NETLOGON

2003-09-12 11:13  sahlberg

	* packet-dcerpc-netlogon.c:

	  Update to netlogon

	  make it decode DsrGetDCSiteCoverage replies properly

2003-09-12 19:40  guy

	* packet-cops.c:

	  From Kari Tiirikainen:

		  Updated the COPS dissector to print the names of the
	  Prefix
		  PRIDs correctly.  The last fix to PRID OID printout
	  caused this
		  minor problem for PPRIDs.

		  Rename a few variables to make the code more logical to
	  read.

2003-09-12 22:52  guy

	* packet-aodv.c:

	  According to draft-ietf-manet-aodv-13, "the only changes to the
	  protocol are that the address fields are enlarged", so presumably
	  that supercedes the now-expired draft-perkins-aodv6-01 which
	  gives different type numbers for V6.	We support both - the
	  draft-ietf-manet-aodv-13 messages are dissected based on the
	  address type of the source address, while the
	  draft-perkins-aodv6-01 messages are dissected as V6.

	  Handle the Route Reply Acknowledgment message.

2003-09-13 00:57  guy

	* packet-aodv.c:

	  According to draft-ietf-manet-aodv-13, the only differences
	  between V4 and V6 AODV messages is the addresses in the message.

	  According to the now-expired draft-perkins-aodv6-01, some of the
	  messages differ in the order of the fields as well.

	  Dissect the draft-ietf-manet-aodv-13 messages correctly.

2003-09-14 20:59  jmayer

	* packet-gtp.c:

	  Fix warning: guint8 is always <= 255

2003-09-14 21:28  gerald

	* packet-gtp.c:

	  Fix a buffer overflow in msisdn_to_str().  Clean up string
	  pointer handling in it, imsi_to_str(), and id_to_str() a bit.

2003-09-15 18:31  guy

	* packet-gtp.c:

	  Use "int"s as array indices - it squelches a
	  signed-vs-unsigned-comparison complaint in one case, and it's a
	  generally good habit.

2003-09-15 18:40  guy

	* AUTHORS, packet-ieee80211.c, doc/ethereal.pod.template:

	  From Ritchie: dissect country information tag.

2003-09-15 18:49  guy

	* packet-bssgp.c:

	  From Josef Korelus: call the data dissector on the contents of
	  the LLC PDU information element.

2003-09-15 19:04  guy

	* epan/filesystem.c, gtk/dcerpc_stat.c,
	  gtk/endpoint_talkers_table.c, gtk/fc_stat.c, gtk/io_stat.c,
	  gtk/mgcp_stat.c, gtk/rpc_stat.c, gtk/smb_stat.c:

	  From Graeme Hewson:

		  Don't crash if "-z" is used on the command line when a
	  live
		  capture is being done (e.g., with "-k -S" - in that case,
		  "cfile.filename" is null when the window is created),
	  just don't
		  display the file name in the title.

		  Don't set the title of a non-existent window - create the
	  window
		  first.

2003-09-15 19:08  guy

	* packet-isakmp.c:

	  From Yaniv Kaul: add AES-XCBC-MAC to the list of authentication
	  methods, per RFC 3566.

2003-09-15 20:37  guy

	* cfile.h, file.c, gtk/dcerpc_stat.c, gtk/endpoint_talkers_table.c,
	  gtk/fc_stat.c, gtk/io_stat.c, gtk/mgcp_stat.c, gtk/rpc_stat.c,
	  gtk/smb_stat.c:

	  Keep a "display name" as part of a capture_file structure; for
	  live capture temporary files, it's "<capture", and for saved
	  capture files, it's the last component of the pathname of the
	  file.  Use that in various places when displaying the file name.

2003-09-15 20:45  guy

	* gtk/main.c:

	  Don't allow -k and a capture file to both be specified on the
	  command line - either we're doing a live capture or we're reading
	  a saved capture file, we can't do both at the same time.

2003-09-15 22:16  guy

	* cfile.h, file.c, file.h, gtk/dcerpc_stat.c,
	  gtk/endpoint_talkers_table.c, gtk/fc_stat.c, gtk/io_stat.c,
	  gtk/mgcp_stat.c, gtk/rpc_stat.c, gtk/smb_stat.c:

	  Add a routine to return the display name for a "capture_file"
	  structure, rather than constructing that name when a capture file
	  is opened and putting a pointer to it in that structure.

2003-09-15 22:17  guy

	* gtk/tcp_graph.c:

	  Get rid of a no-longer-relevant comment.

2003-09-15 22:32  guy

	* gtk/: endpoint_talkers_eth.c, endpoint_talkers_fc.c,
	  endpoint_talkers_fddi.c, endpoint_talkers_ip.c,
	  endpoint_talkers_ipx.c, endpoint_talkers_tcpip.c,
	  endpoint_talkers_tr.c, endpoint_talkers_udpip.c:

	  Get rid of a bunch of unnecessary #includes.

2003-09-15 22:48  guy

	* capture.c, file.c, file.h, tethereal.c, gtk/file_dlg.c,
	  gtk/main.c:

	  Rename various capture file routines to have names starting with
	  "cf_".

2003-09-15 23:15  guy

	* capture.c, capture.h, gtk/main.c:

	  Don't pop up tap windows specified with "-z" options until we
	  have a capture file open.

2003-09-15 23:20  guy

	* gtk/main.c:

	  Clean up an error message.

2003-09-15 23:28  guy

	* file.c:

	  We no longer pop up tap windows until we have a capture file
	  open, so we don't have to worry about the file name being null
	  when "cf_get_display_name()" is called.  (It should never be
	  called before we have a capture file open; if it is, that's a
	  bug.)

2003-09-15 23:48  guy

	* capture.c:

	  Make sure we return FALSE in all the failure paths in
	  "do_capture()".

2003-09-16 17:36  guy

	* packet-distcc.c:

	  Re-register the dissector if a preference changes - otherwise,
	  changing the TCP port number won't have any effect.

2003-09-16 17:42  guy

	* packet-smtp.c:

	  There's no preference setting for the SMTP TCP port (and SMTP has
	  a well-known port), so we remove the extra code to handle
	  changing it - if it ever becomes useful to have the port number
	  settable, we can put it back.

2003-09-16 20:41  guy

	* gtk/tcp_graph.c:

	  Handle PPP with a pseudo-header.

2003-09-17 15:58  jfoster

	* packet-socks.c:

	  Fix recursive heap overflow problem.	When a socks connection was
	  used to create a second socks connection the socks dissector
	  would be called recursively until a heap overflow occurred.

2003-09-17 19:39  guy

	* gtk/: bootp_stat.c, dcerpc_stat.c, endpoint_talkers_eth.c,
	  endpoint_talkers_fc.c, endpoint_talkers_fddi.c,
	  endpoint_talkers_ip.c, endpoint_talkers_ipx.c,
	  endpoint_talkers_tcpip.c, endpoint_talkers_tr.c,
	  endpoint_talkers_udpip.c, fc_stat.c, http_stat.c, io_stat.c,
	  menu.c, mgcp_stat.c, rpc_progs.c, rpc_stat.c, smb_stat.c,
	  tap_rtp.c, wsp_stat.c:

	  Have "register_tap_menu_item()" put the item under Tools, not
	  Tools/Statistics; change the taps to put things under Statistics
	  themselves.  That allows taps to go elsewhere if appropriate.

2003-09-17 20:24  guy

	* packet-smpp.c:

	  From Olivier Biot: put a summary into the top-level SMPP item in
	  the protocol tree.

2003-09-18 19:19  guy

	* packet-tcp.c:

	  Don't store the setting of the window scale option unless the
	  "Relative sequence numbers and window scaling" option is set, as
	  that option says it controls whether we attempt to display the
	  real post-scaling window size.

	  Also, don't store it unless the "Analyze TCP sequence numbers"
	  option is set, as "Relative sequence numbers and window scaling"
	  requires it, because, unless "Analyze TCP sequence numbers" is
	  set, we don't set up conversations for TCP connections and don't
	  have a pool of data structures for per-connection information
	  into which to store the window scale option value.

2003-09-18 21:38  gerald

	* packet-gtp.c:

	  From Michal Melerowicz: Properly terminate the return string in
	  msisdn_to_str().

	  Do the same for imsi_to_str().

2003-09-18 21:42  gerald

	* packet-gtp.c:

	  Make the string variables in the *_to_str() functions non-static.

2003-09-19 04:08  guy

	* wiretap/erf.c:

	  From Jesper Peterson: add support for AAL5 records in ERF files,
	  treating them as PDUs with an AAL5 trailer.

2003-09-19 04:16  guy

	* AUTHORS, Makefile.am, Makefile.nmake, packet-rtp-events.c,
	  packet-rtp-events.h, doc/ethereal.pod.template:

	  From Kevin A. Noll: RFC 2833 RTP Events support.

2003-09-19 04:27  guy

	* packet-rtp-events.c:

	  Use bitfields for the end-of-event, reserved, and volume fields.

	  Don't fetch fields until you need them, so you don't throw an
	  early exception.

	  Give the fields names starting with the name of the protocol.

2003-09-19 04:52  guy

	* file.c, tethereal.c:

	  From Lars Roland: initialize the flags.ref_time field of a
	  frame_data structure.

2003-09-19 05:30  tpot

	* packet-dcerpc.c:

	  Put the presentation context list and transfer syntax list of a
	  dcerpc bind request into some subtrees to make things look a bit
	  nicer.

2003-09-19 07:24  guy

	* gtk/: bootp_stat.c, dcerpc_stat.c, endpoint_talkers_eth.c,
	  endpoint_talkers_fc.c, endpoint_talkers_fddi.c,
	  endpoint_talkers_ip.c, endpoint_talkers_ipx.c,
	  endpoint_talkers_tcpip.c, endpoint_talkers_tr.c,
	  endpoint_talkers_udpip.c, fc_stat.c, http_stat.c, io_stat.c,
	  menu.c, menu.h, mgcp_stat.c, rpc_progs.c, rpc_stat.c, smb_stat.c,
	  tap_rtp.c, wsp_stat.c:

	  Provide a mechanism by which a tap can arrange to have its menu
	  enabled or disabled based on a currently-selected packet (or lack
	  of same) or a currently-selected protocol tree item (or lack of
	  same).  Not currently used, but necessary if we ever make the TCP
	  graph stuff a tap.  API is tentative and subject to change.

	  Also, enable and disable taps based on whether we have any
	  packets to process.

2003-09-20 03:20  guy

	* packet-ieee80211.c:

	  Give the tag number a value_string table, and have common code,
	  rather than tag-specific code, put it, and the tag length, into
	  the protocol tree.  Make those fields FT_UINT8, as they're one
	  byte long.

	  Don't pass to "dissect_vendor_specific_ie()" variables whose
	  names and values are the same as global variables.

2003-09-20 03:31  guy

	* packet-osi.c:

	  From Akira Endoh: handle the NLPID for PPP.

2003-09-20 03:48  guy

	* packet-ieee80211.c:

	  From Richie:

		  the units for output power are dBm, not dbi;

		  decode multiple start channel/number of channels/output
	  power
		  combinations;

		  display the output power as a signed value.

	  Additional change from Martijn Schipper to fix the display of the
	  output power.

	  Pass the tagged data value pointer to
	  "dissect_vendor_specific_ie()".

	  Don't special-case unknown tag values - use "val_to_str()" even
	  for unknown tag values, and handle the value in the "default:"
	  case.

2003-09-20 04:25  guy

	* packet-ncp-int.h, packet-ncp2222.inc:

	  From Greg Morris: update the Info column even if we're not
	  building a protocol tree.

2003-09-20 04:59  guy

	* gtk/: dlg_utils.c, file_dlg.c:

	  From Giles Scott:

		  in GTK+ 2.x, center dialogs on the parent;

		  make the file selection dialogs transient for the main
	  window,
		  just as other dialogs are.

	  Update Gerald's e-mail address.

2003-09-20 08:56  guy

	* packet-gtp.c:

	  You can't safely return from a routine a pointer to an automatic
	  variable.

2003-09-20 08:56  guy

	* AUTHORS, Makefile.am, Makefile.nmake, packet-dcerpc-drsuapi.c,
	  packet-dcerpc-drsuapi.h:

	  From Jean-Baptiste Marchand: initial DRSUAPI (Active Directory
	  directory replication) support.

2003-09-20 09:41  guy

	* AUTHORS, Makefile.am, packet-tacacs.c, packet-tacacs.h,
	  doc/ethereal.pod.template:

	  From Emanuele Caratti: full TACACS+ dissection.

2003-09-20 09:54  guy

	* packet-tacacs.c:

	  Arrange to free the buffer allocated for the decrypted tvbuff.

2003-09-20 10:06  guy

	* configure.in:

	  Put back the AM_PROG_LIBTOOL call, as some older versions of the
	  auto* tools and/or libtool require it.

2003-09-21 20:05  gerald

	* packet-atalk.c, packet-bpdu.c, packet-gtp.c, packet-q931.c,
	  packet-quake2.c, packet-quake3.c, packet-quakeworld.c,
	  packet-rx.c, packet-sctp.c, packet-x11.c, gtk/mgcp_stat.c:

	  Remove a bunch of duplicate semicolons.

2003-09-22 00:59  tpot

	* packet-dcerpc-netlogon.c:

	  A bunch of fixups for the NETLOGON sam database synchronisation
	  dissector:

	    - some rids marked as user are actually groups

	    - decorate some strings higher up in the tree

	    - dissect the delta id as such and add value string text item

2003-09-22 09:06  sahlberg

	* packet-frame.c:

	  Add filterable field for REF TIME frames so it is easy to search
	  for them

2003-09-22 09:08  sahlberg

	* gtk/menu.c:

	  Update the menu text for Time Reference  and give it a hot-key :
	  ctrl-T

2003-09-23 02:35  guy

	* packet-eapol.c, packet-ieee80211.c, packet-ieee80211.h:

	  Get rid of some unnecessary includes.

	  Instead of using "dissect_vendor_specific_ie()" to dissect the
	  WPA key data, turn the code to dissect a collection of 802.11
	  tagged parameters into a routine, use that routine when
	  dissecting 802.11 management frames, and also use it to dissect
	  the key data.

2003-09-23 03:18  guy

	* packet-tacacs.c:

	  From Emanuele Caratti: fix a leak in md5_xor.

2003-09-23 06:25  oabad

	* gtk/main.c:

	  Temporary patch for the packet_list column resize problem in
	  gtk2.

	  We should use the same test (event_button->window ==
	  GTK_CLIST(w)->clist_window) we already use in gtk v1.2 code but
	  in doesn't seem to work in gtk2.

2003-09-23 12:06  sahlberg

	* packet-dcerpc-lsa.c, packet-dcerpc-lsa.h, packet-dcerpc-samr.c,
	  packet-dcerpc-samr.h:

	  From JBM Update all names for SAMR and LSA functions so they
	  match the function names in the API

2003-09-23 18:09  guy

	* gtk/dfilter_expr_dlg.c:

	  The relation list is always displayed (that's been true for a
	  while) - we don't need to support making it visible or not
	  depending on the selected field.

2003-09-23 18:22  guy

	* packet-ncp2222.inc:

	  From Greg Morris: properly initialize request_value->info_string
	  using "strcpy()", not "strcat()".

2003-09-23 18:36  guy

	* packet-per.c:

	  From Graeme Reid: modified PER choice dissector to correctly
	  handle numbered choices starting with non-zero values (eg X.880
	  ROS).

2003-09-23 18:40  guy

	* AUTHORS, Makefile.am, Makefile.nmake, packet-h225.c,
	  packet-h225.h, doc/ethereal.pod.template:

	  From Graeme Reid: H.450 support.

2003-09-23 18:59  guy

	* packet-h450.c:

	  From Graeme Reid: H.450 support.

2003-09-23 21:37  guy

	* packet-tacacs.c:

	  As doc/README.developer's "Portability" section says:

		  Don't use "bzero()", "bcopy()", or "bcmp()"; instead, use
	  the
		  ANSI C routines

			  [memset, memcpy, memcmp] ...

		  Not all platforms necessarily have
	  "bzero()"/"bcopy()"/"bcmp()",
		  and those that do might not declare them in the header
	  file on
		  which they're declared on your platform.

	  Make it so.

2003-09-23 22:04  guy

	* packet-ncp2222.inc:

	  From Greg Morris: get the request data before using it, if we
	  don't already have it.

2003-09-24 00:47  guy

	* cfile.h, file.c, file.h, globals.h, gtk/main.c, gtk/menu.c,
	  gtk/prefs_dlg.c, gtk/proto_draw.c:

	  Make "finfo_selected" a member of a "capture_file" structure
	  rather than an independent global variable.

2003-09-24 02:36  guy

	* file.c, menu.h, gtk/bootp_stat.c, gtk/dcerpc_stat.c,
	  gtk/endpoint_talkers_eth.c, gtk/endpoint_talkers_fc.c,
	  gtk/endpoint_talkers_fddi.c, gtk/endpoint_talkers_ip.c,
	  gtk/endpoint_talkers_ipx.c, gtk/endpoint_talkers_tcpip.c,
	  gtk/endpoint_talkers_tr.c, gtk/endpoint_talkers_udpip.c,
	  gtk/fc_stat.c, gtk/http_stat.c, gtk/io_stat.c, gtk/main.c,
	  gtk/menu.c, gtk/menu.h, gtk/mgcp_stat.c, gtk/rpc_progs.c,
	  gtk/rpc_stat.c, gtk/smb_stat.c, gtk/wsp_stat.c:

	  Pass a pointer to a "capture_file" structure to
	  "set_menus_for_selected_packet()" and
	  "set_menus_for_selected_tree_row()", and have them decide whether
	  to enable or disable menu items based on whether that structure
	  indicates that a packet or field is selected and, if one is, on
	  its properties.

	  Pass to the "selected packet enabled" routine for a menu item the
	  "frame_data" and "edt" members of the "capture_file" structure,
	  and pass to the "selected tree row enabled" routine the
	  "field_info" member of that structure.

	  Clear "cf->current_frame" if no packet is selected.

2003-09-24 03:34  guy

	* packet-ncp-int.h, packet-ncp2222.inc:

	  Create a protocol tree if we don't have one, we're constructing
	  the Info column, and we need stuff from the protocol tree for the
	  Info column.

	  Go back to the previous scheme for constructing the Info column;
	  the previous change fixes the problems for which the Info column
	  changes were fixes.

2003-09-24 06:15  oabad

	* gtk/: Makefile.am, gtkclist.c, gtkclist.h, gtkclist_v12.c,
	  gtkclist_v12.h:

	  Renamed gktclist.[ch] to gtkclist_v12.[ch] to avoid conflicts
	  with the real gtkclist.h file when building the gtk+ v2 gui.

2003-09-24 06:18  oabad

	* gtk/main.c:

	  In packet_list_button_pressed_cb (gtk2 version) : - put back the
	  event_button->window == GTK_CLIST(w)->clist_window test   now
	  that we use the correct structure definition for GtkCList (from
	  the right include file, not from our version of gtkclist.h).

2003-09-24 07:48  guy

	* AUTHORS, doc/ethereal.pod.template, gtk/Makefile.am,
	  gtk/Makefile.nmake, gtk/rtp_analysis.c, gtk/rtp_analysis.h,
	  gtk/rtp_stream.c, gtk/rtp_stream.h, gtk/rtp_stream_dlg.c,
	  gtk/rtp_stream_dlg.h, gtk/tap_rtp.c:

	  From Lars Ruoff: rewritten RTP analysis module.

2003-09-24 08:05  guy

	* AUTHORS, Makefile.am, packet-dcerpc-dcom.h, packet-dcerpc-oxid.c:

	  From Yaniv Kaul: DCERPC OXID operation #5 dissection.

2003-09-24 08:43  guy

	* gtk/: capture_dlg.c, dlg_utils.c, dlg_utils.h, file_dlg.c,
	  print_dlg.c:

	  Add a "file_selection_new()" routine that does all the
	  positioning (GTK+ 2.x) and transient-for setting that's done for
	  other dialogs, and use it for dialogs that come from the main
	  window or from children of the main window.

2003-09-24 18:35  guy

	* epan/plugins.c, plugins/plugin_api.h, plugins/plugin_api_list.c,
	  plugins/Xass-list, plugins/Xplugin_api.c, plugins/Xplugin_api.h,
	  plugins/Xplugin_api_decls.h, plugins/Xplugin_table.h:

	  From Tomas Kukosa:

		  Remove the internal packet-per.c functions
		  "dissect_per_length_determinant()" and
		  "dissect_per_normally_small_nonnegative_whole_number()"
	  from the
		  plugin API, as they shouldn't be used outside the PER
	  dissector.

		  Remove the H.225/H.245 functions
		  "dissect_h225_TransportAddress()" and
		  "dissect_h245_NonStandardParameter()" from the plugin API
	  until
		  we really need them in plugins.

		  Add the string dissector table functions to the plugin
	  API.

2003-09-24 18:41  guy

	* plugins/megaco/packet-megaco.c:

	  From Anders Broman: fix a crash, and fix trailing whitespace on
	  Transaction ID.

2003-09-24 23:35  guy

	* packet-ieee80211.c, packet-lwapp.c:

	  From David Frascone: have an 802.11 dissector that byte-swaps the
	  frame control field, and have a preference in the LWAPP dissector
	  to specify whether to use it or the regular 802.11 dissector, as
	  some hardware sends out LWAPP-encapsulated 802.11 packets with a
	  byte-swapped FC field.

2003-09-24 23:53  guy

	* wiretap/README.developer:

	  From packet steve: update to give the correct name for
	  "file_access.c", and add a discussion of how data_offset works.

2003-09-25 00:08  guy

	* tethereal.c:

	  From Matthijs Melchior: check whether the ring buffer timeout has
	  expired *before* writing a packet, rather than *after* writing a
	  packet, so that if you get no packets for a sufficiently long
	  period that the timeout expires before you get a new packet, the
	  new packet is in the beginning of a new file (as you might get
	  more packets right after that, and want them to be in the new
	  file, rather than have the first packet at the end of one file
	  and the rest of the packets in another file).

2003-09-25 00:37  guy

	* gtk/tcp_graph.c:

	  From Laurent Rabret:

		  handle 802.1Q frames;

		  catch the destroy signal on the main Ethereal window and
	  destroy
		  our windows (avoids a crash).

	  Get the PPP type value for IP from "ppptypes.h" rather than
	  defining it ourselves.

2003-09-25 01:50  tpot

	* reassemble.c:

	  When showing a fragment subtree, put spaces after colons to make
	  things look a bit nicer.  Also separate frame and payload data by
	  a comma.

2003-09-25 08:20  guy

	* file.c:

	  If the currently selected frame doesn't pass the display filter,
	  select the closest frame to that frame that did pass the display
	  filter, if any did.

2003-09-25 08:31  guy

	* file.c:

	  Correctly handle the case where the selected frame doesn't pass
	  the filter and no frames after it pass the filter either.

2003-09-25 11:27  guy

	* packet-ncp2222.inc:

	  In "nds_defrag()", handle "request_value->ncp_rec" being null.

	  In "dissect_nds_request()", insert the request information into
	  the hash table the first time we see the packet, regardless of
	  whether we created a new conversation or not.

2003-09-25 19:35  guy

	* rtp_pt.h:

	  Add PT_CN_OLD, so the RTP analysis code can get the RTP payload
	  types it needs from this header.

2003-09-25 19:35  guy

	* gtk/: rtp_analysis.c, rtp_stream.c:

	  RTP analysis updates from Lars Ruoff:

		  - can now handle streams with different payload types
		  - detects payload changes
		  - detects comfort noise (PT=13 and 19)
		  - status line now shows: sequence errors, payload
	  changes,
		    comfort noise (if any)
		  - uses colours for lines with status != "Ok"
		  - new button "next": jumps to next line with status !=
	  "Ok"
		    (starting from selected line)
		  - fixed: wrong jitter calculation (bug from tap_rtp)
		  - fixed: marker was not shown on first packet or
	  erroneous
		    packets (bug from tap_rtp)
		  - code refactored to improve readability and reuse

2003-09-26 02:09  guy

	* gtk/: bootp_stat.c, dcerpc_stat.c, fc_stat.c, http_stat.c,
	  io_stat.c, mgcp_stat.c, rpc_stat.c, rtp_analysis.c,
	  rtp_stream_dlg.c, smb_stat.c, wsp_stat.c:

	  Assorted GUI cleanups.

2003-09-26 04:43  tpot

	* packet-dcerpc.c:

	  Use zero to mean we haven't seen any authentication level
	  information in dcerpc_auth_info since auth_level is an unsigned
	  type.  Zero is not a valid authentication level anyway
	  (s13.1.2.1, p611 CAE spec).

	  Remove two inscrutable debugging comments that don't seem to mean
	  anything.

2003-09-26 06:30  tpot

	* packet-dcerpc.c, packet-dcerpc.h, packet-ntlmssp.c:

	  This commit refactors the dcerpc authentication subdissectors for
	  handling encrypted request/response PDUs.  Instead of having
	  dissection function pointers which perform both decryption and
	  dissection, the function pointers now only decrypt the DCERPC
	  fragment payload.  Dissection is handled by the
	  dcerpc_try_handoff() function (with DCERPC fragment reassembly if
	  necessary).

	  Details:

	   - Move the dcerpc_auth_info struct into dcerpc.h as it is now
	  used in
	     the function prototype for the decryption function handlers.

	   - decode_encrypted_data() was refactored to take a boolean
	  request
	     parameter instead of passing the DCERPC PDU packet type.

	   - A tvbuff_t * data field was added to dcerpc_auth to hold the
	     verifier.	This is passed as an argument to the decryption
	  function
	     handlers.

	   - Dissection of verifiers in request and response PDUs was moved
	  to
	     before the payload.

	   - The dissect_dcerpc_cn_stub() function was refactored to
	  perform
	     the decryption process and hand decrypted data to the
	  reassembly
	     code instead of performing the decryption after reassembly.

	   - Removed references to decrypted_info_t as it's not necessary
	     anymore.

	  Code was tested using encrypted and unencrypted fragmented PDUs.
	  Before this commit ethereal could not dissect unencrypted (!)
	  fragmented PDUs correctly.

2003-09-26 08:19  guy

	* packet-lapb.c:

	  The LAPB dissector can be called from the Ethernet dissector;
	  don't assume we have an X.25 pseudo-header.

2003-09-26 20:00  guy

	* packet-sip.c:

	  Make the non-heuristic SIP dissector reject the packet if it
	  doesn't look like a SIP packet, so some other dissector gets a
	  chance at it.

	  When looking for the blank line separating headers from data, use
	  "tvb_find_line_end()" so we handle CR/LF and LF as end-of-line
	  indications (RFC 2543 says "senders MUST terminate lines with a
	  CRLF", but it also says "but receivers MUSTalso interpret CR and
	  LF by themselves as line terminators"), and return an offset past
	  the end of the buffer, rather than -1, if we don't find it (not
	  all packets have one).

	  When checking whether a header is one we know about, do a
	  case-insensitive comparison (RFC 2543 says header field names are
	  case-insensitive).

2003-09-26 21:32  guy

	* packet-sip.c:

	  For (non-heuristic) SIP-over-TCP, dissect stuff that's neither a
	  request nor a response as continuation data.	For
	  SIP-over-everything-else, reject it.

	  Parse the headers regardless of whether we're building a protocol
	  tree or not; if we're not, we just do it to look for a blank line
	  separating the headers from the body.  Do that instead of
	  scanning for the message body separately.

	  When scanning for a colon, don't scan past the end of the line.

2003-09-26 22:20  guy

	* Makefile.am, Makefile.nmake, packet-h225.c, packet-h225.h,
	  packet-h245.c, packet-h245.h, packet-h450.c, t35.c, t35.h:

	  From Tomas Kukosa:

		  1) string tables for t35CountryCode, t35Extension and
		     h221ManufacturerCode were moved into the new file
	  t35.c
		     because they are common for more dissectors

		  2) the
	  dissect_h245_NonStandardParameter_with_extension_marker()
		     was moved from h245 to h225 and renamed to
		     dissect_h225_NonStandardParameter() because the
		     NonStandardData type is different for H.225.0 and
	  H.245

		  3) type of the "h245.nsp.object" dissector table was
	  changed from
		     FT_UINT32 to FT_STRING, so it can select a dissector
	  based on
		     an OID rather than the Adler-32 hash of an OID

		  4) the "h225.nsp.object" and "h225.nsp.h221" dissector
	  tables
		     were created

2003-09-26 22:29  guy

	* gtk/rtp_stream_dlg.c:

	  Get the RTP payload types from rtp_pt.h rather than defining them
	  ourselves.

2003-09-26 23:11  guy

	* gtk/: capture_combo_utils.c, capture_prefs.c:

	  From Nathan Jennings:

		  update the CList as you enter/modify options;

		  give Windows users OS descriptions in the displayed
	  devices
		  list;

		  display at least 5 rows in the lists;

		  get rid of the "extra" CList for storing edited values.

2003-09-27 23:34  guy

	* packet-dcerpc-srvsvc.c, packet-dcerpc-srvsvc.h:

	  From Jean-Baptiste Marchand: add names of DFS-related operations
	  in SRVSVC.

2003-09-27 23:43  guy

	* packet-dcerpc-wkssvc.c, packet-dcerpc-wkssvc.h:

	  From Jean-Baptiste Marchand: add names of operations in WKSSVC.

2003-09-27 23:45  sahlberg

	* packet-dcerpc-messenger.c:

	  From JBM   update the function names for Messenger

2003-09-27 23:48  sahlberg

	* packet-dcerpc-netlogon.c, packet-dcerpc-netlogon.h:

	  From JBM   update some function names in Netlogon

2003-09-27 23:51  guy

	* packet-isup.c:

	  From Anders Broman: further dissect APM messages containing BICC
	  stuff, and fix a bug in the "upgraded parameter code".

2003-09-28 00:00  sahlberg

	* tap-smbstat.c, gtk/smb_stat.c:

	  Update to SMB service response time stats.  For short packets, we
	  might not have enough of the payload to decode the transaction
	  info levels  and thus that data structure is NULL.

	  check the pointer to this struct first before we try to
	  dereference it.

2003-09-28 00:11  sahlberg

	* packet-smb.c:

	  in ReadAndX when reading what could potentially be the maxcount
	  high field assume that IF it is 0xFFFFFFFF  that it is not
	  maxcount high at all but instead just some padding/reserved
	  bytes.

	  If this field is 0xFFFFFFFF just ignore it.

2003-09-28 01:52  sahlberg

	* packet-mount.c, packet-nfs.c, packet-nfs.h, packet-nfsacl.c:

	  Prettify NFSv2     decorate COL_INFO and the tree pane as has
	  already been done for v3

2003-09-28 11:35  tpot

	* packet-dcerpc-reg.c, packet-dcerpc-reg.h:

	  Operation name updates for winreg pipe from Jean-Baptiste
	  Marchand.

2003-09-28 21:39  guy

	* epan/tvbuff.c:

	  "compute_offset_length()" must, if it returns FALSE, and
	  "exception" is non-null, set "*exception" to the appropriate
	  exception - its callers rely on it.

	  Now that it does that, there's no need for
	  "check_offset_length()" to check for a length of -1, as
	  "compute_offset_length()" does so, and therefore
	  "check_offset_length_no_exception()" does so.

2003-09-28 23:15  guy

	* wiretap/netxray.c:

	  It appears that, at least for gigabit pod captures, there are
	  time stamp differences between versions 002.001 and 002.002.

2003-09-29 00:01  tpot

	* packet-dcerpc-lsa.c, packet-dcerpc-lsa.h, packet-dcerpc-samr.c,
	  packet-dcerpc-samr.h:

	  More operation names updates from Jean-Baptiste Marchand.

2003-09-29 06:41  oabad

	* gtk/dfilter_expr_dlg.c:

	  - in show_relations() : select the first row of the relation_list
	  when	 using gtk+ v2.  - get rid of some unused variables.

2003-09-29 18:50  guy

	* packet-tacacs.c, packet-tacacs.h:

	  From Emanuele Caratti:

		  just use "g_free()" to free the buffer in "md5_xor()", as
	  it
		  doesn't throw exceptions;

		  temporarily #ifdef out "tacplus_acct_flags" pending the
		  arrival of code to dissect the TACACS+ accounting stuff.

2003-09-29 19:17  jmayer

	* packet-smb.c:

	  Added comment: XXX Argh maxcnt_high is guint16 and thus 16 bit ->
	  always false

2003-09-29 19:18  jmayer

	* tap-httpstat.c, gtk/http_stat.c:

	  Whitespace changes in order to make diff produce more readable
	  results

2003-09-29 19:20  jmayer

	* gtk/rtp_analysis.c:

	  use mkstemp instead of tmpnam

2003-09-29 19:32  jmayer

	* plugins/.cvsignore:

	  xyzzy

2003-09-29 21:12  guy

	* packet-isup.c:

	  From Michael Lum: fix some val_to_str calls to have a non-null
	  format string for unknown values.

2003-09-29 21:50  guy

	* packet-isup.c:

	  Clean up a bunch of length processing - use the reported length
	  rather than the captured length, and fix up some other stuff.

2003-09-30 20:51  guy

	* packet-nt-sonmp.c:

	  From Giles Scott: add some new hardware types.

2003-10-01 07:11  guy

	* packet-eth.c, packet-eth.h, packet-ethertype.c, packet-fw1.c,
	  packet-ieee8023.c, packet-ieee8023.h, packet-llc.c,
	  packet-null.c, packet-sll.c, packet-vlan.c, epan/packet.h,
	  wiretap/5views.c, wiretap/erf.c, wiretap/etherpeek.c,
	  wiretap/file_access.c, wiretap/iptrace.c, wiretap/lanalyzer.c,
	  wiretap/libpcap.c, wiretap/netmon.c, wiretap/nettl.c,
	  wiretap/netxray.c, wiretap/ngsniffer.c, wiretap/radcom.c,
	  wiretap/snoop.c, wiretap/toshiba.c, wiretap/visual.c,
	  wiretap/wtap-int.h, wiretap/wtap.h:

	  Have a pseudo-header for Ethernet packets, giving the size of the
	  FCS - 0 means "there is no FCS in the packet data", 4 means
	  "there is an FCS in the packet data", -1 means "I don't know
	  whether there's an FCS in the packet data, guess based on the
	  packet size".

	  Assume that Ethernet encapsulated inside other protocols has no
	  FCS, by having the "eth" dissector assume that (and not check for
	  an Ethernet pseudo-header).

	  Have "ethertype()" take an argument giving the FCS size; pass 0
	  when appropriate.

	  Fix up Wiretap routines to set the pseudo-header.  This means we
	  no longer use the "generic" seek-and-read routine, so get rid of
	  it.

2003-10-01 08:53  guy

	* packet-smb.c:

	  The max count high field is 32 bits, and, in order to compare it
	  against 0xffffffff, it has to be extracted into a 32-bit
	  variable.

2003-10-01 14:59  jmayer

	* doc/: .cvsignore, Makefile.am, ethereal-filter.pod.template,
	  ethereal.pod, ethereal.pod.template, tethereal.pod,
	  tethereal.pod.template:

	  Put the display-filter elements into it's own manpage
	  (ethereal-filter.4)

2003-10-01 15:09  jmayer

	* Makefile.am, configure.in:

	  Put the display-filter elements into it's own manpage
	  (ethereal-filter.4)

2003-10-01 18:19  guy

	* wiretap/wtap.def:

	  Have a pseudo-header for Ethernet packets, giving the size of the
	  FCS - 0 means "there is no FCS in the packet data", 4 means
	  "there is an FCS in the packet data", -1 means "I don't know
	  whether there's an FCS in the packet data, guess based on the
	  packet size".

	  Assume that Ethernet encapsulated inside other protocols has no
	  FCS, by having the "eth" dissector assume that (and not check for
	  an Ethernet pseudo-header).

	  Have "ethertype()" take an argument giving the FCS size; pass 0
	  when appropriate.

	  Fix up Wiretap routines to set the pseudo-header.  This means we
	  no longer use the "generic" seek-and-read routine, so get rid of
	  it.

2003-10-01 19:41  guy

	* doc/Makefile.am:

	  dfilter2pod.pl and ethereal-filter.pod.template are in $(srcdir)
	  (which defauls to the current directory), not in the parent
	  directory.

2003-10-01 19:44  guy

	* doc/Makefile.nmake:

	  Update for the new ethereal-filter man page.

2003-10-01 20:26  guy

	* doc/Makefile.am:

	  Put in some missing $(srcdir)/.

	  Get rid of redundant "../{t}ethereal.1" in CLEANFILES (they were
	  already there).

2003-10-01 20:27  guy

	* .cvsignore:

	  Add ethereal-filter.4.

2003-10-01 20:36  guy

	* doc/ethereal.pod:

	  Filters in Ethereal are usually display filters, not read
	  filters; go back to describing them as such.

2003-10-01 21:15  guy

	* packet-srvloc.c:

	  The PDU length is 3 bytes long in SLPv2.

	  The minimum number of bytes of SLP we have to reassemble is 5 -
	  it's nominally 4 for SLPv1, but we don't have a way of asking for
	  1 byte (the version) and then saying "I need N bytes of header to
	  get the PDU length, and an SLPv1 packet less than 12 bytes long
	  is bogus anyway.

2003-10-01 21:51  guy

	* packet-enip.c:

	  Reject frames with no command (too short) or an invalid command.

	  Clean up white space somewhat.

2003-10-02 06:13  guy

	* AUTHORS, Makefile.am, Makefile.nmake, asn1.c, asn1.h,
	  packet-tcap.c, packet-tcap.h, doc/ethereal.pod:

	  From Samuel Qu, Michael Lum, and Jeff Morriss: TCAP support, and
	  "asn_id_decode1()" variant of "asn_id_decode()".

2003-10-02 14:03  gerald

	* doc/ethereal-filter.pod.template:

	  Fix a malformed "=head1" tag.

2003-10-02 19:22  gerald

	* doc/tethereal.pod:

	  Add an example for "-d".

2003-10-02 21:04  guy

	* plugins/rtnet/packet-rtnet.c:

	  RTNET has no preferences, so don't register a preferences module
	  for it.

2003-10-02 21:06  guy

	* prefs.c, prefs.h, gtk/prefs_dlg.c:

	  Don't put an entry for a protocol into the Preferences dialog if
	  it doesn't have any settable preferences (for example, if it has
	  only obsolete preferences).

2003-10-02 21:18  guy

	* gtk/prefs_dlg.c:

	  From Tomas Kukosa: radio button groups are GSLists, which means
	  that the radio button group for a button changes when new buttons
	  are added to it (adding to the beginning of a singly-linked list
	  takes constant time, adding to the end takes time linear in the
	  length of the list, and a GSList * points to the beginning of the
	  list).  Re-fetch the radio button group each time through the
	  loop that adds new radio buttons to a radio button group for a
	  preference.

2003-10-02 21:37  guy

	* packet-dcerpc-dnsserver.c, packet-dcerpc-dnsserver.h:

	  From Jean-Baptiste Marchand: add names for new dnsserver
	  operations for W2K3.

2003-10-02 21:40  guy

	* packet-dcerpc-svcctl.c, packet-dcerpc-svcctl.h:

	  From Jean-Baptiste Marchand: add/update names for svcctl
	  operations.

2003-10-02 21:45  guy

	* packet-dcerpc-dfs.c, packet-dcerpc-dfs.h:

	  From Jean-Baptiste Marchand: add additional operation names for
	  dfssvc.

2003-10-02 21:48  guy

	* packet-dcerpc-browser.c, packet-dcerpc-browser.h:

	  From Jean-Baptiste Marchand: add operation names for browser
	  service.

2003-10-02 22:28  gerald

	* doc/Makefile.nmake, packaging/nsis/Makefile.nmake,
	  packaging/nsis/ethereal.nsi:

	  Fix document creation under Windows, add ethereal-filter.html to
	  the NSIS package.

2003-10-02 22:40  guy

	* t35.c, t35.h:

	  Add RCS IDs.

2003-10-02 22:44  guy

	* adler32.c, adler32.h, packet-etherip.c, packet-h450.c,
	  packet-ipsec-udp.c, packet-isns.c:

	  Add RCS IDs.

2003-10-03 04:41  guy

	* doc/tethereal.pod:

	  Fix a typo.

2003-10-03 09:09  sahlberg

	* packet-ipx.c, gtk/endpoint_talkers_table.c:

	  Update ipx and conversation list to make it possible to select
	  and filter for ipx conversations from the conversation list popup
	  menu

2003-10-03 20:18  tuexen

	* packet-sctp.c:

	  - Fixed a typo.  - Changed the default checksum algorithm from
	  Adler32 to CRC32C.

2003-10-03 20:58  guy

	* packet-isup.c:

	  From Anders Broman:

		  fix some cut and paste errors in "upgraded parameter"
	  routine;

		  more BICC work.

2003-10-03 21:03  guy

	* wiretap/ascend-scanner.l:

	  From Graham Bloice: define YY_NO_UNISTD_H on Win32, so that if
	  Flex was a UNIX version generating code that, by default, assumes
	  you have <unistd.h> (as might be the case with recent versions of
	  Cygwin, which I assume *does* supply <unistd.h>), but you're
	  building on a platform that lacks <unistd.h> (e.g., building with
	  MSVC++ or MinGW), you can still compile.

2003-10-03 21:12  jmayer

	* wiretap/ascend-scanner.l:

	  Use #ifndef HAVE_UNISTD_H instead of #ifdef _WIN32

2003-10-03 21:19  jmayer

	* gtk/rtp_analysis.c:

	  Graham Bloice: Add missing #include mkstemp.h

2003-10-03 22:38  guy

	* gtk/rtp_analysis.c:

	  Include "mkstemp.h" only if we're including our own "mkstemp()".

2003-10-03 23:09  guy

	* AUTHORS, Makefile.am, Makefile.nmake, packet-ansi_map.c:

	  From Michael Lum: ANSI MAP support.

2003-10-03 23:22  guy

	* plugins/gryphon/: NEWS, packet-gryphon.c, packet-gryphon.h:

	  From Steve Limkemann:

	      Added two new "well known destinations": SD_IOPWR AND
	  SD_UTIL.

	      Added logic to dissect the CMD_SET_TIME command.

	      Added an alterate destination for the CMD_PGM_START command.

	      Added logic to dissect the CMD_SCHED_MSG_REPLACE command.

	      Added logic to dissect the CMD_USDT_REGISTER command.

	      Added logic to dissect the CMD_USDT_SET_FUNCTIONAL command.

	      Added logic to dissect the following commands
		 CMD_IOPWR_GETINP
		 CMD_IOPWR_GETLATCH
		 CMD_IOPWR_CLRLATCH
		 CMD_IOPWR_GETOUT
		 CMD_IOPWR_SETOUT
		 CMD_IOPWR_SETBIT
		 CMD_IOPWR_CLRBIT
		 CMD_IOPWR_GETPOWER
		 CMD_UTIL_SET_INIT_STRATEGY
		 CMD_UTIL_GET_INIT_STRATEGY

	      Added the ability to recongnize more IOCTLS.  (For the
	  SJA1000 driver, LIN
		  and power drivers.)

	      Added the ability to recognize more card types.

	      Added dissection of more fields for CMD_SCHED_TX command.

	      Bug fixes and general updating.

2003-10-03 23:31  guy

	* packet-ranap.c:

	  From Michael Lum:

		  support for Global RNC ID;

		  fixed some typos

		  added push of 'NAS PDU' so that a GSM 24.008 (DTAP)
	  dissector
		  can be added.

2003-10-04 03:10  sahlberg

	* gtk/io_stat.c:

	  Fix to IO-Stat.

	  IO-Stat failed to produce Advanced/COUNT(*) statistics for fields
	  of type FT_NONE.  Fixed.

	  Now it is possible to do : Advanced/COUNT(*)
	  Filter:tcp.analysis.retransmission
	  Field:tcp.analysis.retransmission Advanced/COUNT(*)
	  Filter:tcp.analysis.duplicate_ack
	  Field:tcp.analysis.duplicate_ack

	  And it will plot the number of Retransmissions and Duplicate ACKs
	  seen in each time interval.

2003-10-04 16:44  guy

	* packet-isakmp.c:

	  If a payload type doesn't have a dissector function, don't crash
	  by calling through the null dissector pointer, just dissect it as
	  "Payload".

2003-10-05 05:04  sharpe

	* mkcap.c:

	  Add mkcap.c, a little utility to generate reasonable looking TCP
	  capture files for pedagogic use.

2003-10-05 14:58  sharpe

	* mkcap.c:

	  Further updates on mkcap.c

2003-10-05 21:57  jmayer

	* packet-dns.c:

	  Fix warning about strict-aliasing

2003-10-05 22:38  jmayer

	* plugins/docsis/packet-tlv.c:

	  Get rid of another strict-aliasing warning: verify_tfs is a
	  true-false-string : dereference it accordingly

2003-10-05 22:44  jmayer

	* packet-tzsp.c:

	  Fix 3 strict-aliasing warnings:   Use TFS(&var) instead of
	  VALS(&var) in case var is a true-false-string

2003-10-05 23:09  jmayer

	* packet-cops.c:

	  variable.type is of type u_char, so use 0 instead of NULL

2003-10-05 23:27  jmayer

	* packet-bssgp.c:

	  Another strict-aliasing warning fix - I hope I got this right :)

2003-10-06 02:01  jmayer

	* plugins/gryphon/packet-gryphon.c:

	  Fix 4 warnings in case of strict-aliasing by declaring timestamp
	  as time_t instead of int.

2003-10-06 07:26  guy

	* packet-lmi.c:

	  Update a URL.

2003-10-06 08:10  guy

	* packet-enip.c:

	  Fix the handling of padding bytes.

2003-10-06 08:35  guy

	* packet-dcerpc-rpriv.c, packet-dcerpc-spoolss.c, packet-isup.c,
	  packet-nlsp.c, packet-ranap.c, packet-sua.c:

	  From packet steve: get rid of some duplicate field definitions
	  (some aren't exactly duplicates, but they both set the same hf_
	  variable).

2003-10-06 08:58  guy

	* gtk/rtp_stream_dlg.c:

	  (Based on a patch from Lars Roland.)

	  Use "gtk_dialog_new()" to create the window - that doesn't create
	  a "dialog box" in the sense of a transient-for window, but it
	  does create a window with a button vbox that the code expects to
	  be present.

2003-10-06 09:08  guy

	* packet-ansi_map.c:

	  From Lars Roland: not all compilers like static const arrays with
	  unknown size, so don't use them.

2003-10-06 09:18  guy

	* AUTHORS, Makefile.am, Makefile.nmake, packet-alcap.c:

	  From Michael Lum: ALCAP (Q.2630.1) support.

2003-10-06 14:48  jmayer

	* packet-alcap.c:

	  Replace the forward declaration of msg_parm_strings by moving the
	  real declaration from the middle of the file to the place of the
	  forward declaration. This should make MSVC happy.

	  Spotted and proposed fix by Ulf Lamping.

2003-10-06 15:41  jmayer

	* plugins/gryphon/packet-gryphon.c:

	  check in the following comment:     /* XXX This code is neither
	  Endianess independent, nor will it work      * on platforms that
	  do not support the *optional* guin64 type	 */

2003-10-06 19:11  guy

	* doc/README.developer:

	  Add One More Item to the list of things not all compilers can
	  handle.

2003-10-06 19:25  guy

	* AUTHORS, Makefile.am, Makefile.nmake, packet-alcap.c,
	  packet-ansi_637.c, packet-ansi_683.c, packet-ansi_map.c:

	  From Michael Lum:

		  IS-637-A (SMS) support
		  IS-683-A (OTA) support
		  ANSI MAP updates

	  Fix a typo in the previous checkin.

2003-10-06 20:46  guy

	* packet-afs-register-info.h, packet-clnp.c, packet-fcdns.c,
	  packet-isup.c, packet-lmi.c, packet-lmp.c, packet-m3ua.c,
	  packet-nfsacl.c, packet-rsvp.c, epan/proto.c:

	  When registering a field, make sure its ID is -1 or 0 - if it's
	  not, that probably means you've registered two fields with the
	  same field ID variable, which is an error.

	  Fix the bugs doing so found.

2003-10-06 22:10  guy

	* gtk/io_stat.c:

	  Make the "needs_redraw" flag a gboolean, as it's a Boolean flag.

	  Rename "max_count_types and "max_calc_types" to
	  "count_type_names" and "calc_type_names", to make it clearer what
	  they are.

	  For the advanced statistics, give different error messages for
	  the case where no field name was specified and where an invalid
	  field name was specified.

	  Give better error messages for the cases where the calculation
	  type isn't supported for a particular field.

	  Initialize the calculation type for a given field.

2003-10-06 22:13  guy

	* gtk/io_stat.c:

	  Rename "max_tick_values" to "tick_interval_values", to make it
	  clearer what it is.

2003-10-07 03:09  guy

	* gtk/print_mswin.c:

	  From Gisle Vanem: if WIN32_LEAN_AND_MEAN is defined, <windows.h>
	  doesn't include <commdlg.h>, but "print_mswin.c" needs it, so
	  include it explicitly.

2003-10-07 03:35  guy

	* packet-ftp.c:

	  From Giles Scott: put the IP address and port number in PORT
	  requests and PASV responses into the protocol tree, and, for PASV
	  responses, create a conversation for the future FTP data
	  conversation and make the FTP data dissector be the dissector for
	  it.

2003-10-07 04:36  guy

	* gtk/main.c:

	  Make the window geometry information static - it's not used
	  outside this file.

	  Fetch the geometry information whenever we get a configure_notify
	  event, i.e. if it actually changes, rather than doing so when we
	  get asked to delete the main window or we exit.  Don't save the
	  geometry if we've never gotten such an event, as it presumably
	  means the size and position haven't changed.

2003-10-07 09:30  sahlberg

	* gtk/: endpoint_talkers_table.c, find_dlg.c, find_dlg.h:

	  Add Find Next/Find Previous submenu to conversation lists.

	  By using Find Next/Previous you will jump to the next/previous
	  matching packet in the ethereal main window.

	  I could not get CTRL-N / CTRL-B to work and was too lazy to
	  research.  It would be nice if CTRL-N / CTRL-P would invoke the
	  same thing as selecting /Find Frame/Find Next/EP1 <-> EP2 or
	  /Find Frame/Find Previous/EP1 <-> EP2 from the menu.	I could not
	  figure out how to get gtk to do this.  The person that adds
	  CTRL-N/CTRL-B here will be a hero.

2003-10-07 09:50  sahlberg

	* gtk/find_dlg.h:

	  Forgot to update a prototype in previous patch

2003-10-07 10:07  sahlberg

	* gtk/: color_dlg.c, color_dlg.h, endpoint_talkers_table.c:

	  Update to endpoint talkers, endpoint talkers now have an extra
	  submenu on the popup where one can select : Colorize
	  Conversation.  This opens up the create color filter dialog with
	  the filter preset to the selected conversation.

2003-10-07 17:21  guy

	* t35.c:

	  From Hans Viens: add an H.221 manufacturer code for Mediatrix,
	  and tweak white space.

2003-10-07 17:29  guy

	* gtk/endpoint_talkers_table.c:

	  Include "gtk/color_dlg.h" to declare
	  "color_display_with_filter()", and include "color.h" to declare
	  "color_filter_t", which "gtk/color_dlg.h" requires.

2003-10-07 17:36  guy

	* packet-ospf.c:

	  From Taisuke Sasaki: put in missing {} in an "if".

2003-10-07 17:43  guy

	* packet-isup.c:

	  From Anders Broman:

		  change some variable names to conform to abbreviations
	  used in
		  the specs;

		  added+dissection of some more BAT ASE elements;

		  fixed some minor bugs.

2003-10-07 18:19  oabad

	* packet-x25.c:

	  Put the "X.264 protocol identifier" and "X.264 sharing strategy"
	  fields in the "User data" subtree.

2003-10-07 21:15  guy

	* epan/to_str.c:

	  Get rid of an out-of-date comment.

2003-10-08 05:36  guy

	* packet-isakmp.c:

	  Dissect NAT-Discovery and NAT-Original Address payloads, and just
	  use the version-independent part of the draft ID for "Negotiation
	  of NAT-Traversal in the IKE" rather than giving a URL for the
	  draft (the URL in question was out-of-date, and a future one runs
	  the risk of becoming out of date, given that the -07 draft
	  expired a few days ago...).

2003-10-08 06:44  guy

	* etypes.h, packet-ethertype.c:

	  0x81fd and 0x81ff appear to be for the Cabletron Interswitch
	  Message Protocol, although the packets I've seen with 0x81fd
	  don't look like the ISMP packets described in RFC 2641/2642/2643.

2003-10-08 11:33  jmayer

	* packet-ftp.c:

	  use g_htonl instead of htonl

2003-10-08 12:29  sahlberg

	* packet-dcerpc.c:

	  Change dissect_deferred_pointer() from being Ordo(n^2) into being
	  Ordo(n)

	  Makes it slightly faster when n (the number of pointers) is
	  >10.000

	  The mother of all dcerpc packets (containing one array of >10.000
	  pointers) was a bit slow.

	  It is still slow but at least completes in out lifetime.

2003-10-09 18:54  guy

	* packet-mmse.c, packet-wbxml.c, packet-wsp.c:

	  From Biot Olivier:

		  Rename WSP defines to avoid collisions with Windows
	  defines.

		  Rename WSP dissector table for integer-value content
	  types.

		  Add WSP dissector table for literal content types.

		  Add WSP dissection registration for literal content
	  types.

		  Register literal and extra WBXML content types to WSP
	  dissector.

		  Register textual MMS content type to WSP dissector.

2003-10-09 18:57  guy

	* doc/README.developer:

	  Add an item about prefixing #define names and enum names with a
	  prefix to avoid name collisions.

2003-10-09 20:52  guy

	* packet-h225.c, packet-h245.c, packet-h450.c, packet-per.c,
	  packet-per.h, packet-t38.c:

	  Prefix OPTIONAL and NOT_OPTIONAL with ASN1_, to avoid collisions
	  with other definitions of OPTIONAL (such as the one in Windows).

2003-10-09 21:18  guy

	* doc/README.developer:

	  From Loc Minier: information on how to do reassembly of PDUs
	  atop TCP.

2003-10-09 22:29  jmayer

	* tethereal.c:

	  In case of a parse error in the capture syntax, check whether it
	  is valid display filter syntax. In case it is, warn about a
	  possbile confusion of the two filter types.

2003-10-09 22:35  guy

	* packet-h225.c, packet-h245.c, packet-h450.c, packet-per.c,
	  packet-per.h, packet-t38.c:

	  Prefix the EXTENSION #defines with ASN1_ as well.

2003-10-09 22:40  guy

	* AUTHORS, packet-isakmp.c, doc/ethereal.pod:

	  From Aki Immonen: add a numbre of vendor IDs.

2003-10-10 03:00  guy

	* Makefile.am, acinclude.m4, capture-wpcap.c, configure.in,
	  pcap-util-unix.c, pcap-util.c:

	  Use "pcap_findalldevs()" if present.

2003-10-10 03:04  guy

	* pcap-util-int.h:

	  Use "pcap_findalldevs()" if present.

2003-10-10 06:05  guy

	* acinclude.m4, capture-wpcap.c, pcap-util-unix.c, pcap-util.h,
	  util.c:

	  Get the version number of the libpcap/WinPcap with which we're
	  running with "pcap_lib_version()", if available.

2003-10-10 08:39  sahlberg

	* gtk/: main.c, main.h, menu.c:

	  Updates to TimeReference Frames

	  Add a Goto Next/Previous  time reference menu option

2003-10-10 08:52  sahlberg

	* gtk/service_response_time_table.c:

	  Add a Find Next/Previous menu option to the
	  ServiceResponseTimeStatistics dialog

2003-10-10 08:59  sahlberg

	* gtk/service_response_time_table.c:

	  Add a ColorizeProcedure menu option to the ServiceResponseTime
	  statistics dialog

2003-10-10 09:48  guy

	* Makefile.nmake, capture-wpcap.c, config.h.win32, config.nmake:

	  Configure whether we have WinPcap based on whether
	  WINPCAP_VERSION is set in the config.nmake file.

	  Configure whether we have pcap_findalldevs() based on whether
	  WINPCAP_VERSION is 2.3 (if so, we don't) or 3.0 or 3.1 (if so, we
	  do).

	  WinPcap 3.0 has the new libpcap declarations of
	  "pcap_lookupnet()" and "pcap_open_live()" in which the first
	  argument is a "const char *" rather than a "char *"; declare the
	  functions and pointers to them appropriately based on the version
	  of WinPcap.

	  If we don't have pcap_findalldevs(), don't declare a pointer to
	  it, as we don't have a declaration of pcap_if_t.

	  We also need to refer to "pcap_freealldevs()", so make a pointer
	  for it.

	  "symbols[]" is a const array; make the pointer to elements in it
	  a const pointer.

	  Fix some typoes.

2003-10-10 10:02  guy

	* t35.c:

	  From Tomas Kukosa: updates from Annex to ITU Operational Bulletin
	  No. 766 - 15.VI.2002), plus other fixes.

2003-10-10 10:04  guy

	* packet-isup.c:

	  Fix a typo.

2003-10-10 10:12  guy

	* acinclude.m4, configure.in:

	  From Brad Hards: fix two problems:

		  1. the --without-adns case wasn't handled correctly;

		  2.  the reporting at the end of the configure didn't deal
	  with
		  the case were the configure check failed (as in my
	  example,
		  where I only had the libadns package installed, not
		  libadns-devel) - it reported that ADNS would be used.

2003-10-10 10:16  guy

	* gtk/rtp_analysis.c:

	  Use PT_ values rather than raw numbers when checking for u-law
	  and A-law payload.

2003-10-10 10:25  guy

	* packet-gtp.c:

	  From Michal Melerowicz: remove obsolete GTP'v0 CDR dissection.

2003-10-10 10:54  sahlberg

	* packet-h245.c:

	  From Martin Regner,  bugfix for H245.

	  The restricted character string for signalType is 1 character,
	  not 1 to 128 characters.

2003-10-10 11:11  sahlberg

	* packet-dcerpc.c, packet-dcerpc.h, gtk/dcerpc_stat.c:

	  Updated the DCERPC service response time to also offer the menu
	  to Filter, Find and Colorize selected procedures in the same way
	  as SMB and ONC-RPC already does.

2003-10-10 11:24  sahlberg

	* gtk/dcerpc_stat.c:

	  Fix a bug for the DCERPC stats window where it forgot to print
	  the title inside the window as it were supposed to.

2003-10-10 13:33  jmayer

	* tethereal.c:

	  Part two of different-filter-syntax-hackaround: Warn in case of
	  capture filter usage where display filter syntax is required.

2003-10-10 21:13  guy

	* acinclude.m4, tethereal.c:

	  Not all versions of libpcap have "pcap_compile_nopcap()"; use it
	  only if we have it.

	  Not all versions of libpcap have DLT_LINUX_SLL, either; use
	  DLT_EN10MB instead.

2003-10-10 21:16  guy

	* AUTHORS, Makefile.am, Makefile.nmake,
	  packet-diffserv-mpls-common.c, packet-diffserv-mpls-common.h,
	  packet-ldp.c, packet-rsvp.c:

	  From Akira Endoh: Diffserv MPLS signaling protocol support.

2003-10-10 21:31  guy

	* Makefile.nmake, doc/Makefile.nmake, epan/Makefile.nmake,
	  epan/dfilter/Makefile.nmake, epan/ftypes/Makefile.nmake,
	  gtk/Makefile.nmake, image/Makefile.nmake,
	  packaging/nsis/Makefile.nmake, plugins/Makefile.nmake,
	  plugins/artnet/Makefile.nmake, plugins/docsis/Makefile.nmake,
	  plugins/giop/Makefile.nmake, plugins/gryphon/Makefile.nmake,
	  plugins/lwres/Makefile.nmake, plugins/megaco/Makefile.nmake,
	  plugins/mgcp/Makefile.nmake, plugins/pcli/Makefile.nmake,
	  plugins/rtnet/Makefile.nmake, tools/Makefile.nmake,
	  tools/lemon/Makefile.nmake, wiretap/Makefile.nmake:

	  Give every Makefile.nmake file a "distclean" rule, and have
	  "distclean" recurse into subdirectories doing "nmake -f
	  Makefile.nmake distclean".

	  Have "nmake -f Makefile.nmake clean" not remove stuff that "make
	  clean" doesn't remove (such as Flex/Bison output and config.h
	  files) - and have "nmake -f Makefile.nmake distclean" remove
	  stuff that "make distclean" removes, including
	  "tethereal-tap-register.c" and "ethereal-tap-register.c".

2003-10-10 21:35  guy

	* README.win32:

	  Mention gtk/ethereal-tap-register.c.

2003-10-10 22:52  sahlberg

	* packet-tcp.c:

	  From Matthijs Melchior Small change to the TCP sequence number
	  analysis and relative sequence number code so that it plays a bit
	  nicer with captures generated by text2pcap.

	  Change the criterion used to initialize the base sequence and ack
	  numbers to set these base offsets where it detects that the
	  bookkeeping structures are NULL (as in no previous packet seen
	  for this session) instead of using a hardcoded magic number 0,
	  which might actually occur in normal captures.

2003-10-11 00:10  guy

	* packet-wsp.c:

	  "add_content_type()" returns either a numerical content type and
	  a null content type pointer or a 0 numerical content type and a
	  non-null content type pointer; if the content type is numerical,
	  we cannot match on the string content type (as we'd dereference a
	  null pointer) and, if the content type is a string, we should not
	  match on the numerical content type (as the value is bogus).

	  We also have to call "add_content_type()" to get the content type
	  regardless of whether we're building a protocol tree, as we need
	  to call subdissectors regardless of whether we're building a
	  protocol tree.

	  We also need to set the columns regardless of whether we're
	  building a protocol tree.

2003-10-11 11:23  sahlberg

	* gtk/io_stat.c:

	  Massive update of the _draw() routine in iostat in preparation of
	  more features.

	  The most visible changes are	 graps drawn as sawtoots instead of
	  bars.    relative times (mainly used for response times
	  FT_RELATIVE_TIME) will be plotted as time measured in "s" "ms" or
	  "us" on the y axis

	  future updates may be  smoothed graphs  and better relative time
	  support

2003-10-11 21:49  jmayer

	* capture.c:

	  Part 3 of display vs. capture syntax confusion patches: Detect
	  probable use of display filter syntax where capture filter syntax
	  need to be used in Ethereal.

2003-10-11 23:17  sahlberg

	* gtk/io_stat.c:

	  minor cleanup and update for printing the y scale as time in
	  units of s,ms and us

2003-10-12 04:20  sahlberg

	* gtk/io_stat.c:

	  Further updates/rewrite of iostat

	  getting closer to add useful features

2003-10-12 12:29  tpot

	* packet-dcerpc-oxid.c:

	  Subdissector name updates from Jean-Baptiste Marchand.

2003-10-12 16:03  sharpe

	* packet-dcerpc-oxid.c:

	  Fix some C++ comments ...

2003-10-13 19:04  guy

	* epan/Makefile.nmake, tools/Makefile.nmake:

	  From Ulf Lamping: add some missing "cd .."s.	(I guess the
	  current directory in nmake files persists across targets;
	  presumably all commands, or, at least, all "cd" commands, are run
	  in the same process.)

2003-10-13 20:53  guy

	* packet-diffserv-mpls-common.c, packet-diffserv-mpls-common.h:

	  Define "phbit_bit{14,15}_vals" in packet-diffserv-mpls-common.c,
	  not in the header file; just declare it in the header file - that
	  way, there's one shared version of both tables, and we don't get
	  compiler warnings because they're not actually used in
	  packet-diffserv-mpls-common.c.

2003-10-14 00:40  guy

	* epan/resolv.c:

	  From Matthias Melchior: parenthesize check for RESOLV_CONCURRENT.

	  Get rid of "!= 0" check - other tests for a bit being on in
	  g_resolv_flags don't do that.

2003-10-14 00:45  guy

	* packet-dcerpc.c:

	  "dce_try_handoff()" isn't necessarily passed a non-null
	  "auth_info" argument - don't dereference it if it's null.

2003-10-14 01:18  guy

	* AUTHORS, Makefile.am, configure.in,
	  packaging/nsis/Makefile.nmake, packaging/nsis/ethereal.nsi,
	  plugins/Makefile.am, plugins/Makefile.nmake, plugins/acn/AUTHORS,
	  plugins/acn/COPYING, plugins/acn/ChangeLog, plugins/acn/INSTALL,
	  plugins/acn/Makefile.am, plugins/acn/Makefile.nmake,
	  plugins/acn/NEWS, plugins/acn/acn.h, plugins/acn/moduleinfo.h,
	  plugins/acn/packet-acn.c:

	  From Erwin Rol: ACN support.

2003-10-14 07:36  guy

	* acinclude.m4:

	  Do the tests for various extra "-L" and "-l" flags that might be
	  needed with "-lsnmp" in a loop; this fixes up the configure
	  script's operation on Solaris.

2003-10-14 08:56  guy

	* plugins/acn/.cvsignore:

	  Add a .cvsignore file.

2003-10-14 09:03  sahlberg

	* gtk/io_stat.c:

	  update to iostat

	  add different styles to draw the plot

2003-10-14 09:11  guy

	* AUTHORS, packet-eapol.c:

	  From Motonori Shindo: Key Information dissection in EAPOL-Key
	  messages.

2003-10-14 09:15  sahlberg

	* gtk/io_stat.c:

	  Simplify handling of tick val remove unnessecary code and
	  structures	cleanup

2003-10-14 09:27  sahlberg

	* gtk/io_stat.c:

	  further cleanup

	  remove the redundant pixels_per_tick structure

2003-10-14 09:55  sahlberg

	* gtk/io_stat.c:

	  further cleanup remove redundant structure for yscale_max

2003-10-14 10:01  sahlberg

	* gtk/io_stat.c:

	  remove the redundant count_type structure as part of the iostat
	  cleanup

2003-10-14 10:34  sahlberg

	* gtk/io_stat.c:

	  update to iostat, added new plot style: filled bar

2003-10-14 17:50  guy

	* packet-isup.c:

	  From Jeff Morriss: note in the Protocol column that we're
	  assuming the ITU dialect of ISUP.

2003-10-14 21:24  jmayer

	* packet-sip.c:

	  Update list of SIP RFCs

2003-10-14 21:26  jmayer

	* packet-sdp.c:

	  Add a comment for (maybe) later connection handling

2003-10-14 23:20  guy

	* AUTHORS, prefs.c, prefs.h, doc/ethereal.pod, gtk/file_dlg.c,
	  gtk/gui_prefs.c, gtk/main.c:

	  From Ian Schorr:

		  Add a preference to control whether the "File > Open"
	  dialog box
		  should start out in the last directory in which it looked
	  - and
		  save that in the preferences file across invocations - or
	  should
		  always start out in a user-specified directory, and add
	  another
		  preference to specify that directory.

		  Write out section name comments into the preferences
	  file.

	  Clean up white space a bit.

2003-10-14 23:42  guy

	* gtk/file_dlg.c:

	  Clean up the stuff that fills in the starting directory.

2003-10-15 02:13  gerald

	* doc/: ethereal-filter.pod.template, ethereal.pod, tethereal.pod:

	  Move the filter syntax description to the ethereal-filter pod
	  page.

2003-10-15 08:08  guy

	* packet-dcerpc-spoolss.c:

	  We got rid of the wrong hf_devmode_driver_extra; bring the wrong
	  one back, and get rid of the one that shouldn't be kept around.

2003-10-15 08:25  sahlberg

	* gtk/io_stat.c:

	  remove an extra ';' to keep visual studio happy

2003-10-15 08:41  sahlberg

	* gtk/io_stat.c:

	  Remove the unnecassary HashTable and use
	  gtk_object_[get|set]_data to keep track of which io structure a
	  certain draw area is associated with.

2003-10-15 09:18  guy

	* packet-gtp.c:

	  Fix the XXX_to_str routines

		  1) not to rely on their static buffers being initialized;

		  2) not to bother checking whether a BCD digit is a valid
	  digit
		     or not (index into a 16-element array, instead);

		  3) to work correctly, in the case of "id_to_str()".

2003-10-15 13:10  sahlberg

	* doc/ethereal.pod, gtk/io_stat.c:

	  Client LOAD measurement for io-stat

	  See manpage (hopefully manpage does not reformat my nice ascii
	  graph)

	  While Service Response Times	 and the MIN/MAX/AVG thing in
	  io-stat are measurements on the server load.	 The new
	  measurement type LOAD is a measurement of Client LOAD.

	  Or rather, it is an attempt to measure client LOAD by measuring
	  how much concurrency in its requests the client generates. It the
	  client is slow in starting new i/o when a previous i/o has
	  completed,  this willb e indicated by the concurrency being
	  lowered.

	  it is an experiment.	i am not aware of any other attempts in
	  deducing client workload from looking at captures.

2003-10-15 19:40  guy

	* AUTHORS, Makefile.am, gtk/Makefile.am, gtk/Makefile.nmake,
	  gtk/main.c, gtk/menu.c, gtk/toolbar.c, gtk/toolbar.h,
	  image/toolbar/capture_24.xpm, image/toolbar/cfilter_24.xpm,
	  image/toolbar/dfilter_24.xpm, image/toolbar/stock_close_24.xpm,
	  image/toolbar/stock_colorselector_24.xpm,
	  image/toolbar/stock_help_24.xpm,
	  image/toolbar/stock_jump_to_24.xpm,
	  image/toolbar/stock_open_24.xpm,
	  image/toolbar/stock_preferences_24.xpm,
	  image/toolbar/stock_print_24.xpm,
	  image/toolbar/stock_refresh_24.xpm,
	  image/toolbar/stock_right_arrow_24.xpm,
	  image/toolbar/stock_save_24.xpm,
	  image/toolbar/stock_search_24.xpm,
	  image/toolbar/stock_stop_24.xpm:

	  From Ulf Lamping: toolbar.

2003-10-15 19:57  guy

	* AUTHORS, packet-socks.c, doc/ethereal.pod:

	  From David E. Weekly: move the code to put the SOCKS version up,
	  so it's done in common code.

2003-10-15 20:07  guy

	* packet-socks.c:

	  Put back a missing comment.

	  Get rid of some extra blanks at the end of the text for some
	  protocol tree items.

	  Use %u, not %d, to format unsigned quantities.

	  Make the "Client Authentication Methods" item's length cover all
	  the authentication methods, not just the count of methods.

2003-10-15 22:00  guy

	* packet-ip.c:

	  From Giles Scott: make some items in the ICMP protocol tree named
	  fields.

2003-10-15 22:34  guy

	* gtk/toolbar.c:

	  Note that we might want to use the GTK+ 2.x stock icon mechanism
	  when building for GTK+ 2.x.

	  Fix the callback for the "Print" button.

2003-10-15 22:37  guy

	* gtk/toolbar.c:

	  "Find frame" can do more than search with a display filter.

2003-10-16 00:45  guy

	* gtk/: file_dlg.c, main.c:

	  There doesn't seem to be any need to set "cfile.dfilter" to the
	  contents of the filter text entry when reloading the file, and:

		  1) that doesn't work with the toolbar "reload" button
	  (the
		     widget passed in for that button doesn't have a
		     E_DFILTER_TE_KEY data item pointing to the text
	  entry);

		  2) that causes the Tools > Summary dialog box to report
	  what
		     you've typed in that box, not the filter that's
	  actually in
		     effect (i.e., it causes "cfile.dfilter" to reflect
	  what's
		     been typed, not what's been applied);

	  so don't bother doing so.  That also means that the
	  "/File/Reload" menu item doesn't need a E_DFILTER_TE_KEY data
	  item, so don't give it one.

2003-10-16 06:47  guy

	* packet-gtp.c:

	  Get rid of a value_string table that was used by now-deleted
	  code.

2003-10-16 09:55  guy

	* packet-gtp.c:

	  From Michal Melerowicz:

		  merge gtpv0 and gtpv1 dissectors into one;

		  fix up XXX_to_str routines.

2003-10-16 18:14  guy

	* packet-ansi_map.c:

	  From Michael Lum: add missing g_free() calls.

2003-10-16 18:15  guy

	* packet-tcap.c:

	  From Michael Lum: fixed some formatting and removed unused code.

2003-10-16 20:56  oabad

	* gtk/: main.c, toolbar.c, toolbar.h:

	  - use stock icons in the toolbar when using GTK2 - use GTK1/2
	  compatibility macros [GS]ET_OBJECT_DATA where needed - add a
	  set_toolbar_object_data() function which associates the display
	  filter entry (from the main window) with the E_DFILTER_TE_KEY for
	  the	open and reload buttons (it is needed by the open and
	  reload   callbacks). The function is called in
	  create_main_window() - reindent

2003-10-16 21:04  oabad

	* gtk/toolbar.c:

	  Put back Guy's changes from r1.3 (print callback, and "Find
	  frame..." tooltip).

2003-10-16 21:19  guy

	* prefs.c, prefs.h, gtk/gui_prefs.c, gtk/toolbar.c, gtk/toolbar.h:

	  From Ulf Lamping: add a GUI preference item to control the
	  toolbar style.

	  Make the style text arrays static, as nobody uses them outside
	  prefs.c.

	  Use FALSE and TRUE for the values for the Boolean controlling the
	  highlighting style.

	  Note that we're now using stock icons in the toolbar in GTK+ 2.x.

	  Put back the resizing of elements in the top-level container, at
	  least for GTK+ 1.2[.x]; otherwise, the toolbar's height never
	  gets smaller, even if you change the style in such a way as to
	  reduce the height of the elements (icons+text -> icons or text,
	  icons -> text).

	  Make some routines and variables not used outside gtk/toolbar.c
	  static.

2003-10-17 06:06  oabad

	* gtk/toolbar.c:

	  Change the comments about toolbar elements resizing as it is not
	  necessary in GTK+ 2.x

2003-10-17 07:45  sahlberg

	* packet-h225.c:

	  change the h225 emailid from a sequence of bytes to a string

2003-10-17 08:01  sahlberg

	* packet-h225.c:

	  destinationType is an  EndPointType and NOT an EndPoint

2003-10-17 08:14  guy

	* gtk/toolbar.c:

	  Further expand a comment.

2003-10-17 17:20  oabad

	* gtk/proto_draw.c:

	  Use gtk_tree_view_expand_to_path() in gtk2 code to expand a node,
	  as it also expands parent nodes if necessary.

2003-10-17 17:28  oabad

	* gtk/: menu.c, toolbar.c:

	  From Olivier Biot : remove packet capture code when compiling
	  without libpcap.

2003-10-17 21:26  guy

	* packet-dhcpv6.c:

	  From Shinsuke Suzuki:

		  - support RFC3319
		  - update the RFC/i-d name
		  - change the DHCPv6 option numbers to catch up with the
		    latest IANA's assignment status

2003-10-17 21:27  guy

	* packet-pim.c:

	  From Shinsuke Suzuki: support Address List Option, newly
	  introduced in draft-ietf-pim-sm-v2-new-08.txt.

2003-10-17 21:28  guy

	* AUTHORS:

	  Update credits for Shinsuke Suzuki.

2003-10-17 22:59  guy

	* packet-ndps.c:

	  From Greg Morris: don't add zero-length items to the tree, add
	  some missing alignment adjustments, fix a call to
	  "address_item()" to set the offset to its return value rather
	  than adding its return value to the offset, handle an object type
	  of 2 (counted list of objects) in an event handling profile,
	  advance the offset past length values after processing the length
	  value.

	  Fix some additional "address_item()" calls, and put the
	  aforementioned length values into the protocol tree.

2003-10-17 23:43  guy

	* packet-fr.c:

	  Fix up some comments.

2003-10-17 23:44  guy

	* packet-lmi.c:

	  Fix a URL.

2003-10-18 18:46  guy

	* packet-rip.c:

	  From Emanuele Caratti:

		  add the dissection of RIPv2 packets with Keyed Message
	  Disest
		  Authentication (RFC2082);

		  fix a small bug - the Auth entry must be the first of the
	  RTE in
		  a RIP packet.

2003-10-19 17:30  guy

	* packet-tacacs.c, packet-tacacs.h:

	  From Emanuele Caratti:

		  add support for multiple encryption keys, one per
	  conversation,
		  in a single capture;

		  add some fields in the accounting dissection.

2003-10-20 06:06  oabad

	* gtk/gui_prefs.c:

	  In fileopen_dir_changed_cb() : - return FALSE immediately if the
	  text entry is empty ; - return FALSE at the end of the function
	  so that the signal is sent to   the entry. It avoids a Gtk-ERROR
	  (and an abort) : file: gtkentry.c: line 4338 (blink_cb):
	  assertion failed: GTK_WIDGET_HAS_FOCUS(entry))

2003-10-20 19:07  guy

	* gtk/toolbar.c:

	  From Ulf Lamping:

		  put toolbar separators in the right places;

		  get rid of the "Capture Stop" button in Win32.

2003-10-20 19:13  guy

	* packet-isup.c:

	  From Anders Broman:

		  added decoding of Element IWFA(NSAP address) in IANA ICP
	  format;

		  fixed decoding of CODEC LIST.

2003-10-20 19:25  guy

	* packet-laplink.c:

	  From Brad Hards: support TCP desegmentation.

2003-10-20 20:18  guy

	* packet-dcerpc-epm.c:

	  From Jim McDonough: add the text sservice name for a UUID/version
	  string at the top level of a floor, falling back to the
	  UUID/version strings themselves if the service isn't found.

	  Use #defines for protocol IDs.

2003-10-20 22:28  guy

	* gtk/: main.c, menu.c:

	  If a tap menu item doesn't have a "selected_packet_enabled()" or
	  "selected_tree_row_enabled()" routine, enable it by default, so
	  that tap windows can be popped up even if you have no capture
	  file.

	  Assorted code cleanups.

2003-10-20 23:05  guy

	* packet-laplink.c:

	  From Jesper Peterson: get rid of GCCism/C++ism - C89 doesn't
	  allow variables to be declared in the middle of executable code.

2003-10-20 23:07  guy

	* doc/README.developer:

	  Warn about Yet Another GCCism.

2003-10-21 07:17  guy

	* packet-dcerpc.c, epan/packet_info.h:

	  Catch exceptions when dissecting a verifier, so we still dissect
	  the stub data even if there's a problem dissecting the verifier.

	  Show stub data as "Encrypted stub data" if it's encrypted,
	  "Decrypted stub data" if it was encrypted but we decrypted it,
	  and "Stub data" if it wasn't encrypted.

	  Don't attempt to decrypt data unless it was encrypted (i.e., the
	  authentication level is "Packet privacy".

	  Get rid of "decrypted_data" member of "packet_info" structure -
	  we don't need it any more.

2003-10-22 01:28  sahlberg

	* packet-h225.c, packet-per.c:

	  Fix to dissection of Mike's problem reported on ethereal-users

	  We did align to byte a bit too frequently inside
	  dissect_per_octet_string

	  Also change GroupIP.group from being a FT_BYTES into being
	  FT_STRING

2003-10-22 01:55  sahlberg

	* AUTHORS, packet-dcerpc-tapi.c, packet-dcerpc-tapi.h:

	  From Jean-Baptiste Marchand add function names for the TAPI
	  interface

2003-10-22 02:03  sahlberg

	* AUTHORS, Makefile.am, Makefile.nmake, packet-dcerpc-butc.c:

	  From Jaime Fournier

	  New protocol DCERPC BUTC Stub dissector for the BUTC interface

2003-10-22 02:07  sahlberg

	* AUTHORS, Makefile.am, Makefile.nmake, packet-dcerpc-rs_bind.c:

	  From Jaime Fournier New protocol DCERPC/RS_BIND

	  Added stub dissector for the RS_BIND protocol

2003-10-22 02:22  guy

	* packet-dcerpc-butc.c, packet-dcerpc-rs_bind.c:

	  Get rid of carriage returns.

2003-10-22 02:24  guy

	* packet-gtp.c:

	  Get rid of C++ comment.

2003-10-22 20:12  guy

	* packet-sccp.c:

	  From Michael Lum: add new SSN values for RANAP, IOS, and
	  BSSAP/BSAP, and add a heuristic subdissector list.

2003-10-22 20:59  guy

	* AUTHORS, Makefile.am, Makefile.nmake, packet-ansi_637.c,
	  packet-ansi_a.c, packet-bssap.c, packet-bssap.h:

	  From Michael Lum:

		  BSSAP (GSM 08.06)/BSAP (IOS 4.0.1) support
		  IOS 4.0.1 support
		  Add Transport Layer support to ANSI IS-637-A dissector

2003-10-22 21:21  guy

	* packet-ymsg.c:

	  From Yaniv Kaul:

		  remove the check on 3 ports only - since Yahoo! Messenger
	  can
		  stream on any port;

		  remove the check that will not dissect if the packet is
	  not big
		  enough - as partial dissection is also helpful sometimes;

		  the version is 2 bytes, not 4 bytes.

2003-10-22 21:26  guy

	* packet-dcerpc.c:

	  From Yaniv Kaul: if there's more than one context item in a BIND
	  PDU, show the number of context items before showing the first
	  one.

2003-10-22 22:13  guy

	* prefs.c, prefs.h, gtk/toolbar.c:

	  From Ulf Lamping: add a preference to control whether to show or
	  hide the main toolbar (currently no GUI to set it; that's in
	  progress).

2003-10-23 00:16  guy

	* packet-ansi_683.c:

	  From Michael Lum: register with the ANSI A-interface dissector.

2003-10-23 04:57  guy

	* packet-dcerpc-netlogon.c:

	  Use -1 rather than "tvb_length(tvb)" to specify a length that
	  covers the entire tvbuff for Secure Channel bind credentials.

	  Use -1 rather than 0 to have the top-level item for Secure
	  Channel ACK credentials cover the entire tvbuff.

2003-10-23 04:59  guy

	* epan/exceptions.h:

	  Add a new EXCEPT_CODE macro to get the exception code for the
	  current exception, for use in CATCH_ALL handlers, so you can
	  catch all exceptions and then pass the exception code on to a
	  routine that handles different exceptions differently.

2003-10-23 05:01  guy

	* packet-frame.c, packet-frame.h:

	  Add a "show_exception()" routine that takes an exception code as
	  an argument, and puts the appropriate exception indication into
	  the tree.

	  In "dissect_frame()", do a CATCH_ALL for exceptions, and pass the
	  exception code to "show_exception()".

2003-10-23 05:23  guy

	* packet-dcerpc.c:

	  Get rid of the "offset" argument to "dcerpc_try_handoff()" - it's
	  always 0.

	  In "dcerpc_try_handoff()", remove the authentication padding from
	  the stub data handed to the subdissector - that's not really stub
	  data for the subdissector, and it should throw an exception if
	  the request or response would go into the authentication padding.
	   Don't even try to dissect the remaining stub data if the
	  authentication padding value consumes all the stub data or would
	  consume even more than that.

	  Show any "Long frame" data before the authentication padding, and
	  show the authentication padding as the stuff at the very end of
	  the stub data, after the "Long frame" data.

	  Catch all exceptions when dissecting authentication information,
	  so that even if it's bad or we don't have all of it, we still
	  dissect the stub data.

	  Try dissecting authentication trailer information even if we
	  don't have all of it in the tvbuff - we want an exception to be
	  thrown if we don't.  Don't try to dissect it if it eats into the
	  stub data, however.

	  Don't bother catching exceptions in "dissect_auth_verf()" - we
	  now always catch exceptions in above it in the DCE RPC dissector
	  call tree.

	  Use CATCH_ALL and "show_exception()" when calling the
	  sub-dissector for a connection-oriented PDU; that means we won't
	  have to worry about adding new exception types unless they're
	  types that we should rethrow.

2003-10-23 05:58  guy

	* packet-dcerpc.c:

	  Catch exceptions in "dissect_dcerpc_cn_bs()", so that if we get
	  an exception dissecting stuff past the DCE RPC header, we still
	  drive on and dissect the next PDU, if any.

2003-10-23 07:14  guy

	* packet-dcerpc.c:

	  Fix a call to "dissect_dcerpc_cn()" to handle the new return
	  value.

2003-10-23 07:52  guy

	* packet-ncp.c:

	  Treat NCP 0x5555 packets as NCP requests, so we store them in the
	  hash table and can identify replies to them.

	  Clean up white space.

	  Note that the "is_signed" hack doesn't work with Ethereal.

2003-10-23 08:16  guy

	* packet-ncp2222.inc:

	  Non-NCP_SERVICE_REQUEST packets don't have a subfunction.

	  The group for a request isn't part of the packet, so give it an
	  offset and length of 0, so if you select it we doesn't highlight
	  some part of the packet.

2003-10-23 08:40  sahlberg

	* packet-smb.c:

	  The ACL revision field is one byte, not 2 bytes.

2003-10-23 18:49  ashokn

	* AUTHORS, packet-lmp.c, doc/ethereal.pod:

	  Added support for LMP draft version -09. Support for older draft
	  versions -02 and -03 is still present (since they are in use),
	  selectable by a protocol preference.

2003-10-24 00:35  guy

	* packet-dcerpc-reg.c:

	  From Jim McDonough: add dissection of the shutdown, shutdownex,
	  and abortshutdown commands within the winreg pipe.

2003-10-24 00:36  guy

	* packet-smb.c:

	  From Jim McDonough: add one more nt status code to
	  packet-dcerpc-smb.c that is often returned from the winreg
	  abortshutdown operation.

2003-10-24 00:38  guy

	* packet-bssap.c:

	  From Michael Lum: get rid of an unused value_string table.

2003-10-24 00:42  guy

	* AUTHORS, packet-dcerpc-mapi.c, packet-dcerpc-mapi.h:

	  From Jean-Baptiste Marchand: add more MAPI procedure names.

2003-10-24 00:50  guy

	* packet-sip.c:

	  From Anders Broman: make it possible to filter on only address or
	  tag in the SIP address fields.

2003-10-24 10:46  sahlberg

	* packet-h225.c, packet-per.c:

	  Fix all the issues Michael Oliveras reported

	  1, TunnellingProtocol_id is a CHOICE not a SEQUENCE 2, change
	  some values to be FT_STRING instead of FT_BYTES 3, update
	  dissect_per_octet_String to always 0 terminate all FT_STRINGs
	  (if necessary in a temporary buffer) before passing them on to
	  proto_tree_add_string() since that function did not want to
	  handle FT_STRING or FT_STRINGZ othervise.

2003-10-24 10:52  sahlberg

	* wiretap/libpcap.c:

	  The capture tools for DGUX has swapped the included/original
	  packet lengths of the frame header.  they specify the pcap
	  version as 543.0

2003-10-24 22:59  guy

	* packet-ospf.c:

	  From Taisuke Sasaki: fix offsets of metrics in
	  Inter-Area-Prefix-LSAs and Inter-Area-Router-LSAs.

2003-10-24 23:55  guy

	* wiretap/: libpcap.c, wtap-int.h:

	  Move the version number checking for libpcap files, to see
	  whether to swap the "captured length" and "length" fields, to the
	  open-file code; store a tri-state (definitely swapped, definitely
	  not swapped, maybe swapped) value in the per-capture-file-format
	  information for libpcap format, and use that when processing
	  packets.

2003-10-25 00:25  sahlberg

	* packet-tcp.c:

	  Update / cleanup to tcp sequence number analysis and new features

	  moved some variables to the structure where they belonged instead
	  of where they currently were and reduced the complexity of the
	  code

	  Fast Retransmission: Ethereal not tries to detect and flag
	  FastRetransmissions: The heuristics for this check is:   >=3
	  dupacks in other direction   this semgent is what the dupacks are
	  asking for   it arrived within 10ms of the last dupack (10ms
	  should be short enough to not confuse with real RTOs)

	  OutOfOrder segments Previously all segments that did not advance
	  the right edge of the window was flagged as retransmission   now
	  ethereal will try to flag segments that are merely reordered as
	  OutOfOrder segments insteaD

	  tHE HEURISTICS ARE:	 it has not been ACKed yet    we have not
	  seen it before    it arrived within 4ms of the segment
	  immediately to the right in the window

2003-10-25 06:07  guy

	* packet-cdp.c:

	  Update comments to give a URL that defines some additional CDP
	  type values, and to use the names from the URL and to refer to
	  it.

2003-10-25 06:10  guy

	* packet-cisco-oui.c:

	  Add some additional Cisco Protocol ID values, and URLs for
	  documents that contain them.

2003-10-25 06:19  guy

	* packet-cisco-oui.c:

	  Add one more Cisco protocol type.

2003-10-25 06:49  guy

	* packet-per.c:

	  In restricted character strings, deal with character values that
	  are greater than the alphabet length.

	  Just use "proto_tree_add_item()" if you have a range of bytes, of
	  known length, that are to be added as an item - that handles both
	  FT_STRING and FT_BYTES, including null-terminating the string
	  value.

2003-10-25 07:17  guy

	* packet-chdlc.c, packet-frame.c, wiretap/ngsniffer.c,
	  wiretap/visual.c, wiretap/wtap.c, wiretap/wtap.h:

	  Add a new WTAP_ENCAP_CHDLC_WITH_PHDR type, to distinguish Cisco
	  HDLC captures with packet direction information from captures
	  without it.  Use them appropriately.

2003-10-26 03:09  sahlberg

	* file.c, gtk/io_stat.c:

	  Update to cf_get_display_name() return "<no file>" if there is no
	  file loaded yet instead of crashing in io-stat

	  io-stat  only print the label for the top tick on the y axis to
	  make it look less cluttered

2003-10-27 00:54  sharpe

	* gtk/smb_stat.c:

	  This changes the Filter: label in the SMB Service Response Time
	  dialog box to a button that brings up the Create Filter dialog
	  box. While it works, the problem is that it also acts as an Enter
	  keypress as far as the start_stat button is concerned.

	  Probably needs a small fix.

2003-10-27 01:09  sharpe

	* gtk/smb_stat.c:

	  Make sure that Clicking OK in the filter creation dialog box does
	  not act as an OK to the dialog box it is called from.

2003-10-27 01:20  sharpe

	* gtk/: rpc_stat.c, smb_stat.c:

	  Add Filter Button support for onc-rpc as well ...

2003-10-27 01:35  sharpe

	* gtk/: dcerpc_stat.c, fc_stat.c:

	  Add filter button support to FibreChannel stats and DCERPC stats.

2003-10-27 09:17  guy

	* AUTHORS, packet-http.c, doc/ethereal.pod:

	  From Loc Minier: HTTP header and payload desegmentation.

2003-10-27 19:30  guy

	* packet-mdshdr.c:

	  From Dinesh Dutt: display the FC CRC for frames encapsulated with
	  MDSHDR, and show only the low-order 13 bits of the packet length
	  field.

2003-10-27 19:34  guy

	* packet-tcp.c:

	  Squelch some signed vs. unsigned comparison warnings.

	  Get rid of an unused variable.

2003-10-27 22:28  guy

	* packet-h225.c, packet-h245.c, packet-h450.c, packet-per.c:

	  From Lars Roland: whitespace cleanups.

2003-10-27 22:29  guy

	* packaging/nsis/Makefile.nmake:

	  From Lars Roland: fix a typo.

2003-10-27 22:45  guy

	* epan/dfilter/scanner.l:

	  Allow + and , in unparsed strings, so that you can use + as a
	  sign in a number or exponent and so that floating-point numbers
	  can use , as well as . as a decimal point.

2003-10-27 23:12  guy

	* gtk/io_stat.c:

	  Don't draw a Y-axis label if you haven't constructed the label
	  string.

2003-10-27 23:31  guy

	* Makefile.am, Makefile.nmake, packet-dcerpc-initshutdown.c,
	  packet-dcerpc-initshutdown.h:

	  From a suggestion by Jim McDonough: support for the INITSHUTDOWN
	  service.

2003-10-28 00:31  guy

	* AUTHORS, Makefile.am, Makefile.nmake, packet-h225.c,
	  packet-h225.h, tap-h225counter.c, doc/ethereal.pod,
	  doc/tethereal.pod, gtk/Makefile.am, gtk/Makefile.nmake,
	  gtk/h225_counter.c:

	  From Lars Roland: H.225 message and reason tag counter taps.

2003-10-28 03:57  guy

	* packet-scsi.c:

	  From Dinesh Dutt:

		  Add dissection code for the following additional SCSI
	  commands:
		       - Start/Stop Unit
		       - Write Buffer
		       - Send Diagnostics

		  Don't copy the product serial number to a buffer before
	  printing
		  it.

2003-10-28 05:49  guy

	* doc/README.developer:

	  As per a suggestion by Olivier Biot, note that objects pointed to
	  by pointer arguments to "proto_tree_add_XXX" functions are copied
	  - if you allocated a buffer for one of them (e.g., a string), and
	  you don't free that buffer when you're done with it, you'll leak
	  memory.

2003-10-28 05:50  guy

	* doc/README.developer:

	  Clarify the previous checkin - that applies to the 'value'
	  argument.

2003-10-28 06:44  guy

	* AUTHORS, Makefile.am, Makefile.nmake, packet-nt-tpcp.c:

	  From Giles Scott: Alteon/Nortel Transparent Proxy Control
	  Protocol support.

2003-10-28 07:02  guy

	* AUTHORS, Makefile.am, configure.in,
	  packaging/nsis/Makefile.nmake, packaging/nsis/ethereal.nsi,
	  plugins/Makefile.am, plugins/Makefile.nmake,
	  plugins/asn1/.cvsignore, plugins/asn1/AUTHORS,
	  plugins/asn1/COPYING, plugins/asn1/ChangeLog,
	  plugins/asn1/INSTALL, plugins/asn1/Makefile.am,
	  plugins/asn1/Makefile.nmake, plugins/asn1/NEWS,
	  plugins/asn1/moduleinfo.h, plugins/asn1/packet-asn1.c:

	  From Matthias Melchior: plugin to decode BER-encoded ASN.1
	  messages, given a type-table from "snacc" as a protocol
	  description.

2003-10-28 08:50  sahlberg

	* packet-tcp.c:

	  Full duplex analyzers that capture each direction of a link with
	  a separate NIC will lose the time integrity between the two NICs
	  more often than one might expect.  It is thus relatively common
	  that a data segment and its ACK being swapped in the capture
	  file.

	  Therefore, drop the condition that a segment must not have been
	  acked yet in the detection of OutOfOrder segments.

	  Second, fix a bug where we didnt keep track of the ack numbers
	  properly for relative sequence number analysis.

2003-10-28 17:27  guy

	* packet-scsi.c:

	  "%.*" expects an "int" argument giving the precision.

2003-10-28 17:59  guy

	* packet-wsp.c:

	  From Loc Minier: get rid of the second of a pair of identical
	  checks.

	  As per a note by Olivier Biot, make the "multipart/XXX" items all
	  lower case.

2003-10-28 18:08  guy

	* packet-ansi_a.c, packet-ansi_map.c, packet-bssap.c:

	  From Michael Lum: fixed BCD decoding of filler nibble and fixed
	  some minor bugs.

2003-10-28 19:27  guy

	* plugins/asn1/Makefile.nmake:

	  Fix the Makefile to match other plugin Makefiles.

2003-10-28 20:44  guy

	* plugins/asn1/Makefile.nmake:

	  This dissector uses GTK+ calls (which no dissector should); until
	  that's fixed, use GTK_CFLAGS and GTK_LIBS rather than GLIB_CFLAGS
	  and GLIB_LIBS.

2003-10-28 20:53  guy

	* plugins/asn1/packet-asn1.c:

	  As we don't supply a default ASN.1 SNACC output file, if we get
	  an ENOENT when trying to open the SNACC file, and the file we're
	  trying to open is the default file, don't print a warning.

	  Fix some typoes.

2003-10-28 21:01  guy

	* plugins/: plugin_api_list.c, Xass-list, Xplugin_api.c,
	  Xplugin_api.h, Xplugin_api_decls.h, Xplugin_table.h:

	  Add "get_datafile_dir()" to the plugin API list, for the benefit
	  of plugins that might get configuration information from a file.

2003-10-28 21:04  guy

	* plugins/asn1/packet-asn1.c:

	  "get_datafile_dir()" is now in the plugin table.

2003-10-28 21:45  guy

	* plugins/: plugin_api_list.c, Xass-list, Xplugin_api.c,
	  Xplugin_api.h, Xplugin_api_decls.h, Xplugin_table.h:

	  Export "get_datafile_path()", not "get_datafile_dir()" - most if
	  not all dissectors need only the former, which does the
	  pathname-construction work for you.

2003-10-28 21:47  guy

	* plugins/asn1/packet-asn1.c:

	  Use "get_datafile_path()", rather than constructing the default
	  ASN.1 file path by hand.

	  Set "default_asn1_filename", not "asn1_filename", to the default
	  path.

2003-10-29 10:37  guy

	* plugins/plugin_api.h:

	  There's no need to #define tvb_get_string or tvb_get_stringz -
	  that's done in Xplugin_api.h.

	  However, we do need to include "epan/filesystem.h", to declare
	  "get_datafile_path()".

2003-10-29 10:54  guy

	* plugins/asn1/packet-asn1.c:

	  From Matthijs Melchior: #ifdef out the GUI code, for now.

2003-10-29 21:19  guy

	* AUTHORS, packet-diameter.c, doc/ethereal.pod:

	  From Steve Ford: "prefs_register_string_preference()" makes a
	  copy of any string pointed to by the preference variable - as the
	  value we set it to is allocated, we should free it after
	  registering the preference.

	  The register routine is called only once - don't worry about
	  whether "gbl_diameterDictionary" is null or not.

	  Get rid of a duplicate credit entry in the man page.

2003-10-29 21:54  guy

	* packet-snmp.c:

	  Fix some memory leaks found by Steve Ford.

2003-10-29 22:00  guy

	* packet-snmp.c:

	  Actually, one of those *isn't* a leak; don't free something we
	  haven't allocated yet.

2003-10-29 22:02  guy

	* packet-snmp.c:

	  Another leak that isn't.

2003-10-29 22:04  guy

	* packet-snmp.c:

	  ...and there's one leak we missed.

2003-10-29 22:11  guy

	* packet-snmp.c:

	  Plug that leak with a cleanup handler, so we don't leak the
	  variable OID if we throw an exception fetching the variable
	  value.

2003-10-29 22:39  guy

	* gtk/toolbar.c:

	  Have the "edit display filters" button do the exact same thing as
	  the "Edit -> Display Filters..." menu item, as per Ulf Lamping -
	  there's apparently some problem wherein &args doesn't get passed
	  properly to the callback.

2003-10-29 23:15  guy

	* gtk/dfilter_expr_dlg.c:

	  Put quotes around values for FT_ABSOLUTE_TIME variables, and
	  around values with white space in them.

2003-10-29 23:48  guy

	* epan/: proto.c, proto.h, ftypes/ftype-bytes.c,
	  ftypes/ftype-string.c, ftypes/ftype-tvbuff.c:

	  Make the "fvalue_set" methods for types whose value is allocated
	  free any previously-allocated version first, so that they don't
	  leak memory.

	  From Olivier Biot: add a "proto_item_append_string()" routine, to
	  append to the string value a protocol tree item has.

2003-10-30 00:39  tpot

	* packet-ipmi.c:

	  Decorate higher level proto_item with NetFn and LUN values in
	  hex.

2003-10-30 02:06  guy

	* AUTHORS, Makefile.am, Makefile.nmake, packet-brdwlk.c,
	  packet-fc.c, packet-fc.h, packet-fcels.c, packet-fcels.h,
	  packet-fcip.c, packet-fcsb3.c, packet-fcsb3.h, packet-fcsp.c,
	  packet-fcsp.h, packet-fcswils.c, packet-fcswils.h,
	  packet-mdshdr.c, epan/packet_info.h:

	  From Dinesh Dutt:

		  - Dissector for FICON
		  - Dissector for FC-SP (Security Protocol for Fibre
	  Channel)
		  - Patches to correct the reassembly of FC fragments.
		  - Support for new MDS Port Analyzer Adapters that carry
	  the
		    frame length for truncated frames.

2003-10-30 03:11  guy

	* AUTHORS, doc/ethereal.pod, wiretap/AUTHORS, wiretap/Makefile.am,
	  wiretap/Makefile.nmake, wiretap/file_access.c, wiretap/hcidump.c,
	  wiretap/hcidump.h, wiretap/wtap.h:

	  From Marcel Holtmann: support for reading Linux Bluez Bluetooth
	  stack "hcidump -w" traces.

	  Note that Jesper Peterson contributed support for reading Endace
	  ERF files.

2003-10-30 03:15  guy

	* packet-brdwlk.c:

	  #if 0 out the stuff to set the reported length, as it'd throw an
	  exception if it would increase the reported length.

2003-10-30 07:00  guy

	* AUTHORS, Makefile.am, Makefile.nmake, packet-ansi_a.c,
	  packet-ansi_map.c, packet-gsm_a.c, packet-gsm_sms.c:

	  From Michael Lum:

		  GSM BSSMAP (GSM 08.08) support
		  GSM DTAP (3GPP TS 24.008) support
		  GSM SMS (3GPP TS 24.011) support
		  GSM SS (3GPP TS 24.080) support
		  GSM SMS TPDU (3GPP TS 23.040) support

2003-10-30 07:14  guy

	* packet-gsm_sms.c:

	  From Michael Lum: squelch a couple of compiler warnings.

2003-10-30 08:07  guy

	* packet-q931.c:

	  From Anders Broman:

		  fix the offset when putting the cause code in a Cause IE
	  into the
		  protocol tree;

		  in a Number IE, show the number type, numbering plan, and
		  extension indicator as named-field bitfields.

2003-10-30 08:34  guy

	* packet-q933.c:

	  Apply Anders Broman's changes to the Q.931 dissector to the Q.933
	  dissector:

		  fix the offset when putting the cause code in a Cause IE
	  into the
		  protocol tree;

		  in a Number IE, show the number type, numbering plan, and
		  extension indicator as named-field bitfields.

2003-10-30 11:21  guy

	* packet-gsm_a.c:

	  Definitions of arrays, with no length specified, are not legal C.

2003-10-30 11:53  guy

	* wiretap/hcidump.c:

	  The quantities in the hcidump header are little-endian, not
	  big-endian.

2003-10-30 11:54  guy

	* packet-gsm_sms.c:

	  No zero-length arrays, please.

2003-10-30 11:56  guy

	* plugins/asn1/packet-asn1.c:

	  "strchr()" and the like would be compared against NULL;
	  "strcmp()", however, is compared against 0.

2003-10-30 19:38  guy

	* packet-ansi_map.c:

	  From Michael Lum: step over unknown parameters.

2003-10-30 19:39  guy

	* packet-gsm_a.c:

	  From Michael Lum: dissect DTAP from RANAP NAS PDU fields.

2003-10-30 19:43  guy

	* packet-bssgp.c:

	  From Josef Korelus: fix reversed messages in true_false_string
	  tables.

2003-10-30 19:56  guy

	* tethereal.c:

	  On UNIX, give up set-UID and set-GID privileges before opening
	  capture files and immediately after opening capture devices, so
	  we run without privileges as much as possible.

2003-10-30 20:30  guy

	* configure.in:

	  If we don't have pod2man, quit - otherwise, we'd just drive on
	  and use the empty POD2MAN variable in commands, producing very
	  confusing errors.

2003-10-30 22:06  guy

	* configure.in:

	  Wrap "x$POD2MAN" in quotes, so if there are spaces in the
	  pathname, the configure script doesn't fail.	(The Makefile will
	  probably fail, but that's another matter.)

	  If "$POD2MAN" is empty, it could mean that pod2man is installed
	  but the user's path doesn't include the directory in which it's
	  installed; fix up the error message.

2003-10-31 00:43  guy

	* AUTHORS, doc/editcap.pod, doc/ethereal.pod, doc/mergecap.pod,
	  doc/tethereal.pod, wiretap/AUTHORS, wiretap/Makefile.am,
	  wiretap/Makefile.nmake, wiretap/file_access.c,
	  wiretap/network_instruments.c, wiretap/network_instruments.h,
	  wiretap/wtap.h:

	  From Scott Emberley: support for reading Network Instruments
	  version 9 capture files.

2003-10-31 07:57  guy

	* util.c:

	  Include <windows.h> so that OSVERSIONINFO and the like are
	  defined on Windows.

2003-10-31 08:06  guy

	* wiretap/: network_instruments.c, network_instruments.h:

	  Temporarily get rid of the "struct tm" in "struct observer_time",
	  and get rid of the reference to its "tm_gmtoff" member - there
	  are platforms on which Ethereal runs that don't have "tm_gmtoff"
	  in "struct tm".  If the time stamp in the packets is nanoseconds
	  since midnight 2001-01-01 *local* time, we'd need to compute the
	  offset between that and midnight 2000-01-01 GMT, and adjust the
	  time with that.

2003-10-31 08:13  guy

	* doc/: editcap.pod, ethereal.pod, mergecap.pod, tethereal.pod:

	  Fix some warnings from pod2man.

2003-10-31 08:15  guy

	* README:

	  Update the list of supported capture formats.

2003-10-31 18:28  guy

	* plugins/acn/: acn.h, packet-acn.c:

	  From Erwin Rol: update.

2003-10-31 19:45  guy

	* gtk/rtp_analysis.c:

	  From Lars Ruoff:

		  - fix missing detection of first packet when writing
	  payload.
		  - fix bug of erroneous handling of confort noise when
	  writing payload.
		  - fix bug of possible endless silence insertion on first
	  packet when
		    writing payload.

2003-10-31 19:48  guy

	* packet-h225.c:

	  From Martin Regner: fix a problem with vendorIdentifier in some
	  H.225 messages.

2003-11-01 02:30  guy

	* AUTHORS, acinclude.m4, capture.c, capture.h, globals.h,
	  pcap-util.c, pcap-util.h, tethereal.c, doc/ethereal.pod,
	  doc/tethereal.pod, gtk/capture_dlg.c, gtk/main.c:

	  Based on a patch from Brian Fundakowski Feldman, add support for
	  setting link-layer type when capturing, using the
	  "pcap_set_datalink()" and related APIs.

2003-11-01 03:03  guy

	* gtk/main.c:

	  Return FALSE from the configure event handler, so that anybody
	  else who's registered for it can get notified about it.

2003-11-01 03:06  guy

	* plugins/plugin_api_list.c:

	  From Charlie Duke: add more functions to the plugin API.

2003-11-01 03:08  guy

	* plugins/plugin_api_list.c:

	  Move the new functions to the end of the list, so we don't change
	  the ordinal numbers of the routines already in the list (that
	  breaks binary compatibility).

2003-11-01 03:10  guy

	* plugins/plugin_api_list.c:

	  "End" means end, not "almost the end".

2003-11-01 03:10  guy

	* plugins/: Xass-list, Xplugin_api.c, Xplugin_api.h,
	  Xplugin_api_decls.h, Xplugin_table.h:

	  From Charlie Duke: add more functions to the plugin API.

2003-11-01 03:38  guy

	* wiretap/: network_instruments.c, network_instruments.h:

	  The time in Observer files is in nanoseconds since midnight,
	  January 1, 2000, 00:00:00 *local* time.  The amount to add to
	  that is just the UNIX time stamp value for that point in time;
	  get it with "mktime()".

2003-11-01 04:42  guy

	* ncp2222.py:

	  From Greg Morris:

		  1. Add several return values
		  2. Fix the reply structure for NCP 22/48, 23/122
		  3. Fix the request structure for NCP 23/121
		  4. ServerID should be displayed as a hex value.
		  5. ServerStationLong should be LE.
		  6. JobNumberList should be JobNumberLong.
		  7. Fix 87/64, 87/65, 87/66, 87/68, 87/69 - These are not
	  Advanced Audit
		     Service, they really 64 bit file support NCP's.

2003-11-02 03:55  tpot

	* packet-dcerpc-netlogon.c:

	  In a secure channel verifier, sometimes the nonce isn't present;
	  not sure why this is so.

2003-11-02 19:31  gerald

	* gtk/main.c:

	  The recent link-layer type additions broke "-r".  Make it work
	  again.

2003-11-02 22:12  gerald

	* ipproto.c, ipproto.h:

	  Add an entry for Novell NCS heartbeats (ID 0xE0).

2003-11-02 23:12  gerald

	* packet-snmp.c, util.c, epan/filesystem.c, epan/filesystem.h,
	  plugins/plugin_api_list.c, plugins/asn1/packet-asn1.c:

	  From Gisle Vanem:

	  * Added a new function get_file_in_temp() to	 epan/filesystem.c.
	  This because of asn1.dll plugin which   had code to write to a
	  log-file "c:\temp\ethereal.log". I feel   this patch makes this
	  safer; I don't even have a c:\temp dir.

	  * Patched packet-asn1.c to use get_file_in_temp().

	  * Added some #undef to packet-snmp.c to silence gcc.

	  * Changed "%u" -> "%lu" formats in util.c

	  Rename get_file_in_temp() to get_tempfile_path() to match other
	  function names.

2003-11-02 23:24  gerald

	* packet-gsm_a.c:

	  From Michael Lum: Add decode of Bearer Capability parameter.

2003-11-03 02:41  gerald

	* epan/filesystem.c:

	  Make get_tempfile_path() work like get_datafile_path(), which
	  removes a dependency on PATH_MAX (which apparently isn't defined
	  under Windows).

2003-11-03 02:46  gerald

	* plugins/: Xass-list, Xplugin_api.c, Xplugin_api.h,
	  Xplugin_api_decls.h, Xplugin_table.h:

	  Export get_tempfile_path() to the plugins.

