------------------------------------------------------------------------
r13699 | gerald | 2005-03-10 14:23:04 -0600 (Thu, 10 Mar 2005) | 6 lines
Changed paths:
   M /releases/ethereal-0.10.10/asn1/h245/h245.cnf
   M /releases/ethereal-0.10.10/epan/dissectors/packet-h245.c
   M /releases/ethereal-0.10.10/epan/dissectors/packet-rtp-events.c
   M /releases/ethereal-0.10.10/epan/dissectors/packet-rtp-events.h
   M /releases/ethereal-0.10.10/epan/dissectors/packet-rtp.c
   M /releases/ethereal-0.10.10/epan/dissectors/packet-rtp.h
   M /releases/ethereal-0.10.10/epan/dissectors/packet-rtsp.c
   M /releases/ethereal-0.10.10/epan/dissectors/packet-sdp.c
   M /releases/ethereal-0.10.10/epan/dissectors/packet-skinny.c
   M /releases/ethereal-0.10.10/gtk/voip_calls.c
   M /releases/ethereal-0.10.10/gtk/voip_calls.h
   M /releases/ethereal-0.10.10/gtk/voip_calls_dlg.c

Copy r13697 from the trunk:

From Alejandro Vaquero:
- Automatic dissection of RTP events (RFC2833) set in SDP sessions.
- Add RTP events (RFC2833) to the Voip Graph

------------------------------------------------------------------------
r13698 | gerald | 2005-03-10 14:17:34 -0600 (Thu, 10 Mar 2005) | 6 lines
Changed paths:
   M /releases/ethereal-0.10.10/plugins/xml/packet-xml.c
   M /releases/ethereal-0.10.10/plugins/xml/packet-xml.h
   M /releases/ethereal-0.10.10/plugins/xml/xml_lexer.c
   M /releases/ethereal-0.10.10/plugins/xml/xml_lexer.l

Copy r13696 from the trunk:

Instead of first running the lexer to create a list of items and then
iterate through this items to create the tree, just create the tree from
the lexer.

------------------------------------------------------------------------
r13695 | gerald | 2005-03-10 09:51:13 -0600 (Thu, 10 Mar 2005) | 2 lines
Changed paths:
   A /releases/ethereal-0.10.10 (from /trunk:13694)

Branch off the 0.10.10 release.

------------------------------------------------------------------------
r13694 | gerald | 2005-03-10 09:49:02 -0600 (Thu, 10 Mar 2005) | 2 lines
Changed paths:
   M /trunk/NEWS

More NEWS updates.

------------------------------------------------------------------------
r13693 | jmayer | 2005-03-10 08:04:35 -0600 (Thu, 10 Mar 2005) | 1 line
Changed paths:
   M /trunk/gtk/sctp_assoc_analyse.c

Warning fix: function declaration isn’t a prototype
------------------------------------------------------------------------
r13692 | jmayer | 2005-03-10 06:49:05 -0600 (Thu, 10 Mar 2005) | 1 line
Changed paths:
   M /trunk/gtk/sctp_byte_graph_dlg.c
   M /trunk/gtk/sctp_graph_dlg.c

Warning fix: ISO C forbids zero-size array ‘tsns
------------------------------------------------------------------------
r13691 | jmayer | 2005-03-10 06:43:35 -0600 (Thu, 10 Mar 2005) | 1 line
Changed paths:
   M /trunk/gtk/sctp_stat_dlg.c
   M /trunk/gtk/voip_calls_dlg.c

Trivial warning fixes
------------------------------------------------------------------------
r13690 | sahlberg | 2005-03-10 04:16:49 -0600 (Thu, 10 Mar 2005) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc.c
   M /trunk/epan/dissectors/packet-gssapi.c
   M /trunk/epan/dissectors/packet-gssapi.h
   M /trunk/epan/dissectors/packet-kerberos.c
   M /trunk/epan/dissectors/packet-ldap.c
   M /trunk/epan/dissectors/packet-ntlmssp.c
   M /trunk/epan/dissectors/packet-spnego.c

add support to decrypt and dissect sign-and-sealed traffic.
(cifs: dc's talking to eachother   and when longhorn comes out: anyone wanting to talk dce to a dc!)

((this is an incredibly advanced feature well worthy of mentioning in NEWS))


------------------------------------------------------------------------
r13689 | sahlberg | 2005-03-10 02:52:59 -0600 (Thu, 10 Mar 2005) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ldap.c
   M /trunk/epan/packet_info.h

add two nice defines for how to decrypt a GSSKRB tvb

dce has slightly different padding and checksumming so we have to tell decrypt_arcfour() about it.



------------------------------------------------------------------------
r13688 | sahlberg | 2005-03-10 02:50:18 -0600 (Thu, 10 Mar 2005) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc.c
   M /trunk/epan/dissectors/packet-dcerpc.h
   M /trunk/epan/dissectors/packet-ntlmssp.c

change the signature for the functions to decrypt data for the
dcerpc_auth_subdissector_fns structure.

the SignAndSeal decryption (which works really well) needs this.



------------------------------------------------------------------------
r13687 | lego | 2005-03-10 00:33:07 -0600 (Thu, 10 Mar 2005) | 3 lines
Changed paths:
   M /trunk/plugins/xml/xml_lexer.c

check in the newly generated lexer too


------------------------------------------------------------------------
r13686 | lego | 2005-03-10 00:32:06 -0600 (Thu, 10 Mar 2005) | 6 lines
Changed paths:
   M /trunk/plugins/xml/packet-xml.c
   M /trunk/plugins/xml/packet-xml.h
   M /trunk/plugins/xml/xml_lexer.l

- changed the lexer to return entire tags, refactored packet-xml.c for those changes
- add markup_declarations and indent on doctype's []
- removed debugging code
- renamed meta_tag into xmlpi


------------------------------------------------------------------------
r13685 | gerald | 2005-03-09 17:49:55 -0600 (Wed, 09 Mar 2005) | 3 lines
Changed paths:
   M /trunk/ChangeLog
   M /trunk/NEWS
   M /trunk/config.nmake
   M /trunk/configure.in

Prep for 0.10.10: Update the ChangeLog and NEWS files, bump the version
number.

------------------------------------------------------------------------
r13684 | ulfl | 2005-03-09 17:00:21 -0600 (Wed, 09 Mar 2005) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-bssgp.c
   M /trunk/epan/dissectors/packet-dtp.c
   M /trunk/epan/dissectors/packet-fcp.c
   M /trunk/epan/dissectors/packet-iscsi.c
   M /trunk/gtk/stats_tree_stat.c

removed some MSVC compiler warnings, mostly I've casted "downsized function parameters"
------------------------------------------------------------------------
r13683 | obiot | 2005-03-09 13:52:58 -0600 (Wed, 09 Mar 2005) | 4 lines
Changed paths:
   M /trunk/plugins/xml/packet-xml.c

Remove duplicate media types and add XML media types from packet-text-media.c.

NOTE: we need to make sure that all the media types registered in the XML dissector get registered with the line-based text dissector as a fall-back when the XML dissector is disabled.

------------------------------------------------------------------------
r13682 | gerald | 2005-03-09 13:43:29 -0600 (Wed, 09 Mar 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-spnego.c

Add a couple of definitions not present in MIT Kerberos.  Fix a compiler
warning.

------------------------------------------------------------------------
r13681 | guy | 2005-03-09 06:30:41 -0600 (Wed, 09 Mar 2005) | 3 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/ethereal_gen.py

From Jaap Keuter: update ethereal_gen.py to generate new-style plugin
dissectors.

------------------------------------------------------------------------
r13680 | sahlberg | 2005-03-09 05:59:40 -0600 (Wed, 09 Mar 2005) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-spnego.c

refactor the code to not use heimdal functions to decrypt and unwrap the blob.
use builtin functrions instead  which will make it trivial to add this support to mit later


------------------------------------------------------------------------
r13679 | guy | 2005-03-09 04:57:58 -0600 (Wed, 09 Mar 2005) | 13 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dtp.c

Set the eol-style and keywords properties.

Use "tvb_reported_length_remaining()", not "tvb_length_remaining()", in
the loop parsing the packet contents, so we throw an exception on a
short frame (to mark that it *is* a short frame).

Use "tvb_format_text()" for text strings, so we don't have a problem
with non-printable characters.

Use "ether_to_str()" to turn MAC addresses into strings.

Clean up indentation.

------------------------------------------------------------------------
r13678 | guy | 2005-03-09 04:43:34 -0600 (Wed, 09 Mar 2005) | 7 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/dissectors/packet-ieee80211.c

From Vladimir Kondratiev:

- better parsing for TIM info element: it parses 'bitmap control' byte
and provides list of AID for stations having power saving traffic.
- separate names for TIM elements. It helps to higlight beacons with
some properties, for example DTIM ones (dtim_count==0).

------------------------------------------------------------------------
r13677 | guy | 2005-03-09 04:29:59 -0600 (Wed, 09 Mar 2005) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bssgp.c

Comment out a routine that's not currently being used.

------------------------------------------------------------------------
r13676 | guy | 2005-03-09 04:24:34 -0600 (Wed, 09 Mar 2005) | 2 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/dissectors/packet-cdp.c

From Ricardo Muggli: decode the voice VLAN field in CDP packets.

------------------------------------------------------------------------
r13675 | guy | 2005-03-09 04:12:05 -0600 (Wed, 09 Mar 2005) | 3 lines
Changed paths:
   M /trunk/gtk/voip_calls_dlg.c

From Francisco Alcoba: don't generate long filter expressions, fall back
to the old filter mechanism if the filter expression is too long.

------------------------------------------------------------------------
r13674 | ulfl | 2005-03-09 01:51:07 -0600 (Wed, 09 Mar 2005) | 1 line
Changed paths:
   M /trunk/file.c

bugfix in PSML export output: the epan API slightly changed, epan_dissect_fill_in_columns must be called now to fill in column data. This resulted in missing values in PSML output.
------------------------------------------------------------------------
r13673 | sahlberg | 2005-03-09 01:29:52 -0600 (Wed, 09 Mar 2005) | 4 lines
Changed paths:
   M /trunk/epan/crypt-md5.c
   M /trunk/epan/crypt-md5.h

add helper to compute the md5 hmac



------------------------------------------------------------------------
r13672 | guy | 2005-03-08 21:15:59 -0600 (Tue, 08 Mar 2005) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-pgsql.c

Updates from Abhijit Menon-Sen.

------------------------------------------------------------------------
r13671 | guy | 2005-03-08 21:04:46 -0600 (Tue, 08 Mar 2005) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-kink.c

Fix the properties.

------------------------------------------------------------------------
r13670 | guy | 2005-03-08 21:03:10 -0600 (Tue, 08 Mar 2005) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-spnego.c

Squelch some compiler warnings if we don't have Kerberos.

------------------------------------------------------------------------
r13669 | guy | 2005-03-08 20:39:31 -0600 (Tue, 08 Mar 2005) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-kink.c

"time_t", not "timer_t".

------------------------------------------------------------------------
r13668 | sahlberg | 2005-03-08 17:47:29 -0600 (Tue, 08 Mar 2005) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-spnego.c

use the rc4 functions from epan/crypt-rc4  instead of those in heimdal
so that we dont have to include <rc4.h> from heimdal

hopefully the build on freebsd will succeed now


------------------------------------------------------------------------
r13667 | sahlberg | 2005-03-08 16:32:43 -0600 (Tue, 08 Mar 2005) | 5 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-kink.c

New protocol : KINK

From Taekshi Nakashima   the KINK protocol


------------------------------------------------------------------------
r13666 | sahlberg | 2005-03-08 15:36:04 -0600 (Tue, 08 Mar 2005) | 3 lines
Changed paths:
   M /trunk/acinclude.m4

we dont need to link with gssapi.a any more


------------------------------------------------------------------------
r13665 | sahlberg | 2005-03-08 15:13:14 -0600 (Tue, 08 Mar 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-spnego.c

remove some dependencies of libgssapi


------------------------------------------------------------------------
r13664 | sahlberg | 2005-03-08 14:22:07 -0600 (Tue, 08 Mar 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-spnego.c

remove the need to include <gssapi.h> from heimdal


------------------------------------------------------------------------
r13663 | guy | 2005-03-08 13:31:50 -0600 (Tue, 08 Mar 2005) | 2 lines
Changed paths:
   M /trunk/doc/README.plugins

More editing.

------------------------------------------------------------------------
r13662 | guy | 2005-03-08 13:31:01 -0600 (Tue, 08 Mar 2005) | 2 lines
Changed paths:
   M /trunk/doc/README.plugins

Editing.

------------------------------------------------------------------------
r13661 | ulfl | 2005-03-08 13:03:09 -0600 (Tue, 08 Mar 2005) | 1 line
Changed paths:
   M /trunk/doc/README.plugins

from jaap keuter: add info how to update from old to new style plugin registering
------------------------------------------------------------------------
r13660 | sahlberg | 2005-03-08 03:46:24 -0600 (Tue, 08 Mar 2005) | 8 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ldap.c

If ethereal is linked with HEIMDAL
and Kerberos decryption is enabled in preferences
and if we have the keytab file available

then attempt to decrypt Secure LDAP



------------------------------------------------------------------------
r13659 | sahlberg | 2005-03-08 03:45:19 -0600 (Tue, 08 Mar 2005) | 8 lines
Changed paths:
   M /trunk/acinclude.m4
   M /trunk/epan/dissectors/packet-spnego.c

when HEIMDAL is linked with :
make spnego able to decrypt data wrapped inside
 GSSAPI/SPNEGO/KRB5 arcfour-hmac

This code will be more etherealified and evolve into being able to link with MIT as well.



------------------------------------------------------------------------
r13658 | sahlberg | 2005-03-08 03:43:36 -0600 (Tue, 08 Mar 2005) | 3 lines
Changed paths:
   M /trunk/epan/packet.c
   M /trunk/epan/packet_info.h

gssapi decryption nees a few new fields to pass the blobs from application layer dissector all the way down to spnego or friends and back.


------------------------------------------------------------------------
r13657 | lroland | 2005-03-07 16:31:13 -0600 (Mon, 07 Mar 2005) | 1 line
Changed paths:
   M /trunk/packaging/nsis/Makefile.nmake
   M /trunk/packaging/nsis/ethereal.nsi

add xml and stats_tree plugin to the installer.
------------------------------------------------------------------------
r13656 | lroland | 2005-03-07 15:40:29 -0600 (Mon, 07 Mar 2005) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-pn-rt.c
   M /trunk/plugins/mate/mate.h
   M /trunk/plugins/mate/mate_plugin.c
   M /trunk/plugins/stats_tree/stats_tree_plugin.c
   M /trunk/plugins/xml/xml_plugin.c

remove remnants of the old plugin api from dissectors and plugins
------------------------------------------------------------------------
r13655 | lroland | 2005-03-07 15:11:34 -0600 (Mon, 07 Mar 2005) | 2 lines
Changed paths:
   M /trunk/gtk/stats_tree_stat.c

add a default size to stats_tree windows. so we do not have to resize them everytime.

------------------------------------------------------------------------
r13654 | lroland | 2005-03-07 14:31:35 -0600 (Mon, 07 Mar 2005) | 1 line
Changed paths:
   M /trunk/plugins/stats_tree/Makefile.nmake

set SVN keyword ID
------------------------------------------------------------------------
r13653 | lroland | 2005-03-07 14:25:09 -0600 (Mon, 07 Mar 2005) | 1 line
Changed paths:
   M /trunk/plugins/stats_tree/Makefile.nmake

fix clean target
------------------------------------------------------------------------
r13652 | etxrab | 2005-03-07 14:11:03 -0600 (Mon, 07 Mar 2005) | 1 line
Changed paths:
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-g723.c

Add a g723 dissector to dissect the first byte to find the rate and if speech is pressent or not.
------------------------------------------------------------------------
r13651 | lego | 2005-03-07 13:10:21 -0600 (Mon, 07 Mar 2005) | 15 lines
Changed paths:
   M /trunk/gtk/graph_analysis.c
   M /trunk/gtk/voip_calls.c
   M /trunk/gtk/voip_calls.h

From Alejandro Vaqero:

    - Fix a problem when pressing a key when  the "Graph" is  displayed
without any frame selected.

   - Add support for RTP Payload changes. Now the graph will show any
change in the RTP payload type. This is useful for example to show DTMF
2833 in a call.

-This line, and those below, will be ignored--

M    gtk/graph_analysis.c
M    gtk/voip_calls.c
M    gtk/voip_calls.h

------------------------------------------------------------------------
r13650 | lego | 2005-03-07 05:35:52 -0600 (Mon, 07 Mar 2005) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-radius.c
   M /trunk/epan/sminmpec.c
   M /trunk/epan/sminmpec.h

From Florian Lohoff:

Add Netscreen vendor specific attributes


------------------------------------------------------------------------
r13649 | lego | 2005-03-07 05:01:16 -0600 (Mon, 07 Mar 2005) | 6 lines
Changed paths:
   M /trunk/gtk/voip_calls_dlg.c

From Francisco Alcoba:

 - Correct the order of the calls in the VoIP Calls dialog when ordering by time fields
 - Prevent an assertion when ordering on the last columns


------------------------------------------------------------------------
r13648 | jmayer | 2005-03-07 04:19:33 -0600 (Mon, 07 Mar 2005) | 4 lines
Changed paths:
   M /trunk/capture.h
   M /trunk/gtk/capture_info_dlg.c
   M /trunk/gtk/main.c
   M /trunk/gtk/summary_dlg.c
   M /trunk/summary.h
   M /trunk/tethereal.c

- pcap.h needs to be included before capture.h
- As capture.h is empty without libpcap defined, only include it in that
  case and don't protect the file internally against libpcap any more.

------------------------------------------------------------------------
r13647 | jmayer | 2005-03-07 04:15:03 -0600 (Mon, 07 Mar 2005) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-kerberos.c

Fix a small typo that would prevent compilation with MIT Kerberos
------------------------------------------------------------------------
r13646 | sahlberg | 2005-03-07 03:02:33 -0600 (Mon, 07 Mar 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-kerberos.c
   M /trunk/epan/dissectors/packet-kerberos.h

export some symbols we will need later.


------------------------------------------------------------------------
r13645 | jmayer | 2005-03-07 02:47:48 -0600 (Mon, 07 Mar 2005) | 11 lines
Changed paths:
   M /trunk/epan/dissectors/packet-kerberos.c

Make packet-kerberos.c compile again:

Replace the use of the undefined type krb5_keyusage (at least with heimdal)
in decrypt_krb5_data with the old int. The change wasn't complete anyway
as the .h file wasn't changed and the third implemenitation of
decrypt_krb5_data was left out also.

Disclaimer: I only made sure it compiles again, I don't know whether the
  change has any side effects.


------------------------------------------------------------------------
r13644 | guy | 2005-03-06 20:44:41 -0600 (Sun, 06 Mar 2005) | 10 lines
Changed paths:
   M /trunk/doc/README.plugins
   M /trunk/epan/plugins.c
   M /trunk/epan/plugins.h
   M /trunk/ethereal_gen.py
   M /trunk/gtk/plugins_dlg.c
   M /trunk/plugins/acn/packet-acn.c
   M /trunk/plugins/agentx/packet-agentx.c
   M /trunk/plugins/artnet/packet-artnet.c
   M /trunk/plugins/asn1/packet-asn1.c
   M /trunk/plugins/ciscosm/packet-sm.c
   M /trunk/plugins/docsis/packet-docsis.c
   M /trunk/plugins/enttec/packet-enttec.c
   M /trunk/plugins/giop/packet-coseventcomm.c
   M /trunk/plugins/giop/packet-cosnaming.c
   M /trunk/plugins/gryphon/packet-gryphon.c
   M /trunk/plugins/irda/packet-irda.c
   M /trunk/plugins/lwres/packet-lwres.c
   M /trunk/plugins/mate/mate_plugin.c
   M /trunk/plugins/megaco/packet-megaco.c
   M /trunk/plugins/mgcp/packet-mgcp.c
   M /trunk/plugins/opsi/packet-opsi.c
   M /trunk/plugins/pcli/packet-pcli.c
   M /trunk/plugins/rdm/packet-rdm.c
   M /trunk/plugins/rlm/packet-rlm.c
   M /trunk/plugins/rtnet/packet-rtnet.c
   M /trunk/plugins/rudp/packet-rudp.c
   M /trunk/plugins/stats_tree/stats_tree_plugin.c
   M /trunk/plugins/v5ua/packet-v5ua.c
   M /trunk/plugins/xml/xml_plugin.c

Call the "new-style init" routine for plugins a "register" routine, as
it serves the same purpose as the register routine in a built-in
dissector, and don't require all dissectors to have one, as they might
just be taps.

Get rid of the stats tree's init routine, as it's just a tap, and as it
doesn't do anything.

Update the idl2eth Python script to generate plugins with register routines.

------------------------------------------------------------------------
r13643 | guy | 2005-03-06 19:22:55 -0600 (Sun, 06 Mar 2005) | 4 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/dissectors/packet-bacapp.c

Back out the BACnet application layer dissectin code - its use of
recursion instead of iteration means that packets with sufficiently
large lists can cause it to overflow the stack and crash.

------------------------------------------------------------------------
r13642 | sahlberg | 2005-03-06 16:52:58 -0600 (Sun, 06 Mar 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-spnego.c

minor update, add an extra parameter to a call to prepare for decryption of GSSAPI wrapped data


------------------------------------------------------------------------
r13641 | sahlberg | 2005-03-06 16:34:13 -0600 (Sun, 06 Mar 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-kerberos.c
   M /trunk/epan/dissectors/packet-kerberos.h

export decrypt_krb5_data


------------------------------------------------------------------------
r13640 | guy | 2005-03-06 16:14:24 -0600 (Sun, 06 Mar 2005) | 14 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bacapp.c

The length field in the "BACnet encoding rules" is limited to 32 bits
("Data lengths larger than 2^32-1 are not encodable using primitive
tags"), so it doesn't need to be a "guint64" - but it *can* be that big,
so we should handle the 65536-2^32-1 case.

Don't gratuitously throw away the upper 24 bits of various lengths by
casting them to guint8.

Show signed values as such.

Don't use "match_strval()" - it returns a null pointer if it doesn't
find the value in the value_string table; instead, use "val_to_str()" so
we don't blow up if the value isn't found.

------------------------------------------------------------------------
r13639 | lego | 2005-03-06 15:57:25 -0600 (Sun, 06 Mar 2005) | 4 lines
Changed paths:
   M /trunk/plugins/xml/packet-xml.c
   M /trunk/plugins/xml/xml_lexer.c
   M /trunk/plugins/xml/xml_lexer.l

- Add some media types to be dissected as xml
- be more tollerant on how an XML document should look like


------------------------------------------------------------------------
r13638 | lego | 2005-03-06 15:32:13 -0600 (Sun, 06 Mar 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-http.c

Add a preference for another alternate tcp port


------------------------------------------------------------------------
r13637 | etxrab | 2005-03-06 14:54:01 -0600 (Sun, 06 Mar 2005) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-amr.c

Fix a minor bug with FT_BOOLEAN.
------------------------------------------------------------------------
r13636 | lego | 2005-03-06 14:43:54 -0600 (Sun, 06 Mar 2005) | 2 lines
Changed paths:
   M /trunk/epan/libethereal.def

 add format_text() to the plugin API

------------------------------------------------------------------------
r13635 | guy | 2005-03-06 14:13:58 -0600 (Sun, 06 Mar 2005) | 4 lines
Changed paths:
   M /trunk/epan/address.h
   M /trunk/epan/column-utils.c
   M /trunk/epan/dissectors/packet-idp.c
   M /trunk/epan/dissectors/packet-smb.c
   M /trunk/epan/dissectors/packet-spp.c
   M /trunk/plugins/stats_tree/pinfo_stats_tree.c

Handle XNS IDP socket numbers.

Handle SMB-over-SPP.

------------------------------------------------------------------------
r13634 | guy | 2005-03-06 13:37:09 -0600 (Sun, 06 Mar 2005) | 4 lines
Changed paths:
   M /trunk/epan/epan.h
   M /trunk/epan/plugins.c

"report_err.h" declares "report_failure()", so it doesn't need to be
declared in "epan.h", and, as "epan/plugins.c" now includes
"report_err.h", it doesn't need to include "epan.h".

------------------------------------------------------------------------
r13633 | lego | 2005-03-06 12:30:59 -0600 (Sun, 06 Mar 2005) | 2 lines
Changed paths:
   M /trunk/plugins/xml/xml_lexer.c
   M /trunk/plugins/xml/xml_lexer.l

- get rid of some warnings

------------------------------------------------------------------------
r13632 | lego | 2005-03-06 12:02:27 -0600 (Sun, 06 Mar 2005) | 3 lines
Changed paths:
   M /trunk/plugins/stats_tree/http_stats_tree.c

- use the string id of the node, not the integer id in tick_stat_node


------------------------------------------------------------------------
r13631 | lego | 2005-03-06 11:06:55 -0600 (Sun, 06 Mar 2005) | 3 lines
Changed paths:
   M /trunk/epan/stats_tree.c

- replace tabs with spaces while printing
- get rid of a warning in windows compile

------------------------------------------------------------------------
r13630 | lego | 2005-03-06 10:58:34 -0600 (Sun, 06 Mar 2005) | 3 lines
Changed paths:
   M /trunk/plugins/stats_tree/stats_tree_plugin.c

Forgot this in the last checkin


------------------------------------------------------------------------
r13629 | lego | 2005-03-06 10:49:16 -0600 (Sun, 06 Mar 2005) | 3 lines
Changed paths:
   M /trunk/configure.in
   M /trunk/plugins/Makefile.am
   M /trunk/plugins/Makefile.nmake
   M /trunk/plugins/stats_tree/Makefile.am
   A /trunk/plugins/stats_tree/Makefile.nmake

Add stats_tree and xml plugins to the build process


------------------------------------------------------------------------
r13628 | jmayer | 2005-03-06 04:26:00 -0600 (Sun, 06 Mar 2005) | 4 lines
Changed paths:
   M /trunk/gtk/packet_win.c


Undo the last "fix" (13626): Unconditionally including <pcap.h> is
going to cause trouble for compilations without libpcap.

------------------------------------------------------------------------
r13627 | jmayer | 2005-03-06 04:03:53 -0600 (Sun, 06 Mar 2005) | 5 lines
Changed paths:
   M /trunk/gtk/menu.c

Warning fix:
menu.c:1841:1: warning: C++ style comments are not allowed in ISO C90
menu.c:1841:1: warning: (this will be reported only once per input file)
(just removed it)

------------------------------------------------------------------------
r13626 | jmayer | 2005-03-06 04:02:39 -0600 (Sun, 06 Mar 2005) | 7 lines
Changed paths:
   M /trunk/gtk/packet_win.c

Warning fix:
../capture.h:115: warning: struct pcap_stat declared inside parameter list
../capture.h:115: warning: its scope is only this definition or declaration,
        which is probably not what you want
../capture.h:125: warning: struct pcap_stat declared inside parameter list


------------------------------------------------------------------------
r13625 | jmayer | 2005-03-06 03:40:58 -0600 (Sun, 06 Mar 2005) | 5 lines
Changed paths:
   M /trunk/epan/epan.h
   M /trunk/epan/plugins.c

Warning fix:
plugins.c:236: warning: implicit declaration of function
        'report_failure'


------------------------------------------------------------------------
r13624 | jmayer | 2005-03-06 03:33:44 -0600 (Sun, 06 Mar 2005) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-sdp.c

Warning fix:
packet-sdp.c:74: warning: 'reset_sdp_packet_info' declared 'static'
        but never defined


------------------------------------------------------------------------
r13623 | guy | 2005-03-05 22:42:51 -0600 (Sat, 05 Mar 2005) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ssl.c

From Yaniv Kaul: show the protocol name in every record.

------------------------------------------------------------------------
r13622 | guy | 2005-03-05 22:41:42 -0600 (Sat, 05 Mar 2005) | 2 lines
Changed paths:
   M /trunk/epan/plugins.c

Squelch some compiler warnings.

------------------------------------------------------------------------
r13621 | guy | 2005-03-05 22:41:00 -0600 (Sat, 05 Mar 2005) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bacapp.c

Get rid of an unused variable.

------------------------------------------------------------------------
r13620 | lego | 2005-03-05 21:45:41 -0600 (Sat, 05 Mar 2005) | 3 lines
Changed paths:
   M /trunk/plugins/stats_tree/stats_tree_plugin.c

oops, no new_plugin_init() now there is


------------------------------------------------------------------------
r13619 | lego | 2005-03-05 21:38:25 -0600 (Sat, 05 Mar 2005) | 4 lines
Changed paths:
   A /trunk/plugins/xml
   A /trunk/plugins/xml/AUTHORS
   A /trunk/plugins/xml/COPYING
   A /trunk/plugins/xml/Makefile.am
   A /trunk/plugins/xml/Makefile.nmake
   A /trunk/plugins/xml/moduleinfo.h
   A /trunk/plugins/xml/packet-xml.c
   A /trunk/plugins/xml/packet-xml.h
   A /trunk/plugins/xml/xml_lexer.c
   A /trunk/plugins/xml/xml_lexer.l
   A /trunk/plugins/xml/xml_plugin.c

The first part of the XML dissector
currently just a preety-printer with some generic fields


------------------------------------------------------------------------
r13618 | guy | 2005-03-05 21:38:17 -0600 (Sat, 05 Mar 2005) | 2 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/dissectors/packet-diameter.c

No, the code is the numerical value, not the vendor ID.

------------------------------------------------------------------------
r13617 | guy | 2005-03-05 21:28:41 -0600 (Sat, 05 Mar 2005) | 2 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/dissectors/packet-diameter.c

From Ben Turner: fix an addVendor() call.

------------------------------------------------------------------------
r13616 | guy | 2005-03-05 21:25:19 -0600 (Sat, 05 Mar 2005) | 2 lines
Changed paths:
   M /trunk/asn1/inap/packet-inap-template.h
   M /trunk/epan/dissectors/packet-inap.h

Add a newline to the end of the file.

------------------------------------------------------------------------
r13615 | guy | 2005-03-05 21:19:34 -0600 (Sat, 05 Mar 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rtsp.c

Get rid of "unknown transport" warnings - don't spam the user just
because we haven't yet written a dissector for a particular protocol.

------------------------------------------------------------------------
r13614 | guy | 2005-03-05 21:11:24 -0600 (Sat, 05 Mar 2005) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-pgsql.c

Handle the "32-bit length is > 2^31-1, so the protocol tree routines
will treat it as negative" problem by first calling
"tvb_ensure_bytes_exist()" - if the length is *that* large, it will run
past the end of the tvbuff, so the exception that
"tvb_ensure_bytes_exist()" will throw with a negative argument will be
the correct exception.

------------------------------------------------------------------------
r13613 | lego | 2005-03-05 20:55:06 -0600 (Sat, 05 Mar 2005) | 2 lines
Changed paths:
   M /trunk/plugins/stats_tree/stats_tree_plugin.c

remove plugin_init()

------------------------------------------------------------------------
r13612 | lego | 2005-03-05 20:53:23 -0600 (Sat, 05 Mar 2005) | 2 lines
Changed paths:
   M /trunk/plugins/mate/mate_plugin.c

Change to new_plugin_init()

------------------------------------------------------------------------
r13611 | guy | 2005-03-05 20:24:49 -0600 (Sat, 05 Mar 2005) | 16 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bacapp.c

No, they don't use BER for the variable portion of a PDU; update the
comment appropriately.

Make a bunch of routines static.

Don't just dissect stuff past the end of the variable portion as data -
the protocol spec doesn't appear to say there's anything after that.

Don't pass the offset to the routines to dissect the different types of
PDUs, just have them start at 0.

Use guint8 for 8-bit unsigned quantities.

Rename the routine to dissect Abort PDUs to match the other PDU
dissectors.

------------------------------------------------------------------------
r13610 | jmayer | 2005-03-05 20:07:53 -0600 (Sat, 05 Mar 2005) | 1 line
Changed paths:
   M /trunk/FAQ
   M /trunk/help/faq.txt

Update to Sun, February 27 2005.
------------------------------------------------------------------------
r13609 | guy | 2005-03-05 19:53:56 -0600 (Sat, 05 Mar 2005) | 9 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bacapp.c

Don't use "long" and "%l[doux]" for 64-bit quantities, use guint64 and %
followed by PRIu64.

Don't use C++/C99-style comments.

Use "tvb_reported_length()" to get packet lengths - don't use
"tvb_length()", and especially don't directly refer to the "length"
field of the tvbuff.

------------------------------------------------------------------------
r13608 | jmayer | 2005-03-05 19:52:34 -0600 (Sat, 05 Mar 2005) | 7 lines
Changed paths:
   M /trunk/make-manuf
   M /trunk/manuf
   M /trunk/manuf.tmpl


- Modify make-manuf to add a message to manuf how to modify it
  (aka: don't modify manuf, change manuf.tmpl and wka.tmpl instead)
- Remove OUI 08:00:0F from manuf.tmpl, the IEEE provides the correct
  value by now.
- Regenerate manuf

------------------------------------------------------------------------
r13607 | jmayer | 2005-03-05 19:15:29 -0600 (Sat, 05 Mar 2005) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-rdt.c

Martin Mathieson: Add information sources
------------------------------------------------------------------------
r13606 | lego | 2005-03-05 18:39:40 -0600 (Sat, 05 Mar 2005) | 2 lines
Changed paths:
   M /trunk/manuf

Juan Gonzales of Mitel Networks pointed out this change to the IEEE's OUI list

------------------------------------------------------------------------
r13605 | guy | 2005-03-05 18:17:37 -0600 (Sat, 05 Mar 2005) | 3 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/dissectors/packet-bacapp.c

From Herbert Lischka: implement some (not all) tags according to BACNET
application handbook.

------------------------------------------------------------------------
r13604 | guy | 2005-03-05 17:44:23 -0600 (Sat, 05 Mar 2005) | 2 lines
Changed paths:
   M /trunk/gtk/sctp_stat_dlg.c

Get rid of a redundant test.

------------------------------------------------------------------------
r13603 | guy | 2005-03-05 17:36:07 -0600 (Sat, 05 Mar 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ospf.c

For OSPF versions other than 2 or 3, stop dissecting the packet after
the checksum (which is the last header field common to V2 and V3).

------------------------------------------------------------------------
r13602 | sahlberg | 2005-03-05 15:00:41 -0600 (Sat, 05 Mar 2005) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-jxta.c

From Mike Duigou   updates to JXTA



------------------------------------------------------------------------
r13601 | guy | 2005-03-05 14:52:03 -0600 (Sat, 05 Mar 2005) | 3 lines
Changed paths:
   M /trunk/gtk/gsm_map_summary.c

From Laurent Rabret: handle the case where there's no file name (i.e.,
an unsaved live capture), and avoid dividing by zero.

------------------------------------------------------------------------
r13600 | guy | 2005-03-05 14:36:03 -0600 (Sat, 05 Mar 2005) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-fw1.c

Clean up indentation.

Strings don't have a base, so use BASE_NONE with them, not BASE_DEC or
BASE_HEX.

------------------------------------------------------------------------
r13599 | gerald | 2005-03-05 11:57:27 -0600 (Sat, 05 Mar 2005) | 4 lines
Changed paths:
   M /trunk/gtk/rtp_analysis.c

When analyzing RTP streams, use the source address as well as the SSRC
to determine forward and reverse directions.  This fixes a capture I
have which has the same SSRC in the forward and reverse streams.

------------------------------------------------------------------------
r13598 | sahlberg | 2005-03-05 05:12:01 -0600 (Sat, 05 Mar 2005) | 6 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-dtp.c

New Protocol : DTP


From Charlie Lenahan   initial DTP support


------------------------------------------------------------------------
r13597 | sahlberg | 2005-03-05 04:51:30 -0600 (Sat, 05 Mar 2005) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bssgp.c

from susanne edlund :  make tlli appear in the tree

also change value_length and total_length signed to eliminate a compiler warning



------------------------------------------------------------------------
r13596 | lroland | 2005-03-05 00:28:10 -0600 (Sat, 05 Mar 2005) | 12 lines
Changed paths:
   M /trunk/doc/README.plugins
   M /trunk/epan/plugins.c
   M /trunk/plugins/acn/Makefile.nmake
   M /trunk/plugins/acn/packet-acn.c
   M /trunk/plugins/agentx/Makefile.nmake
   M /trunk/plugins/agentx/packet-agentx.c
   M /trunk/plugins/artnet/Makefile.nmake
   M /trunk/plugins/artnet/packet-artnet.c
   M /trunk/plugins/asn1/Makefile.nmake
   M /trunk/plugins/asn1/packet-asn1.c
   M /trunk/plugins/ciscosm/Makefile.nmake
   M /trunk/plugins/ciscosm/packet-sm.c
   M /trunk/plugins/docsis/Makefile.nmake
   M /trunk/plugins/docsis/packet-bpkmattr.c
   M /trunk/plugins/docsis/packet-bpkmreq.c
   M /trunk/plugins/docsis/packet-bpkmrsp.c
   M /trunk/plugins/docsis/packet-docsis.c
   M /trunk/plugins/docsis/packet-dsaack.c
   M /trunk/plugins/docsis/packet-dsareq.c
   M /trunk/plugins/docsis/packet-dsarsp.c
   M /trunk/plugins/docsis/packet-dscack.c
   M /trunk/plugins/docsis/packet-dscreq.c
   M /trunk/plugins/docsis/packet-dscrsp.c
   M /trunk/plugins/docsis/packet-dsdreq.c
   M /trunk/plugins/docsis/packet-dsdrsp.c
   M /trunk/plugins/docsis/packet-intrngreq.c
   M /trunk/plugins/docsis/packet-macmgmt.c
   M /trunk/plugins/docsis/packet-map.c
   M /trunk/plugins/docsis/packet-regack.c
   M /trunk/plugins/docsis/packet-regreq.c
   M /trunk/plugins/docsis/packet-regrsp.c
   M /trunk/plugins/docsis/packet-rngreq.c
   M /trunk/plugins/docsis/packet-rngrsp.c
   M /trunk/plugins/docsis/packet-tlv.c
   M /trunk/plugins/docsis/packet-type29ucd.c
   M /trunk/plugins/docsis/packet-uccreq.c
   M /trunk/plugins/docsis/packet-uccrsp.c
   M /trunk/plugins/docsis/packet-ucd.c
   M /trunk/plugins/docsis/packet-vendor.c
   M /trunk/plugins/enttec/Makefile.nmake
   M /trunk/plugins/enttec/packet-enttec.c
   M /trunk/plugins/giop/Makefile.nmake
   M /trunk/plugins/giop/packet-coseventcomm.c
   M /trunk/plugins/giop/packet-cosnaming.c
   M /trunk/plugins/gryphon/Makefile.nmake
   M /trunk/plugins/gryphon/packet-gryphon.c
   M /trunk/plugins/irda/Makefile.nmake
   M /trunk/plugins/irda/packet-ircomm.c
   M /trunk/plugins/irda/packet-irda.c
   M /trunk/plugins/irda/packet-sir.c
   M /trunk/plugins/lwres/Makefile.nmake
   M /trunk/plugins/lwres/packet-lwres.c
   M /trunk/plugins/mate/Makefile.nmake
   M /trunk/plugins/megaco/Makefile.nmake
   M /trunk/plugins/megaco/packet-megaco.c
   M /trunk/plugins/mgcp/Makefile.nmake
   M /trunk/plugins/mgcp/packet-mgcp.c
   M /trunk/plugins/opsi/Makefile.nmake
   M /trunk/plugins/opsi/packet-opsi.c
   M /trunk/plugins/pcli/Makefile.nmake
   M /trunk/plugins/pcli/packet-pcli.c
   M /trunk/plugins/rdm/Makefile.nmake
   M /trunk/plugins/rdm/packet-rdm.c
   M /trunk/plugins/rlm/Makefile.nmake
   M /trunk/plugins/rlm/packet-rlm.c
   M /trunk/plugins/rtnet/Makefile.nmake
   M /trunk/plugins/rtnet/packet-rtnet.c
   M /trunk/plugins/rudp/Makefile.nmake
   M /trunk/plugins/rudp/packet-rudp.c
   M /trunk/plugins/v5ua/Makefile.nmake
   M /trunk/plugins/v5ua/packet-v5ua.c

Preparations for dropping the old plugin api.
Introduce a new init routine for plugins, 
which does not take the plugin api table as an 
argument and allows etheral to distinguish 
between plugins using the old and the new api.

Update README.plugins accordingly

Change all g_warnings() in epan/plugins.c to report_failue().
On windows we do not have a log console open while
loading the plugins, because a log console cannot be opened before the prefs have been read. Thus g_warnings()
does not work for reporting problems with plugins.
------------------------------------------------------------------------
r13595 | guy | 2005-03-04 22:58:13 -0600 (Fri, 04 Mar 2005) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bssgp.c

From Susanne Edlund: filter on NRI values in BSSGP.

------------------------------------------------------------------------
r13594 | guy | 2005-03-04 19:03:22 -0600 (Fri, 04 Mar 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-tzsp.c

From Chris Waters: correct an error with the decoding of signal
strength information in 802.11 captures.

------------------------------------------------------------------------
r13593 | guy | 2005-03-04 19:00:15 -0600 (Fri, 04 Mar 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-kerberos.c

Omit some stuff when building without a Kerberos library, as it's unused
if you don't have a Kerberos library to do decryption.

------------------------------------------------------------------------
r13592 | tuexen | 2005-03-04 18:51:33 -0600 (Fri, 04 Mar 2005) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-sctp.c

Enable details in protocol tree by default like TCP and UDP.

------------------------------------------------------------------------
r13591 | lroland | 2005-03-04 18:21:46 -0600 (Fri, 04 Mar 2005) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-kerberos.c

fix kerberos dissector for those having no kerberos decryption
------------------------------------------------------------------------
r13590 | sahlberg | 2005-03-04 16:32:06 -0600 (Fri, 04 Mar 2005) | 6 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/dissectors/Makefile.common
   M /trunk/epan/dissectors/packet-mpls-echo.c
   M /trunk/epan/dissectors/packet-mpls.c
   A /trunk/epan/dissectors/packet-mpls.h

from Carlos Pignataro

update MPLS to support MPLS Echo



------------------------------------------------------------------------
r13589 | sahlberg | 2005-03-04 16:25:02 -0600 (Fri, 04 Mar 2005) | 5 lines
Changed paths:
   M /trunk/gtk/main.c

from didier:  bug fix for the menu,
if ethereal could not open the file   make us still be able to use the Open menu item to open a different file



------------------------------------------------------------------------
r13588 | jmayer | 2005-03-04 12:54:22 -0600 (Fri, 04 Mar 2005) | 1 line
Changed paths:
   M /trunk/docbook/Makefile

Small fixes to previous patch
------------------------------------------------------------------------
r13587 | gerald | 2005-03-04 11:42:42 -0600 (Fri, 04 Mar 2005) | 4 lines
Changed paths:
   M /trunk/Makefile.am

Remove AUTHORS-SHORT and AUTHORS-SHORT-FORMAT from the distribution.
(They're automatically generated.)


------------------------------------------------------------------------
r13586 | sahlberg | 2005-03-04 07:39:15 -0600 (Fri, 04 Mar 2005) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-kerberos.c
   M /trunk/epan/dissectors/packet-kerberos.h
   M /trunk/epan/dissectors/packet-kpasswd.c

make kpasswd privide subdissectors to handle the user-data field for the KRB_PRIV structure for kpasswd requests and replies.


decrypt and behold the new password in plaintext in all its glory
(given you have the keytab with the old one of course)


------------------------------------------------------------------------
r13585 | jmayer | 2005-03-04 07:24:47 -0600 (Fri, 04 Mar 2005) | 3 lines
Changed paths:
   M /trunk/docbook/Makefile
   M /trunk/docbook/README.txt

- Add -Xmx256m automatically on unixish systems.
- Make build process for A4 and letter pdfs more similar.

------------------------------------------------------------------------
r13584 | sahlberg | 2005-03-04 06:28:00 -0600 (Fri, 04 Mar 2005) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gssapi.c
   M /trunk/epan/dissectors/packet-kerberos.c

some authentication stuff from metze



------------------------------------------------------------------------
r13583 | sahlberg | 2005-03-04 06:21:40 -0600 (Fri, 04 Mar 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-kerberos.c
   M /trunk/epan/dissectors/packet-kerberos.h

make ethereal able to decrypt KRB_PRIV which kpasswd uses


------------------------------------------------------------------------
r13582 | sahlberg | 2005-03-04 05:08:03 -0600 (Fri, 04 Mar 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc-mapi.c

the unknown stuff in the decrypted blobs in mapi are just uninitialized buffer padding  so dont show them in the decode tree


------------------------------------------------------------------------
r13581 | lego | 2005-03-03 07:59:52 -0600 (Thu, 03 Mar 2005) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rmcp.c

From Francisco Alcoba,
do not look for data blocks in ACK packets


------------------------------------------------------------------------
r13580 | guy | 2005-03-03 04:23:29 -0600 (Thu, 03 Mar 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-isup.c

From Anders Broman: fix a fault in the CODEC LIST routine where offset
was wrongly calculated, and clean up some other miscellaneous stuff.

------------------------------------------------------------------------
r13579 | guy | 2005-03-03 03:36:19 -0600 (Thu, 03 Mar 2005) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-idp.h

Oops, forgot packet-idp.h.

------------------------------------------------------------------------
r13578 | guy | 2005-03-03 02:54:00 -0600 (Thu, 03 Mar 2005) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-acse.c
   M /trunk/epan/dissectors/packet-acse.h

From Yuriy Sidelnikov: correctly display User Information
field in release request/response PDu if the Reason field
is absent.

------------------------------------------------------------------------
r13577 | guy | 2005-03-03 02:34:48 -0600 (Thu, 03 Mar 2005) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-3com-xns.c
   M /trunk/epan/dissectors/packet-ethertype.c
   A /trunk/epan/dissectors/packet-idp.c
   M /trunk/epan/dissectors/packet-retix-bpdu.c
   A /trunk/epan/dissectors/packet-spp.c
   M /trunk/etypes.h

Add support for what appears to be 3Com's scheme for encapsulating XNS
over Token Ring (and presumably other link layers using 802.2 LLC), and
for the XNS IDP and SPP protocols.

------------------------------------------------------------------------
r13576 | lego | 2005-03-02 17:25:41 -0600 (Wed, 02 Mar 2005) | 3 lines
Changed paths:
   M /trunk/gtk/voip_calls.c

From Alejandro Vaquero:
Avoid adding to a call non ISUP mtp3 packets towards the same destination as a copy of the last ISUP packet towards that dpc.

------------------------------------------------------------------------
r13575 | lego | 2005-03-02 17:22:11 -0600 (Wed, 02 Mar 2005) | 4 lines
Changed paths:
   M /trunk/gtk/rtp_analysis.c
   M /trunk/gtk/rtp_stream.c
   M /trunk/gtk/rtp_stream.h

This is the rest of the patch from Francisco Alcoba.
I forgot to check in changes to these files yesterday


------------------------------------------------------------------------
r13574 | guy | 2005-03-02 15:08:47 -0600 (Wed, 02 Mar 2005) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-3g-a11.c

Use "tvb_get_string()" to fetch strings from the packet, rather than
filling up a fixed-length buffer.

Add a bunch of length checks.

Clean up indentation.

------------------------------------------------------------------------
r13573 | etxrab | 2005-03-02 14:16:18 -0600 (Wed, 02 Mar 2005) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-diameter.c

Present diameter time as UTC time rather than the local time zone of the machine running Ethereal is at.
 Insert a comment that time before 1970 will not be presented properly.
------------------------------------------------------------------------
r13572 | lego | 2005-03-01 19:24:18 -0600 (Tue, 01 Mar 2005) | 5 lines
Changed paths:
   M /trunk/gtk/rtp_stream_dlg.c

Frrom Francisco Alcoba
- Name resolution support for the RTP Stream Analysis functionality
- fix a crash when trying to analyze with no stream selected.


------------------------------------------------------------------------
r13571 | guy | 2005-03-01 18:21:33 -0600 (Tue, 01 Mar 2005) | 11 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gprs-llc.c

Handle the CRC correctly:

	don't do it if we don't have the entire packet, including the
	CRC value;

	fetch the CRC value from the packet with tvb_get_letoh24(),
	and compare that against the computed CRC, rather than comparing
	the computed CRC (presumably in host byte order) with the
	little-endian CRC in the packet (that doesn't work if host byte
	order is big-endian).

------------------------------------------------------------------------
r13570 | lego | 2005-03-01 17:46:05 -0600 (Tue, 01 Mar 2005) | 4 lines
Changed paths:
   M /trunk/tethereal.c

If -z was not given as the very last argument the tap listener initialization might have crashed.

Copy the optarg so that when the tap initialization is called it gets the right argument.

------------------------------------------------------------------------
r13569 | guy | 2005-03-01 15:49:19 -0600 (Tue, 01 Mar 2005) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-retix-bpdu.c

OK, *really* set the properties this time.

------------------------------------------------------------------------
r13568 | guy | 2005-03-01 15:47:54 -0600 (Tue, 01 Mar 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-retix-bpdu.c

Set the svn:keywords and svn:eol-style properties appropriately, and
give it an RCS ID.

------------------------------------------------------------------------
r13567 | guy | 2005-03-01 13:59:54 -0600 (Tue, 01 Mar 2005) | 3 lines
Changed paths:
   M /trunk/wiretap/file_access.c

The DBS Etherwatch file handler does look for a magic number (the word
"ETHERWATCH").

------------------------------------------------------------------------
r13566 | lego | 2005-03-01 13:43:14 -0600 (Tue, 01 Mar 2005) | 3 lines
Changed paths:
   M /trunk/plugins/stats_tree/http_stats_tree.c

add the http_srv tap a tree to verify load distribution between several http servers and/or virtual hosts


------------------------------------------------------------------------
r13565 | lego | 2005-03-01 10:19:46 -0600 (Tue, 01 Mar 2005) | 10 lines
Changed paths:
   M /trunk/gtk/graph_analysis.c
   M /trunk/gtk/graph_analysis.h
   M /trunk/gtk/voip_calls.c

From Alejandro Vaquero:

patch to the voip calls facility to:

- Add a horizontal scrollbar in the "Graph" to scroll the "comments"
- Fix a "state" bug in H323 and SIP calls
- Fix a bug that can make the "graph" to crash, and also clean up the "address" when the window is close



------------------------------------------------------------------------
r13564 | lego | 2005-03-01 05:37:26 -0600 (Tue, 01 Mar 2005) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-http.c


In packets with more than one req/resp the items of all the req/resp subtrees always pointed to the offset of the first req/resp.


------------------------------------------------------------------------
r13563 | sahlberg | 2005-03-01 04:09:53 -0600 (Tue, 01 Mar 2005) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-iscsi.c

If errorrecoverylevel==0 is used and the A bit is clear in a DataIn PDU 
the iscsi layer will not hold the LUN value (it is reserved)
so we need to remember if from the initial Command PDU.

make the LUN reporting work for errorrecoverylevel==0 targets


------------------------------------------------------------------------
r13562 | guy | 2005-03-01 00:32:56 -0600 (Tue, 01 Mar 2005) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-3g-a11.c

Show NTP times correctly.

------------------------------------------------------------------------
r13561 | guy | 2005-03-01 00:04:31 -0600 (Tue, 01 Mar 2005) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ntp.c

Show NTP times in a fashion more similar to that used for other times.

------------------------------------------------------------------------
r13560 | guy | 2005-03-01 00:03:08 -0600 (Tue, 01 Mar 2005) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mip.c

Show NTP times correctly.

------------------------------------------------------------------------
r13559 | guy | 2005-02-28 18:05:57 -0600 (Mon, 28 Feb 2005) | 9 lines
Changed paths:
   M /trunk/doc/ethereal.pod
   M /trunk/doc/tethereal.pod
   M /trunk/epan/prefs.c

From Graeme Hewson: rename the global preferences file to "preferences"
(it's now in an "ethereal" directory, so there's no need for it to have
a name that distinguishes it from files for other programs) - if it's
not found as "preferences", try "ethereal.conf" for compatibility - and
update the man pages appropriately.

Fix a typo in the section color filters (the file name is "colorfilters",
not "color filters").

------------------------------------------------------------------------
r13558 | ulfl | 2005-02-28 16:46:49 -0600 (Mon, 28 Feb 2005) | 3 lines
Changed paths:
   M /trunk/capture.c
   M /trunk/capture.h
   M /trunk/capture_sync.c
   M /trunk/file.c
   M /trunk/file.h

Another step towards using the parent/child mode for ALL captures.

This is currently still disabled, as we cannot pass all required capture flags to the child process (lack of command line parameters).
------------------------------------------------------------------------
r13557 | lego | 2005-02-28 16:39:03 -0600 (Mon, 28 Feb 2005) | 15 lines
Changed paths:
   M /trunk/epan/dissectors/packet-http.c

even if unharmful, this was simply ugly.
change

do {
 if (i == 0) break;
 ...
} while (i);

for a propper

while(i) {
 ...
}


------------------------------------------------------------------------
r13556 | lego | 2005-02-28 16:32:16 -0600 (Mon, 28 Feb 2005) | 4 lines
Changed paths:
   M /trunk/plugins/stats_tree/Makefile.am
   A /trunk/plugins/stats_tree/http_stats_tree.c
   M /trunk/plugins/stats_tree/stats_tree_plugin.c

add the http_stats_tree,
a replacement for the current http tap listeners and a tree for requested hosts/uris


------------------------------------------------------------------------
r13555 | lego | 2005-02-28 16:27:24 -0600 (Mon, 28 Feb 2005) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-http.c
   M /trunk/epan/dissectors/packet-http.h

few changes to http
- stat_infos are mantained in a GPtrArray to avoid leaking and overwriting them
- added http_host and request_uri to http_info_value_t 


------------------------------------------------------------------------
r13554 | etxrab | 2005-02-28 14:51:23 -0600 (Mon, 28 Feb 2005) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-radius.c

Change the RADIUS ATTRIBUTES for some 3GPP AVP:s to display them as (UTF8)Strings, also
added some more AVP:s from a later spec.
------------------------------------------------------------------------
r13553 | etxrab | 2005-02-28 14:49:34 -0600 (Mon, 28 Feb 2005) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-diameter.c

Undo change of return (addVendor(atoi(id), code, name)); as it wasn't correct.
------------------------------------------------------------------------
r13552 | etxrab | 2005-02-28 14:48:23 -0600 (Mon, 28 Feb 2005) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-bssgp.c

Correct presentation of IMSI digits and highlight correct bytes.
------------------------------------------------------------------------
r13551 | guy | 2005-02-28 13:47:46 -0600 (Mon, 28 Feb 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rx.c

Add a link to an RX spec, and ask whether the Epoch really should be
dissected as a UN*X time.

------------------------------------------------------------------------
r13550 | lego | 2005-02-28 05:10:49 -0600 (Mon, 28 Feb 2005) | 3 lines
Changed paths:
   M /trunk/plugins/stats_tree/stats_tree_plugin.c

Adapt the stats_tree example plugin to the last changes


------------------------------------------------------------------------
r13549 | guy | 2005-02-28 03:21:59 -0600 (Mon, 28 Feb 2005) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gprs-llc.c

Fix capitalization.

------------------------------------------------------------------------
r13548 | guy | 2005-02-28 03:21:19 -0600 (Mon, 28 Feb 2005) | 2 lines
Changed paths:
   M /trunk/epan/prefs.c

Map "llcgprs.ignore_cipher_bit" to "llcgprs.autodetect_cipher_bit".

------------------------------------------------------------------------
r13547 | guy | 2005-02-28 02:22:02 -0600 (Mon, 28 Feb 2005) | 2 lines
Changed paths:
   M /trunk/tools/asn2eth.py

Handle the new signature for "dissect_per_restricted_character_string()".

------------------------------------------------------------------------
r13546 | lego | 2005-02-27 19:20:52 -0600 (Sun, 27 Feb 2005) | 7 lines
Changed paths:
   M /trunk/gtk/stats_tree_stat.c


- do not free the string passed to register_ethereal_tap()
it caused the taps to have "funny" names.

- rename the window as "$name Stats Tree"


------------------------------------------------------------------------
r13545 | lego | 2005-02-27 18:55:49 -0600 (Sun, 27 Feb 2005) | 5 lines
Changed paths:
   M /trunk/gtk/main.c
   M /trunk/tethereal.c

Make sure that plugin tap listeners get registered before the non-plugin tap listeners
that's because stat trees are registered as tap listeners by either
gtk/stats_tree_stat.c or tap-stats_tree.c


------------------------------------------------------------------------
r13544 | lego | 2005-02-27 17:43:12 -0600 (Sun, 27 Feb 2005) | 3 lines
Changed paths:
   M /trunk/epan/libethereal.def

Add register_all_plugin_tap_listeners() to libethereal.def


------------------------------------------------------------------------
r13543 | guy | 2005-02-27 16:04:48 -0600 (Sun, 27 Feb 2005) | 4 lines
Changed paths:
   M /trunk/epan/plugins.c
   M /trunk/epan/plugins.h
   M /trunk/gtk/main.c
   M /trunk/gtk/plugins_dlg.c
   M /trunk/tethereal.c

The stats tree stuff should ultimately allow us to have plugin taps, so
add infrastructure for them, and display the plugin type (which could be
both dissector *and* tap) in the list of plugins.

------------------------------------------------------------------------
r13542 | etxrab | 2005-02-27 15:33:32 -0600 (Sun, 27 Feb 2005) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-diameter.c

Avoid trying to display a time before 00:00:00 UTC, January 1, 1970 as it currently will be displayed wrongly.
------------------------------------------------------------------------
r13541 | guy | 2005-02-27 15:15:30 -0600 (Sun, 27 Feb 2005) | 3 lines
Changed paths:
   M /trunk/capture_opts.c
   M /trunk/clopts_common.c
   M /trunk/clopts_common.h
   M /trunk/gtk/main.c

Move "get_natural_int()" and "get_positive_int()" from "capture_opts.c"
to "clopts_common.c", make them not static, and use them in "gtk/main.c".

------------------------------------------------------------------------
r13540 | lego | 2005-02-27 14:26:55 -0600 (Sun, 27 Feb 2005) | 13 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ip.c
   M /trunk/epan/dissectors/packet-rmt-fec.c

From Stefano Pettini

1) added _U_ tags in RMT dissectors to suppress "unused parameter" warnings.

2) added a dissector_add_handle("ip.udp", ip_handle) to IP dissector, to
allow the following chain of protocols: IP over UDP over IP. It seems
uncommon, but it's used by implementations of experimental protocols
(e.g. TCP-XM) that run a userspace IP stack (e.g. lwIP) over UDP. The
dissector of IP over UDP must be enabled explicitly using the "decode
as..." window.



------------------------------------------------------------------------
r13539 | lego | 2005-02-27 14:17:06 -0600 (Sun, 27 Feb 2005) | 5 lines
Changed paths:
   M /trunk/gtk/stats_tree_stat.c

the last commit broke windows compilation.
 minor changes in typing variables
 exclude a GTK2 call from being called while using GTK1


------------------------------------------------------------------------
r13538 | ulfl | 2005-02-27 13:59:03 -0600 (Sun, 27 Feb 2005) | 1 line
Changed paths:
   M /trunk/capture.c

some more cleanup of the capturing code (e.g. split up of the code reading in the "normal mode" captured data)
------------------------------------------------------------------------
r13537 | ulfl | 2005-02-27 12:52:05 -0600 (Sun, 27 Feb 2005) | 3 lines
Changed paths:
   M /trunk/capture.c

bugfix to bring up correct error message if capture file couldn't be openened.

some code cleanup
------------------------------------------------------------------------
r13536 | ulfl | 2005-02-27 12:27:30 -0600 (Sun, 27 Feb 2005) | 1 line
Changed paths:
   M /trunk/epan/libethereal.def

add missing reinit_stats_tree symbol, so MSVC can compile again
------------------------------------------------------------------------
r13535 | ulfl | 2005-02-27 11:30:33 -0600 (Sun, 27 Feb 2005) | 1 line
Changed paths:
   M /trunk/capture.c
   M /trunk/capture.h
   M /trunk/gtk/main.c

some clarification of the capture child thing
------------------------------------------------------------------------
r13534 | lego | 2005-02-27 10:55:24 -0600 (Sun, 27 Feb 2005) | 8 lines
Changed paths:
   M /trunk/epan/stats_tree.c
   M /trunk/epan/stats_tree.h
   M /trunk/epan/stats_tree_priv.h
   M /trunk/gtk/stats_tree_stat.c
   M /trunk/tap-stats_tree.c

Several fixes to the stats_tree
 - Avoid creating a copy of every branch at reinitialization
       this used to cause some GTK warnings and a leakage of tree nodes

- propperly check the optarg to avoid getting junk in the filter text
       this caused a crash


------------------------------------------------------------------------
r13533 | ulfl | 2005-02-27 10:54:52 -0600 (Sun, 27 Feb 2005) | 1 line
Changed paths:
   M /trunk/capture.h

minor comment additions
------------------------------------------------------------------------
r13532 | lego | 2005-02-27 08:01:12 -0600 (Sun, 27 Feb 2005) | 2 lines
Changed paths:
   M /trunk/gtk/main.c

abort early in main_filter_packets() if dftext is NULL

------------------------------------------------------------------------
r13531 | lego | 2005-02-27 07:57:45 -0600 (Sun, 27 Feb 2005) | 5 lines
Changed paths:
   M /trunk/gtk/sctp_stat_dlg.c

few fixes to The SCTP associations dialog
- do not call main_filter_packets() with a null dfilter string
- fix two leaks


------------------------------------------------------------------------
r13530 | lego | 2005-02-27 07:00:22 -0600 (Sun, 27 Feb 2005) | 6 lines
Changed paths:
   M /trunk/gtk/dlg_utils.c

From Martin Mathielson

- from the "Capture Options" dialog, if you select the Capture Filter(s)
file browser, Cancel doesn't work.


------------------------------------------------------------------------
r13529 | lego | 2005-02-27 06:45:07 -0600 (Sun, 27 Feb 2005) | 7 lines
Changed paths:
   M /trunk/gtk/rtp_stream_dlg.c

From Martin Mathielson
- from the "RTP streams" dialog, pressing 'Analyze' with no stream selected
would throw up an 'invalid filter' error.  This patch avoids anything if no
steam(s) are selected.



------------------------------------------------------------------------
r13528 | guy | 2005-02-25 18:14:22 -0600 (Fri, 25 Feb 2005) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-kerberos.c

The Kerberos-over-UDP dissector can decide not to dissect packets, so it
needs to be a new-style dissector and explicitly reject them so that
other dissectors can pick them up.

------------------------------------------------------------------------
r13527 | guy | 2005-02-25 17:47:21 -0600 (Fri, 25 Feb 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-kerberos4.c

The Kerberos 4 dissector is now a dissector that can reject packets, so
register it with "new_register_dissector".

------------------------------------------------------------------------
r13526 | guy | 2005-02-25 17:44:44 -0600 (Fri, 25 Feb 2005) | 3 lines
Changed paths:
   M /trunk/epan/packet_info.h

Make the DCE transport type an "int" so that -1 is a valid value and the
compiler doesn't say "that's unsigned, it can't possibly be equal to -1".

------------------------------------------------------------------------
r13525 | lroland | 2005-02-25 17:37:14 -0600 (Fri, 25 Feb 2005) | 3 lines
Changed paths:
   M /trunk/epan/libethereal.def

Add another function from epan/stats_tree.c to the list of exported functions in libethereal.def

Finally ethereal can be built again on windows.
------------------------------------------------------------------------
r13524 | lroland | 2005-02-25 17:08:53 -0600 (Fri, 25 Feb 2005) | 1 line
Changed paths:
   M /trunk/plugins/Makefile.nmake
   M /trunk/plugins/Xass-list
   M /trunk/plugins/Xplugin_api.c
   M /trunk/plugins/Xplugin_api.h
   M /trunk/plugins/Xplugin_api_decls.h
   M /trunk/plugins/Xplugin_table.h
   M /trunk/plugins/plugin_api_list.c

add agentx plugin to the clean target and update the old plugin api
------------------------------------------------------------------------
r13523 | sahlberg | 2005-02-25 17:03:24 -0600 (Fri, 25 Feb 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-scsi.c

start dissecting serviceactionin16


------------------------------------------------------------------------
r13522 | lego | 2005-02-25 16:57:43 -0600 (Fri, 25 Feb 2005) | 4 lines
Changed paths:
   M /trunk/gtk/stats_tree_stat.c

- undo disabling the GTK2 version
- do not declare a variable after the first statement or else windows compilation fails


------------------------------------------------------------------------
r13521 | lego | 2005-02-25 16:30:58 -0600 (Fri, 25 Feb 2005) | 3 lines
Changed paths:
   M /trunk/gtk/stats_tree_stat.c

Temporarily disable the gtk2 version that causes a compilation error on windows.


------------------------------------------------------------------------
r13520 | lroland | 2005-02-25 16:06:00 -0600 (Fri, 25 Feb 2005) | 1 line
Changed paths:
   M /trunk/epan/libethereal.def

Add another function from epan/stats_tree.c to the list of exported functions in libethereal.def
------------------------------------------------------------------------
r13519 | lroland | 2005-02-25 15:51:29 -0600 (Fri, 25 Feb 2005) | 1 line
Changed paths:
   M /trunk/epan/libethereal.def

Add some functions from epan/stats_tree.c to the list of exported functions in libethereal.def
------------------------------------------------------------------------
r13518 | tuexen | 2005-02-25 15:03:48 -0600 (Fri, 25 Feb 2005) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-sctp.c

Show prot numbers in protocol tree, if wanted. Suggested by Jeff Morris.

------------------------------------------------------------------------
r13517 | tuexen | 2005-02-25 14:33:28 -0600 (Fri, 25 Feb 2005) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mtp3.c

Add higher SI values.

------------------------------------------------------------------------
r13516 | sahlberg | 2005-02-25 05:38:56 -0600 (Fri, 25 Feb 2005) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-kerberos.c
   M /trunk/epan/dissectors/packet-kerberos4.c

add support to call krb4 for suspected krb4 stuff soming in on udp port 88

weirdo krb4 implementations apparently do this.


------------------------------------------------------------------------
r13515 | sahlberg | 2005-02-25 04:30:21 -0600 (Fri, 25 Feb 2005) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc.c
   M /trunk/epan/dissectors/packet-dcerpc.h
   M /trunk/epan/dissectors/packet-smb-pipe.c
   M /trunk/epan/packet_info.h
   M /trunk/gtk/decode_as_dcerpc.c

pinfo->private_data was a quite subptimal idea


change the decodeas for dcerpc so that it actually works again for dcerpc over smb



------------------------------------------------------------------------
r13514 | guy | 2005-02-25 03:58:50 -0600 (Fri, 25 Feb 2005) | 8 lines
Changed paths:
   M /trunk/Makefile.am

"docboook/Makefile.auto.in" is presumably generated from
"docbook/Makefile.auto.am", so it shouldn't need to be included in
EXTRA_DIST - and including it causes "make distcheck" to fail very early
with

	make: *** No rule to make target `docbook/Makefile.auto.in',
	    needed by `distdir'.  Stop.

------------------------------------------------------------------------
r13513 | guy | 2005-02-25 03:56:04 -0600 (Fri, 25 Feb 2005) | 2 lines
Changed paths:
   M /trunk/epan/libethereal.def
   M /trunk/epan/stats_tree.h

There's no "tick_range_with_parent_name()" routine.

------------------------------------------------------------------------
r13512 | guy | 2005-02-25 02:32:33 -0600 (Fri, 25 Feb 2005) | 3 lines
Changed paths:
   M /trunk/plugins/Xplugin_table.h

Fix the declaration of "dissect_ber_boolean()" to match the current
version.

------------------------------------------------------------------------
r13511 | guy | 2005-02-25 02:31:51 -0600 (Fri, 25 Feb 2005) | 3 lines
Changed paths:
   M /trunk/plugins/plugin_api_list.c

Fix the declaration of "dissect_ber_boolean()" to match the current
version.

------------------------------------------------------------------------
r13510 | guy | 2005-02-25 01:48:51 -0600 (Fri, 25 Feb 2005) | 4 lines
Changed paths:
   M /trunk/epan/libethereal.def

Add the stats tree routines.

Alphabetize, in dictionary order (case-insensitive).

------------------------------------------------------------------------
r13509 | lego | 2005-02-24 23:15:18 -0600 (Thu, 24 Feb 2005) | 3 lines
Changed paths:
   M /trunk/plugins/stats_tree/pinfo_stats_tree.c

added a tree example


------------------------------------------------------------------------
r13508 | lego | 2005-02-24 23:14:38 -0600 (Thu, 24 Feb 2005) | 2 lines
Changed paths:
   M /trunk/epan/stats_tree.c
   M /trunk/epan/stats_tree.h

change to int the return type of manip_stat_node() so that it can be used as a parent

------------------------------------------------------------------------
r13507 | lego | 2005-02-24 22:02:00 -0600 (Thu, 24 Feb 2005) | 3 lines
Changed paths:
   M /trunk/Makefile.common
   M /trunk/epan/Makefile.common
   M /trunk/gtk/Makefile.common

Get stats_tree compiled


------------------------------------------------------------------------
r13506 | lego | 2005-02-24 21:56:12 -0600 (Thu, 24 Feb 2005) | 6 lines
Changed paths:
   M /trunk/epan/stats_tree.c
   M /trunk/epan/stats_tree_priv.h
   M /trunk/gtk/stats_tree_stat.c

some more work for

- beautify the text output
- make gtk1 textbox implementation usable (I hope)


------------------------------------------------------------------------
r13505 | etxrab | 2005-02-24 16:36:26 -0600 (Thu, 24 Feb 2005) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-h248.c

Dissect  MTP3 with service indicator 14 as H248.
------------------------------------------------------------------------
r13504 | etxrab | 2005-02-24 16:35:10 -0600 (Thu, 24 Feb 2005) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-diameter.c

From Ben Turner:
Vendors were not being parsed properly from the XML diameter dictionary.
------------------------------------------------------------------------
r13503 | lego | 2005-02-24 16:04:34 -0600 (Thu, 24 Feb 2005) | 7 lines
Changed paths:
   M /trunk/plugins/stats_tree/pinfo_stats_tree.c
   M /trunk/plugins/stats_tree/stats_tree_plugin.c

Change the plugin to be something useful.

Adds more taps,
tests range nodes
tests pivot nodes


------------------------------------------------------------------------
r13502 | lego | 2005-02-24 16:02:31 -0600 (Thu, 24 Feb 2005) | 7 lines
Changed paths:
   M /trunk/epan/stats_tree.c
   M /trunk/epan/stats_tree.h
   M /trunk/epan/stats_tree_priv.h
   M /trunk/gtk/stats_tree_stat.c
   M /trunk/tap-stats_tree.c

Update to the stats_tree tapping API

- change the tap init_string to %s,tree instead of %s,stat
- change the registration key (it used to be tapname, that disallowed to register more than one tap per protocol)
- add a "pivot" node for convenience


------------------------------------------------------------------------
r13501 | lroland | 2005-02-24 15:31:20 -0600 (Thu, 24 Feb 2005) | 3 lines
Changed paths:
   M /trunk/gtk/graph_analysis.c
   M /trunk/gtk/graph_analysis.h
   M /trunk/gtk/voip_calls.c
   M /trunk/gtk/voip_calls.h
   M /trunk/gtk/voip_calls_dlg.c

By Francisco Alcoba:

Support for name resolution and IPv6 in VoIP Call Analysis
------------------------------------------------------------------------
r13500 | lego | 2005-02-24 15:22:51 -0600 (Thu, 24 Feb 2005) | 6 lines
Changed paths:
   M /trunk/capture_opts.c


avoid capture stopping after just 1 packet in tethereal,

- in capture_opts_init() set capture_opts->autostop_packets to 0 instead of one.


------------------------------------------------------------------------
r13499 | jmayer | 2005-02-24 13:46:15 -0600 (Thu, 24 Feb 2005) | 1 line
Changed paths:
   M /trunk/configure.in

Search for fop, not fop.sh
------------------------------------------------------------------------
r13498 | jmayer | 2005-02-24 13:45:08 -0600 (Thu, 24 Feb 2005) | 1 line
Changed paths:
   M /trunk/wiretap/README.airmagnet

Minor fixes
------------------------------------------------------------------------
r13497 | jmayer | 2005-02-24 03:08:20 -0600 (Thu, 24 Feb 2005) | 1 line
Changed paths:
   M /trunk/Makefile.am
   M /trunk/doc/Makefile.am

Didier Gautheron: Fix out of tree compilation
------------------------------------------------------------------------
r13496 | jmayer | 2005-02-24 01:23:18 -0600 (Thu, 24 Feb 2005) | 1 line
Changed paths:
   M /trunk/Makefile.am

Preliminary cleanup of static plugin linking
------------------------------------------------------------------------
r13495 | jmayer | 2005-02-24 01:19:42 -0600 (Thu, 24 Feb 2005) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

Add some minor Cisco proprietary stuff (hostname, network-eap)
------------------------------------------------------------------------
r13494 | guy | 2005-02-23 23:45:15 -0600 (Wed, 23 Feb 2005) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rtcp.c

Clean up white space.

"decode_boolean_bitfield()" returns a "const char *" - don't cast it to
a "gchar *" and modify what it points to.  Instead, just use
"other_decode_bitfield_value()".

------------------------------------------------------------------------
r13493 | guy | 2005-02-23 23:42:51 -0600 (Wed, 23 Feb 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-eth.h

Not everything that uses "capture_eth()" includes "capture.h" (the ATM
dissector, for one).

------------------------------------------------------------------------
r13492 | guy | 2005-02-23 23:42:03 -0600 (Wed, 23 Feb 2005) | 3 lines
Changed paths:
   M /trunk/gtk/rtp_stream_dlg.c

Mallocate the strings to be put into the columns, rather than filling in
fixed-length buffers.

------------------------------------------------------------------------
r13491 | guy | 2005-02-23 23:40:55 -0600 (Wed, 23 Feb 2005) | 2 lines
Changed paths:
   M /trunk/gtk/main.c

Don't include "../image/eicon3d64.xpm", as we're not using it for now.

------------------------------------------------------------------------
r13490 | guy | 2005-02-23 23:39:59 -0600 (Wed, 23 Feb 2005) | 5 lines
Changed paths:
   M /trunk/capture_opts.c

Include <string.h> and <ctype.h> to get the appropriate functions
declared and macros defined.

Pass all the necessary arguments to "get_natural_int()".

------------------------------------------------------------------------
r13489 | lego | 2005-02-23 22:15:40 -0600 (Wed, 23 Feb 2005) | 10 lines
Changed paths:
   M /trunk/gtk/graph_analysis.c
   M /trunk/gtk/voip_calls_dlg.c

From Alejandro Vaquero
voip_calls_dlg.c
    Change the "prepare filter" function to be protocol independent. Now it uses the
    "frame_num"s  from the Graph structure to create the filter. This also add support
    to MGCP and H323 LRQ/LCF filters that were not supported before.

graph_analysis.c:
    Change the mouse scroll wheel implementation to make a 3 line step change instead of 1 line.


------------------------------------------------------------------------
r13488 | lego | 2005-02-23 22:11:31 -0600 (Wed, 23 Feb 2005) | 4 lines
Changed paths:
   M /trunk/plugins/mate/mate_util.c
   M /trunk/plugins/mate/packet-mate.c

- fix a crash in new_avpl_strict_match when the operator avpl was empty
- change the name of the preference mate.config_filename: into mate.config:


------------------------------------------------------------------------
r13487 | ulfl | 2005-02-23 18:30:32 -0600 (Wed, 23 Feb 2005) | 1 line
Changed paths:
   M /trunk/capture_sync.c

if capture filename passed to parent, save it. Will currently take no effect.
------------------------------------------------------------------------
r13486 | etxrab | 2005-02-23 17:14:42 -0600 (Wed, 23 Feb 2005) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_map.c
   M /trunk/epan/dissectors/packet-gsm_map.h

fix some asn2eth warnings
------------------------------------------------------------------------
r13485 | etxrab | 2005-02-23 17:13:57 -0600 (Wed, 23 Feb 2005) | 1 line
Changed paths:
   M /trunk/asn1/gsmmap/GSMMAP.asn
   M /trunk/asn1/gsmmap/gsmmap.cnf
   M /trunk/asn1/gsmmap/packet-gsm_map-template.c

Fix some asn2eth warnings.
------------------------------------------------------------------------
r13484 | etxrab | 2005-02-23 17:12:48 -0600 (Wed, 23 Feb 2005) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-h248.c
   M /trunk/epan/dissectors/packet-h248.h

Add dissection of packet tdmc
------------------------------------------------------------------------
r13483 | etxrab | 2005-02-23 17:12:07 -0600 (Wed, 23 Feb 2005) | 1 line
Changed paths:
   M /trunk/asn1/h248/packet-h248-template.c

Add dissection of packet tdmc
------------------------------------------------------------------------
r13482 | ulfl | 2005-02-23 16:04:31 -0600 (Wed, 23 Feb 2005) | 1 line
Changed paths:
   M /trunk/capture_loop.c
   M /trunk/capture_opts.c
   M /trunk/capture_sync.c
   M /trunk/capture_sync.h

pass child capture filename to parent process (name currently unused) and some fork_child cleanup
------------------------------------------------------------------------
r13481 | ulfl | 2005-02-23 15:04:19 -0600 (Wed, 23 Feb 2005) | 1 line
Changed paths:
   M /trunk/capture.h

CHILD_NAME is only used #ifdef HAVE_LIBPCAP
------------------------------------------------------------------------
r13480 | lego | 2005-02-23 11:05:32 -0600 (Wed, 23 Feb 2005) | 4 lines
Changed paths:
   M /trunk/tethereal.c

in tethereal
list_link_layer_types was not being initialized causing the "-r" option to fail


------------------------------------------------------------------------
r13479 | sahlberg | 2005-02-23 02:57:47 -0600 (Wed, 23 Feb 2005) | 3 lines
Changed paths:
   M /trunk/asn1/cms/cms-exp.cnf
   M /trunk/asn1/pkixcrmf/crmf-exp.cnf
   M /trunk/asn1/x509af/x509af-exp.cnf
   M /trunk/asn1/x509ce/x509ce-exp.cnf
   M /trunk/asn1/x509if/x509if-exp.cnf
   M /trunk/asn1/x509sat/x509sat-exp.cnf
   M /trunk/epan/dissectors/packet-ber.c
   M /trunk/epan/dissectors/packet-ber.h
   M /trunk/epan/dissectors/packet-cms.c
   M /trunk/epan/dissectors/packet-cms.h
   M /trunk/epan/dissectors/packet-crmf.c
   M /trunk/epan/dissectors/packet-crmf.h
   M /trunk/epan/dissectors/packet-gsm_map.c
   M /trunk/epan/dissectors/packet-gsm_map.h
   M /trunk/epan/dissectors/packet-h248.c
   M /trunk/epan/dissectors/packet-h248.h
   M /trunk/epan/dissectors/packet-inap.c
   M /trunk/epan/dissectors/packet-kerberos.c
   M /trunk/epan/dissectors/packet-ocsp.c
   M /trunk/epan/dissectors/packet-pkcs1.c
   M /trunk/epan/dissectors/packet-pkix1explicit.c
   M /trunk/epan/dissectors/packet-pkix1explicit.h
   M /trunk/epan/dissectors/packet-pkixqualified.c
   M /trunk/epan/dissectors/packet-pkixtsp.c
   M /trunk/epan/dissectors/packet-smrse.c
   M /trunk/epan/dissectors/packet-x509af.c
   M /trunk/epan/dissectors/packet-x509af.h
   M /trunk/epan/dissectors/packet-x509ce.c
   M /trunk/epan/dissectors/packet-x509ce.h
   M /trunk/epan/dissectors/packet-x509if.c
   M /trunk/epan/dissectors/packet-x509if.h
   M /trunk/epan/dissectors/packet-x509sat.c
   M /trunk/epan/dissectors/packet-x509sat.h
   M /trunk/tools/asn2eth.py

update asn2eth and all generated dissectors to new dissect_ber_boolean that takes a implicit_tag parameter


------------------------------------------------------------------------
r13478 | sahlberg | 2005-02-23 02:38:18 -0600 (Wed, 23 Feb 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ndmp.c

fix printout of length of ndmp pdu


------------------------------------------------------------------------
r13477 | sahlberg | 2005-02-23 02:37:30 -0600 (Wed, 23 Feb 2005) | 4 lines
Changed paths:
   M /trunk/gtk/voip_calls.c

g_strrstr does not exist in gtk 1
replace it with strstr


------------------------------------------------------------------------
r13476 | ulfl | 2005-02-23 02:34:12 -0600 (Wed, 23 Feb 2005) | 1 line
Changed paths:
   M /trunk/capture.h
   M /trunk/capture_opts.c
   M /trunk/gtk/main.c
   M /trunk/tethereal.c

use the applications name (currently "ethereal" or "tethereal") in capture_opts, instead of hardcoded "ethereal" for both.
------------------------------------------------------------------------
r13475 | gerald | 2005-02-22 23:47:17 -0600 (Tue, 22 Feb 2005) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-http.c

Add request URI and Version fields.  Add a question about fixing a memory leak.

------------------------------------------------------------------------
r13474 | ulfl | 2005-02-22 19:01:19 -0600 (Tue, 22 Feb 2005) | 1 line
Changed paths:
   M /trunk/Makefile.common
   M /trunk/capture.c
   A /trunk/capture_opts.c
   M /trunk/gtk/main.c
   M /trunk/tethereal.c

move capture_opts related things (init, command line, ...) from capture.c to a new file capture_opts.c and let both ethereal and tethereal use it.
------------------------------------------------------------------------
r13473 | ulfl | 2005-02-22 17:46:54 -0600 (Tue, 22 Feb 2005) | 5 lines
Changed paths:
   M /trunk/capture.c
   M /trunk/doc/ethereal.pod

add the number of autostop files to the command line parameters, e.g.:

-a files:20

also added this to the manpage, the user's guide will follow later
------------------------------------------------------------------------
r13472 | ulfl | 2005-02-22 15:22:56 -0600 (Tue, 22 Feb 2005) | 2 lines
Changed paths:
   M /trunk/gtk/main.c

There seems to be some disagreement about if and how the welcome screen feature should be implemented.
As I currently don't have the time to continue this, I've temporarily disabled it.
------------------------------------------------------------------------
r13471 | ulfl | 2005-02-22 14:25:23 -0600 (Tue, 22 Feb 2005) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc-pn-io.c
   M /trunk/epan/dissectors/packet-pn-rt.c

fix usage of "if(tree) {" to display the right things, even if no coloring rule is set
------------------------------------------------------------------------
r13470 | lego | 2005-02-22 13:37:46 -0600 (Tue, 22 Feb 2005) | 5 lines
Changed paths:
   M /trunk/gtk/voip_calls.c

From Alejandro Vaquero:
  replace the code that used g_strsplit_set and was broken by me
  changing it to g_strsplit with something that works


------------------------------------------------------------------------
r13469 | lego | 2005-02-22 13:17:28 -0600 (Tue, 22 Feb 2005) | 7 lines
Changed paths:
   M /trunk/tethereal.c

Do not call the tap's initialization as soon as the -z option is read,
postpone it after the preferences callback has being called.

That way mate's fields, which are registered by the preferences callback
can be used as part of the tap's filter.


------------------------------------------------------------------------
r13468 | ulfl | 2005-02-22 01:53:54 -0600 (Tue, 22 Feb 2005) | 1 line
Changed paths:
   M /trunk/gtk/graph_analysis.c

prevent messages like "Couldn't load font x, falling back to y", see comment for details
------------------------------------------------------------------------
r13467 | ulfl | 2005-02-22 01:31:19 -0600 (Tue, 22 Feb 2005) | 1 line
Changed paths:
   M /trunk/gtk/voip_calls_dlg.c

some changes to the dialog's button behaviour
------------------------------------------------------------------------
r13466 | ulfl | 2005-02-22 01:25:16 -0600 (Tue, 22 Feb 2005) | 1 line
Changed paths:
   M /trunk/gtk/voip_calls.c

bugfix: using the "rtp_example.raw.gz" from the wiki, the dialog runs into an endless loop, as a g_list_next() was missing in a while loop
------------------------------------------------------------------------
r13465 | ulfl | 2005-02-22 01:22:51 -0600 (Tue, 22 Feb 2005) | 1 line
Changed paths:
   M /trunk/gtk/rtp_stream_dlg.c

buttons should use "Header capitalization" see GNOME HIG http://developer.gnome.org/projects/gup/hig/1.0/layout.html#layout-capitalization
------------------------------------------------------------------------
r13464 | lego | 2005-02-21 20:16:35 -0600 (Mon, 21 Feb 2005) | 2 lines
Changed paths:
   M /trunk/plugins/mate/mate_setup.c

avoid crashing when Debug_Cfg is set and no Payload is given for a Pdu

------------------------------------------------------------------------
r13463 | lego | 2005-02-21 19:55:04 -0600 (Mon, 21 Feb 2005) | 7 lines
Changed paths:
   M /trunk/epan/addr_resolv.c
   M /trunk/epan/addr_resolv.h
   M /trunk/epan/address.h
   M /trunk/epan/column-utils.c
   M /trunk/gtk/conversations_table.c
   M /trunk/gtk/hostlist_table.c

From Francisco Alcoba:
changed the behaviour of get_addr_name:
 - resolve to a name if the address supports it
 - call address_to_str if it does not, but the address is valid
 - return "NONE" if it is AT_NONE


------------------------------------------------------------------------
r13462 | lego | 2005-02-21 17:29:49 -0600 (Mon, 21 Feb 2005) | 4 lines
Changed paths:
   M /trunk/plugins/mgcp/packet-mgcp.h


ooops,I forgot this one with the last checkin


------------------------------------------------------------------------
r13461 | lego | 2005-02-21 16:53:01 -0600 (Mon, 21 Feb 2005) | 7 lines
Changed paths:
   M /trunk/gtk/voip_calls.c

from Alejandro Vaquero
 - fix the thinks I broken removing warnings in the last commit

other than that I removed calls to glib2 that broke
compilation on solaris' buiddbot


------------------------------------------------------------------------
r13460 | ulfl | 2005-02-21 14:19:15 -0600 (Mon, 21 Feb 2005) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-ethertype.c
   M /trunk/etypes.h

added IEEE 802.1 Link Layer Discovery Protocol (LLDP) to the ethertypes, but sorry, no dissector (yet?)
------------------------------------------------------------------------
r13459 | ulfl | 2005-02-21 13:51:13 -0600 (Mon, 21 Feb 2005) | 1 line
Changed paths:
   M /trunk/gtk/about_dlg.c

We've "just reached" 2005, extend the copyright notice by the "new" year ...
------------------------------------------------------------------------
r13458 | ulfl | 2005-02-21 13:49:38 -0600 (Mon, 21 Feb 2005) | 1 line
Changed paths:
   M /trunk/gtk/main.c

As we have a (two) WishList(s) in the Wiki now, this to do list doesn't make any sense
------------------------------------------------------------------------
r13457 | lego | 2005-02-20 21:06:41 -0600 (Sun, 20 Feb 2005) | 5 lines
Changed paths:
   M /trunk/gtk/graph_analysis.c

From Alejandro Vaquero
Add support of mouse scroll wheel and directional keys
(Up, down, left, and right) in the Graph Analysis.


------------------------------------------------------------------------
r13456 | lego | 2005-02-20 20:36:55 -0600 (Sun, 20 Feb 2005) | 6 lines
Changed paths:
   M /trunk/gtk/voip_calls.c

fix few things:
- boolean does not exists in *nix change them to g_boolean
- removed some warnings about uninitialized variables
- mgcp_info->hasDigitMap is a pointer to a boolean, dereference it


------------------------------------------------------------------------
r13455 | ulfl | 2005-02-20 20:35:42 -0600 (Sun, 20 Feb 2005) | 3 lines
Changed paths:
   M /trunk/docbook/Makefile

I have to check this in with HHC enabled, otherwise I cannot get a chm file without the SVN-version.xml includes a modified tag.

Joerg seem's to have fix this HHC thing, so it should be compilable on unix systems without errors (hopefully).
------------------------------------------------------------------------
r13454 | ulfl | 2005-02-20 20:12:21 -0600 (Sun, 20 Feb 2005) | 1 line
Changed paths:
   M /trunk/docbook/Makefile

add svn_version.xml to both validate targets
------------------------------------------------------------------------
r13453 | jmayer | 2005-02-20 19:02:43 -0600 (Sun, 20 Feb 2005) | 1 line
Changed paths:
   M /trunk/docbook

svn:ignore the new pdf file names and svn_version.xml
------------------------------------------------------------------------
r13452 | ulfl | 2005-02-20 16:36:34 -0600 (Sun, 20 Feb 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcm.c
   M /trunk/epan/dissectors/packet-pres.c
   M /trunk/epan/dissectors/packet-rtcp.c
   M /trunk/epan/dissectors/packet-sigcomp.c
   M /trunk/epan/sigcomp_state_hdlr.c
   M /trunk/epan/xmlstub.h
   M /trunk/plugins/acn/packet-acn.c
   M /trunk/plugins/lwres/packet-lwres.c
   M /trunk/plugins/mate/mate_util.c

fix a typo: lenght -> length

This seems to be a "more common" typo, fixed it 13 times throughout the code ...
------------------------------------------------------------------------
r13451 | ulfl | 2005-02-20 15:45:52 -0600 (Sun, 20 Feb 2005) | 3 lines
Changed paths:
   M /trunk/docbook/Makefile

from Joerg Mayer: changes towards the automake generation

I've added some minor cleanup things 
------------------------------------------------------------------------
r13450 | ulfl | 2005-02-20 14:49:15 -0600 (Sun, 20 Feb 2005) | 6 lines
Changed paths:
   A /trunk/docbook/edg_graphics/note.png
   A /trunk/docbook/edg_graphics/tip.png
   A /trunk/docbook/edg_graphics/warning.png
   M /trunk/docbook/graphics/note.png
   M /trunk/docbook/graphics/tip.png
   M /trunk/docbook/graphics/warning.png

The former icons used for both guide's were copied from the DOCBOOKXSLT package, which is used to convert the files from XML to HTML or whatever.

As it's unsure if the license of these icons match the way we use it (I would think so, but I'm unsure), 
I've replaced them by stock icons (see http://developer.gnome.org/doc/API/2.0/gtk/gtk-Stock-Items.html) from the GTK library (licensed under LPGL), so it should be ok to use them in an GPL project.

I had to scale them from 48x48 to 24x24, but the Gimp is my friend :-)
------------------------------------------------------------------------
r13449 | lego | 2005-02-20 12:18:10 -0600 (Sun, 20 Feb 2005) | 2 lines
Changed paths:
   M /trunk/gtk/stats_tree_stat.c

comment out two g_message() calls

------------------------------------------------------------------------
r13448 | lego | 2005-02-20 11:43:38 -0600 (Sun, 20 Feb 2005) | 5 lines
Changed paths:
   M /trunk/epan/stats_tree.c
   M /trunk/epan/stats_tree.h
   M /trunk/epan/stats_tree_priv.h
   M /trunk/gtk/stats_tree_stat.c
   M /trunk/plugins/stats_tree/stats_tree_plugin.c

Fixes few things during reinitialization with gtk2 (it doesn't crash anymore),
  there are still problems at reinit (gtk2 node->pr warns about an iterator not been OK)

set up propperties of the given files

------------------------------------------------------------------------
r13447 | lroland | 2005-02-20 09:53:11 -0600 (Sun, 20 Feb 2005) | 7 lines
Changed paths:
   M /trunk/gtk/mgcp_stat.c
   M /trunk/gtk/voip_calls.c
   M /trunk/gtk/voip_calls.h
   M /trunk/gtk/voip_calls_dlg.c
   M /trunk/plugins/mgcp/packet-mgcp.c
   M /trunk/plugins/mgcp/packet-mgcp.h
   M /trunk/tap-mgcpstat.c

Don't register mgcp taps, 
when we haven't loaded the mgcp plugin.

and

From Alejandro Vaquero:
mgcp support for the voip call analysis tap
------------------------------------------------------------------------
r13446 | jmayer | 2005-02-20 01:25:58 -0600 (Sun, 20 Feb 2005) | 1 line
Changed paths:
   M /trunk/docbook/Makefile

Fix generation of svn_version.xml with Unix make
------------------------------------------------------------------------
r13445 | jmayer | 2005-02-20 00:42:08 -0600 (Sun, 20 Feb 2005) | 1 line
Changed paths:
   M /trunk/configure.in
   M /trunk/docbook/Makefile

Correct fix for distcheck this time - definitely
------------------------------------------------------------------------
r13444 | jmayer | 2005-02-20 00:08:15 -0600 (Sun, 20 Feb 2005) | 1 line
Changed paths:
   M /trunk/docbook/Makefile

The last checkin changed the settings to my system - reevrt them back so Ulf can use it out of the box
------------------------------------------------------------------------
r13443 | jmayer | 2005-02-19 23:53:06 -0600 (Sat, 19 Feb 2005) | 1 line
Changed paths:
   M /trunk/docbook/Makefile

Remove Makefile.auto during make clean (distcheck again)
------------------------------------------------------------------------
r13442 | jmayer | 2005-02-19 23:39:24 -0600 (Sat, 19 Feb 2005) | 1 line
Changed paths:
   M /trunk/plugins/stats_tree
   M /trunk/plugins/stats_tree/AUTHORS
   M /trunk/plugins/stats_tree/Makefile.am
   M /trunk/plugins/stats_tree/NEWS
   M /trunk/plugins/stats_tree/pinfo_stats_tree.c
   M /trunk/plugins/stats_tree/stats_tree_plugin.c

Add some svn props
------------------------------------------------------------------------
r13441 | jmayer | 2005-02-19 23:20:42 -0600 (Sat, 19 Feb 2005) | 1 line
Changed paths:
   M /trunk/configure.in

Remove stats_tree again: It breaks distcheck
------------------------------------------------------------------------
r13440 | jmayer | 2005-02-19 23:06:28 -0600 (Sat, 19 Feb 2005) | 1 line
Changed paths:
   M /trunk/Makefile.am

Makefile.autoi.* isn't automagically added to tarball - add to EXTRA_DIST for now
------------------------------------------------------------------------
r13439 | jmayer | 2005-02-19 23:01:46 -0600 (Sat, 19 Feb 2005) | 1 line
Changed paths:
   M /trunk/configure.in
   M /trunk/docbook
   A /trunk/docbook/Makefile.auto.am

Beginnings of autogenerating docbook/Makefile (long way to go) so call it Makefile.auto for now
------------------------------------------------------------------------
r13438 | jmayer | 2005-02-19 22:34:03 -0600 (Sat, 19 Feb 2005) | 1 line
Changed paths:
   M /trunk/configure.in

Create stats_tree Makefile to allow manual builds
------------------------------------------------------------------------
r13437 | jmayer | 2005-02-19 22:31:30 -0600 (Sat, 19 Feb 2005) | 1 line
Changed paths:
   M /trunk/gtk/Makefile.nmake

Replace some spaces by TAB to make vim with syntax highlighting happy
------------------------------------------------------------------------
r13436 | jmayer | 2005-02-19 22:17:17 -0600 (Sat, 19 Feb 2005) | 1 line
Changed paths:
   M /trunk/epan/dissectors/Makefile.common

Add packet-rdt.h to DISSECTOR_INCLUDES
------------------------------------------------------------------------
r13435 | lego | 2005-02-19 20:21:04 -0600 (Sat, 19 Feb 2005) | 9 lines
Changed paths:
   M /trunk/plugins/mate/examples/call.mate
   M /trunk/plugins/mate/examples/mms.mate
   M /trunk/plugins/mate/examples/pasv_ftp.mate
   M /trunk/plugins/mate/examples/tcp.mate
   M /trunk/plugins/mate/examples/web.mate
   M /trunk/plugins/mate/mate.h
   M /trunk/plugins/mate/mate_setup.c
   M /trunk/plugins/mate/packet-mate.c

Changed the GopTree in GogDef and GogExtra from a boolean to a string
  GopTree={BasicTree|NoTree|FullTree}
    NoTree: just an item for each gop
    BasicTree: (default) some essential information regarding the gop
    FullTree: the Gop's full tree

added Id and eol-style to examples


------------------------------------------------------------------------
r13434 | lego | 2005-02-19 19:58:29 -0600 (Sat, 19 Feb 2005) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rdt.c
   M /trunk/epan/dissectors/packet-rdt.h

modify eol-style property

------------------------------------------------------------------------
r13433 | lego | 2005-02-19 19:41:57 -0600 (Sat, 19 Feb 2005) | 2 lines
Changed paths:
   M /trunk/plugins/mate/examples/mms.mate

set the property keyword Id 

------------------------------------------------------------------------
r13432 | lego | 2005-02-19 19:40:31 -0600 (Sat, 19 Feb 2005) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rdt.c
   M /trunk/epan/dissectors/packet-rdt.h

set the Id keyword for these two new files

------------------------------------------------------------------------
r13431 | lego | 2005-02-19 16:43:38 -0600 (Sat, 19 Feb 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-rdt.c
   A /trunk/epan/dissectors/packet-rdt.h
   M /trunk/epan/dissectors/packet-rtsp.c

From Martin Mathielson
 RDT (Realplayer Data Protocol) dissector and patch RTSP to create RDT conversations

------------------------------------------------------------------------
r13430 | lego | 2005-02-18 21:22:24 -0600 (Fri, 18 Feb 2005) | 2 lines
Changed paths:
   A /trunk/plugins/mate/examples/mms.mate

add mms.mate to the examples collection

------------------------------------------------------------------------
r13429 | lego | 2005-02-18 21:10:50 -0600 (Fri, 18 Feb 2005) | 2 lines
Changed paths:
   M /trunk/plugins/mate/mate_setup.c

In order to avoid a crash at reanalize_gop(), do not accept a GogKey where the Gop has not yet being declared.

------------------------------------------------------------------------
r13428 | lego | 2005-02-18 16:43:12 -0600 (Fri, 18 Feb 2005) | 2 lines
Changed paths:
   M /trunk/plugins/mate/moduleinfo.h

Step the version number of the plugin

------------------------------------------------------------------------
r13427 | lego | 2005-02-18 16:33:16 -0600 (Fri, 18 Feb 2005) | 3 lines
Changed paths:
   M /trunk/plugins/mate/mate.h
   M /trunk/plugins/mate/mate_runtime.c
   M /trunk/plugins/mate/mate_setup.c

Adds Payload AVP to PduDef AVPLs simmetric to the Transport AVP
allows to fetch fields also from ranges that are the payload of the Proto

------------------------------------------------------------------------
r13426 | sahlberg | 2005-02-18 15:19:01 -0600 (Fri, 18 Feb 2005) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-jxta.c

usage of tcp_dissect_pdu   is broken

comment it out to stop it from dumping core.
jxta people will have to fix this properly later.



------------------------------------------------------------------------
r13425 | lego | 2005-02-18 14:19:52 -0600 (Fri, 18 Feb 2005) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-eth.h

do not prototype capture_eth() unless capture.h has being included

------------------------------------------------------------------------
r13424 | lego | 2005-02-18 14:11:30 -0600 (Fri, 18 Feb 2005) | 2 lines
Changed paths:
   M /trunk/plugins/mate/packet-mate.c

Get rid of some useless lines from the last patch

------------------------------------------------------------------------
r13423 | lego | 2005-02-18 14:02:40 -0600 (Fri, 18 Feb 2005) | 2 lines
Changed paths:
   M /trunk/plugins/mate/mate.h
   M /trunk/plugins/mate/mate_setup.c
   M /trunk/plugins/mate/packet-mate.c

Add a pointer to the start frame of each gop in the gog's tree

------------------------------------------------------------------------
r13422 | lego | 2005-02-18 12:40:25 -0600 (Fri, 18 Feb 2005) | 5 lines
Changed paths:
   M /trunk/plugins/mate/mate_setup.c

two fixes in config loading:
  - do not accept GopDefs for non existent pdus Pdu
  - GogExtra "no For" instead of "no Name" 


------------------------------------------------------------------------
r13421 | sahlberg | 2005-02-17 14:56:47 -0600 (Thu, 17 Feb 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-scsi.c

minor prettification


------------------------------------------------------------------------
r13420 | sahlberg | 2005-02-17 06:07:45 -0600 (Thu, 17 Feb 2005) | 8 lines
Changed paths:
   M /trunk/epan/dissectors/packet-fcp.c
   M /trunk/epan/dissectors/packet-iscsi.c
   M /trunk/epan/dissectors/packet-ndmp.c
   M /trunk/epan/dissectors/packet-scsi.c
   M /trunk/epan/dissectors/packet-scsi.h

pass lun (and status) to scsi subdissector so we can filter
on scsi.lun   and prettify the summary line a bit.

ndmp still needs some work to track luns between commands
and fcp needs verification it works for volumesetaddressing.



------------------------------------------------------------------------
r13419 | guy | 2005-02-16 21:05:54 -0600 (Wed, 16 Feb 2005) | 6 lines
Changed paths:
   M /trunk/file.c
   M /trunk/file.h
   M /trunk/gtk/drag_and_drop.c
   M /trunk/gtk/file_dlg.c

Have "cf_merge_files()" take a pointer-to-pointer-to-char as the output
file name argument; if the pointed-to pointer is null, it opens a
temporary file, and sets that pointer to a mallocated copy of the
pathname of the temporary file.  It no longer needs a file descriptor as
an argument.

------------------------------------------------------------------------
r13418 | etxrab | 2005-02-16 16:44:15 -0600 (Wed, 16 Feb 2005) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_map.c
   M /trunk/epan/dissectors/packet-gsm_map.h

Add some of the anytime operations.
------------------------------------------------------------------------
r13417 | etxrab | 2005-02-16 16:42:52 -0600 (Wed, 16 Feb 2005) | 1 line
Changed paths:
   M /trunk/asn1/gsmmap/GSMMAP.asn
   M /trunk/asn1/gsmmap/gsmmap.cnf

Add some of the AnyTime... Operations.
------------------------------------------------------------------------
r13416 | etxrab | 2005-02-16 16:40:56 -0600 (Wed, 16 Feb 2005) | 3 lines
Changed paths:
   M /trunk/tools/asn2eth.py

From Tomas Kukosa:
Fix  problems with bitfields with dashed ("-") names

------------------------------------------------------------------------
r13415 | lego | 2005-02-16 08:26:27 -0600 (Wed, 16 Feb 2005) | 3 lines
Changed paths:
   A /trunk/plugins/stats_tree
   A /trunk/plugins/stats_tree/AUTHORS
   A /trunk/plugins/stats_tree/Makefile.am
   A /trunk/plugins/stats_tree/NEWS
   A /trunk/plugins/stats_tree/pinfo_stats_tree.c
   A /trunk/plugins/stats_tree/stats_tree_plugin.c

An example stats_tree plugin using pinfo as its only data source
I'm not checking changes to the Makefiles yet.

------------------------------------------------------------------------
r13414 | lego | 2005-02-16 08:16:40 -0600 (Wed, 16 Feb 2005) | 3 lines
Changed paths:
   A /trunk/epan/stats_tree.c
   A /trunk/epan/stats_tree.h
   A /trunk/epan/stats_tree_priv.h
   A /trunk/gtk/stats_tree_stat.c
   A /trunk/tap-stats_tree.c

Initial checkin of the stats-tree tap API
Makefiles have not been modified yet, there's still work to do.

------------------------------------------------------------------------
r13413 | sahlberg | 2005-02-16 05:31:56 -0600 (Wed, 16 Feb 2005) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc-nt.c
   M /trunk/epan/dissectors/packet-dcerpc-nt.h

preparations for autogenerated ms dcerpc interfaces
make it possible to prettify SIDs and control how and where their string representation should be shown in the summary line and the tree
similar to how counted_strings prettification can be controlled


------------------------------------------------------------------------
r13412 | sahlberg | 2005-02-16 04:25:00 -0600 (Wed, 16 Feb 2005) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc-nt.c

mark the frame opened/closed fields for policy handles as GENERATED fields



------------------------------------------------------------------------
r13411 | sahlberg | 2005-02-16 04:11:26 -0600 (Wed, 16 Feb 2005) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/dcerpc/idl2eth.c

add simple check that if a hf_rename field has not been referenced by the idl/cnf files then it is likely the conformance file has become stale and needs updating.   abort with an error message.



------------------------------------------------------------------------
r13410 | sahlberg | 2005-02-16 03:24:52 -0600 (Wed, 16 Feb 2005) | 3 lines
Changed paths:
   M /trunk/gtk/rtp_analysis.c
   M /trunk/gtk/rtp_analysis.h
   M /trunk/gtk/rtp_stream.c
   M /trunk/gtk/rtp_stream.h
   M /trunk/gtk/rtp_stream_dlg.c

from lars ruoff    a few extra columns for rtp analysis


------------------------------------------------------------------------
r13409 | sahlberg | 2005-02-15 18:19:52 -0600 (Tue, 15 Feb 2005) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc.c

add extra sanity check.
dont match a request with a reply that came earlier in the trace or SRT will
look funny :-)



------------------------------------------------------------------------
r13408 | sahlberg | 2005-02-15 15:01:51 -0600 (Tue, 15 Feb 2005) | 3 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-retix-bpdu.c

new protocol from Giles Scott : Retix spanning tree protocol


------------------------------------------------------------------------
r13407 | guy | 2005-02-15 14:01:24 -0600 (Tue, 15 Feb 2005) | 7 lines
Changed paths:
   M /trunk/file.c
   M /trunk/gtk/drag_and_drop.c
   M /trunk/gtk/file_dlg.c

Have "cf_merge_files()" always close "out_fd" before returning; it does
so if "wtap_dump_fdopen()" succeeds (as a side-effect of calling
"wtap_dump_close()"), even if "cf_merge_fails()" after that, so it
should do so if it fails.

That means we don't need to close it in the callers of "cf_merge_files()".

------------------------------------------------------------------------
r13406 | guy | 2005-02-14 21:49:12 -0600 (Mon, 14 Feb 2005) | 4 lines
Changed paths:
   M /trunk/capture_loop.c

WinPcap 3.0 might support PPP/WAN capturing on Windows OT, so lump it
together with the pre-3.0 releases.  Mention 3.1 beta's support, noting
that it's a beta.

------------------------------------------------------------------------
r13405 | guy | 2005-02-14 19:42:39 -0600 (Mon, 14 Feb 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/Makefile.common

Add the missing packet-dcerpc-budb.h to the list of header files, so it
goes into the source tarball.

------------------------------------------------------------------------
r13404 | guy | 2005-02-14 16:07:26 -0600 (Mon, 14 Feb 2005) | 2 lines
Changed paths:
   M /trunk/asn1/gsmmap/packet-gsm_map-template.c
   M /trunk/epan/dissectors/packet-gsm_map.c
   M /trunk/epan/dissectors/packet-gsm_map.h

Fix some compiler warnings (at least one of which is for a real problem).

------------------------------------------------------------------------
r13403 | guy | 2005-02-14 16:06:22 -0600 (Mon, 14 Feb 2005) | 2 lines
Changed paths:
   M /trunk/gtk/voip_calls.c
   M /trunk/gtk/voip_calls_dlg.c

Add #includes to define various macros and declare various functions.

------------------------------------------------------------------------
r13402 | guy | 2005-02-14 14:33:57 -0600 (Mon, 14 Feb 2005) | 22 lines
Changed paths:
   M /trunk/Makefile.am
   M /trunk/Makefile.common
   M /trunk/Makefile.nmake
   M /trunk/doc/Makefile.nmake
   M /trunk/epan/Makefile.am
   M /trunk/epan/Makefile.nmake
   M /trunk/epan/dfilter/Makefile.nmake
   M /trunk/epan/dissectors/Makefile.am
   M /trunk/epan/dissectors/Makefile.common
   M /trunk/epan/dissectors/Makefile.nmake
   M /trunk/epan/ftypes/Makefile.nmake
   M /trunk/gtk/Makefile.am
   M /trunk/gtk/Makefile.common
   M /trunk/gtk/Makefile.nmake
   M /trunk/help/Makefile.nmake
   M /trunk/image/Makefile.nmake
   M /trunk/packaging/nsis/Makefile.nmake
   M /trunk/plugins/Makefile.nmake
   M /trunk/plugins/acn/Makefile.nmake
   M /trunk/plugins/agentx/Makefile.nmake
   M /trunk/plugins/artnet/Makefile.nmake
   M /trunk/plugins/asn1/Makefile.nmake
   M /trunk/plugins/ciscosm/Makefile.nmake
   M /trunk/plugins/docsis/Makefile.nmake
   M /trunk/plugins/enttec/Makefile.nmake
   M /trunk/plugins/giop/Makefile.nmake
   M /trunk/plugins/gryphon/Makefile.nmake
   M /trunk/plugins/irda/Makefile.nmake
   M /trunk/plugins/lwres/Makefile.nmake
   M /trunk/plugins/mate/Makefile.nmake
   M /trunk/plugins/megaco/Makefile.nmake
   M /trunk/plugins/mgcp/Makefile.nmake
   M /trunk/plugins/opsi/Makefile.nmake
   M /trunk/plugins/pcli/Makefile.nmake
   M /trunk/plugins/rdm/Makefile.nmake
   M /trunk/plugins/rlm/Makefile.nmake
   M /trunk/plugins/rtnet/Makefile.nmake
   M /trunk/plugins/rudp/Makefile.nmake
   M /trunk/plugins/v5ua/Makefile.nmake
   M /trunk/tools/Makefile.nmake
   M /trunk/tools/lemon/Makefile.nmake
   M /trunk/wiretap/Makefile.nmake

Make the "maintainer-clean" rules get rid of some additional generated
files.  Do this with GENERATED_HEADER_FILES, GENERATED_C_FILES, and
GENERATED_FILES macros in Makefile.common files, along the lines of what
wiretap/Makefile.common has.

Clean up "*~" files with "make clean" rather than only "make distclean"
in some additional places.

Add "maintainer-clean" rules to the Makefile.nmake files, paralelling
the ones in the automake-generated Makefile.in files, using the
GENERATED_FILES macros from Makefile.common files.  In some cases, move
the cleanup of files from "make distclean" to "make maintainer-clean",
and in other cases, put in a comment indicating why we're not doing that
(because some files that are distributed in the source tarballs, namely
Flex output, were built with a UN*X Flex and won't compile on Windows,
so we get rid of them with "make distclean" so you can clean up stuff
that *has* to be re-generated for Windows).

Clean up some *CLEANFILES definitions - get rid of ones that no longer
apply as files were moved or that add to the definition a name that's
already there.

------------------------------------------------------------------------
r13401 | sahlberg | 2005-02-14 13:56:11 -0600 (Mon, 14 Feb 2005) | 3 lines
Changed paths:
   A /trunk/epan/dissectors/dcerpc/budb
   A /trunk/epan/dissectors/dcerpc/budb/Makefile
   A /trunk/epan/dissectors/dcerpc/budb/budb.cnf
   A /trunk/epan/dissectors/dcerpc/budb/budb.idl
   A /trunk/epan/dissectors/dcerpc/budb/template.c
   A /trunk/epan/dissectors/dcerpc/budb/template.h
   M /trunk/epan/dissectors/packet-dcerpc-budb.c
   A /trunk/epan/dissectors/packet-dcerpc-budb.h

add machinegenerated full dissector for dcedfs BUDB protocol


------------------------------------------------------------------------
r13400 | sahlberg | 2005-02-14 13:46:03 -0600 (Mon, 14 Feb 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/dcerpc/idl2eth.c

 make idl-lite compiler handle varying arrays


------------------------------------------------------------------------
r13399 | sahlberg | 2005-02-14 13:43:34 -0600 (Mon, 14 Feb 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc.c
   M /trunk/epan/dissectors/packet-dcerpc.h

add support for varying arrays


------------------------------------------------------------------------
r13398 | sahlberg | 2005-02-14 13:34:59 -0600 (Mon, 14 Feb 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-tcp.c

in sack options   only look for tcp session metadata if both tcp_analysis and tcp_relative  preferences are set.   relative depends on analysis


------------------------------------------------------------------------
r13397 | etxrab | 2005-02-14 10:21:47 -0600 (Mon, 14 Feb 2005) | 1 line
Changed paths:
   M /trunk/asn1/gsmmap/GSMMAP.asn
   M /trunk/asn1/gsmmap/gsmmap.cnf
   M /trunk/asn1/gsmmap/packet-gsm_map-template.c

Add some more V3 opcodes
------------------------------------------------------------------------
r13396 | etxrab | 2005-02-14 10:20:58 -0600 (Mon, 14 Feb 2005) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_map.c

Add some more V3 opcodes
------------------------------------------------------------------------
r13395 | etxrab | 2005-02-14 02:21:14 -0600 (Mon, 14 Feb 2005) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_map.c

From :Tim Endean correct conditions for a while loop.
------------------------------------------------------------------------
r13394 | etxrab | 2005-02-14 02:20:33 -0600 (Mon, 14 Feb 2005) | 1 line
Changed paths:
   M /trunk/asn1/gsmmap/packet-gsm_map-template.c

From :Tim Endean correct conditions for a while loop.
------------------------------------------------------------------------
r13393 | guy | 2005-02-13 20:46:54 -0600 (Sun, 13 Feb 2005) | 2 lines
Changed paths:
   M /trunk/plugins/agentx

Add the usual set of file names/patterns to ignore.

------------------------------------------------------------------------
r13392 | lroland | 2005-02-13 17:30:56 -0600 (Sun, 13 Feb 2005) | 1 line
Changed paths:
   M /trunk/gtk/graph_analysis.c
   M /trunk/gtk/voip_calls.c
   M /trunk/gtk/voip_calls_dlg.c

remove a bunch of unnecessary "includes" from VoIP tap and graph analysis sources
------------------------------------------------------------------------
r13391 | lego | 2005-02-12 21:53:48 -0600 (Sat, 12 Feb 2005) | 3 lines
Changed paths:
   M /trunk/AUTHORS

Update Venna Nagarjuna
change my own e-mail address (I'll keep the old one for two more weeks only)

------------------------------------------------------------------------
r13390 | lego | 2005-02-12 21:41:44 -0600 (Sat, 12 Feb 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rtcp.c

From Venna, Nagarjuna:
   add support for RTCP-XR as specified in RFC 3611 

------------------------------------------------------------------------
r13389 | lroland | 2005-02-12 18:10:15 -0600 (Sat, 12 Feb 2005) | 8 lines
Changed paths:
   M /trunk/Makefile.nmake
   M /trunk/alert_box.c
   M /trunk/capture.c
   M /trunk/capture_sync.c
   M /trunk/capture_ui_utils.c
   M /trunk/color_filters.c
   M /trunk/dftest.c
   M /trunk/epan/Makefile.nmake
   M /trunk/file.c
   M /trunk/gtk/capture_if_dlg.c
   M /trunk/print.c
   M /trunk/tap-ansi_astat.c
   M /trunk/tap-gsm_astat.c
   M /trunk/tap-h225counter.c
   M /trunk/tap-rpcstat.c
   M /trunk/tap-smbsids.c
   M /trunk/tap-smbstat.c
   M /trunk/tap-wspstat.c
   M /trunk/tethereal.c

change nmake makefiles in /trunk and /trunk/epan so that
object code for libethereal.dll isn't generated by the
makefile in /trunk.

Having no code in /trunk linked into libethereal.dll
anymore, the definition of the macro _NEED_VAR_IMPORT_
can be moved from various source files in /trunk to /trunk/Makefile.nmake .
So do that, too.
------------------------------------------------------------------------
r13388 | etxrab | 2005-02-12 15:36:56 -0600 (Sat, 12 Feb 2005) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_a.c

Add a part of the previous patch that didn't apply.
------------------------------------------------------------------------
r13387 | etxrab | 2005-02-12 15:35:01 -0600 (Sat, 12 Feb 2005) | 9 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_a.c

GMM/SM:
   - Dissect detach_type now correctly ( fixed by Miklos Szurdi )
   - Dissect timer correctly ( fixed by Miklos Szurdi )
   - Update SM causes for Release 6 ( Miklos Szurdi )
   - Update service_type for Release 6 ( Miklos Szurdi )
   - Rearange pco code like Guy Harris has suggested ( Guy Harris )
   - reimplement dissection of IPv4 and IPv6 addresses
   - Fix offset in pdp_addr
   - Fix offset in Traffic Flow Template (tft
------------------------------------------------------------------------
r13386 | etxrab | 2005-02-12 15:20:38 -0600 (Sat, 12 Feb 2005) | 20 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gprs-llc.c

From Rene Pilz :

BSSGP:
   - Does not dissect the LLC-PDU twice

LLC:
- Add CRC calculation to differ between ciphered and non-ciphered packets without taking care about the encryption bit.
This solves crashes when the option "ignore ciphere bit" was activated


GMM/SM:
   - Dissect detach_type now correctly ( fixed by Miklos Szurdi )
   - Dissect timer correctly ( fixed by Miklos Szurdi )
   - Update SM causes for Release 6 ( Miklos Szurdi )
   - Update service_type for Release 6 ( Miklos Szurdi )
   - Rearange pco code like Guy Harris has suggested ( Guy Harris )
   - reimplement dissection of IPv4 and IPv6 addresses
   - Fix offset in pdp_addr
   - Fix offset in Traffic Flow Template (tft)

------------------------------------------------------------------------
r13385 | etxrab | 2005-02-12 15:20:01 -0600 (Sat, 12 Feb 2005) | 20 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bssgp.c

From Rene Pilz :

BSSGP:
   - Does not dissect the LLC-PDU twice

LLC:
- Add CRC calculation to differ between ciphered and non-ciphered packets without taking care about the encryption bit.
This solves crashes when the option "ignore ciphere bit" was activated


GMM/SM:
   - Dissect detach_type now correctly ( fixed by Miklos Szurdi )
   - Dissect timer correctly ( fixed by Miklos Szurdi )
   - Update SM causes for Release 6 ( Miklos Szurdi )
   - Update service_type for Release 6 ( Miklos Szurdi )
   - Rearange pco code like Guy Harris has suggested ( Guy Harris )
   - reimplement dissection of IPv4 and IPv6 addresses
   - Fix offset in pdp_addr
   - Fix offset in Traffic Flow Template (tft)

------------------------------------------------------------------------
r13384 | etxrab | 2005-02-11 16:44:09 -0600 (Fri, 11 Feb 2005) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_map.c

Dissect Return error and some more operationcodes.
------------------------------------------------------------------------
r13383 | etxrab | 2005-02-11 16:43:24 -0600 (Fri, 11 Feb 2005) | 1 line
Changed paths:
   M /trunk/asn1/gsmmap/GSMMAP.asn
   M /trunk/asn1/gsmmap/packet-gsm_map-template.c

Dissect Return error and some more operationcodes.
------------------------------------------------------------------------
r13382 | lego | 2005-02-10 18:04:25 -0600 (Thu, 10 Feb 2005) | 1 line
Changed paths:
   M /trunk/plugins/mate/mate_runtime.c
   M /trunk/plugins/mate/packet-mate.c

avoid freeing the gop_key more than once and do not reregister the tap at every reload
------------------------------------------------------------------------
r13381 | lego | 2005-02-10 11:14:31 -0600 (Thu, 10 Feb 2005) | 1 line
Changed paths:
   M /trunk/plugins/mate/packet-mate.c

mate runtime did not get initialized when configured after loading a capture file
------------------------------------------------------------------------
r13380 | lego | 2005-02-10 10:55:08 -0600 (Thu, 10 Feb 2005) | 1 line
Changed paths:
   M /trunk/plugins/mate/mate.h
   M /trunk/plugins/mate/mate_setup.c
   M /trunk/plugins/mate/packet-mate.c

add "mate" as a protocol to its tree
------------------------------------------------------------------------
r13379 | gerald | 2005-02-10 10:24:12 -0600 (Thu, 10 Feb 2005) | 4 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/dissectors/packet-dns.c

From Nicolas Dichtel via Vincent Jardin:

Print a couple of missing fields.

------------------------------------------------------------------------
r13378 | lego | 2005-02-10 10:23:52 -0600 (Thu, 10 Feb 2005) | 1 line
Changed paths:
   A /trunk/plugins/mate/examples/call.mate
   D /trunk/plugins/mate/examples/call.thing
   D /trunk/plugins/mate/examples/cmplx_call.thing
   D /trunk/plugins/mate/examples/ftp.thing
   D /trunk/plugins/mate/examples/mgw.thing
   D /trunk/plugins/mate/examples/mgw2.thing
   D /trunk/plugins/mate/examples/mgw_mi.thing
   D /trunk/plugins/mate/examples/newcall.mate
   D /trunk/plugins/mate/examples/nrg_sms.thing
   A /trunk/plugins/mate/examples/pasv_ftp.mate
   D /trunk/plugins/mate/examples/rad.thing
   A /trunk/plugins/mate/examples/tcp.mate
   A /trunk/plugins/mate/examples/web.mate
   M /trunk/plugins/mate/matelib/sip.mate
   D /trunk/plugins/mate/presentation.txt

cleanup matelib and mate examples
------------------------------------------------------------------------
r13377 | guy | 2005-02-10 02:52:35 -0600 (Thu, 10 Feb 2005) | 2 lines
Changed paths:
   M /trunk/plugins/agentx/packet-agentx.c

Use tcp_dissect_pdus().

------------------------------------------------------------------------
r13376 | guy | 2005-02-10 02:15:35 -0600 (Thu, 10 Feb 2005) | 3 lines
Changed paths:
   M /trunk/plugins/agentx/packet-agentx.c

Use VB_ rather than V_ for the VarBind types, to avoid a collision with
V_INT in oleauto.h in Windows.

------------------------------------------------------------------------
r13375 | guy | 2005-02-10 02:10:18 -0600 (Thu, 10 Feb 2005) | 3 lines
Changed paths:
   M /trunk/epan/libethereal.def

Export the routines to add 64-bit integer values, and export
tvb_ensure_length_remaining().

------------------------------------------------------------------------
r13374 | guy | 2005-02-10 02:07:44 -0600 (Thu, 10 Feb 2005) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-iax2.c

Add a hack to set "reversed" and "circuit" in code paths where it wasn't
getting set.  The hack needs to be replaced by code that does the right
thing.

Fix indentation.

------------------------------------------------------------------------
r13373 | guy | 2005-02-10 01:23:01 -0600 (Thu, 10 Feb 2005) | 3 lines
Changed paths:
   M /trunk/gtk/capture_prefs.c

Always make the elements of the "text" array point to g_mallocated
strings, so that they can safely be g_freed.

------------------------------------------------------------------------
r13372 | guy | 2005-02-10 00:36:21 -0600 (Thu, 10 Feb 2005) | 2 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/Makefile.am
   M /trunk/configure.in
   M /trunk/packaging/nsis/Makefile.nmake
   M /trunk/packaging/nsis/ethereal.nsi
   M /trunk/plugins/Makefile.am
   M /trunk/plugins/Makefile.nmake
   A /trunk/plugins/agentx
   A /trunk/plugins/agentx/AUTHORS
   A /trunk/plugins/agentx/Makefile.am
   A /trunk/plugins/agentx/Makefile.nmake
   A /trunk/plugins/agentx/moduleinfo.h
   A /trunk/plugins/agentx/packet-agentx.c

From Oleg Terletsky: AgentX support.

------------------------------------------------------------------------
r13371 | guy | 2005-02-09 21:19:59 -0600 (Wed, 09 Feb 2005) | 3 lines
Changed paths:
   M /trunk/asn1/inap/packet-inap-template.c
   M /trunk/epan/dissectors/packet-inap.c
   M /trunk/epan/dissectors/packet-inap.h

Remove an extra /*, some unused variables, and an unneeded include (INAP
currently has no taps).

------------------------------------------------------------------------
r13370 | guy | 2005-02-09 21:10:08 -0600 (Wed, 09 Feb 2005) | 2 lines
Changed paths:
   A /trunk/asn1/inap/Makefile

Add a Makefile.

------------------------------------------------------------------------
r13369 | ulfl | 2005-02-09 19:55:36 -0600 (Wed, 09 Feb 2005) | 1 line
Changed paths:
   M /trunk/file.c

bugfix for sync_mode captures, wasn't started correctly (cf_callback_invoke(cf_cb_live_capture_started); was never called)
------------------------------------------------------------------------
r13368 | lroland | 2005-02-09 19:26:19 -0600 (Wed, 09 Feb 2005) | 4 lines
Changed paths:
   M /trunk/Makefile.nmake
   M /trunk/epan/Makefile.am
   M /trunk/epan/Makefile.common
   M /trunk/epan/Makefile.nmake
   M /trunk/epan/dissectors/Makefile.nmake

clean up makefiles.

especially /trunk/Makefile.nmake doesn't have to include
/trunk/epan/Makefile.common anymore.
------------------------------------------------------------------------
r13367 | lroland | 2005-02-09 17:55:14 -0600 (Wed, 09 Feb 2005) | 1 line
Changed paths:
   M /trunk/asn1/inap/inap.cnf

fix svn properties
------------------------------------------------------------------------
r13366 | lroland | 2005-02-09 17:38:00 -0600 (Wed, 09 Feb 2005) | 8 lines
Changed paths:
   M /trunk/Makefile.common
   D /trunk/asn1.c
   D /trunk/asn1.h
   M /trunk/epan/Makefile.common
   A /trunk/epan/asn1.c (from /trunk/asn1.c:13362)
   A /trunk/epan/asn1.h (from /trunk/asn1.h:13362)
   M /trunk/epan/dissectors/ncp2222.py
   M /trunk/epan/dissectors/packet-acse.c
   M /trunk/epan/dissectors/packet-ansi_map.c
   M /trunk/epan/dissectors/packet-atalk.c
   M /trunk/epan/dissectors/packet-clnp.c
   M /trunk/epan/dissectors/packet-cops.c
   M /trunk/epan/dissectors/packet-dcerpc.c
   M /trunk/epan/dissectors/packet-diameter.c
   M /trunk/epan/dissectors/packet-dnp.c
   M /trunk/epan/dissectors/packet-eap.c
   M /trunk/epan/dissectors/packet-fc.c
   M /trunk/epan/dissectors/packet-ftam.c
   M /trunk/epan/dissectors/packet-gsm_a.c
   M /trunk/epan/dissectors/packet-gsm_sms_ud.c
   M /trunk/epan/dissectors/packet-gsm_ss.c
   M /trunk/epan/dissectors/packet-gssapi.c
   M /trunk/epan/dissectors/packet-ieee80211.c
   M /trunk/epan/dissectors/packet-inap.c
   M /trunk/epan/dissectors/packet-ip.c
   M /trunk/epan/dissectors/packet-ipv6.c
   M /trunk/epan/dissectors/packet-kerberos.c
   M /trunk/epan/dissectors/packet-ldap.c
   M /trunk/epan/dissectors/packet-lwapp.c
   M /trunk/epan/dissectors/packet-mq.c
   M /trunk/epan/dissectors/packet-mysql.c
   M /trunk/epan/dissectors/packet-ncp.c
   M /trunk/epan/dissectors/packet-ndmp.c
   M /trunk/epan/dissectors/packet-ndps.c
   M /trunk/epan/dissectors/packet-netbios.c
   M /trunk/epan/dissectors/packet-ntlmssp.c
   M /trunk/epan/dissectors/packet-pgsql.c
   M /trunk/epan/dissectors/packet-pres.c
   M /trunk/epan/dissectors/packet-q931.c
   M /trunk/epan/dissectors/packet-rpc.c
   M /trunk/epan/dissectors/packet-smb-pipe.c
   M /trunk/epan/dissectors/packet-smb.c
   M /trunk/epan/dissectors/packet-sna.c
   M /trunk/epan/dissectors/packet-sndcp.c
   M /trunk/epan/dissectors/packet-snmp.c
   M /trunk/epan/dissectors/packet-spnego.c
   M /trunk/epan/dissectors/packet-srvloc.c
   M /trunk/epan/dissectors/packet-ssh.c
   M /trunk/epan/dissectors/packet-tcap.c
   M /trunk/epan/dissectors/packet-tcp.c
   M /trunk/epan/dissectors/packet-tds.c
   M /trunk/epan/dissectors/packet-wtp.c
   M /trunk/epan/dissectors/packet-x25.c
   A /trunk/epan/follow.c (from /trunk/follow.c:13362)
   A /trunk/epan/follow.h (from /trunk/follow.h:13362)
   M /trunk/epan/packet.c
   M /trunk/epan/plugins.c
   A /trunk/epan/ptvcursor.c (from /trunk/ptvcursor.c:13362)
   A /trunk/epan/ptvcursor.h (from /trunk/ptvcursor.h:13362)
   A /trunk/epan/reassemble.c (from /trunk/reassemble.c:13362)
   A /trunk/epan/reassemble.h (from /trunk/reassemble.h:13362)
   A /trunk/epan/xmlstub.c (from /trunk/xmlstub.c:13359)
   A /trunk/epan/xmlstub.h (from /trunk/xmlstub.h:13359)
   D /trunk/follow.c
   D /trunk/follow.h
   M /trunk/gtk/follow_dlg.c
   M /trunk/plugins/asn1/packet-asn1.c
   M /trunk/plugins/plugin_api.h
   M /trunk/plugins/plugin_api_list.c
   D /trunk/ptvcursor.c
   D /trunk/ptvcursor.h
   D /trunk/reassemble.c
   D /trunk/reassemble.h
   D /trunk/xmlstub.c
   D /trunk/xmlstub.h

Move the following files from /trunk to /trunk/epan:
asn1.[ch]
follow.[ch]
ptvcursor.[ch]
reassemble.[ch]
xmlstub.[ch]

fix #include statements accordingly.
------------------------------------------------------------------------
r13365 | etxrab | 2005-02-09 16:43:57 -0600 (Wed, 09 Feb 2005) | 1 line
Changed paths:
   M /trunk/AUTHORS

Add Tim Endean
------------------------------------------------------------------------
r13364 | etxrab | 2005-02-09 16:35:49 -0600 (Wed, 09 Feb 2005) | 1 line
Changed paths:
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-inap.c
   A /trunk/epan/dissectors/packet-inap.h

From Tim Endean: INAP dissector.
------------------------------------------------------------------------
r13363 | etxrab | 2005-02-09 16:31:40 -0600 (Wed, 09 Feb 2005) | 1 line
Changed paths:
   A /trunk/asn1/inap/inap.asn
   A /trunk/asn1/inap/inap.cnf
   A /trunk/asn1/inap/packet-inap-template.c
   A /trunk/asn1/inap/packet-inap-template.h

From Tim Endean: INAP dissector.
------------------------------------------------------------------------
r13362 | etxrab | 2005-02-09 16:01:53 -0600 (Wed, 09 Feb 2005) | 1 line
Changed paths:
   A /trunk/asn1/inap

From Tim Endean: INAP dissector
------------------------------------------------------------------------
r13361 | etxrab | 2005-02-09 15:55:55 -0600 (Wed, 09 Feb 2005) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_map.c

Fix dissection of some opcodes etc.
------------------------------------------------------------------------
r13360 | etxrab | 2005-02-09 15:54:57 -0600 (Wed, 09 Feb 2005) | 1 line
Changed paths:
   M /trunk/asn1/gsmmap/GSMMAP.asn
   M /trunk/asn1/gsmmap/gsmmap.cnf
   M /trunk/asn1/gsmmap/packet-gsm_map-template.c

Fix decoding of some opcodes etc.
------------------------------------------------------------------------
r13359 | guy | 2005-02-09 03:25:54 -0600 (Wed, 09 Feb 2005) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-l2tp.c

From Deepak Jain: add support for some Cisco L2TPv3 AVPs, always show
the numerical value of the pseudowire type, and show the Remote End ID
AVP as text rather than binary data.

------------------------------------------------------------------------
r13358 | lroland | 2005-02-08 16:10:04 -0600 (Tue, 08 Feb 2005) | 1 line
Changed paths:
   M /trunk/packaging/nsis/ethereal.nsi

Set Registry key for starting NPF service to "Auto Start" and not "System Start".
------------------------------------------------------------------------
r13357 | lroland | 2005-02-08 15:12:54 -0600 (Tue, 08 Feb 2005) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rtp.c

use "guint" instead of "uint". 
"uint" is not available on Windows
------------------------------------------------------------------------
r13356 | guy | 2005-02-08 14:54:08 -0600 (Tue, 08 Feb 2005) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rtp.c

From Jon Ringle: add a preference to allow packets with an RTP version
of 0 to be dissected as STUN packets, to support dissecting of
application that follow the ICE methodology described in
draft-ietf-mmusic-ice-03.

Remove some extra spaces at the end of tags for preferences.

------------------------------------------------------------------------
r13355 | ulfl | 2005-02-08 13:57:16 -0600 (Tue, 08 Feb 2005) | 3 lines
Changed paths:
   M /trunk/capture.c
   M /trunk/file.h
   M /trunk/gtk/main.c

fix a capture bug if the capture filter wasn't valid to get back to "empty" state.

instead of already invoking cf_cb_live_capture_started in capture.c, I've introduced the new event cf_cb_live_capture_prepare which only has to set the main windows title and nothing more.
------------------------------------------------------------------------
r13354 | lroland | 2005-02-08 13:36:20 -0600 (Tue, 08 Feb 2005) | 2 lines
Changed paths:
   M /trunk/Makefile.common
   M /trunk/asn1/h225/packet-h225-template.c
   M /trunk/epan/Makefile.common
   M /trunk/epan/dissectors/packet-h225.c
   A /trunk/epan/h225-persistentdata.c (from /trunk/h225-persistentdata.c:13345)
   A /trunk/epan/h225-persistentdata.h (from /trunk/h225-persistentdata.h:13345)
   D /trunk/h225-persistentdata.c
   D /trunk/h225-persistentdata.h

Move h225-persistentdata.[ch] to epan,
as its code is linked into libethereal.dll.
------------------------------------------------------------------------
r13353 | lroland | 2005-02-08 13:15:56 -0600 (Tue, 08 Feb 2005) | 2 lines
Changed paths:
   M /trunk/gtk/Makefile.am
   M /trunk/gtk/Makefile.common
   D /trunk/gtk/h323_analysis.c
   D /trunk/gtk/h323_analysis.h
   D /trunk/gtk/h323_conversations.c
   D /trunk/gtk/h323_conversations.h
   D /trunk/gtk/h323_conversations_dlg.c
   D /trunk/gtk/h323_conversations_dlg.h

Remove the buggy h323 conversations tap.
It is superseded by the superior Voip Call analysis.
------------------------------------------------------------------------
r13352 | ulfl | 2005-02-08 13:12:17 -0600 (Tue, 08 Feb 2005) | 1 line
Changed paths:
   M /trunk/gtk/menu.c

bringing the packet details context menu item "Expand Tree" back as "Expand Subtrees". Renaming this, as this makes it much more obvious that potentially more than subtree (recursively) will be expanded
------------------------------------------------------------------------
r13351 | etxrab | 2005-02-08 12:51:27 -0600 (Tue, 08 Feb 2005) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-radius.c

From LEGO
patch adding few more fields to RADIUS (I and O Packets and Octets)
------------------------------------------------------------------------
r13350 | etxrab | 2005-02-08 12:50:05 -0600 (Tue, 08 Feb 2005) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-nsip.c

From : Susanne Edlund
patch for NSIP to fix a bug in packet SNS_DELETE.
------------------------------------------------------------------------
r13349 | lroland | 2005-02-07 20:34:15 -0600 (Mon, 07 Feb 2005) | 8 lines
Changed paths:
   M /trunk/packaging/nsis/ethereal.nsi

Add a section to the installer, which sets following key to "1" on WIN NT, if the key is available.

HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\NPF\Start

With this key set to 1, the NPF service is started automatically at startup and then even users with restricted privilegies should be able to access Network Devices for capturing. 
See also:
http://winpcap.polito.it/misc/faq.htm#Q-18

------------------------------------------------------------------------
r13348 | guy | 2005-02-07 15:40:53 -0600 (Mon, 07 Feb 2005) | 9 lines
Changed paths:
   M /trunk/tethereal.c

Fix up the suppression of packet printing and packet count printing so
that:

	packets are printed iff we're not saving packets to a file and
	"-q" wasn't specified;

	packet counts are printed iff we're capturing (i.e., not reading
	from a file) and "-q" wasn't specified.

------------------------------------------------------------------------
r13347 | lroland | 2005-02-07 15:09:23 -0600 (Mon, 07 Feb 2005) | 4 lines
Changed paths:
   M /trunk/asn1/h225/h225.cnf
   M /trunk/asn1/h225/packet-h225-template.c
   M /trunk/asn1/h225/packet-h225-template.h
   M /trunk/gtk/voip_calls.c

And finally (I hope) the last part from the patch
from Alejandro Vaquero:
 
  patch for "Voip analysis" to get the LRQ/LCF/LRJ messages included in the H323 calls for Gatekeeper to Gatekeeper configurations
------------------------------------------------------------------------
r13346 | guy | 2005-02-07 14:52:59 -0600 (Mon, 07 Feb 2005) | 2 lines
Changed paths:
   M /trunk/file.h
   M /trunk/gtk/font_utils.c
   M /trunk/gtk/main.c
   M /trunk/gtk/ui_util.c
   M /trunk/tethereal.c

Make Ethereal and Tethereal compile if we're building without libpcap.

------------------------------------------------------------------------
r13345 | ulfl | 2005-02-07 14:38:10 -0600 (Mon, 07 Feb 2005) | 1 line
Changed paths:
   M /trunk/capture.c

fix a bug if capturing into named files is used
------------------------------------------------------------------------
r13344 | etxrab | 2005-02-07 14:30:27 -0600 (Mon, 07 Feb 2005) | 4 lines
Changed paths:
   M /trunk/plugins/Xplugin_table.h
   M /trunk/plugins/plugin_api_list.c

From Alejandro Vaquero :

 Find attached a patch for "Voip analysis" to get the LRQ/LCF/LRJ messages included in the H323 calls for Gatekeeper to Gatekeeper configurations

------------------------------------------------------------------------
r13343 | ulfl | 2005-02-07 14:14:22 -0600 (Mon, 07 Feb 2005) | 1 line
Changed paths:
   M /trunk/capture_sync.c

when building the argv string, use save_file_fd_str instead of save_file_fd to avoid confusion with the capture_opts field 
------------------------------------------------------------------------
r13342 | guy | 2005-02-07 13:42:32 -0600 (Mon, 07 Feb 2005) | 2 lines
Changed paths:
   M /trunk/tethereal.c

Suppress the packet counts when we're reading from a file.

------------------------------------------------------------------------
r13341 | guy | 2005-02-07 13:33:49 -0600 (Mon, 07 Feb 2005) | 2 lines
Changed paths:
   M /trunk/tethereal.c

Tethereal can write to a file in binary even if not built with libpcap.

------------------------------------------------------------------------
r13340 | guy | 2005-02-07 13:11:45 -0600 (Mon, 07 Feb 2005) | 6 lines
Changed paths:
   M /trunk/tethereal.c

Clean up indentation.

The default for "capture_options.save_file" is a null pointer, meaning
we're not writing to a save file, we're writing out the dissection as
text.

------------------------------------------------------------------------
r13339 | jmayer | 2005-02-07 09:55:13 -0600 (Mon, 07 Feb 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

In case we have an unknown vendor tag, just decode the vendor from
manuf.

------------------------------------------------------------------------
r13338 | etxrab | 2005-02-07 02:58:40 -0600 (Mon, 07 Feb 2005) | 2 lines
Changed paths:
   M /trunk/tools/asn2eth.py

From Alejandro Vaquero :
 Find attached a patch for "Voip analysis" to get the LRQ/LCF/LRJ messages included in the H323 calls for Gatekeeper to Gatekeeper configurations
------------------------------------------------------------------------
r13337 | etxrab | 2005-02-07 02:57:47 -0600 (Mon, 07 Feb 2005) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-h225.c
   M /trunk/epan/dissectors/packet-h225.h
   M /trunk/epan/dissectors/packet-per.c
   M /trunk/epan/dissectors/packet-per.h

From Alejandro Vaquero :
 Find attached a patch for "Voip analysis" to get the LRQ/LCF/LRJ messages included in the H323 calls for Gatekeeper to Gatekeeper configurations
------------------------------------------------------------------------
r13336 | etxrab | 2005-02-07 02:56:39 -0600 (Mon, 07 Feb 2005) | 2 lines
Changed paths:
   M /trunk/gtk/voip_calls.h
   M /trunk/gtk/voip_calls_dlg.c

From Alejandro Vaquero :
 Find attached a patch for "Voip analysis" to get the LRQ/LCF/LRJ messages included in the H323 calls for Gatekeeper to Gatekeeper configurations
------------------------------------------------------------------------
r13335 | etxrab | 2005-02-07 02:54:24 -0600 (Mon, 07 Feb 2005) | 6 lines
Changed paths:
   M /trunk/plugins/mate/mate_runtime.c
   M /trunk/plugins/mate/mate_util.c

From LEGO:
 - fixes a leak in analize_pdu()
 - fixes a typo in analize_pdu()
 - fixes a crash in scs_unsubscribe() 
 - save a malloc and a free in get_pdu_fields()

------------------------------------------------------------------------
r13334 | guy | 2005-02-06 21:35:51 -0600 (Sun, 06 Feb 2005) | 3 lines
Changed paths:
   M /trunk/gtk/main.c

The welcome pane isn't scrollable, so add it to the scrolling window
with a viewport.

------------------------------------------------------------------------
r13333 | guy | 2005-02-06 21:13:51 -0600 (Sun, 06 Feb 2005) | 5 lines
Changed paths:
   M /trunk/capture_sync.c

In the child process, capture_opts->fork_child is 0, not -1, so, in that
case, don't attempt to send a signal to the child.

Expand a comment.

------------------------------------------------------------------------
r13332 | guy | 2005-02-06 20:09:30 -0600 (Sun, 06 Feb 2005) | 7 lines
Changed paths:
   M /trunk/capture.c
   M /trunk/file.c
   M /trunk/file.h
   M /trunk/gtk/main.c

Move the code to set the title on a window when a capture is in progress
to the "start live capture" callback, and call that from "do_capture()".

When opening a capture file, don't pop up the "What do you want to do?"
pane when closing any existing file you have open, as we're just going
to put the regular view up right after that.

------------------------------------------------------------------------
r13331 | guy | 2005-02-06 19:32:53 -0600 (Sun, 06 Feb 2005) | 7 lines
Changed paths:
   M /trunk/capture_sync.c
   M /trunk/file.c
   M /trunk/file.h

Declare "cf_callback_t" before using it in a further declaration.

Mark the "func" argument to "cf_callback_remove()" as unused.

Get rid of the "iface" argument to "cf_start_tail()", as it's no longer
used.

------------------------------------------------------------------------
r13330 | ulfl | 2005-02-06 18:54:46 -0600 (Sun, 06 Feb 2005) | 8 lines
Changed paths:
   M /trunk/file.c
   M /trunk/file.h
   M /trunk/gtk/main.c

Instead of calling each single thing when doing/finish a file operation, file.c shouldn't call all the GUI related functions itself, instead throwing some kind of Events to it's caller(s). 

I've implemented a very simple callback mechanism which provides exactly this. I've tried GHook from GLib before, but this doesn't seem to be the right thing, as it's too inflexible for the purpose here.

So I've implemented a callback function in main.c which receives all "events" and spreads them to menu, statusbar and itself.

I would see this implementation as a prototype which may need  improvements. Please comment the changes.

------------------------------------------------------------------------
r13329 | guy | 2005-02-06 18:31:45 -0600 (Sun, 06 Feb 2005) | 2 lines
Changed paths:
   M /trunk/gtk/main.c

Clean up indentation.

------------------------------------------------------------------------
r13328 | guy | 2005-02-06 17:16:05 -0600 (Sun, 06 Feb 2005) | 8 lines
Changed paths:
   M /trunk/Makefile.common
   M /trunk/file.c
   M /trunk/gtk/main.c
   M /trunk/gtk/main.h
   M /trunk/gtk/menu.c
   A /trunk/main_window.h

Don't have "set_menus_for_captured_packets()" call
"main_set_for_capture_file()"; it should only deal with menus, not
anything else - and it gets called while the menus are being set up,
which is before the main window has been completely created, so
"main_widgets_show_or_hide()", which is called by
"main_set_for_capture_file()", gets errors trying to show or hide
widgets the pointers to which are null.

------------------------------------------------------------------------
r13327 | guy | 2005-02-06 17:06:23 -0600 (Sun, 06 Feb 2005) | 2 lines
Changed paths:
   M /trunk/menu.h

Get rid of extra blank line at the end.

------------------------------------------------------------------------
r13326 | guy | 2005-02-06 16:21:51 -0600 (Sun, 06 Feb 2005) | 2 lines
Changed paths:
   M /trunk/tethereal.c

"iface" is now a member of "capture_opts", not "cfile".

------------------------------------------------------------------------
r13325 | guy | 2005-02-06 16:19:53 -0600 (Sun, 06 Feb 2005) | 2 lines
Changed paths:
   M /trunk/capture_loop.c
   M /trunk/capture_sync.c

Get rid of a few cf_get_ references missed by the previous checkin.

------------------------------------------------------------------------
r13324 | guy | 2005-02-06 16:18:15 -0600 (Sun, 06 Feb 2005) | 4 lines
Changed paths:
   M /trunk/capture.c

Include <ctype.h> for "isspace()".

#ifdef a variable used only if _WIN32 is defined.

------------------------------------------------------------------------
r13323 | guy | 2005-02-06 16:06:31 -0600 (Sun, 06 Feb 2005) | 2 lines
Changed paths:
   M /trunk/capture.h

Clean up indentation.

------------------------------------------------------------------------
r13322 | guy | 2005-02-06 15:36:11 -0600 (Sun, 06 Feb 2005) | 5 lines
Changed paths:
   M /trunk/configure.in
   M /trunk/epan/Makefile.am

Back out the previous change - we were setting "datafiledir", not
"datafile", and code in epan/filesystem.c expectes DATAFILE_DIR to be
set to the "ethereal" subdirectory of the data directory, not to the
data directory itself.

------------------------------------------------------------------------
r13321 | ulfl | 2005-02-06 15:34:59 -0600 (Sun, 06 Feb 2005) | 1 line
Changed paths:
   M /trunk/summary.h

minor code cleanup
------------------------------------------------------------------------
r13320 | ulfl | 2005-02-06 15:20:35 -0600 (Sun, 06 Feb 2005) | 7 lines
Changed paths:
   M /trunk/capture.c
   M /trunk/capture.h
   M /trunk/capture_loop.c
   M /trunk/capture_sync.c
   M /trunk/cfile.c
   M /trunk/cfile.h
   M /trunk/file.c
   M /trunk/file.h
   M /trunk/gtk/capture_dlg.c
   M /trunk/gtk/capture_if_dlg.c
   M /trunk/gtk/main.c
   M /trunk/gtk/summary_dlg.c
   M /trunk/summary.c
   M /trunk/summary.h
   M /trunk/tethereal.c

another two steps towards privilege seperation:

move another two capture related fields (iface and cfilter) from cfile to capture_opts

also move the handling of capture related command line options from main.c to capture.c, that way a future privilege seperated capture program can use the same code to parse it's command line than Ethereal. 
It might be even possible to share this parser code even with Tethereal, didn't took a closer look at this.

------------------------------------------------------------------------
r13319 | guy | 2005-02-06 14:53:54 -0600 (Sun, 06 Feb 2005) | 10 lines
Changed paths:
   M /trunk/gtk/sctp_error_dlg.c
   M /trunk/gtk/sctp_stat.c
   M /trunk/gtk/sctp_stat.h

Clean up indentation.

Make "reset()" static (it's not used outside "sctp_stat.c"), and fix its
prototype to match what's expected for a reset routine passed to
"register_tap_listener()".  Similarly, fix the prototypes of other
routines passed to "register_tap_listener()", and get rid of the casts
of pointers to those functions to "void *".

Fix some declarations in "sctp_stat.h" to have function prototypes.

------------------------------------------------------------------------
r13318 | etxrab | 2005-02-06 14:37:02 -0600 (Sun, 06 Feb 2005) | 6 lines
Changed paths:
   M /trunk/plugins/mate/mate.h
   M /trunk/plugins/mate/mate_runtime.c
   M /trunk/plugins/mate/mate_setup.c
   M /trunk/plugins/mate/mate_util.c

From: LEGO
- fix a bug at gog reinit that disabled gogs after reload of a file.
- fix some crashes when Debug_GoG>0
- cleanup the debug output (no CR at the end is needed)
- Gops start when no GopStart is given and match an existing GogKey

------------------------------------------------------------------------
r13317 | ulfl | 2005-02-06 08:43:27 -0600 (Sun, 06 Feb 2005) | 1 line
Changed paths:
   M /trunk/capture.c
   M /trunk/gtk/main.c

some cleanup of the initial start sequence of Ethereal, filling in capture_opts and alike
------------------------------------------------------------------------
r13316 | ulfl | 2005-02-06 06:21:27 -0600 (Sun, 06 Feb 2005) | 1 line
Changed paths:
   M /trunk/capture.c
   M /trunk/gtk/main.c

fix bugs regarding the capture child
------------------------------------------------------------------------
r13315 | ulfl | 2005-02-05 18:13:00 -0600 (Sat, 05 Feb 2005) | 1 line
Changed paths:
   M /trunk/capture.c
   M /trunk/capture.h
   M /trunk/gtk/main.c

instead of initializing the capture_options in main.c, use the new function capture_opts_init
------------------------------------------------------------------------
r13314 | lroland | 2005-02-05 17:34:56 -0600 (Sat, 05 Feb 2005) | 1 line
Changed paths:
   M /trunk/gtk/voip_calls.c
   M /trunk/gtk/voip_calls.h

remove obsolete function add_rtp_streams_graph() from voip_calls.[ch] and fix a register_tap_listener() call.
------------------------------------------------------------------------
r13313 | ulfl | 2005-02-05 17:12:44 -0600 (Sat, 05 Feb 2005) | 3 lines
Changed paths:
   M /trunk/gtk/compat_macros.h
   M /trunk/gtk/main.c

begin a welcome page which is shown, if you don't have any capture data loaded.

This might be improved to have additional content and/or better layout of the elements.
------------------------------------------------------------------------
r13312 | ulfl | 2005-02-05 11:53:39 -0600 (Sat, 05 Feb 2005) | 1 line
Changed paths:
   M /trunk/gtk/main.c
   M /trunk/gtk/main.h
   M /trunk/gtk/menu.c

completely hide the main window panes, if we currently don't have a capture file.
------------------------------------------------------------------------
r13311 | gerald | 2005-02-05 11:39:12 -0600 (Sat, 05 Feb 2005) | 6 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/wiretap/ascend-grammar.y
   M /trunk/wiretap/ascend-int.h
   M /trunk/wiretap/ascend-scanner.l
   M /trunk/wiretap/ascend.c
   M /trunk/wiretap/wtap.h

From Josh Bailey:

Attached is an update to Lucent/Ascend trace parsing: fix a few bugs,
add support for ISDN and Ethernet captures - diffs to 0.10.9.


------------------------------------------------------------------------
r13310 | etxrab | 2005-02-05 09:51:45 -0600 (Sat, 05 Feb 2005) | 1 line
Changed paths:
   M /trunk/asn1/gsmmap/gsmmap.cnf

Remove g_free.
------------------------------------------------------------------------
r13309 | ulfl | 2005-02-05 09:40:44 -0600 (Sat, 05 Feb 2005) | 3 lines
Changed paths:
   M /trunk/gtk/main.h

fixed the dnd_init declaration

(we have to do something about the non existing win32 compile dependencies, this is just a pain)
------------------------------------------------------------------------
r13308 | ulfl | 2005-02-05 09:35:25 -0600 (Sat, 05 Feb 2005) | 5 lines
Changed paths:
   M /trunk/capture.c
   M /trunk/capture.h
   M /trunk/capture_sync.c
   M /trunk/gtk/Makefile.common
   A /trunk/gtk/drag_and_drop.c
   M /trunk/gtk/main.c
   M /trunk/gtk/main.h

rename kill_capture_child to capture_kill_child to have a common prefix

split drag and drop support out of main.c into new file drag_and_drop.c, to reduce the size of main.c a bit.

Hopefully this won't break unix builds because of missing #include's, I will keep an eye on the buildbot
------------------------------------------------------------------------
r13307 | ulfl | 2005-02-05 08:37:56 -0600 (Sat, 05 Feb 2005) | 1 line
Changed paths:
   M /trunk/file.c

use the interfaces descriptive name to be shown in the statusbar as it's, well, more descriptive
------------------------------------------------------------------------
r13306 | ulfl | 2005-02-05 08:33:03 -0600 (Sat, 05 Feb 2005) | 1 line
Changed paths:
   M /trunk/file.h

fix a comment
------------------------------------------------------------------------
r13305 | etxrab | 2005-02-05 08:24:26 -0600 (Sat, 05 Feb 2005) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_map.c
   M /trunk/epan/dissectors/packet-gsm_map.h

Re-commit the asn2eth based gsm-map dissector, hopfully it'll work better now.
------------------------------------------------------------------------
r13304 | ulfl | 2005-02-05 07:44:27 -0600 (Sat, 05 Feb 2005) | 1 line
Changed paths:
   M /trunk/capture_sync.c
   M /trunk/file.c
   M /trunk/file.h
   M /trunk/gtk/file_dlg.c

minor enhancements to Guy's last update
------------------------------------------------------------------------
r13303 | guy | 2005-02-05 06:50:47 -0600 (Sat, 05 Feb 2005) | 2 lines
Changed paths:
   M /trunk/capture.c
   M /trunk/capture_sync.c
   M /trunk/file.c
   M /trunk/file.h
   M /trunk/gtk/file_dlg.c
   M /trunk/gtk/main.c
   M /trunk/tethereal.c

Put "cf_status_t" back.

------------------------------------------------------------------------
r13302 | guy | 2005-02-05 06:08:01 -0600 (Sat, 05 Feb 2005) | 2 lines
Changed paths:
   M /trunk/tethereal.c

Make "cf_open()" match the prototype in "file.h".

------------------------------------------------------------------------
r13301 | ulfl | 2005-02-05 05:37:56 -0600 (Sat, 05 Feb 2005) | 1 line
Changed paths:
   M /trunk/capture.h

updated some comments
------------------------------------------------------------------------
r13300 | etxrab | 2005-02-05 05:08:24 -0600 (Sat, 05 Feb 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rtp.c
   M /trunk/epan/dissectors/packet-rtp.h

From Alejandro Vaquero:
a patch that to shows the RTP streams in the Graph. Now 
using an RTP tap (not using the rtp_stream).
------------------------------------------------------------------------
r13299 | etxrab | 2005-02-05 05:07:21 -0600 (Sat, 05 Feb 2005) | 4 lines
Changed paths:
   M /trunk/gtk/voip_calls.c
   M /trunk/gtk/voip_calls.h
   M /trunk/gtk/voip_calls_dlg.c

From Alejandro Vaquero:
a patch that to shows the RTP streams in the Graph. Now 
using an RTP tap (not using the rtp_stream).

------------------------------------------------------------------------
r13298 | ulfl | 2005-02-05 05:00:04 -0600 (Sat, 05 Feb 2005) | 1 line
Changed paths:
   M /trunk/file.c
   M /trunk/file.h

make some string parameters const, as they are not changed inside
------------------------------------------------------------------------
r13297 | guy | 2005-02-04 22:37:36 -0600 (Fri, 04 Feb 2005) | 2 lines
Changed paths:
   M /trunk/gtk/sctp_assoc_analyse.c

retap_packets() was renamed cf_retap_packets().

------------------------------------------------------------------------
r13296 | tuexen | 2005-02-04 16:48:17 -0600 (Fri, 04 Feb 2005) | 2 lines
Changed paths:
   M /trunk/gtk/Makefile.common

Activate SCTP association analysis

------------------------------------------------------------------------
r13295 | tuexen | 2005-02-04 16:45:15 -0600 (Fri, 04 Feb 2005) | 2 lines
Changed paths:
   M /trunk/gtk/sctp_assoc_analyse.c
   M /trunk/gtk/sctp_byte_graph_dlg.c
   M /trunk/gtk/sctp_error_dlg.c
   M /trunk/gtk/sctp_graph_dlg.c
   M /trunk/gtk/sctp_stat.c
   M /trunk/gtk/sctp_stat.h

Update to versions compiling on and working on Windows and Unix.

------------------------------------------------------------------------
r13294 | tuexen | 2005-02-04 16:39:48 -0600 (Fri, 04 Feb 2005) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-sctp.c
   M /trunk/epan/dissectors/packet-sctp.h

Add detection of zero checksum.

------------------------------------------------------------------------
r13293 | guy | 2005-02-04 14:54:12 -0600 (Fri, 04 Feb 2005) | 6 lines
Changed paths:
   M /trunk/file.c
   M /trunk/file.h
   M /trunk/gtk/main.c
   M /trunk/gtk/print_dlg.c
   M /trunk/tethereal.c

Instead of having a single enumerated type for status return values from
cf_ functions, have separate ones for different classes of routines, and
use gboolean when the return value is just "success" or "failure" - that
way you don't get compiler warnings if a case statement isn't handling a
particular status value if the routine in question won't return it.

------------------------------------------------------------------------
r13292 | guy | 2005-02-04 14:32:32 -0600 (Fri, 04 Feb 2005) | 2 lines
Changed paths:
   M /trunk/file.c

Properly define "cf_start_tail()".

------------------------------------------------------------------------
r13291 | ulfl | 2005-02-04 13:29:27 -0600 (Fri, 04 Feb 2005) | 2 lines
Changed paths:
   M /trunk/gtk/gsm_map_summary.c
   M /trunk/gtk/mtp3_summary.c
   M /trunk/gtk/summary_dlg.c
   M /trunk/summary.c
   M /trunk/summary.h

remove #include "globals.h" from summary.c, as it's a bad idea for multiple capture files. 
If a summary user would like to get a summary, it should know the file of *which* it needs the summary.
------------------------------------------------------------------------
r13290 | ulfl | 2005-02-04 13:24:40 -0600 (Fri, 04 Feb 2005) | 5 lines
Changed paths:
   M /trunk/pcap-util-unix.c

this file doesn't use any item of the globals.h so remove #include. 
However, if it needs one of:
#include "file.h"
#include <epan/timestamp.h>
it should include it directly, please let me know if it's required, as I can't test it :-(
------------------------------------------------------------------------
r13289 | ulfl | 2005-02-04 12:44:44 -0600 (Fri, 04 Feb 2005) | 5 lines
Changed paths:
   M /trunk/capture.c
   M /trunk/capture_sync.c
   M /trunk/file.c
   M /trunk/file.h
   M /trunk/gtk/bootp_stat.c
   M /trunk/gtk/color_dlg.c
   M /trunk/gtk/conversations_table.c
   M /trunk/gtk/dcerpc_stat.c
   M /trunk/gtk/decode_as_dlg.c
   M /trunk/gtk/fc_stat.c
   M /trunk/gtk/file_dlg.c
   M /trunk/gtk/find_dlg.c
   M /trunk/gtk/goto_dlg.c
   M /trunk/gtk/graph_analysis.c
   M /trunk/gtk/h225_counter.c
   M /trunk/gtk/h225_ras_srt.c
   M /trunk/gtk/h323_analysis.c
   M /trunk/gtk/h323_conversations_dlg.c
   M /trunk/gtk/hostlist_table.c
   M /trunk/gtk/http_stat.c
   M /trunk/gtk/io_stat.c
   M /trunk/gtk/ldap_stat.c
   M /trunk/gtk/main.c
   M /trunk/gtk/main.h
   M /trunk/gtk/menu.c
   M /trunk/gtk/mgcp_stat.c
   M /trunk/gtk/packet_history.c
   M /trunk/gtk/packet_list.c
   M /trunk/gtk/prefs_dlg.c
   M /trunk/gtk/print_dlg.c
   M /trunk/gtk/proto_dlg.c
   M /trunk/gtk/proto_draw.c
   M /trunk/gtk/rpc_progs.c
   M /trunk/gtk/rpc_stat.c
   M /trunk/gtk/rtp_analysis.c
   M /trunk/gtk/rtp_stream.c
   M /trunk/gtk/rtp_stream_dlg.c
   M /trunk/gtk/sctp_error_dlg.c
   M /trunk/gtk/sctp_stat_dlg.c
   M /trunk/gtk/sip_stat.c
   M /trunk/gtk/smb_stat.c
   M /trunk/gtk/tcp_graph.c
   M /trunk/gtk/voip_calls_dlg.c
   M /trunk/gtk/wsp_stat.c
   M /trunk/tethereal.c

huge cleanup of capture file API (functions in file.c/file.h).

This includes: all functions in file.h now have a cf_ prefix, will have doxygen tags, will have the capture_file *cf as the first parameter and I tried to generalize the return values for non trivial functions.

Hopefully, I didn't introduced any new bugs, as I had to change a lot of files...
------------------------------------------------------------------------
r13288 | gerald | 2005-02-04 09:22:25 -0600 (Fri, 04 Feb 2005) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/Makefile.common
   M /trunk/plugins/Xass-list
   M /trunk/plugins/Xplugin_api.c
   M /trunk/plugins/Xplugin_api.h
   M /trunk/plugins/Xplugin_api_decls.h
   M /trunk/plugins/Xplugin_table.h
   M /trunk/plugins/plugin_api_list.c

Fix a couple of distcheck problems:

Update conversation_new and find_conversation in plugin_api_list.c and
associated files.

Add packet-dcerpc-butc.h to the distribution.

------------------------------------------------------------------------
r13287 | guy | 2005-02-04 04:48:03 -0600 (Fri, 04 Feb 2005) | 4 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/dissectors/packet-slowprotocols.c

From Dominique Bastien: marker and OAM slow protocol support.

Fix his e-mail address.

------------------------------------------------------------------------
r13286 | guy | 2005-02-04 04:32:28 -0600 (Fri, 04 Feb 2005) | 2 lines
Changed paths:
   M /trunk/plugins/mate/mate_setup.c

HFILL can't be used to initialize at run time.

------------------------------------------------------------------------
r13285 | ulfl | 2005-02-04 02:52:38 -0600 (Fri, 04 Feb 2005) | 1 line
Changed paths:
   M /trunk/capture_sync.c

remove access to global cfile, use access functions and capture_opts instead
------------------------------------------------------------------------
r13284 | ulfl | 2005-02-04 02:42:39 -0600 (Fri, 04 Feb 2005) | 1 line
Changed paths:
   M /trunk/capture_loop.c
   M /trunk/file.c
   M /trunk/file.h

remove #include "globals.h" and access to global cfile, use access functions and capture_opts instead
------------------------------------------------------------------------
r13283 | ulfl | 2005-02-04 02:27:41 -0600 (Fri, 04 Feb 2005) | 1 line
Changed paths:
   M /trunk/capture.c
   M /trunk/file.c
   M /trunk/file.h

remove #include "globals.h" and access to global cfile, use access functions and capture_opts instead
------------------------------------------------------------------------
r13282 | sahlberg | 2005-02-03 23:26:51 -0600 (Thu, 03 Feb 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/dcerpc/butc/butc.idl
   M /trunk/epan/dissectors/packet-dcerpc-butc.c
   M /trunk/epan/dissectors/packet-dcerpc-butc.h

use a bitmap for the restore flags so the dissection is prettier


------------------------------------------------------------------------
r13281 | sahlberg | 2005-02-03 22:58:03 -0600 (Thu, 03 Feb 2005) | 3 lines
Changed paths:
   A /trunk/epan/dissectors/dcerpc/butc
   A /trunk/epan/dissectors/dcerpc/butc/Makefile
   A /trunk/epan/dissectors/dcerpc/butc/butc.cnf
   A /trunk/epan/dissectors/dcerpc/butc/butc.idl
   A /trunk/epan/dissectors/dcerpc/butc/template.c
   A /trunk/epan/dissectors/dcerpc/butc/template.h

initial checkin of modified idl file for autogenerating the BUTC interface


------------------------------------------------------------------------
r13280 | sahlberg | 2005-02-03 22:37:47 -0600 (Thu, 03 Feb 2005) | 7 lines
Changed paths:
   A /trunk/epan/dissectors/dcerpc
   A /trunk/epan/dissectors/dcerpc/idl2eth.c

check in new directory for the files for autogenerating dcerpc interfaces
and the prototype idl compiler.

this is not ready for wide use yet but is useful with a svn area where we can sync our changes to the compiler.



------------------------------------------------------------------------
r13279 | sahlberg | 2005-02-03 22:31:59 -0600 (Thu, 03 Feb 2005) | 2 lines
Changed paths:
   M /trunk/capture_sync.c

add missing conversion to new use of save_file and fork_child

------------------------------------------------------------------------
r13278 | sahlberg | 2005-02-03 22:02:36 -0600 (Thu, 03 Feb 2005) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc.c
   M /trunk/epan/dissectors/packet-dcerpc.h

add support for varying strings in addition to conformant and varying strings that we already support



------------------------------------------------------------------------
r13277 | sahlberg | 2005-02-03 20:17:29 -0600 (Thu, 03 Feb 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc-butc.c
   A /trunk/epan/dissectors/packet-dcerpc-butc.h

update BUTC and fill in all (bar one) dissectors


------------------------------------------------------------------------
r13276 | ulfl | 2005-02-03 19:29:29 -0600 (Thu, 03 Feb 2005) | 4 lines
Changed paths:
   M /trunk/capture.c
   M /trunk/capture.h
   M /trunk/capture_loop.c
   M /trunk/capture_sync.c
   M /trunk/capture_sync.h
   M /trunk/cfile.c
   M /trunk/cfile.h
   M /trunk/file.c
   M /trunk/file.h
   M /trunk/gtk/capture_dlg.c
   M /trunk/gtk/capture_info_dlg.c
   M /trunk/gtk/main.c
   M /trunk/tethereal.c

(some) redesign of capture data structures.

don't use global cfile at all but only an untpyed handle to call the cf_... functions in file.c
move the save_file member from capture_file to capture_opts, as it's only used while capturing and while preparing it
------------------------------------------------------------------------
r13275 | jmayer | 2005-02-03 18:29:37 -0600 (Thu, 03 Feb 2005) | 13 lines
Changed paths:
   M /trunk/configure.in
   M /trunk/epan/Makefile.am

Albert Chin:
>From autoconf.info:
     In order to support these features, it is essential that `datadir'
  remains being defined as `${prefix}/share' to depend upon the current
  value of `prefix'.

     A corollary is that you should not use these variables except in
  Makefiles.  For instance, instead of trying to evaluate `datadir' in
  `configure' and hard-coding it in Makefiles using e.g.,
  `AC_DEFINE_UNQUOTED(DATADIR, "$datadir")', you should add
  `-DDATADIR="$(datadir)"' to your `CPPFLAGS'.


------------------------------------------------------------------------
r13274 | jmayer | 2005-02-03 18:22:00 -0600 (Thu, 03 Feb 2005) | 6 lines
Changed paths:
   M /trunk/plugins/mate/mate_setup.c

albert chin:
        The HP-UX compilers don't like non-constant initializers (C99'ism).
        Patch attached for plugins/mate/mate_setup.c.

Fix a few warnings (change some () to (void))

------------------------------------------------------------------------
r13273 | jmayer | 2005-02-03 17:42:06 -0600 (Thu, 03 Feb 2005) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-fw1.c

Yaniv Kaul
        Attached patch simplifies a very complex 'if' statement in packet-fw1.c
        and generally streamlines the code.


------------------------------------------------------------------------
r13272 | jmayer | 2005-02-03 17:35:57 -0600 (Thu, 03 Feb 2005) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ip.c

Yaniv Kaul:
        Attached please find a small performance optimization to packet-ip.c,
        which removes multiple redundant calls to tvb_get_ptr().

Changed srt_addr and dst_addr from char to guchar

------------------------------------------------------------------------
r13271 | jmayer | 2005-02-03 17:24:08 -0600 (Thu, 03 Feb 2005) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-cosine.c

Motonori Shindo:
Please find attached a small patch for CoSine L2 debug dissector. The
code used to incorrectly select the first 4 octets in the tvbuff. This
patch fixes this problem.

------------------------------------------------------------------------
r13270 | jmayer | 2005-02-03 17:18:23 -0600 (Thu, 03 Feb 2005) | 4 lines
Changed paths:
   M /trunk/epan/to_str.c

Yniv Kaul: Small performance optimization
  It change a while()->do, to do->while() and removes a variable (and an
  assignment to it).

------------------------------------------------------------------------
r13269 | jmayer | 2005-02-03 16:52:20 -0600 (Thu, 03 Feb 2005) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-arp.c

ncisco Alcoba: 
        Do not add target address if the packet is a Request. According to the RFC,
        target addresses in requests have no meaning


------------------------------------------------------------------------
r13268 | ulfl | 2005-02-03 16:48:20 -0600 (Thu, 03 Feb 2005) | 1 line
Changed paths:
   M /trunk/capture.c
   M /trunk/capture.h
   M /trunk/capture_loop.c
   M /trunk/capture_sync.c
   M /trunk/cfile.c
   M /trunk/cfile.h
   M /trunk/gtk/main.c
   M /trunk/tethereal.c

move capture_file_fd field from capture_file to capture_opts type, as this is the place where it should be
------------------------------------------------------------------------
r13267 | jmayer | 2005-02-03 16:44:13 -0600 (Thu, 03 Feb 2005) | 1 line
Changed paths:
   M /trunk/wiretap/nettl.c
   M /trunk/wiretap/nettl.h

Mark C. Brown: Added support for new ixgbe card
------------------------------------------------------------------------
r13266 | ulfl | 2005-02-03 15:58:33 -0600 (Thu, 03 Feb 2005) | 1 line
Changed paths:
   M /trunk/capture_loop.c
   M /trunk/ringbuffer.c
   M /trunk/ringbuffer.h
   M /trunk/tethereal.c

prevent ringbuffer from having to know about capture_file type at all (decoupling dependencies)
------------------------------------------------------------------------
r13265 | etxrab | 2005-02-03 15:57:42 -0600 (Thu, 03 Feb 2005) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-h248.c
   M /trunk/epan/dissectors/packet-h248.h

Add dissection of some more packages.
------------------------------------------------------------------------
r13264 | etxrab | 2005-02-03 15:56:59 -0600 (Thu, 03 Feb 2005) | 1 line
Changed paths:
   M /trunk/asn1/h248/h248.cnf
   M /trunk/asn1/h248/packet-h248-template.c

Add dissection of some more packages.
------------------------------------------------------------------------
r13263 | etxrab | 2005-02-03 15:51:35 -0600 (Thu, 03 Feb 2005) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-isup.c
   M /trunk/epan/dissectors/packet-isup.h
   M /trunk/epan/dissectors/packet-q931.c
   M /trunk/epan/dissectors/packet-q931.h

From Francisco Alcoba:
Patch for graphing ISUP calls. It shows the type of message, 
in the first one the calling and called numbers, and in the second the SPs 
and CIC; in releases it shows the cause value.
------------------------------------------------------------------------
r13262 | etxrab | 2005-02-03 15:50:19 -0600 (Thu, 03 Feb 2005) | 4 lines
Changed paths:
   M /trunk/gtk/voip_calls.c

From Francisco Alcoba:
Patch for graphing ISUP calls. It shows the type of message, 
in the first one the calling and called numbers, and in the second the SPs 
and CIC; in releases it shows the cause value.
------------------------------------------------------------------------
r13261 | etxrab | 2005-02-03 15:22:09 -0600 (Thu, 03 Feb 2005) | 1 line
Changed paths:
   M /trunk/asn1/gsmmap/GSMMAP.asn
   M /trunk/asn1/gsmmap/gsmmap.cnf
   M /trunk/asn1/gsmmap/packet-gsm_map-template.c

Various updates to GSM MAP
------------------------------------------------------------------------
r13260 | jmayer | 2005-02-03 15:11:46 -0600 (Thu, 03 Feb 2005) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-stun.c

Jon Ringle: bug fix to the stun ERROR-CODE dissecting

------------------------------------------------------------------------
r13259 | ulfl | 2005-02-03 14:44:19 -0600 (Thu, 03 Feb 2005) | 1 line
Changed paths:
   M /trunk/gtk/follow_dlg.c

add tooltips to the dialogs radio buttons
------------------------------------------------------------------------
r13258 | guy | 2005-02-03 14:14:11 -0600 (Thu, 03 Feb 2005) | 3 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/wka.tmpl

From Dominique Bastien: add the slow protocol MAC address to the list of
well-known MAC addresses.

------------------------------------------------------------------------
r13257 | lroland | 2005-02-03 10:22:08 -0600 (Thu, 03 Feb 2005) | 1 line
Changed paths:
   M /trunk/asn1/h225/h225.cnf
   M /trunk/epan/dissectors/packet-h225.c

Small fix for h225 dissector as suggested by Tomas Kukosa
------------------------------------------------------------------------
r13256 | gram | 2005-02-03 09:03:29 -0600 (Thu, 03 Feb 2005) | 3 lines
Changed paths:
   M /trunk/epan/ftypes/ftype-string.c

From Pekka Pietikainen <pp@ee.oulu.fi>, add a byte to the hex[]
array so that there is room for the terminating NUL from sprintf().

------------------------------------------------------------------------
r13255 | etxrab | 2005-02-03 00:54:55 -0600 (Thu, 03 Feb 2005) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_map.c

Add an OID
------------------------------------------------------------------------
r13254 | ulfl | 2005-02-02 20:35:20 -0600 (Wed, 02 Feb 2005) | 2 lines
Changed paths:
   M /trunk/packaging/nsis/ethereal.nsi

Enable GTK-Wimp only for Windows 2000/XP/2003
...as Win9x/ME/NT known to have problems with it!
------------------------------------------------------------------------
r13253 | ulfl | 2005-02-02 20:32:48 -0600 (Wed, 02 Feb 2005) | 6 lines
Changed paths:
   A /trunk/packaging/nsis/GetWindowsVersion.nsh

Copied this file from:
http://nsis.sourceforge.net/archive/nsisweb.php?page=15&instances=0,11

Licensing question, as the NSIS homepage states:
http://nsis.sourceforge.net/features/license/
so it should be ok to rerelease this file under the GPL
------------------------------------------------------------------------
r13252 | guy | 2005-02-02 20:26:20 -0600 (Wed, 02 Feb 2005) | 2 lines
Changed paths:
   M /trunk/wiretap/erf.c

Give a URL for the ERF specification.

------------------------------------------------------------------------
r13251 | guy | 2005-02-02 19:24:07 -0600 (Wed, 02 Feb 2005) | 2 lines
Changed paths:
   M /trunk/epan/circuit.c

Fix a comment.

------------------------------------------------------------------------
r13250 | guy | 2005-02-02 19:08:39 -0600 (Wed, 02 Feb 2005) | 3 lines
Changed paths:
   M /trunk/epan/conversation.c
   M /trunk/epan/conversation.h

Check in the missing part of Jon Ringle's patch (the part that actually
changed the conversation code).

------------------------------------------------------------------------
r13249 | guy | 2005-02-02 19:07:21 -0600 (Wed, 02 Feb 2005) | 2 lines
Changed paths:
   M /trunk/AUTHORS

Undo de-UTF-8ification and other damage.

------------------------------------------------------------------------
r13248 | ulfl | 2005-02-02 16:18:37 -0600 (Wed, 02 Feb 2005) | 1 line
Changed paths:
   M /trunk/docbook/eug_src/EUG_app_files.xml

added %ETHEREAL%\disabled_protos
------------------------------------------------------------------------
r13247 | ulfl | 2005-02-02 15:13:52 -0600 (Wed, 02 Feb 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-clnp.c

bugfix: the EOT flag detection in a COTP data TPDU was using little endian, although it's big endian in the packet.

some other minor output enhancements
------------------------------------------------------------------------
r13246 | etxrab | 2005-02-02 14:15:29 -0600 (Wed, 02 Feb 2005) | 1 line
Changed paths:
   M /trunk/AUTHORS

Add Jon Ringle, at the moment I don't have the e-mail address.
------------------------------------------------------------------------
r13245 | etxrab | 2005-02-02 14:09:00 -0600 (Wed, 02 Feb 2005) | 11 lines
Changed paths:
   M /trunk/plugins/irda/packet-irda.c

From Jon Ringle:
 1) Added a setup_frame parameter to conversation_t
2) Used the conversation_t next to maintain a list of conversations with the 
same src/dest tuple but different setup_frame number.
3) Changed the signature of find_conversation() and conversation_new() to pass 
in the frame number.
4) Adjusted packet-sdp to select RTP conversation if both m=audio and m=image 
are present, and T.38 conversation if only m=image is present. I expect that 
RTP/T.38 dissecting to be better, but I don't have a way to generate T.38 
packets.

------------------------------------------------------------------------
r13244 | etxrab | 2005-02-02 14:08:36 -0600 (Wed, 02 Feb 2005) | 11 lines
Changed paths:
   M /trunk/plugins/mgcp/packet-mgcp.c

From Jon Ringle:
 1) Added a setup_frame parameter to conversation_t
2) Used the conversation_t next to maintain a list of conversations with the 
same src/dest tuple but different setup_frame number.
3) Changed the signature of find_conversation() and conversation_new() to pass 
in the frame number.
4) Adjusted packet-sdp to select RTP conversation if both m=audio and m=image 
are present, and T.38 conversation if only m=image is present. I expect that 
RTP/T.38 dissecting to be better, but I don't have a way to generate T.38 
packets.

------------------------------------------------------------------------
r13243 | etxrab | 2005-02-02 14:07:03 -0600 (Wed, 02 Feb 2005) | 11 lines
Changed paths:
   M /trunk/epan/dissectors/packet-afp.c
   M /trunk/epan/dissectors/packet-afs.c
   M /trunk/epan/dissectors/packet-ajp13.c
   M /trunk/epan/dissectors/packet-aoe.c
   M /trunk/epan/dissectors/packet-atalk.c
   M /trunk/epan/dissectors/packet-beep.c
   M /trunk/epan/dissectors/packet-bittorrent.c
   M /trunk/epan/dissectors/packet-dcerpc.c
   M /trunk/epan/dissectors/packet-dcm.c
   M /trunk/epan/dissectors/packet-eap.c
   M /trunk/epan/dissectors/packet-fc.c
   M /trunk/epan/dissectors/packet-fcdns.c
   M /trunk/epan/dissectors/packet-fcels.c
   M /trunk/epan/dissectors/packet-fcfcs.c
   M /trunk/epan/dissectors/packet-fcfzs.c
   M /trunk/epan/dissectors/packet-fcp.c
   M /trunk/epan/dissectors/packet-fcsb3.c
   M /trunk/epan/dissectors/packet-fcswils.c
   M /trunk/epan/dissectors/packet-ftp.c
   M /trunk/epan/dissectors/packet-gssapi.c
   M /trunk/epan/dissectors/packet-h225.c
   M /trunk/epan/dissectors/packet-h225.h
   M /trunk/epan/dissectors/packet-ipx.c
   M /trunk/epan/dissectors/packet-iscsi.c
   M /trunk/epan/dissectors/packet-isns.c
   M /trunk/epan/dissectors/packet-kerberos.c
   M /trunk/epan/dissectors/packet-ldap.c
   M /trunk/epan/dissectors/packet-mq.c
   M /trunk/epan/dissectors/packet-msproxy.c
   M /trunk/epan/dissectors/packet-mysql.c
   M /trunk/epan/dissectors/packet-ncp.c
   M /trunk/epan/dissectors/packet-ncp2222.inc
   M /trunk/epan/dissectors/packet-ndmp.c
   M /trunk/epan/dissectors/packet-ndps.c
   M /trunk/epan/dissectors/packet-ntlmssp.c
   M /trunk/epan/dissectors/packet-pgsql.c
   M /trunk/epan/dissectors/packet-portmap.c
   M /trunk/epan/dissectors/packet-quake.c
   M /trunk/epan/dissectors/packet-rlogin.c
   M /trunk/epan/dissectors/packet-rpc.c
   M /trunk/epan/dissectors/packet-rsync.c
   M /trunk/epan/dissectors/packet-rtcp.c
   M /trunk/epan/dissectors/packet-rtp.c
   M /trunk/epan/dissectors/packet-rtsp.c
   M /trunk/epan/dissectors/packet-sdp.c
   M /trunk/epan/dissectors/packet-smb.c
   M /trunk/epan/dissectors/packet-smtp.c
   M /trunk/epan/dissectors/packet-snmp.c
   M /trunk/epan/dissectors/packet-socks.c
   M /trunk/epan/dissectors/packet-spnego.c
   M /trunk/epan/dissectors/packet-ssh.c
   M /trunk/epan/dissectors/packet-ssl.c
   M /trunk/epan/dissectors/packet-t38.c
   M /trunk/epan/dissectors/packet-tcp.c
   M /trunk/epan/dissectors/packet-tds.c
   M /trunk/epan/dissectors/packet-tftp.c
   M /trunk/epan/dissectors/packet-tuxedo.c
   M /trunk/epan/dissectors/packet-wsp.c
   M /trunk/epan/dissectors/packet-x11.c
   M /trunk/epan/dissectors/packet-xyplex.c

From Jon Ringle:
 1) Added a setup_frame parameter to conversation_t
2) Used the conversation_t next to maintain a list of conversations with the 
same src/dest tuple but different setup_frame number.
3) Changed the signature of find_conversation() and conversation_new() to pass 
in the frame number.
4) Adjusted packet-sdp to select RTP conversation if both m=audio and m=image 
are present, and T.38 conversation if only m=image is present. I expect that 
RTP/T.38 dissecting to be better, but I don't have a way to generate T.38 
packets.

------------------------------------------------------------------------
r13242 | etxrab | 2005-02-02 14:02:46 -0600 (Wed, 02 Feb 2005) | 11 lines
Changed paths:
   M /trunk/asn1/h225/h225.cnf
   M /trunk/asn1/h225/packet-h225-template.c

From Jon Ringle:
 1) Added a setup_frame parameter to conversation_t
2) Used the conversation_t next to maintain a list of conversations with the 
same src/dest tuple but different setup_frame number.
3) Changed the signature of find_conversation() and conversation_new() to pass 
in the frame number.
4) Adjusted packet-sdp to select RTP conversation if both m=audio and m=image 
are present, and T.38 conversation if only m=image is present. I expect that 
RTP/T.38 dissecting to be better, but I don't have a way to generate T.38 
packets.

------------------------------------------------------------------------
r13241 | tuexen | 2005-02-02 07:37:04 -0600 (Wed, 02 Feb 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mtp3.c

Add mtp3.pc as suggested by Luis Ontanon.
Cleanups

------------------------------------------------------------------------
r13240 | guy | 2005-02-02 04:28:51 -0600 (Wed, 02 Feb 2005) | 16 lines
Changed paths:
   M /trunk/gtk/follow_dlg.c
   M /trunk/print.c
   M /trunk/print.h

Writing the raw data of a TCP stream to a file isn't printing it, so
don't use the print mechanism for that - do the writing directly in the
"follow stream" code.

Use "size_t" for character counts.

Make the "hexchars" array static and const, as it's not written to, and
there's probably no point in copying it to the stack (unless that
improves cache locality).

There's no need to explain why we're subtracting the number of bytes
actually read, rather than the number of bytes asked for, from the data
length.

Note an issue with printing lines.

------------------------------------------------------------------------
r13239 | guy | 2005-02-02 04:19:35 -0600 (Wed, 02 Feb 2005) | 2 lines
Changed paths:
   M /trunk/gtk/graph_analysis.c
   M /trunk/gtk/rtp_analysis.c
   M /trunk/gtk/rtp_stream_dlg.c
   M /trunk/gtk/voip_calls_dlg.c

Get rid of an unused typedef.

------------------------------------------------------------------------
r13238 | guy | 2005-02-02 03:08:42 -0600 (Wed, 02 Feb 2005) | 2 lines
Changed paths:
   M /trunk/gtk/graph_analysis.c
   M /trunk/gtk/graph_analysis.h
   M /trunk/gtk/voip_calls.c
   M /trunk/gtk/voip_calls.h

Use C89 syntax, not C++ syntax, for functions that take no arguments.

------------------------------------------------------------------------
r13237 | guy | 2005-02-02 02:53:08 -0600 (Wed, 02 Feb 2005) | 12 lines
Changed paths:
   M /trunk/gtk/voip_calls_dlg.c

Don't assume that the only blank filter expression is empty - check for
an all-space-character string.

Don't use "filter_string" both for the (unfreeable, unmodifiable) value
fetched from the text entry and the new filter expression; use it only
for the former, and make it a "const" pointer to avoid compiler
warnings.

Use a GString to construct the stuff to be added to the new filter
expression - the old code, when appending stuff to the filter expression
in a loop, would leak the pre-append value.

------------------------------------------------------------------------
r13236 | sahlberg | 2005-02-02 02:50:40 -0600 (Wed, 02 Feb 2005) | 10 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/gtk/follow_dlg.c
   M /trunk/print.c
   M /trunk/print.h

from chris eagle

add radiobutton to allow saving raw tcpstreams


these radiobuttons should, by someone that uses, this feature be changed into
a menu instead.



------------------------------------------------------------------------
r13235 | guy | 2005-02-02 02:08:53 -0600 (Wed, 02 Feb 2005) | 4 lines
Changed paths:
   M /trunk/gtk/voip_calls.c

Make sure "comment" is set.

Get rid of an unused variable.

------------------------------------------------------------------------
r13234 | guy | 2005-02-02 02:02:46 -0600 (Wed, 02 Feb 2005) | 4 lines
Changed paths:
   M /trunk/gtk/graph_analysis.c

Clean up white space.

Get rid of an unused variable and two #includes that aren't needed.

------------------------------------------------------------------------
r13233 | guy | 2005-02-02 02:01:27 -0600 (Wed, 02 Feb 2005) | 3 lines
Changed paths:
   M /trunk/gtk/voip_calls_dlg.c

"filter_string_fwd" is assigned a "const" pointer, so make it a "const"
pointer.

------------------------------------------------------------------------
r13232 | lroland | 2005-02-01 19:02:09 -0600 (Tue, 01 Feb 2005) | 13 lines
Changed paths:
   M /trunk/gtk/Makefile.am
   M /trunk/gtk/Makefile.common
   M /trunk/gtk/voip_calls.c
   M /trunk/gtk/voip_calls.h
   M /trunk/gtk/voip_calls_dlg.c
   M /trunk/gtk/voip_calls_dlg.h

for VoIP Call Analysis:
- make VoIP Call Analysis work if, called from command line
- should also work now while capturing with packet list
  updated in "real time" (to be tested)
- give each tap listener a unique identifier, so ethereal
  won't mix them up
- various cleanups
- compile by default

Todo:
- add support for "tap display filter"
- reimplement function to add rtp streams to the call flow.
 
------------------------------------------------------------------------
r13231 | ulfl | 2005-02-01 17:49:02 -0600 (Tue, 01 Feb 2005) | 1 line
Changed paths:
   M /trunk/docbook/eug_src/EUG_app_files.xml

by more specific about unix configuration files
------------------------------------------------------------------------
r13230 | sahlberg | 2005-02-01 17:33:04 -0600 (Tue, 01 Feb 2005) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb-mailslot.c

the old netlogon protocol is now called smb_netlogon



------------------------------------------------------------------------
r13229 | sahlberg | 2005-02-01 17:30:18 -0600 (Tue, 01 Feb 2005) | 4 lines
Changed paths:
   M /trunk/asn1/h245/packet-h245-template.c
   M /trunk/epan/dissectors/packet-h245.c

g_strlcpy does not exist in gtk 1.2
use strncpy instead


------------------------------------------------------------------------
r13228 | etxrab | 2005-02-01 16:57:22 -0600 (Tue, 01 Feb 2005) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-tcap.c

Improve handling of pinfo->private_data
------------------------------------------------------------------------
r13227 | jmayer | 2005-02-01 09:45:03 -0600 (Tue, 01 Feb 2005) | 1 line
Changed paths:
   M /trunk/doc/README.developer

Add boolean to the list of non-portable types
------------------------------------------------------------------------
r13226 | lroland | 2005-02-01 08:00:25 -0600 (Tue, 01 Feb 2005) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-sdp.h
   M /trunk/gtk/graph_analysis.c

add packet-sdp.h
and from Julien Leproust:
fix graph_analysis.c

------------------------------------------------------------------------
r13225 | lroland | 2005-02-01 06:12:35 -0600 (Tue, 01 Feb 2005) | 7 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/asn1/h225/h225.cnf
   M /trunk/asn1/h225/packet-h225-template.c
   M /trunk/asn1/h225/packet-h225-template.h
   M /trunk/asn1/h245/h245.cnf
   M /trunk/asn1/h245/packet-h245-template.c
   M /trunk/asn1/h245/packet-h245-template.h
   M /trunk/epan/dissectors/packet-h225.c
   M /trunk/epan/dissectors/packet-h225.h
   M /trunk/epan/dissectors/packet-h245.c
   M /trunk/epan/dissectors/packet-h245.h
   M /trunk/epan/dissectors/packet-isup.c
   M /trunk/epan/dissectors/packet-isup.h
   M /trunk/epan/dissectors/packet-q931.c
   M /trunk/epan/dissectors/packet-q931.h
   M /trunk/epan/dissectors/packet-rtp.c
   M /trunk/epan/dissectors/packet-sdp.c
   M /trunk/epan/dissectors/packet-sip.c
   M /trunk/epan/dissectors/packet-sip.h
   M /trunk/epan/libethereal.def
   A /trunk/gtk/graph_analysis.c
   A /trunk/gtk/graph_analysis.h
   M /trunk/gtk/rtp_stream.c
   M /trunk/gtk/rtp_stream.h
   A /trunk/gtk/voip_calls.c
   A /trunk/gtk/voip_calls.h
   A /trunk/gtk/voip_calls_dlg.c
   A /trunk/gtk/voip_calls_dlg.h
   M /trunk/rtp_pt.h

From Alejandro Vaquero:
h323 taps support up to 5 messages per packet now.

VoIP call analysis:
      - Collect ISUP, SIP and H323 calls from a capture and show them in window with the following info:
      - Start and Stop time of the call
      - Init
------------------------------------------------------------------------
r13224 | guy | 2005-02-01 05:11:15 -0600 (Tue, 01 Feb 2005) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-diameter-defs.h

Add some comments noting issues with some of the items in here.

------------------------------------------------------------------------
r13223 | guy | 2005-01-31 23:21:08 -0600 (Mon, 31 Jan 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc-netlogon.c
   M /trunk/epan/dissectors/packet-dcerpc-nt.c
   M /trunk/epan/dissectors/packet-dcerpc-nt.h

Move "dissect_nt_GUID()" into "packet-dcerpc-nt.c", as it's used by the
LSA dissector as well, and declare it in "packet-dcerpc-nt.h".

------------------------------------------------------------------------
r13222 | guy | 2005-01-31 23:19:53 -0600 (Mon, 31 Jan 2005) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-atm.c

If the VCI and payload type indicate that a cell is an OAM cell, dissect
it as such.

Clear the Info column when dissecting cells for an AAL we handle before
dissecting the cell, and set the Info column for OAM cells.

------------------------------------------------------------------------
r13221 | ulfl | 2005-01-31 18:52:38 -0600 (Mon, 31 Jan 2005) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-redback.c
   M /trunk/epan/dissectors/packet-rmt-fec.c

removed MSVC warnings:
packet-redback.c(63) : warning C4244: '=' : conversion from 'unsigned short ' to 'unsigned char ', possible loss of data
packet-redback.c(64) : warning C4244: '=' : conversion from 'unsigned short ' to 'unsigned char ', possible loss of data
packet-redback.c(65) : warning C4244: '=' : conversion from 'unsigned short ' to 'unsigned char ', possible loss of data
packet-rmt-fec.c(108) : warning C4244: '=' : conversion from 'unsigned short ' to 'unsigned char ', possible loss of data

------------------------------------------------------------------------
r13220 | ulfl | 2005-01-31 18:51:42 -0600 (Mon, 31 Jan 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-juniper.c

removed MSVC warnings:
packet-juniper.c(262) : warning C4761: integral size mismatch in argument; conversion supplied
packet-juniper.c(289) : warning C4761: integral size mismatch in argument; conversion supplied
------------------------------------------------------------------------
r13219 | etxrab | 2005-01-31 15:40:51 -0600 (Mon, 31 Jan 2005) | 1 line
Changed paths:
   M /trunk/asn1/gsmmap/GSMMAP.asn
   M /trunk/asn1/gsmmap/gsmmap.cnf
   M /trunk/asn1/gsmmap/packet-gsm_map-template.c

Prepare for handling of different versions of the protocol.
------------------------------------------------------------------------
r13218 | etxrab | 2005-01-31 15:38:56 -0600 (Mon, 31 Jan 2005) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-tcap.c

Put application context OID in pinfo->private data to be used by sub-dissector(s).
------------------------------------------------------------------------
r13217 | etxrab | 2005-01-31 15:37:11 -0600 (Mon, 31 Jan 2005) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-diameter-defs.h

Update som valuse strings
------------------------------------------------------------------------
r13216 | etxrab | 2005-01-31 15:36:31 -0600 (Mon, 31 Jan 2005) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-radius.c

From LEGO:
 - remove duplicate fields from VSAs (every defined field in VSAs was set twice)
 - dissect radius packet with avplen == 0 (did not decode authenticator when no AVPs were present)

------------------------------------------------------------------------
r13215 | sahlberg | 2005-01-31 03:56:42 -0600 (Mon, 31 Jan 2005) | 17 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb-logon.c

there are two NETLOGON protocols

the really really old one which is never used
and there is the DCE/RPC one that is used by all windows/cifs implementations.

We used to reserve the protocol name NETLOGON for the old obsolete protocol
and since we can not have two protocols with the same name, called
the current protocol RPC_NETLOGON instead.

that does not exactly make sense.


This renames the old obsolete protocol to SMB_NETLOGON  to make way and allow
the real netlogon protocol take the name NETLOGON



------------------------------------------------------------------------
r13214 | sahlberg | 2005-01-31 03:43:07 -0600 (Mon, 31 Jan 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc-lsa-ds.c
   M /trunk/epan/dissectors/packet-dcerpc-nt.h

call dissect_ndr_uuit_t directly and avoid a dependency on packet-dcerpc-netlogon


------------------------------------------------------------------------
r13213 | sahlberg | 2005-01-30 21:31:13 -0600 (Sun, 30 Jan 2005) | 3 lines
Changed paths:
   M /trunk/asn1/h248/packet-h248-template.c
   M /trunk/epan/dissectors/packet-h248.c

support H.248 BER over SCTP PPID 7


------------------------------------------------------------------------
r13212 | guy | 2005-01-30 21:03:02 -0600 (Sun, 30 Jan 2005) | 2 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-redback.c
   M /trunk/wiretap/libpcap.c
   M /trunk/wiretap/wtap.c
   M /trunk/wiretap/wtap.h

From Florian Lohoff: Redback SmartEdge SE400/800 tcpdump disassembly.

------------------------------------------------------------------------
r13211 | guy | 2005-01-30 18:28:02 -0600 (Sun, 30 Jan 2005) | 23 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gnutella.c
   M /trunk/epan/dissectors/packet-gnutella.h

Add a URL for Gnutella specs.

Don't check, in the dissectors for particular Gnutella packets, whether
the packet goes past the end of the tvbuff - let that throw an exception
so unreassembled packets are shown as such.

Clean up indentation.

Boost GNUTELLA_MAX_SNAP_SIZE to 4096 (one Gnutella spec suggests that
packets should be < 4K), and use it to

	1) clamp the length of packets (so we don't do huge reassembly
	   or have problems when the total packet length, including the
	   header, overflows 32 bits)

and

	2) check the length of packets before using tcp_dissect_pdus(),
	   to distinguish between packets to be reassembled and a
	   transfer stream.

Pass the correct value to tcp_dissect_pdus() as the header length.

------------------------------------------------------------------------
r13210 | sahlberg | 2005-01-30 17:15:10 -0600 (Sun, 30 Jan 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-windows-common.c

add dissection of three new flags in the security descriptor


------------------------------------------------------------------------
r13209 | etxrab | 2005-01-30 12:00:48 -0600 (Sun, 30 Jan 2005) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_map.c

Add OID:s to old dissector, for comparison reasons.
------------------------------------------------------------------------
r13208 | etxrab | 2005-01-30 11:48:18 -0600 (Sun, 30 Jan 2005) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-ber.c

In case of "faulty" BER tag:s return tvb = NULL
------------------------------------------------------------------------
r13207 | sahlberg | 2005-01-30 07:00:35 -0600 (Sun, 30 Jan 2005) | 9 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc-lsa.c
   M /trunk/epan/dissectors/packet-dcerpc-lsa.h
   M /trunk/epan/dissectors/packet-dcerpc-netlogon.c

rename lsa_dissect_LSA_SECURITY_DESCRIPTOR to lsa_dissect_sec_desc_buf
change its signature to match the autogenerated signatures.

add a small wrapper function so tha tthe handwritten lsa can still call the
function through dissect_ndr_pointer()

no changes in functionality,  essentially just a rename of a function and signature change


------------------------------------------------------------------------
r13206 | sahlberg | 2005-01-30 06:38:38 -0600 (Sun, 30 Jan 2005) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc-lsa.c
   M /trunk/epan/dissectors/packet-dcerpc-lsa.h
   M /trunk/epan/dissectors/packet-dcerpc-srvsvc.c

rename lsa_dissect_LSA_SECURITY_DESCRIPTOR_data to lsa_dissect_sec_desc_buf_data
to make the symbol compatible with an autogenerated LSA dissector.

no changes to the code, just a rename.


------------------------------------------------------------------------
r13205 | sahlberg | 2005-01-30 06:21:17 -0600 (Sun, 30 Jan 2005) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc-lsa.c
   M /trunk/epan/dissectors/packet-dcerpc-lsa.h
   M /trunk/epan/dissectors/packet-dcerpc-netlogon.c

rename lsa_dissect_POLICY_DNS_DOMAIN_INFO to lsa_dissect_DnsDomainInfo and change the signature slightly.

the signature change is to make it compatilbe with the signatures the idl compiler generates.


------------------------------------------------------------------------
r13204 | sahlberg | 2005-01-30 05:56:37 -0600 (Sun, 30 Jan 2005) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc-nt.c
   M /trunk/epan/dissectors/packet-dcerpc-nt.h

add a new dissect_ndr_counted_ascii_string() that mimics dissect_ndr_counted_string() but handles an ASCII string instead of a Unicode one.



------------------------------------------------------------------------
r13203 | guy | 2005-01-29 21:43:03 -0600 (Sat, 29 Jan 2005) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc-nt.c

Byte arrays are byte arrays, not strings.

------------------------------------------------------------------------
r13202 | sahlberg | 2005-01-29 20:52:25 -0600 (Sat, 29 Jan 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc-netlogon.c
   M /trunk/epan/dissectors/packet-dcerpc-nt.c
   M /trunk/epan/dissectors/packet-dcerpc-nt.h

change dissect_ndr_counted_byte_array  to be more consistent with dissect_ndr_counted_string


------------------------------------------------------------------------
r13201 | guy | 2005-01-29 17:45:53 -0600 (Sat, 29 Jan 2005) | 16 lines
Changed paths:
   M /trunk/epan/dissectors/packet-l2tp.c

Add the I-D name for L2TPv3 to a comment.

Do more, and more careful, AVP length checks.

Use tvb_format_text() to display strings.

Just use "col_add_fstr()" to set the Info column - there's no need to
format into a buffer and then set the column to that buffer.

Make the L2TP dissector a "new-style" dissector and have it reject
packets with an unknown version number - the dissection effect is the
same if no other dissector claims the packet (it just gets displayed as
data), but this allows other dissectors to claim it.

Don't use the length field if the length bit isn't set.

------------------------------------------------------------------------
r13200 | guy | 2005-01-29 16:21:09 -0600 (Sat, 29 Jan 2005) | 9 lines
Changed paths:
   M /trunk/epan/dissectors/packet-juniper.c

Put the dissection of the payload at the top level.

If the information that we used to guess the payload type is part of the
payload, don't make it correspond to the "Payload Type" protocol tree
item - it's covered by the dissected payload.

If we don't succeed in guessing the protocol type, just dissect the
payload as data.

------------------------------------------------------------------------
r13199 | guy | 2005-01-29 14:56:20 -0600 (Sat, 29 Jan 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-scsi.c

Treat the command opcodes as SBC-2 for CD-ROMs as well as for block
devices.

------------------------------------------------------------------------
r13198 | guy | 2005-01-29 14:39:14 -0600 (Sat, 29 Jan 2005) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc-ndr.c
   M /trunk/epan/dissectors/packet-dcerpc.c
   M /trunk/epan/dissectors/packet-dcerpc.h
   M /trunk/epan/dissectors/packet-dcom-cba-acco.c
   M /trunk/epan/dissectors/packet-dcom-oxid.c
   M /trunk/epan/dissectors/packet-dcom-remact.c
   M /trunk/epan/dissectors/packet-dcom.c
   M /trunk/epan/dissectors/packet-dcom.h

Use the 64-bit integer fetch routines to support 64-bit NDR integers.

------------------------------------------------------------------------
r13197 | guy | 2005-01-29 14:35:42 -0600 (Sat, 29 Jan 2005) | 2 lines
Changed paths:
   M /trunk/gtk/packet_list.c

Mark unused arguments as such.

------------------------------------------------------------------------
r13196 | ulfl | 2005-01-29 09:38:15 -0600 (Sat, 29 Jan 2005) | 1 line
Changed paths:
   M /trunk/docbook/Makefile
   M /trunk/docbook/developer-guide.xml
   A /trunk/docbook/edg_graphics/ethereal-logo.png
   M /trunk/docbook/user-guide.xml

various versioning related things (like using the svn version number), fix a broken link in the developer-guide
------------------------------------------------------------------------
r13195 | ulfl | 2005-01-29 08:43:33 -0600 (Sat, 29 Jan 2005) | 1 line
Changed paths:
   M /trunk/docbook/eug_src/EUG_chapter_capture.xml
   M /trunk/docbook/eug_src/EUG_chapter_customize.xml
   M /trunk/docbook/eug_src/EUG_chapter_work.xml
   M /trunk/docbook/user-guide.xml

add links to wiki example pages (Capture/Display Filters and Coloring Rules)
------------------------------------------------------------------------
r13194 | guy | 2005-01-29 04:48:16 -0600 (Sat, 29 Jan 2005) | 2 lines
Changed paths:
   M /trunk/wiretap/netxray.c

Add some notes about stuff discovered by Ken Mann.

------------------------------------------------------------------------
r13193 | sahlberg | 2005-01-28 22:44:40 -0600 (Fri, 28 Jan 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-iscsi.c

only add 4 bytes to the pdu length IFF header digest/crc32 is actually used.


------------------------------------------------------------------------
r13192 | ulfl | 2005-01-28 20:14:25 -0600 (Fri, 28 Jan 2005) | 4 lines
Changed paths:
   M /trunk/gtk/menu.c
   M /trunk/gtk/packet_list.c
   M /trunk/gtk/packet_list.h

Add a new menu item "View/Resize Columns" to, well, resize columns. As this might take a long time, I've provided a progress bar with the option to cancel the operation.

I might later add something like "View/Auto Resize Columns" with a checkbox menu item, so this is done everytime a capture file finished loading. However, I don't know how well this will work together with "Update list of packets in real time" while doing a capture.

------------------------------------------------------------------------
r13191 | ulfl | 2005-01-28 17:24:04 -0600 (Fri, 28 Jan 2005) | 1 line
Changed paths:
   M /trunk/plugins/mate/packet-mate.c

use MATE (not mate) for protocol name and protocol tree
------------------------------------------------------------------------
r13190 | lroland | 2005-01-28 07:53:14 -0600 (Fri, 28 Jan 2005) | 3 lines
Changed paths:
   M /trunk/plugins/mate/mate.h
   M /trunk/plugins/mate/mate_runtime.c
   M /trunk/plugins/mate/packet-mate.c

A new patch for mate from Luis Ontanon:
  - move mate_packet into packet-mate.c and remove it frome mate.h
  - supressed some warnings
------------------------------------------------------------------------
r13189 | guy | 2005-01-28 05:31:19 -0600 (Fri, 28 Jan 2005) | 4 lines
Changed paths:
   M /trunk/wiretap/AUTHORS
   M /trunk/wiretap/file_access.c
   M /trunk/wiretap/wtap.c
   M /trunk/wiretap/wtap.h

From Yoshihiro Oyama: support "-" as a file name, referring to the
standard input.  Opening it for random access isn't supported; we add a
new error for that.

------------------------------------------------------------------------
r13188 | guy | 2005-01-28 04:15:03 -0600 (Fri, 28 Jan 2005) | 3 lines
Changed paths:
   M /trunk/plugins/mate/mate.h

From Yoshihiro Oyama: get rid of _U_s in prototype declarations that
lack variable names.

------------------------------------------------------------------------
r13187 | guy | 2005-01-28 03:55:24 -0600 (Fri, 28 Jan 2005) | 4 lines
Changed paths:
   M /trunk/Makefile.am

From Yoshihiro Oyama: include the names of all the IrDA plugin's .o
files in the ENABLE_STATIC plugin_ldadd list.  (This one was missing
from the previous checkin.)

------------------------------------------------------------------------
r13186 | guy | 2005-01-28 03:47:52 -0600 (Fri, 28 Jan 2005) | 3 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/Makefile.am

From Yoshihiro Oyama: include the names of all the IrDA plugin's .o
files in the ENABLE_STATIC plugin_ldadd list.

------------------------------------------------------------------------
r13185 | sahlberg | 2005-01-28 03:37:47 -0600 (Fri, 28 Jan 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc-ndr.c
   M /trunk/epan/dissectors/packet-dcerpc.h

we need a dissect_ndr_uint64() that dissects an NDR hyper


------------------------------------------------------------------------
r13184 | sahlberg | 2005-01-28 03:29:49 -0600 (Fri, 28 Jan 2005) | 9 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc-browser.c
   M /trunk/epan/dissectors/packet-dcerpc-lsa.c
   M /trunk/epan/dissectors/packet-dcerpc-ndr.c
   M /trunk/epan/dissectors/packet-dcerpc-netlogon.c
   M /trunk/epan/dissectors/packet-dcerpc-samr.c
   M /trunk/epan/dissectors/packet-dcerpc-srvsvc.c
   M /trunk/epan/dissectors/packet-dcerpc.h
   M /trunk/epan/dissectors/packet-dcom.h

older MS DCE/RPC interfaces often use a construct that is to be treated as a 64 bit integer but in reality is a struct containing 2  32bit integers.
this construct is aligned on 4 byte boundaries in ndr and NOT
8 bytes as a real uint64 (== hyper) would be.


rename the existing dissect_ndr_uint64  ro  dissect_ndr_duint32  (double uint32) to make it reflect better the alignment of the type.



------------------------------------------------------------------------
r13183 | sahlberg | 2005-01-28 03:12:40 -0600 (Fri, 28 Jan 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc-nt.h

add a macro for aligning NDR datastreams to 8 byte boundaries


------------------------------------------------------------------------
r13182 | guy | 2005-01-27 05:23:06 -0600 (Thu, 27 Jan 2005) | 3 lines
Changed paths:
   M /trunk/gtk/file_dlg.c

We use the range utilities regardless of whether we're built with
libpcap or not.

------------------------------------------------------------------------
r13181 | guy | 2005-01-27 04:47:27 -0600 (Thu, 27 Jan 2005) | 2 lines
Changed paths:
   M /trunk/gtk/main.c

Fix a problem with building with libpcap disabled.

------------------------------------------------------------------------
r13180 | ulfl | 2005-01-26 17:17:00 -0600 (Wed, 26 Jan 2005) | 2 lines
Changed paths:
   M /trunk/epan/proto.c

add another REPORT_DISSECTOR_BUG() call, if tfi->tree_type is existing and not in valid range. 
Question remains: Is it safe to continue in that case?
------------------------------------------------------------------------
r13179 | ulfl | 2005-01-26 17:14:54 -0600 (Wed, 26 Jan 2005) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-icq.c

if there must be an unknown version message, use hex instead of decimal to print the unknown version number
------------------------------------------------------------------------
r13178 | ulfl | 2005-01-26 17:13:36 -0600 (Wed, 26 Jan 2005) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-rtsp.c

if there must be an "unknown transport" message, at least print the transport name
------------------------------------------------------------------------
r13177 | ulfl | 2005-01-26 16:37:04 -0600 (Wed, 26 Jan 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-daap.c

bugfix of crash_00001_20050124142515.cap: dissector packet-daap.c displayed [Dissector Bug] as it dissected a length field and used it without checking it first.

use tvb_ensure_bytes_exist() before using this length value, so [Malformed Packet] will be displayed
------------------------------------------------------------------------
r13176 | ulfl | 2005-01-26 16:24:42 -0600 (Wed, 26 Jan 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-etheric.c

bugfix of crash_00026_20050124150108.cap: three places with possible write behind the end of fixed arrays

used g_malloc instead of a fixed array
------------------------------------------------------------------------
r13175 | etxrab | 2005-01-26 14:07:35 -0600 (Wed, 26 Jan 2005) | 1 line
Changed paths:
   M /trunk/asn1/gsmmap/GSMMAP.asn
   M /trunk/asn1/gsmmap/gsmmap.cnf
   M /trunk/asn1/gsmmap/packet-gsm_map-template.c

Unpack and display digits, Decode SS-status.
------------------------------------------------------------------------
r13174 | etxrab | 2005-01-26 14:06:09 -0600 (Wed, 26 Jan 2005) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-h245.c

Fix a typo leading to no conversation set up for RTCP
------------------------------------------------------------------------
r13173 | etxrab | 2005-01-26 14:05:26 -0600 (Wed, 26 Jan 2005) | 1 line
Changed paths:
   M /trunk/asn1/h245/h245.cnf

Fix a typo leading to no conversation set up for RTCP
------------------------------------------------------------------------
r13172 | guy | 2005-01-25 14:53:27 -0600 (Tue, 25 Jan 2005) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-text-media.c

Add "applications/soap+xml" as a text media type.

------------------------------------------------------------------------
r13171 | etxrab | 2005-01-24 16:33:36 -0600 (Mon, 24 Jan 2005) | 1 line
Changed paths:
   M /trunk/asn1/gsmmap/GSMMAP.asn
   M /trunk/asn1/gsmmap/gsmmap.cnf
   M /trunk/asn1/gsmmap/packet-gsm_map-template.c

Add calling of sms dissector and make ssn number selection preferences.
------------------------------------------------------------------------
r13170 | etxrab | 2005-01-24 14:41:19 -0600 (Mon, 24 Jan 2005) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_map.c

Make the sub system number  (ssn) settings  preferences.
------------------------------------------------------------------------
r13169 | ulfl | 2005-01-24 13:33:47 -0600 (Mon, 24 Jan 2005) | 3 lines
Changed paths:
   M /trunk/gtk/main.h
   M /trunk/gtk/menu.c
   M /trunk/gtk/print_dlg.c

if context menu item "Print" is clicked from the packet list context menu, it should use the selected range setting as default. As we currently have only one packet selectable, this will print only this one. 

If we would allow selecting multiple packets in the packet list in the future, this option would print all selected packets.
------------------------------------------------------------------------
r13168 | ulfl | 2005-01-24 13:30:07 -0600 (Mon, 24 Jan 2005) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-dcom-remact.c
   M /trunk/epan/dissectors/packet-dcom-remunkn.c

the methods from these interfaces were missing the DCOM this/that header and therefore were missdissected
------------------------------------------------------------------------
r13167 | etxrab | 2005-01-24 13:26:04 -0600 (Mon, 24 Jan 2005) | 1 line
Changed paths:
   M /trunk/AUTHORS

Add Mutsuya Irie
------------------------------------------------------------------------
r13166 | etxrab | 2005-01-24 13:25:28 -0600 (Mon, 24 Jan 2005) | 1 line
Changed paths:
   M /trunk/epan/sigcomp_state_hdlr.c

Bugfix incorect while condition from Mutsuya Irie
------------------------------------------------------------------------
r13165 | guy | 2005-01-23 19:20:14 -0600 (Sun, 23 Jan 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gnutella.c

Add support for reassembly of Gnutella packets that cross TCP segment
boundaries.

------------------------------------------------------------------------
r13164 | guy | 2005-01-23 18:18:13 -0600 (Sun, 23 Jan 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-tcp.c

Get rid of an extra space after the edge value of a SACK item if
relative sequence numbers aren't being used.

------------------------------------------------------------------------
r13163 | ulfl | 2005-01-22 15:46:35 -0600 (Sat, 22 Jan 2005) | 1 line
Changed paths:
   M /trunk/epan/libethereal.def

Some dcerpc related stuff needed to write dcerpc plugin
------------------------------------------------------------------------
r13162 | sahlberg | 2005-01-22 13:56:12 -0600 (Sat, 22 Jan 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc-nt.h

needs an ALIGN_TO_2_BYTES to make the idl compiler happy


------------------------------------------------------------------------
r13161 | ulfl | 2005-01-21 19:03:21 -0600 (Fri, 21 Jan 2005) | 1 line
Changed paths:
   M /trunk/gtk/menu.c

first proposal: try to rearrange context menus to be more context relevant
------------------------------------------------------------------------
r13160 | etxrab | 2005-01-21 16:49:13 -0600 (Fri, 21 Jan 2005) | 1 line
Changed paths:
   M /trunk/asn1/gsmmap/GSMMAP.asn
   M /trunk/asn1/gsmmap/packet-gsm_map-template.c

Fix of asn1 code for one opcode to new spec used?
------------------------------------------------------------------------
r13159 | etxrab | 2005-01-21 16:46:14 -0600 (Fri, 21 Jan 2005) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-h450.c
   M /trunk/epan/dissectors/packet-h450.h

Handle some more op codes.
------------------------------------------------------------------------
r13158 | etxrab | 2005-01-21 16:45:20 -0600 (Fri, 21 Jan 2005) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-h245.c

Fixed bugs with conversations and t35
------------------------------------------------------------------------
r13157 | etxrab | 2005-01-21 16:44:14 -0600 (Fri, 21 Jan 2005) | 1 line
Changed paths:
   M /trunk/asn1/h450/h450.cnf
   M /trunk/asn1/h450/h4501.asn
   M /trunk/asn1/h450/packet-h450-template.c

asn1 done for h450.1 - h450.12, remains to tie to Operations and Responses.
------------------------------------------------------------------------
r13156 | etxrab | 2005-01-21 16:42:32 -0600 (Fri, 21 Jan 2005) | 1 line
Changed paths:
   M /trunk/asn1/h245/h245.cnf
   M /trunk/asn1/h245/packet-h245-template.c

Fix buggs with conversations not beeing set up in some cases. Decoding of t35 
------------------------------------------------------------------------
r13155 | lroland | 2005-01-21 13:16:05 -0600 (Fri, 21 Jan 2005) | 2 lines
Changed paths:
   M /trunk/packaging/nsis/Makefile.nmake
   M /trunk/packaging/nsis/ethereal.nsi

Add mate.dll to the installer. 
However it won't be installed by default.
------------------------------------------------------------------------
r13154 | lroland | 2005-01-21 13:11:59 -0600 (Fri, 21 Jan 2005) | 3 lines
Changed paths:
   M /trunk/plugins/mate/mate.h
   M /trunk/plugins/mate/mate_runtime.c
   M /trunk/plugins/mate/mate_setup.c
   M /trunk/plugins/mate/mate_util.c

From Luis Ontanon for Mate:
- supress some solaris compiler warnings
- adds GopExpiration, GopIdleTimeout and GopLifetime parameters
------------------------------------------------------------------------
r13153 | lroland | 2005-01-21 12:50:12 -0600 (Fri, 21 Jan 2005) | 2 lines
Changed paths:
   M /trunk/config.nmake

Another step towards getting the old plugin API retired:
Official plugins get linked with libethereal.dll's import library by default now. 
------------------------------------------------------------------------
r13152 | ulfl | 2005-01-20 17:17:23 -0600 (Thu, 20 Jan 2005) | 1 line
Changed paths:
   M /trunk/gtk/capture_dlg.c
   M /trunk/gtk/capture_if_dlg.c
   M /trunk/gtk/color_dlg.c
   M /trunk/gtk/conversations_table.c
   M /trunk/gtk/decode_as_dlg.c
   M /trunk/gtk/filter_dlg.c
   M /trunk/gtk/find_dlg.c
   M /trunk/gtk/goto_dlg.c
   M /trunk/gtk/help_dlg.c
   M /trunk/gtk/help_dlg.h
   M /trunk/gtk/hostlist_table.c
   M /trunk/gtk/io_stat.c
   M /trunk/gtk/menu.c
   M /trunk/gtk/print_dlg.c
   M /trunk/gtk/proto_dlg.c
   M /trunk/gtk/proto_hier_stats_dlg.c
   M /trunk/gtk/summary_dlg.c
   M /trunk/gtk/toolbar.c
   M /trunk/gtk/webbrowser.c

add some more online help functionality and help buttons at various dialog boxes, if a help page *is* available. However, the new help system needs a lot more work before completed.
------------------------------------------------------------------------
r13149 | ulfl | 2005-01-20 13:26:24 -0600 (Thu, 20 Jan 2005) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc.c

use col_set_fence for COL_INFO, if multiple DCE/RPC requests/responses are in one (TCP)PDU. I've used " # " as the delimiter string, BTW: do we have an "official" one yet?
------------------------------------------------------------------------
r13148 | guy | 2005-01-20 12:34:48 -0600 (Thu, 20 Jan 2005) | 2 lines
Changed paths:
   M /trunk/AUTHORS

Fix Julien Leproust's e-mail address.

------------------------------------------------------------------------
r13141 | sahlberg | 2005-01-20 07:19:11 -0600 (Thu, 20 Jan 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-tcp.c

SACK prettyfication


------------------------------------------------------------------------
r13140 | sahlberg | 2005-01-20 06:29:11 -0600 (Thu, 20 Jan 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-tcp.c

make TCP SACK option handle relative sequence numbers


------------------------------------------------------------------------
r13139 | kukosa | 2005-01-20 06:16:53 -0600 (Thu, 20 Jan 2005) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-h225.c

NonStandardData and TunnelledProtocol reimplemented and tested
H225 dissector regenerated with new asn2eth version
------------------------------------------------------------------------
r13138 | kukosa | 2005-01-20 06:02:08 -0600 (Thu, 20 Jan 2005) | 1 line
Changed paths:
   M /trunk/asn1/h225/h225.cnf
   M /trunk/asn1/h225/packet-h225-template.c

NonStandardData and TunnelledProtocol reimplemented and tested
------------------------------------------------------------------------
r13137 | kukosa | 2005-01-20 05:56:33 -0600 (Thu, 20 Jan 2005) | 1 line
Changed paths:
   M /trunk/tools/asn2eth.py

Fix bug in SEQUENCE/SET OF handling
------------------------------------------------------------------------
r13136 | guy | 2005-01-20 05:35:45 -0600 (Thu, 20 Jan 2005) | 2 lines
Changed paths:
   M /trunk/epan/packet.c

Squelch a compiler warning.

------------------------------------------------------------------------
r13135 | guy | 2005-01-20 05:05:06 -0600 (Thu, 20 Jan 2005) | 6 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/packet.c

From Julien Leproust: add heuristic dissectors' protocol names to the
layers string.

Remove protocol names from the layer names string if the dissector
rejects the frame.

------------------------------------------------------------------------
r13134 | guy | 2005-01-20 03:44:29 -0600 (Thu, 20 Jan 2005) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dnp.c

Free the chunk of reassembled DNP data iff there was a CRC error;
otherwise, we're using it in a tvbuff and shouldn't free it (even if the
next level of reassembly isn't complete, so that al_tvb is ultimately
null).

------------------------------------------------------------------------
r13133 | guy | 2005-01-20 01:58:23 -0600 (Thu, 20 Jan 2005) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-frame.c

Squelch some compiler warnings.

------------------------------------------------------------------------
r13132 | guy | 2005-01-20 01:02:08 -0600 (Thu, 20 Jan 2005) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-juniper.c

Make some routines static that aren't used outside this module.

Use "guint16" instead of "u_int16_t", "guint8" instead of "u_int8_t",
and "guint" instead of "u_int", to handle platforms lacking the latter
types.  Make "ppp_heuristic_guess()" reeturn a Boolean, as it just
returns a "yes or no" answer.

------------------------------------------------------------------------
r13131 | guy | 2005-01-20 00:22:20 -0600 (Thu, 20 Jan 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_map.c
   M /trunk/epan/dissectors/packet-gsm_map.h

Back out the asn2eth-generated GSM MAP dissector for now, at Anders
Broman's request, as it has a number of problems.

------------------------------------------------------------------------
r13130 | guy | 2005-01-19 23:40:56 -0600 (Wed, 19 Jan 2005) | 2 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/dissectors/Makefile.common
   M /trunk/epan/dissectors/packet-ip.c
   M /trunk/epan/dissectors/packet-ipv6.c
   A /trunk/epan/dissectors/packet-juniper.c
   M /trunk/epan/dissectors/packet-osi.c
   M /trunk/epan/dissectors/packet-ppp.c
   M /trunk/wiretap/libpcap.c
   M /trunk/wiretap/wtap.c
   M /trunk/wiretap/wtap.h

From Hannes Gredler: support for Juniper's DLT_JUNIPER_ATM{1,2} values.

------------------------------------------------------------------------
r13129 | guy | 2005-01-19 23:06:38 -0600 (Wed, 19 Jan 2005) | 3 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-dcerpc-pnp.c
   A /trunk/epan/dissectors/packet-dcerpc-pnp.h
   A /trunk/epan/dissectors/packet-dcerpc-rras.c
   A /trunk/epan/dissectors/packet-dcerpc-rras.h

From Jean-Baptiste Marchand: stub dissectors for rras and pnp MSRPC
interfaces.

------------------------------------------------------------------------
r13128 | guy | 2005-01-19 22:37:03 -0600 (Wed, 19 Jan 2005) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-http.c
   M /trunk/epan/dissectors/packet-rtsp.c
   M /trunk/epan/req_resp_hdrs.c
   M /trunk/epan/req_resp_hdrs.h

There's no guaranteee that "req_resp_hdrs_do_reassembly()" gets called
only at the beginning of a tvbuff, so it needs an argument that's the
starting offset in the tvbuff.

------------------------------------------------------------------------
r13127 | guy | 2005-01-19 19:26:34 -0600 (Wed, 19 Jan 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-multipart.c

From Ruud Linders: support short names in multipart headers; SIP-T
requires this.

------------------------------------------------------------------------
r13126 | ulfl | 2005-01-19 17:41:07 -0600 (Wed, 19 Jan 2005) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc.c

try to defragment DCE/RPC fragments (simply one after the other), if alloc_hint is zero
------------------------------------------------------------------------
r13123 | etxrab | 2005-01-19 16:44:09 -0600 (Wed, 19 Jan 2005) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-h225.c
   M /trunk/epan/dissectors/packet-h225.h

Attempt to reimplement "non standard data/parameter" and "tunnelled
protocol"
------------------------------------------------------------------------
r13122 | etxrab | 2005-01-19 16:43:15 -0600 (Wed, 19 Jan 2005) | 2 lines
Changed paths:
   M /trunk/asn1/h225/h225-exp.cnf
   M /trunk/asn1/h225/h225.cnf
   M /trunk/asn1/h225/packet-h225-template.c

Attempt to reimplement "non standard data/parameter" and "tunnelled
protocol"
------------------------------------------------------------------------
r13118 | gerald | 2005-01-18 22:49:29 -0600 (Tue, 18 Jan 2005) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-frame.c
   M /trunk/epan/packet.c
   M /trunk/epan/packet_info.h

Add a field called "frame.protocols" which shows the protocols present
in the frame.   The filter "frame.protocols contains ip:icmp:ip" could
be used to find any ICMP packets containing IP headers.

Clean up whitespace.

------------------------------------------------------------------------
r13117 | ulfl | 2005-01-18 19:12:45 -0600 (Tue, 18 Jan 2005) | 1 line
Changed paths:
   M /trunk/gtk/main.c
   M /trunk/gtk/main.h
   M /trunk/gtk/menu.c

while I'm at it, add another packet details context menu item, which will link to the specific display filter reference page (just try it out :-)
------------------------------------------------------------------------
r13116 | ulfl | 2005-01-18 17:06:10 -0600 (Tue, 18 Jan 2005) | 1 line
Changed paths:
   M /trunk/docbook/eug_src/EUG_app_files.xml
   M /trunk/docbook/eug_src/EUG_app_tools.xml
   M /trunk/docbook/eug_src/EUG_chapter_build_install.xml
   M /trunk/docbook/eug_src/EUG_chapter_capture.xml
   M /trunk/docbook/eug_src/EUG_chapter_introduction.xml
   M /trunk/docbook/eug_src/EUG_chapter_io.xml
   M /trunk/docbook/eug_src/EUG_chapter_statistics.xml
   M /trunk/docbook/eug_src/EUG_chapter_use.xml
   M /trunk/docbook/eug_src/EUG_chapter_work.xml

noticed by Nicolas Kaiser: fix various typos
------------------------------------------------------------------------
r13115 | ulfl | 2005-01-18 16:24:07 -0600 (Tue, 18 Jan 2005) | 1 line
Changed paths:
   M /trunk/gtk/main.c
   M /trunk/gtk/menu.c

added the "Online Protocol Info" to the packet details context menu with a simple_dialog doing some explanation.
------------------------------------------------------------------------
r13113 | ulfl | 2005-01-18 14:44:11 -0600 (Tue, 18 Jan 2005) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-dcom-oxid.c

slightly improve dissection of complex_ping response
------------------------------------------------------------------------
r13112 | ulfl | 2005-01-18 14:42:47 -0600 (Tue, 18 Jan 2005) | 1 line
Changed paths:
   M /trunk/doc/mergecap.pod

we can merge more than two files with mergecap
------------------------------------------------------------------------
r13109 | gerald | 2005-01-18 10:00:57 -0600 (Tue, 18 Jan 2005) | 2 lines
Changed paths:
   M /trunk/make-version.pl

Fix the handling of "enable: 0" in version.conf.

------------------------------------------------------------------------
