commit 1d39db667e
Author: Gerald Combs <gerald@wireshark.org>
Date:   Tue Jul 9 18:15:22 2024 -0700

    Prep for 4.0.16

    [skip ci]

commit 0439f14f02
Author: Gerald Combs <gerald@wireshark.org>
Date:   Sun Jul 7 12:00:45 2024 -0500

    GitLab CI: Fix an upload command

commit 933352900a
Author: Gerald Combs <gerald@wireshark.org>
Date:   Sun Jul 7 09:21:44 2024 +0000

    [Automatic update for 2024-07-07]

    Update manuf, services enterprise numbers, translations, and other items.

commit 606ace300b
Author: Gerald Combs <gerald@wireshark.org>
Date:   Sat Jul 6 20:27:55 2024 -0500

    GitLab CI: Use Mino mc on Ubuntu

    Switch to minio mc on Ubuntu. Unlike `aws s3 cp` it can copy multiple
    files. It should also reduce the Ubuntu image size a bit.

    (cherry picked from commit d7eefd41a2b03bf72547901cd7e6b729f217793a)

    Conflicts:
            .gitlab-ci.yml

commit 221b887f34
Author: Gerald Combs <gerald@wireshark.org>
Date:   Sat Jul 6 22:19:20 2024 -0500

    GitLab CI: Switch to clang 18

commit 8fc00d2da4
Author: Uli Heilmeier <uh@heilmeier.eu>
Date:   Fri Jul 5 10:19:28 2024 +0000

    DCHP: Fix Relay Agent Information Source Port

    Fixes: #19909

    (cherry picked from commit acd8dca562a07a6811788617bdca03f4f3a27753)

    Co-authored-by: Uli Heilmeier <uh@heilmeier.eu>

commit 283113da39
Author: Gerald Combs <gerald@wireshark.org>
Date:   Sun Jun 30 09:20:58 2024 +0000

    [Automatic update for 2024-06-30]

    Update manuf, services enterprise numbers, translations, and other items.

commit d9efbcf348
Author: John Thacker <johnthacker@gmail.com>
Date:   Wed Jun 26 11:44:43 2024 +0000

    idl2wrs.c: Fix generation of idl2wrs-dissectors

    This hasn't worked since 8ca846436d14da6079a51da4111a860e0f357c36
    (September 24, 2016) because the code actually depended on atoi
    failing silently and returning 0 when faced with a non integer.

    Switch the ws_strtou32 call to being *after* the checks for the
    special values '*' and ']'.

    We don't need to copy the result into a string buffer and compare,
    because ws_strtou32 with a NULL end of string pointer will err in
    the cases where the comparison would fail.

    (cherry picked from commit f3f19e8fbb972a49fa3d141e59ef3d9a007a24aa)

    Co-authored-by: John Thacker <johnthacker@gmail.com>

commit 0c849e9764
Author: David Perry <boolean263@protonmail.com>
Date:   Tue Jun 25 13:49:25 2024 -0400

    WiSUN: correct offset logic errors

    Change local variable `offset` from a `guint8` to a `guint` in two
    functions with loops, to prevent a potential infinite loop from
    overflowing the variable.

    Change `dissect_wisun_nrie()` to return the number of bytes it
    dissected, since that's how `dissect_wisun_hie()` seemingly expects it
    to behave. It previously returned the new offset at the end of what it
    dissected -- which is how several `dissect_...()` functions in this
    dissector are expected to behave, but this is not one of them. (This
    inconsistency adds friction when maintaining this dissector and should
    be addressed at some point.)

    (backported from commit 6931eb67e7a3fd7a2ad115f3523fb0a4778c885f)

commit c970a78bcc
Author: Gerald Combs <gerald@wireshark.org>
Date:   Sun Jun 23 09:21:19 2024 +0000

    [Automatic update for 2024-06-23]

    Update manuf, services enterprise numbers, translations, and other items.

commit 37dffcf28c
Author: John Thacker <johnthacker@gmail.com>
Date:   Wed Jun 19 22:14:23 2024 +0000

    radius: Switch back to the previous FILE if an $INCLUDE doesn't open

    Save the previous FILE pointer so we can switch back to it if a
    file name listed in an $INCLUDE doesn't open, instead of leaving
    it null, so that any subsequent read attempts (or attempts to close
    it at the end) don't crash.

    Fix #6466. (The other parts of the issue have been fixed.)

    (cherry picked from commit ef37a3e41e32f96d19d684e0873b51a31069184b)

    Co-authored-by: John Thacker <johnthacker@gmail.com>

commit b8f1839713
Author: John Thacker <johnthacker@gmail.com>
Date:   Wed Jun 19 12:52:09 2024 -0400

    release notes: Mention fix to TCP Stream Graph tcptrace

    Related to #19846

    (cherry picked from commit cb890416dbdfb4dc72cf88ee808bad9dcec61b1f)

commit 167e47c4e6
Author: Gerald Combs <gerald@wireshark.org>
Date:   Sun Jun 16 09:22:03 2024 +0000

    [Automatic update for 2024-06-16]

    Update manuf, services enterprise numbers, translations, and other items.

commit 343738bf87
Author: Guy Harris <gharris@sonic.net>
Date:   Sat Jun 15 07:14:22 2024 +0000

    log3gpp: Fix read of uninitialized data.

    Clang static analysis reports that subsecond_decimals_buf[1] through [3] might
    be used uninitialized.  This is because the array is being NUL-terminated, but
    the NUL-termination is not relevant (and is in fact erroneous) when the array
    is being directly evaluated one character at a time and assumed to be only
    digits.

    The NUL-termination can be removed (and the array size reduced by one) and
    instead we directly initialize to '0' any characters not read from the source
    line.

    (cherry picked from commit 6ead3e26572ebc5be814206f4a5a833866eb4f32)

    Co-authored-by: Darius Davis <darius-wireshark@free-range.com.au>

commit 641a0294ed
Author: Gerald Combs <gerald@wireshark.org>
Date:   Sun Jun 9 09:21:54 2024 +0000

    [Automatic update for 2024-06-09]

    Update manuf, services enterprise numbers, translations, and other items.

commit 9f9ad25eeb
Author: Guy Harris <gharris@sonic.net>
Date:   Thu Jun 6 17:29:42 2024 +0000

    mergecap: prevent appending to an input file

    Prevent the infinite loop described in #19402 by refusing to operate if
    asked to append to an output file that is also one of the inputs. Uses
    `files_identical()` from wsutil.

    (cherry picked from commit 3b63098fb1e2b7f8fe350989bb973d8323464639)

    Co-authored-by: David Perry <boolean263@protonmail.com>

commit 3efa7424b7
Author: John Thacker <johnthacker@gmail.com>
Date:   Thu Jun 6 01:08:43 2024 +0000

    Qt: Allow the Learn links to word wrap

    Over the course of the 4.0 series the Sharkfest, Discord, and Donation
    links were added to the Welcome page. They are now the limiting factor
    in the application page width. For some language translations they
    are even longer.

    Some of the "Learn" links have multiple words, like "Questions and
    Answers," or "Wireshark Discord." Allow the multiword link titles
    to word wrap.

    Fix #19861

    (cherry picked from commit 389151f569600f5340845879f7d3a5b783b6ea57)

    Co-authored-by: John Thacker <johnthacker@gmail.com>

commit c90f926c59
Author: John Thacker <johnthacker@gmail.com>
Date:   Mon Jun 3 20:05:25 2024 -0400

    Qt: Fix byte view text wrapping with Qt <= 5.10

    There's at least two concepts that might be described as the width
    of a string of characters; the width of a box that surrounds the
    existing characters, and the width that measures where to place
    the next characer. The former has always been obtained from
    QFontMetrics::boundingRect(text).width(), but prior to Qt 5.11
    QFontMetrics::width(text) gave the latter. This led to many people
    using the latter when they usually wanted the former.

    Thus in Qt 5.11 QFontMetrics::width() was deprecated for
    QFontMetrics::horizontalAdvance().

    In our case, we really want horizontalAdvance, because we're manually
    drawing characters. It makes a difference because for non ASCII
    characters we use the UTF-8 middle dot character, which has a lot
    of necessary blank space before and after it where other characters
    shouldn't be drawn. With some fonts and scalings using the width
    of the bounding rectangle makes our lines too short and the end of
    the ASCII text wraps, when there's lots of non ASCII / middle dots.

    So on Qt 5.10 and earlier, use the width() function that is
    equivalent to horizontalAdvance (een though it is marked obsolete
    for later versions.)

    Fix #18096

    (backported from commit eca87127fd598865eedb135095b53318de8f9615)

commit fc88d8a0ed
Author: John Thacker <johnthacker@gmail.com>
Date:   Mon Jun 3 13:03:44 2024 +0000

    Qt: Make it possible to clear Comments from all interfaces

    We only add an entry for an interface if it has a non-empty Comment
    (aka user description). That means we need to make sure that the
    map has a default empty QStringList for that pref so we can set it
    to the empty string; otherwise, if some interfaces have Comments, but
    the user tries to the clear the comments from all interfaces, it won't
    work. The map won't have an entry for that pref, so it won't get
    changed to the empty string.

    The same is true for the Monitor Mode setting.

    (cherry picked from commit f622eac21f24b450076fb85bac3b40f58eca2ecc)

    Co-authored-by: John Thacker <johnthacker@gmail.com>

commit 7daf5cf6e7
Author: Gerald Combs <gerald@wireshark.org>
Date:   Sun Jun 2 09:22:07 2024 +0000

    [Automatic update for 2024-06-02]

    Update manuf, services enterprise numbers, translations, and other items.

commit 0166794db5
Author: John Thacker <johnthacker@gmail.com>
Date:   Sat Jun 1 12:23:30 2024 +0000

    Qt: Fix leak on CaptureFileDialog preview of file with errors

    Remember to call wtap_close when the preview stats have an error
    to avoid leaking the file.

    (cherry picked from commit c29c1bb27ce6a4ab50866ea3b580af859d44323b)

    Co-authored-by: John Thacker <johnthacker@gmail.com>

commit bddaaeec28
Author: John Thacker <johnthacker@gmail.com>
Date:   Fri May 31 12:54:32 2024 +0000

    Qt: Fix CaptureOptionsDialog tooltip for stop files spinbox

    The tooltip for the stop files spinbox is accidentally duplicated
    from the stop number of packets spinbox.

    (cherry picked from commit 8b9c3c620e983ec4e63cfeda2f5de449f2bd3ace)

    Co-authored-by: John Thacker <johnthacker@gmail.com>

commit bfc5a8a084
Author: Pascal Quantin <pascal@wireshark.org>
Date:   Fri May 31 10:40:32 2024 +0200

    NAS 5GS: fix dissection of extended rejected NSSAI IE

    (cherry picked from commit adb9543df7a312e9309f0b54eeab62249de54d84)

    Conflicts:
            epan/dissectors/packet-nas_5gs.c
    (cherry picked from commit 2e88a7ca5fe719601b4956464102c9d077b1a3fd)

    Conflicts:
            epan/dissectors/packet-nas_5gs.c

commit cc67f836c0
Author: John Thacker <johnthacker@gmail.com>
Date:   Wed May 29 14:23:04 2024 +0000

    SPRT: Fix crash

    SDP can setup a RTP conversation with a setup frame before the current
    frame, which changes the dissection on the second pass. If in the period
    in the middle there is a SPRT packet, it can be dissected differently on
    the second pass, and the SPRT conversation data won't be found on the
    second pass.

    Fix #19559 (at least prevent the crash. There's some more cleanup that
    should happen.)

    (cherry picked from commit 05f6364cbd766e8758f98c5ee2070aef27c1ffef)

    Co-authored-by: John Thacker <johnthacker@gmail.com>

commit bd4e7472fd
Author: John Thacker <johnthacker@gmail.com>
Date:   Mon May 27 10:34:04 2024 +0000

    Qt: Only remove and delete the FunnelTextDialog's own buttons

    FunnelTextDialog has a static global map of all the buttons. When closing
    a dialog, only delete the buttons from that dialog's button box, not all
    the button from all the dialogs in the map.

    Fix #18386

    (cherry picked from commit d40040eac72bd3ceb51cdd1b99b9553c3f7aa48c)

    Co-authored-by: John Thacker <johnthacker@gmail.com>

commit f65b4aaf81
Author: Gerald Combs <gerald@wireshark.org>
Date:   Sun May 26 09:21:42 2024 +0000

    [Automatic update for 2024-05-26]

    Update manuf, services enterprise numbers, translations, and other items.

commit 970ccb5ec0
Author: Pascal Quantin <pascal@wireshark.org>
Date:   Tue May 21 11:50:52 2024 +0000

    RLC LTE: fix dissection of EUTRA DL CCCH messages

    (cherry picked from commit 0c3bf2d77e32e08011e5567ede189b45947805ca)

    Co-authored-by: Pascal Quantin <pascal@wireshark.org>

commit 4c5f65527b
Author: John Thacker <johnthacker@gmail.com>
Date:   Mon May 20 23:52:55 2024 +0000

    wscbor: defer creation of composite tvb

    Prevents an exception in finalize if no tvbs are appended.

    (cherry picked from commit a0c96275021fa7fa763e93ccfbc54911d1055114)

    Co-authored-by: Kevin Albertson <kevin.eric.albertson@gmail.com>

commit c508ebf9c3
Author: John Thacker <johnthacker@gmail.com>
Date:   Mon May 20 11:24:37 2024 +0000

    Qt: Switch rwin_graph axes depending on TCP Stream graph selected

    Fix #19846

    (cherry picked from commit 8f6822071ee44931a9594a282bc4e3649bd7153a)

    Co-authored-by: John Thacker <johnthacker@gmail.com>

commit 919424a658
Author: Gerald Combs <gerald@wireshark.org>
Date:   Sun May 19 09:22:23 2024 +0000

    [Automatic update for 2024-05-19]

    Update manuf, services enterprise numbers, translations, and other items.

commit 13556f4c71
Author: Gerald Combs <gerald@wireshark.org>
Date:   Wed May 15 12:56:01 2024 -0700

    Version: 4.0.14 â†’ 4.0.15

    [skip ci]
