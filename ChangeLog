------------------------------------------------------------------------
r16878 | gerald | 2005-12-21 20:06:39 -0600 (Wed, 21 Dec 2005) | 2 lines
Changed paths:
   A /releases/ethereal-0.10.14 (from /trunk:16877)

Branch off the 0.10.14 release.

------------------------------------------------------------------------
r16877 | jmayer | 2005-12-21 19:36:42 -0600 (Wed, 21 Dec 2005) | 8 lines
Changed paths:
   M /trunk/epan/proto.c

Jaap Keuter:

While looking into bug 239 I found a type mismatch in proto.c. Even
though tree_is_expanded is defined as a (gboolean *) the memory
allocation is carried out using sizeof (gint *). The attached patch
fixes this.


------------------------------------------------------------------------
r16876 | jmayer | 2005-12-21 19:33:56 -0600 (Wed, 21 Dec 2005) | 3 lines
Changed paths:
   M /trunk/doc/editcap.pod

Jaap Keuter:
        Add the documentation part of the fix for bug 379

------------------------------------------------------------------------
r16875 | jmayer | 2005-12-21 19:26:04 -0600 (Wed, 21 Dec 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-msnlb.c

Jaap Keuter:
        Add MS NLB buildin dissector

------------------------------------------------------------------------
r16874 | gerald | 2005-12-21 19:23:27 -0600 (Wed, 21 Dec 2005) | 43 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/gtk/tcp_graph.c

From Bill Meier:

After investigating the time-sequence graphs (Stevens and tcptrace) produced 
using an FTP capture file supplied by Eduardo Segura 
(see http://www.ethereal.com/lists/ethereal-users/200512/msg00153.html ) 
I've identified several problems in tcp_trace.c.

The problems mostly involve incorrect determination of the lower/upper 
sequence number bounds (for the Y axis) in certain cases (e.g. having to do
with 'partial' conversations).

I've reworked the '...get_bounds' code to handle cases such as:

1. out of order data segments (e.g.: the first segment in a captured
conversation has a higher sequence number than a later segment);

2. 'ack' sequence numbers for initial ack segments in a conversation lower
than the sequence numbers of the initial data segments;

3. maximum 'ack + win' sequence number in a conversation greater than the 
max data sequence number;

4. Stevens graph: only use data segment sequence numbers when 
determining bounds;

5. TCP RST packet without 'ack' flag: do not try to use the 'ack' seq num from
the packet in this case. (This was the specific cause of the originally reported
problem).


I've also reworked the tcptrace display code slightly to properly handle 
the initial ack packet of a sequence;

As an example of the some of the fixes the Ethereal tcptrace style graph 
of the following conversation fragment will now be similar to the graph 
produced by Tcptrace.

data:  seq 10000 len 100
data:  seq 10100 len 200
ack:   ack 5000  win 6000
ack:   ack 5400  win 5600 


------------------------------------------------------------------------
r16873 | jmayer | 2005-12-21 19:08:07 -0600 (Wed, 21 Dec 2005) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-3com-njack.c

- Add max frame size
- Add port power forwarding
- Some more field cleanups

------------------------------------------------------------------------
r16872 | gerald | 2005-12-21 10:49:47 -0600 (Wed, 21 Dec 2005) | 2 lines
Changed paths:
   M /trunk/config.nmake
   M /trunk/configure.in
   M /trunk/docbook/release-notes.xml

Prep for 0.10.14.

------------------------------------------------------------------------
r16871 | jmayer | 2005-12-21 05:21:49 -0600 (Wed, 21 Dec 2005) | 8 lines
Changed paths:
   M /trunk/epan/dissectors/packet-3com-njack.c

- Don't use numbers when there are enum values
- Better nameing of tfs_ arrays
- Name and dissect "version" field (previously unknown)
- Name and dissect "add tag scheme" (previously unknown)
- Add lots of comments about meanings in the port data
- The first byte in the set command is probably some salt value


------------------------------------------------------------------------
r16870 | guy | 2005-12-21 02:59:52 -0600 (Wed, 21 Dec 2005) | 5 lines
Changed paths:
   M /trunk/gtk/about_dlg.c
   M /trunk/gtk/main.c
   M /trunk/tethereal.c
   M /trunk/version_info.c
   M /trunk/version_info.h

Provide not only copyright information, but a GPL blurb, in all the
version/usage messages.

Put newlines at the end of various version strings.

------------------------------------------------------------------------
r16869 | sahlberg | 2005-12-21 02:48:59 -0600 (Wed, 21 Dec 2005) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb.c

add dissection of two more NTCreateAndX bits :    
open by file id 
and
backup intent



------------------------------------------------------------------------
r16868 | etxrab | 2005-12-20 12:38:13 -0600 (Tue, 20 Dec 2005) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-enip.c
   M /trunk/epan/dissectors/packet-mip.c

From jaap Keuter:
Taking a random dissector from the list on the Wiki I picked packet-enip.c. Nothing wrong with this one, I still ememified it.

From Bart Braem:
packet-mip.c does not have support for all registration denials by the foreign agent, code 77 was left out. The attached patch fixes that.

------------------------------------------------------------------------
r16867 | etxrab | 2005-12-20 12:26:28 -0600 (Tue, 20 Dec 2005) | 1 line
Changed paths:
   M /trunk/asn1/ansi_map/ansi_map.asn
   M /trunk/asn1/ansi_map/ansi_map.cnf
   M /trunk/asn1/ansi_map/packet-ansi_map-template.c

Add ASN1 code from some more 3GPP2 dockuments.
------------------------------------------------------------------------
r16866 | jmayer | 2005-12-20 03:23:42 -0600 (Tue, 20 Dec 2005) | 1 line
Changed paths:
   A /trunk/epan/dissectors/packet-rnsap.c
   A /trunk/epan/dissectors/packet-rnsap.h

packet-rnsap.[hc] were added to Makefile.common but missing from svn
------------------------------------------------------------------------
r16865 | jmayer | 2005-12-20 02:35:53 -0600 (Tue, 20 Dec 2005) | 8 lines
Changed paths:
   M /trunk/epan/dissectors/packet-radius.c
   M /trunk/epan/dissectors/packet-xml.c

packet-radius.c, packet-xml.c:
        Fix a memory leak found by valgrind:
        Although dir isn't a directory it may still use memory

packet-xml.c:
        Reformat the relevant function in packet-xml.c to be readable on systems
        where a tab is 8 spaces.

------------------------------------------------------------------------
r16864 | etxrab | 2005-12-20 01:22:33 -0600 (Tue, 20 Dec 2005) | 1 line
Changed paths:
   M /trunk/asn1/Makefile.nmake
   A /trunk/asn1/rnsap
   A /trunk/asn1/rnsap/Makefile
   A /trunk/asn1/rnsap/Makefile.nmake
   A /trunk/asn1/rnsap/packet-rnsap-template.c
   A /trunk/asn1/rnsap/packet-rnsap-template.h
   A /trunk/asn1/rnsap/rnsap.asn
   A /trunk/asn1/rnsap/rnsap.cnf
   M /trunk/epan/dissectors/Makefile.common

Add dissection of RNSAP, not complete yet.
------------------------------------------------------------------------
r16863 | gerald | 2005-12-19 20:50:04 -0600 (Mon, 19 Dec 2005) | 2 lines
Changed paths:
   M /trunk/epan/radius_dict.l

Make sure we don't try to close an already-closed file.

------------------------------------------------------------------------
r16862 | etxrab | 2005-12-19 13:39:42 -0600 (Mon, 19 Dec 2005) | 1 line
Changed paths:
   M /trunk/asn1/ansi_map/ansi_map.asn
   M /trunk/asn1/ansi_map/packet-ansi_map-template.c

Fix some asn1 errors and insert the new code to call TCAP.
------------------------------------------------------------------------
r16861 | etxrab | 2005-12-19 13:36:32 -0600 (Mon, 19 Dec 2005) | 1 line
Changed paths:
   M /trunk/asn1/h450/Makefile.nmake
   M /trunk/asn1/h450/h450.cnf
   M /trunk/asn1/h450/packet-h450-template.c
   M /trunk/epan/dissectors/packet-gsm_map.c
   M /trunk/epan/dissectors/packet-gsm_map.h
   M /trunk/epan/dissectors/packet-h450.c
   M /trunk/epan/dissectors/packet-h450.h

Get rid of some GCC warnings about unused code.
------------------------------------------------------------------------
r16860 | etxrab | 2005-12-19 13:34:52 -0600 (Mon, 19 Dec 2005) | 1 line
Changed paths:
   M /trunk/asn1/gsmmap/GSMMAP.asn
   M /trunk/asn1/gsmmap/gsmmap.cnf
   M /trunk/asn1/gsmmap/packet-gsm_map-template.c

Add dissection of Error parameters hopfully geting rid of some GCC warnings.
------------------------------------------------------------------------
r16859 | lego | 2005-12-19 13:21:32 -0600 (Mon, 19 Dec 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-m3ua.c

register the m3ua dissector by name


------------------------------------------------------------------------
r16858 | lego | 2005-12-19 13:20:31 -0600 (Mon, 19 Dec 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-alcap.c

Avoid a warning if release_cause == 0


------------------------------------------------------------------------
r16857 | lego | 2005-12-19 13:18:20 -0600 (Mon, 19 Dec 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-juniper.c
   M /trunk/wiretap/libpcap.c
   M /trunk/wiretap/wtap.h

Add support for Juniper GGSN generated pcap files.


------------------------------------------------------------------------
r16856 | etxrab | 2005-12-19 00:48:07 -0600 (Mon, 19 Dec 2005) | 22 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bittorrent.c
   M /trunk/epan/dissectors/packet-edonkey.c
   M /trunk/epan/dissectors/packet-edonkey.h

From John Sullivan:
Three patches here:

eth-ed-2.diff
-------------

1) The handling of HashSet Answer messages was wrong
2) Add dissection of some more eMule extension packets to do with
   error recovery

   
eth-bt-1.diff
-------------

New versions of the Azureus BitTorrent client implement a new extension to the protocol, which is effectively a text based encapsulation of the binary BitTorrent protocol, embedded within the BitTorrent protocol. Who knows why they thought that was a good idea, but this patch can pick apart their new headers.


eth-bt-2.diff
-------------

By registering a normal dissector as well as the heuristic one, BitTorrent shows up on the Decode As... list so you can manually override its mistake.

------------------------------------------------------------------------
r16855 | jmayer | 2005-12-18 17:29:37 -0600 (Sun, 18 Dec 2005) | 4 lines
Changed paths:
   M /trunk/epan/column-utils.c

"Fix" for warning: enumeration value 'TS_NOT_SET' not handled in switch
   Just g_assert until someone who understands the code checks in a real
   fix.

------------------------------------------------------------------------
r16854 | jmayer | 2005-12-18 17:23:21 -0600 (Sun, 18 Dec 2005) | 1 line
Changed paths:
   M /trunk/epan/to_str.c

warning: no newline at end of file
------------------------------------------------------------------------
r16853 | jmayer | 2005-12-18 17:22:47 -0600 (Sun, 18 Dec 2005) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-nhrp.c
   M /trunk/gtk/sctp_byte_graph_dlg.c

warning: C++ style comments are not allowed in ISO C90
------------------------------------------------------------------------
r16852 | jmayer | 2005-12-18 17:18:06 -0600 (Sun, 18 Dec 2005) | 1 line
Changed paths:
   M /trunk/asn1/h245/packet-h245-template.c
   M /trunk/capture_opts.h
   M /trunk/dumpcap.c
   M /trunk/epan/dissectors/packet-h245.c
   M /trunk/epan/dissectors/packet-nhrp.c

warning: function declaration isn't a prototype
------------------------------------------------------------------------
r16851 | jmayer | 2005-12-18 16:40:49 -0600 (Sun, 18 Dec 2005) | 16 lines
Changed paths:
   M /trunk/tools/pidl/lib/Parse/Pidl/Ethereal/Conformance.pm
   M /trunk/tools/pidl/lib/Parse/Pidl/Ethereal/NDR.pm

Update from samba tree revision 12205 to 12325
============================ Samba log start ============
------------------------------------------------------------------------
r12205 | jelmer | 2005-12-13 02:56:04 +0100 (Tue, 13 Dec 2005) | 2 lines

Support 'TFS' command in conformance files

------------------------------------------------------------------------
r12206 | jelmer | 2005-12-13 14:14:23 +0100 (Tue, 13 Dec 2005) | 2 lines

Fix some issues in NOEMIT

------------------------------------------------------------------------
============================ Samba log end ==============


------------------------------------------------------------------------
r16850 | guy | 2005-12-18 14:54:47 -0600 (Sun, 18 Dec 2005) | 3 lines
Changed paths:
   M /trunk/AUTHORS

Indent authors' e-mail addresses with tabs (so the list is properly
aligned in the About box).

------------------------------------------------------------------------
r16849 | guy | 2005-12-18 13:46:38 -0600 (Sun, 18 Dec 2005) | 2 lines
Changed paths:
   M /trunk/AUTHORS

Use tabs to indent all credits.

------------------------------------------------------------------------
r16848 | guy | 2005-12-18 13:41:49 -0600 (Sun, 18 Dec 2005) | 2 lines
Changed paths:
   M /trunk/AUTHORS

Re-UTF-8ify.

------------------------------------------------------------------------
r16847 | etxrab | 2005-12-18 13:01:46 -0600 (Sun, 18 Dec 2005) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ospf.c

From Michael Rozhavsky:
In my previous patch I forgot to add a OOBResync flag to the DBD packet flags field. This patch adds this flag.
------------------------------------------------------------------------
r16846 | etxrab | 2005-12-18 12:17:29 -0600 (Sun, 18 Dec 2005) | 1 line
Changed paths:
   A /trunk/asn1/ansi_map
   A /trunk/asn1/ansi_map/Makefile.nmake
   A /trunk/asn1/ansi_map/README
   A /trunk/asn1/ansi_map/ansi_map.asn
   A /trunk/asn1/ansi_map/ansi_map.cnf
   A /trunk/asn1/ansi_map/packet-ansi_map-template.c
   A /trunk/asn1/ansi_map/packet-ansi_map-template.h

Work in progress ANSI MAP dissector. 
------------------------------------------------------------------------
r16845 | etxrab | 2005-12-18 12:15:24 -0600 (Sun, 18 Dec 2005) | 7 lines
Changed paths:
   M /trunk/Makefile.am
   M /trunk/doc/README.malloc

From Martin Warnes
Attached a small patch to top level Makefile.am to include the recently 
added diamter data files chargecontrol.xml and TGPPSh.xml

From jaaap Keuter:
I've polished up the README.malloc describing ememified memory management. It's basically the same information, but made a bit more accessable. All this in response to bug 511

------------------------------------------------------------------------
r16844 | etxrab | 2005-12-18 12:13:05 -0600 (Sun, 18 Dec 2005) | 11 lines
Changed paths:
   M /trunk/epan/dissectors/Makefile.common
   M /trunk/epan/dissectors/ncp2222.py
   A /trunk/epan/dissectors/packet-ncs.c

From Greg Morris:
-  New Dissector Novell Cluster Services

1. Changes Dir Handle Type from Boolean to val string
2. Changes Search Mode from Boolean to val string
3. Adds a number of additional attribute definitions
4. Adds file migration state values
5. Adds missing return values
6. Adds NCP 90,150 "File Migration Request"
 

------------------------------------------------------------------------
r16843 | ulfl | 2005-12-18 05:36:06 -0600 (Sun, 18 Dec 2005) | 1 line
Changed paths:
   M /trunk/gtk/main.c

use #ifdef SHOW_WELCOME_PAGE for the currently disabled welcome page instead of simply #if 0
------------------------------------------------------------------------
r16842 | guy | 2005-12-18 05:19:25 -0600 (Sun, 18 Dec 2005) | 3 lines
Changed paths:
   M /trunk/asn1/tcap/packet-tcap-template.c
   M /trunk/epan/dissectors/packet-tcap.c

If we're going to use a handle for the data handle, we need to get a
handle for that dissector.  This fixes bug 637.

------------------------------------------------------------------------
r16841 | guy | 2005-12-18 05:08:38 -0600 (Sun, 18 Dec 2005) | 2 lines
Changed paths:
   M /trunk/asn1/tcap/tcap.cnf

Update tcap.cnf to generate the current packet-tcap.c

------------------------------------------------------------------------
r16840 | guy | 2005-12-18 04:59:45 -0600 (Sun, 18 Dec 2005) | 2 lines
Changed paths:
   M /trunk/asn1/mms/packet-mms-template.c
   M /trunk/epan/dissectors/packet-mms.c

Get rid of an unused variable.

------------------------------------------------------------------------
r16839 | guy | 2005-12-18 04:58:47 -0600 (Sun, 18 Dec 2005) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

Squelch a compiler warning.

------------------------------------------------------------------------
r16838 | guy | 2005-12-18 04:51:41 -0600 (Sun, 18 Dec 2005) | 2 lines
Changed paths:
   M /trunk/asn1/gsm_ss/packet-gsm_ss-template.c
   M /trunk/epan/dissectors/packet-gsm_ss.c

Get rid of an unused variable.

------------------------------------------------------------------------
r16837 | guy | 2005-12-18 04:42:29 -0600 (Sun, 18 Dec 2005) | 4 lines
Changed paths:
   M /trunk/asn1/nbap/packet-nbap-template.c
   M /trunk/epan/dissectors/packet-nbap.c
   M /trunk/epan/dissectors/packet-nbap.h

Get rid of an unused variable.

Fix a typo in svn:keywords.

------------------------------------------------------------------------
r16836 | ulfl | 2005-12-17 21:42:01 -0600 (Sat, 17 Dec 2005) | 1 line
Changed paths:
   M /trunk/docbook/eug_src/EUG_chapter_advanced.xml

reassembling as enabled by default (the default was changed from disabled to enabled some time ago)
------------------------------------------------------------------------
r16835 | lego | 2005-12-17 15:17:58 -0600 (Sat, 17 Dec 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-tcap.c

remove // comments


------------------------------------------------------------------------
r16834 | lego | 2005-12-17 10:55:45 -0600 (Sat, 17 Dec 2005) | 5 lines
Changed paths:
   M /trunk/asn1/camel/packet-camel-template.c
   M /trunk/asn1/gsmmap/packet-gsm_map-template.c
   M /trunk/asn1/inap/packet-inap-template.c
   M /trunk/asn1/tcap/packet-tcap-template.c
   M /trunk/asn1/tcap/packet-tcap-template.h
   M /trunk/epan/dissectors/packet-ansi_map.c
   M /trunk/epan/dissectors/packet-camel.c
   M /trunk/epan/dissectors/packet-camel.h
   M /trunk/epan/dissectors/packet-gsm_map.c
   M /trunk/epan/dissectors/packet-inap.c
   M /trunk/epan/dissectors/packet-sccp.c
   M /trunk/epan/dissectors/packet-tcap.c
   M /trunk/epan/dissectors/packet-tcap.h

Have tcap subdissectors registering using functions provided by tcap and tcap manage ssn registration.

In packet-sccp.c avoid not having a binding.


------------------------------------------------------------------------
r16833 | ulfl | 2005-12-16 18:19:47 -0600 (Fri, 16 Dec 2005) | 3 lines
Changed paths:
   M /trunk/capture_loop.c
   M /trunk/capture_opts.c

Win32 bugfix: peeking the signal_pipe at capture_loop start seems to be unreliable

Instead, simply keep the signal_pipe setting directly from the command line which is working well
------------------------------------------------------------------------
r16832 | ulfl | 2005-12-16 18:16:37 -0600 (Fri, 16 Dec 2005) | 1 line
Changed paths:
   M /trunk/docbook/developer-guide.xml
   M /trunk/docbook/user-guide.xml

both eug and edg still mentioned Ethereal 0.10.12
------------------------------------------------------------------------
r16831 | sahlberg | 2005-12-16 16:06:52 -0600 (Fri, 16 Dec 2005) | 16 lines
Changed paths:
   A /trunk/epan/dissectors/pidl/srvsvc.idl

add work in progress srvsvc.idl.

This idl file is required by wkssvc.idl since wkssvc references Platform_id


There are still some minor changes required for pidl to prettify the output for both wkssvc and srvsvc before these two dissectors should be used.



note that this idl is significantly different from the samba4 idl since it contains all the additional functions and structures the handwritten dissector has that is lacking from s4 idl.

it is expected that s4 will take up the authorative version of this idl soon so there will only be one master copy of this idl.




------------------------------------------------------------------------
r16830 | etxrab | 2005-12-16 14:58:50 -0600 (Fri, 16 Dec 2005) | 1 line
Changed paths:
   M /trunk/packaging/nsis/ethereal.nsi

Include the latest diameter.xml files
------------------------------------------------------------------------
r16829 | etxrab | 2005-12-16 14:54:24 -0600 (Fri, 16 Dec 2005) | 1 line
Changed paths:
   M /trunk/gtk/flow_graph.c

modify the tool tip "Nodes in the diagram are identified with network source and destination address (like SS7 point codes)" remove the section between parenthesis
------------------------------------------------------------------------
r16828 | etxrab | 2005-12-16 14:37:45 -0600 (Fri, 16 Dec 2005) | 11 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ospf.c

A patch for packet-ospf.c is attached:
 - Fix the handling of the DN-bit of options field.
 - Add a new function dissect_ospf_bitfield() to dissect a bitfield
   such as options, flags. The following functions are merged by
   using this function.
     - dissect_ospf_lls_extended_options()
     - dissect_ospf_dbd()
     - dissect_ospf_options()
     - dissect_ospf_v3_prefix_options()
 - dissect the flags and prefix-options bitfield.

------------------------------------------------------------------------
r16827 | etxrab | 2005-12-16 14:36:09 -0600 (Fri, 16 Dec 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mtp3.c
   M /trunk/epan/dissectors/packet-mtp3.h

As per Olivier Jacques mail, 
"preferences/mtp3 must be changed accordingly (it is explicitly indicated that the "network address format" is ..."
Change the text and som names.
------------------------------------------------------------------------
r16826 | gerald | 2005-12-16 11:53:44 -0600 (Fri, 16 Dec 2005) | 9 lines
Changed paths:
   M /trunk/Makefile.nmake
   M /trunk/util.c

If "CLIENTNAME" is set (which indicates that we're using RDP) use
"not tcp port 3389" instead of "not ip host $CLIENTNAME", since it
seems to be more reliable.

Make sure we remove dumpcap.obj when we clean.

This also tests the content-type "text/plain; charset=utf-8" for commit
messages.  Maybe Stig B's name will show up correctly now.

------------------------------------------------------------------------
r16825 | jmayer | 2005-12-16 11:52:05 -0600 (Fri, 16 Dec 2005) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-3com-njack.c

Some updates
------------------------------------------------------------------------
r16824 | jmayer | 2005-12-16 11:05:37 -0600 (Fri, 16 Dec 2005) | 10 lines
Changed paths:
   M /trunk/Makefile.am

Don't link dumpcap against libethereal etc.
It might be, that I've removed too many options:

in that case, replace
@PCAP_LIBS@
by some of
@PCAP_LIBS@ @SOCKET_LIBS@ @NSL_LIBS@

and let me know which of the options are needed

------------------------------------------------------------------------
r16823 | jmayer | 2005-12-16 10:40:31 -0600 (Fri, 16 Dec 2005) | 7 lines
Changed paths:
   M /trunk/manuf
   M /trunk/wka.tmpl

Jaap Keuter:
I'm seeing a variant of the registered Ethernet address for MS NLB
multicast being used.

Changed to remove "multicast" from the name as it isn't a multicast
address.

------------------------------------------------------------------------
r16822 | etxrab | 2005-12-16 10:37:03 -0600 (Fri, 16 Dec 2005) | 25 lines
Changed paths:
   M /trunk/asn1/camel/packet-camel-template.c
   M /trunk/editcap.c
   M /trunk/epan/dissectors/packet-camel.c
   M /trunk/epan/dissectors/packet-ieee80211.c
   M /trunk/epan/dissectors/packet-lldp.c

From Jaap Keuter:
- Editcap 
Mikko Tiihonen filed bug 379 including a patch for editcap. This wasn't picked up so far. I've ported the patch to svn 16820 and included a documentation patch.

-packet-ieee80211.c
Radek Vokal of RedHat filed a bug found by Vladimir Kondratiev of Intel in the 802.11 dissector. Radek provided a sample capture and Vladimir a oneliner patch. I've ported the patch to svn 16820 and tested it against the provided capture. Works well.


-From Kan Sasaki
A patch for packet-ospf.c is attached:
 - Fix the handling of the DN-bit of options field.
 - Add a new function dissect_ospf_bitfield() to dissect a bitfield
   such as options, flags. The following functions are merged by
   using this function.
     - dissect_ospf_lls_extended_options()
     - dissect_ospf_dbd()


     - dissect_ospf_options()
     - dissect_ospf_v3_prefix_options()
 - dissect the flags and prefix-options bitfield.

- lldp Bugfix Bug 596  LLDP TIA Network Policy Decode is not correct 

- Camel make it possible to dissect based on OID.
------------------------------------------------------------------------
r16821 | etxrab | 2005-12-16 10:31:46 -0600 (Fri, 16 Dec 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dccp.c

From Jaap Keuter:
Bug 373 complains about a field type. Trivial fix attached.

------------------------------------------------------------------------
r16820 | ulfl | 2005-12-16 02:20:22 -0600 (Fri, 16 Dec 2005) | 6 lines
Changed paths:
   M /trunk/config.nmake

Declare the GTK 2.6 as the official mainline now!!!

(as per mailing list discussions and mainly as the Gimp windows port also uses this version)


fix the NSIS install settings for GTK 2.6 of GTK-Wimp
------------------------------------------------------------------------
r16819 | ulfl | 2005-12-16 01:43:24 -0600 (Fri, 16 Dec 2005) | 1 line
Changed paths:
   M /trunk/dumpcap.c
   M /trunk/log.h
   M /trunk/tethereal.c

some minor fixes: logging and comments fixed
------------------------------------------------------------------------
r16818 | etxrab | 2005-12-16 01:37:28 -0600 (Fri, 16 Dec 2005) | 12 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ospf.c

From Michael Rozhavsky:

This patch adds support for draft-nguyen-ospf-lls-05.txt, draft-nguyen-ospf-oob-resync-05.txt and draft-nguyen-ospf-restart-05.txt. These are an alternative way to do OSPF graceful restart.

These drafts are implemented by cisco and several other vendors that want to interoperate with cisco. My patch adds a dissectors for LLS TLVs.

I had to modify the existing ospf dissector as it assumed that all the data after IP header is OSPF packet. This is not true anymore and probably was not true before as well.

Also please find attached an example of OSPF packets with LLS data blocks.
-- 
   
   
------------------------------------------------------------------------
r16817 | etxrab | 2005-12-16 01:20:13 -0600 (Fri, 16 Dec 2005) | 11 lines
Changed paths:
   M /trunk/gtk/flow_graph.c

From Jacques, Olivier (OCBU-Test Infra)

> here is a small patch for the flow graph feature. It allows 
> to have SS7 nodes (network indicator/point codes) to be 
> recognized as nodes in the graphs.
> The patch consists in using "pinfo->net_src" or 
> "pinfo->net_dst" instead of "pinfo->src" or "pinfo->dst".
> I did some tests with other IP protocols and behavior was 
> still the same as before. But I do not guaranty that it 
> doesn't have some bad side effects for some protocols.

------------------------------------------------------------------------
r16816 | etxrab | 2005-12-16 01:18:52 -0600 (Fri, 16 Dec 2005) | 10 lines
Changed paths:
   M /trunk/epan/oid_resolv.c

From Grame Lunt:
The new oid_resolv.c OID handling is more strict on what an OID is. It now requires the OID string representation to be a sequence of dotted integers - particularly when looking up an associated name.

The X.411 and DISP dissectors have [ab]used the OID handling to support the dissection of x.411 standard-extensions (which are indicated by a single
integer) and where the OID is sufficient by itself (disp). Have a look at x411.cnf and disp.cnf

Attached is a small patch to restore the previous functionality in the new handling. If this is something you don't wish to continue to support in the OID handling, then I'll look at alternate mechanisms.

Graeme

------------------------------------------------------------------------
r16815 | etxrab | 2005-12-16 01:05:50 -0600 (Fri, 16 Dec 2005) | 1 line
Changed paths:
   M /trunk/asn1/h248/Makefile.nmake
   M /trunk/asn1/h248/packet-h248-template.c
   M /trunk/asn1/tcap/packet-tcap-template.c
   M /trunk/epan/dissectors/packet-h248.c
   M /trunk/epan/dissectors/packet-h248.h
   M /trunk/epan/dissectors/packet-isup.c
   M /trunk/epan/dissectors/packet-m3ua.c
   M /trunk/epan/dissectors/packet-sccp.c
   M /trunk/epan/dissectors/packet-sua.c
   M /trunk/epan/dissectors/packet-tcap.c
   M /trunk/epan/dissectors/packet-tcap.h

Get rid of duplicted dissector tables for MTP3 Service indicator and SCCP ssn:s
------------------------------------------------------------------------
r16814 | etxrab | 2005-12-16 00:47:22 -0600 (Fri, 16 Dec 2005) | 12 lines
Changed paths:
   M /trunk/asn1/dap/packet-dap-template.c
   M /trunk/asn1/dop/dop.asn
   M /trunk/asn1/h225/Makefile.nmake
   M /trunk/asn1/tcap/Makefile.nmake
   M /trunk/epan/dissectors/packet-dap.c
   M /trunk/epan/dissectors/packet-dap.h
   M /trunk/epan/dissectors/packet-disp.c
   M /trunk/epan/dissectors/packet-disp.h
   M /trunk/epan/dissectors/packet-dop.c
   M /trunk/epan/dissectors/packet-dop.h
   M /trunk/epan/dissectors/packet-ros.c
   M /trunk/epan/dissectors/packet-ros.h
   M /trunk/epan/dissectors/packet-rtse.c
   M /trunk/epan/dissectors/packet-rtse.h
   M /trunk/epan/dissectors/packet-x411.c
   M /trunk/epan/dissectors/packet-x411.h
   M /trunk/epan/dissectors/packet-x509if.c
   M /trunk/epan/dissectors/packet-x509if.h
   M /trunk/epan/dissectors/packet-x509sat.c
   M /trunk/epan/dissectors/packet-x509sat.h

From Graeme Lunt:
* DOP - This has now been successfully tested and so is now enabled by default and workaround code removed. 
Also now uses the correct EXPORTs from the other modules/dissectors.

* X509SAT - Most of the selected attributes are now supported in addition to the DirectoryString syntax attributes. This includes restoring the correct DirectoryString syntax and also providing the basic syntaxes (e.g. OBJECT IDENTIFIER, PrintableString). The latter requires a sed line in the Makefile which I assume should be OK? Not all the SAT can be defined in x509sat - so some have been included in x509if and x509af - though x509sat.cnf contains the master list and references the other dissectors where appropriate.

(I still prefer a syntax registration approach but I don't think that is going to be agreed in the short term.)

* X509IF - a mechanism to register some formating, based upon the hf_index, that is used in the cnf file.

* A couple of fixes identified by Stig.

------------------------------------------------------------------------
r16813 | sahlberg | 2005-12-15 18:32:12 -0600 (Thu, 15 Dec 2005) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-clnp.c
   M /trunk/epan/dissectors/packet-frame.c
   M /trunk/epan/dissectors/packet-frame.h

From Stig B
Patch for COTP reassembly.

There does not seem to be any reasonable or cleaner way to fix COTP 
reassembly than adding the frame.[ch] patch.


------------------------------------------------------------------------
r16812 | sahlberg | 2005-12-15 17:17:01 -0600 (Thu, 15 Dec 2005) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ip.c

from Jaap K

fix for bug 306


------------------------------------------------------------------------
r16811 | sahlberg | 2005-12-15 16:54:33 -0600 (Thu, 15 Dec 2005) | 16 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mbtcp.c

update to modbus/tcp

Make the dissector new-style and add simple (better than nothing) heuristics so that it can reject some packets that are obviously not modbus.

change the constants to upper case


 the horrors:
replace two instances where tvb_memcpy()  were used to read straight into a structure to instead read the structure field by field using tvb_get_...()
This may allow the modbus dissector to actually work.






------------------------------------------------------------------------
r16810 | gerald | 2005-12-15 13:12:51 -0600 (Thu, 15 Dec 2005) | 2 lines
Changed paths:
   M /trunk/config.nmake
   M /trunk/packaging/nsis/Makefile.nmake
   M /trunk/packaging/nsis/ethereal.nsi

Fix themeing for GTK+ 2.8.  This hasn't been tested under 2.6 or 2.4.

------------------------------------------------------------------------
r16809 | gerald | 2005-12-14 21:36:17 -0600 (Wed, 14 Dec 2005) | 2 lines
Changed paths:
   M /trunk/config.nmake
   M /trunk/packaging/nsis/Makefile.nmake
   M /trunk/packaging/nsis/ethereal.nsi

Make sure we install the libpng and cairo DLLs if needed.

------------------------------------------------------------------------
r16808 | guy | 2005-12-14 20:44:26 -0600 (Wed, 14 Dec 2005) | 9 lines
Changed paths:
   M /trunk/epan/dissectors/packet-tipc.c

Use the reported length, not the length, to figure out how much to
dissect (so that we report a packet cut short by the snapshot length).

Get rid of an unused variable..

As we restore "pinfo->fragmented" from "save_fragmented" regardless of
whether we're defragmenting or not, we have to save its previous value
in "save_fragmented" regardless of whether we're defragmenting or not.

------------------------------------------------------------------------
r16807 | ulfl | 2005-12-14 18:48:59 -0600 (Wed, 14 Dec 2005) | 4 lines
Changed paths:
   M /trunk/capture_sync.c

remove the setting of no longer required command line options:

-H (Hide capture info dialog)
-m (font to use)
------------------------------------------------------------------------
r16806 | ulfl | 2005-12-14 18:46:23 -0600 (Wed, 14 Dec 2005) | 1 line
Changed paths:
   M /trunk/gtk/main.c

remove a missplaced comment
------------------------------------------------------------------------
r16805 | ulfl | 2005-12-14 18:45:29 -0600 (Wed, 14 Dec 2005) | 3 lines
Changed paths:
   M /trunk/dumpcap.c

use capture_opts_trim_iface() instead of duplicated code

various minor code cleanup
------------------------------------------------------------------------
r16804 | etxrab | 2005-12-14 15:46:56 -0600 (Wed, 14 Dec 2005) | 4 lines
Changed paths:
   M /trunk/asn1/camel/camel.cnf
   M /trunk/epan/dissectors/packet-camel.c

Fix Bug 628  Bugzilla 2.18.3  
CAMEL - Connect decoding error 
- Calledparty number included first two octets

------------------------------------------------------------------------
r16803 | etxrab | 2005-12-14 15:40:04 -0600 (Wed, 14 Dec 2005) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-tipc.c

Add possibility to try to dissect IP over TIPC.
------------------------------------------------------------------------
r16802 | gerald | 2005-12-14 15:19:39 -0600 (Wed, 14 Dec 2005) | 2 lines
Changed paths:
   M /trunk/Makefile.nmake
   M /trunk/config.nmake
   M /trunk/packaging/nsis/Makefile.nmake
   M /trunk/packaging/nsis/ethereal.nsi
   M /trunk/tools/win32-setup.sh

Add support for GLib/GTK+ 2.8.  Point to the latest tag.

------------------------------------------------------------------------
r16801 | etxrab | 2005-12-14 15:14:57 -0600 (Wed, 14 Dec 2005) | 8 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/dissectors/packet-udp.c
   M /trunk/epan/dissectors/packet-udp.h

From Jaap Keuter:
> Two patch files are attached adding UDP-Lite dissection to the UDP 
> dissector. Wiki page is available at the normal location, including 
> sample captures courtesy of Gerrit Renker of the University of 
> Aberdeen Electronics Research Group. The patch has been tested with 
> both the sample captures and Fuzz test.

And add Marc Petit-Huguenin to AUTHORS
------------------------------------------------------------------------
r16800 | etxrab | 2005-12-14 15:04:42 -0600 (Wed, 14 Dec 2005) | 1 line
Changed paths:
   M /trunk/asn1/ros/Makefile.nmake
   M /trunk/asn1/x509sat/Makefile.nmake

Add makefiles
------------------------------------------------------------------------
r16799 | etxrab | 2005-12-14 15:02:56 -0600 (Wed, 14 Dec 2005) | 15 lines
Changed paths:
   M /trunk/asn1/dap/dap-exp.cnf
   M /trunk/asn1/dap/dap.asn
   M /trunk/asn1/dap/dap.cnf
   M /trunk/asn1/dap/packet-dap-template.c
   M /trunk/asn1/disp/disp.asn
   M /trunk/asn1/disp/disp.cnf
   M /trunk/asn1/disp/packet-disp-template.c
   M /trunk/asn1/disp/packet-disp-template.h
   M /trunk/asn1/dop/dop-exp.cnf
   M /trunk/asn1/dop/dop.cnf
   M /trunk/asn1/dop/packet-dop-template.c
   M /trunk/asn1/dsp/dsp.asn
   M /trunk/asn1/ros/packet-ros-template.c
   M /trunk/asn1/rtse/packet-rtse-template.c
   M /trunk/asn1/x411/Makefile
   M /trunk/asn1/x509if/packet-x509if-template.c
   M /trunk/asn1/x509if/packet-x509if-template.h
   M /trunk/asn1/x509if/x509if.cnf
   M /trunk/asn1/x509sat/Makefile
   M /trunk/asn1/x509sat/SelectedAttributeTypes.asn
   M /trunk/asn1/x509sat/x509sat-exp.cnf
   M /trunk/asn1/x509sat/x509sat.cnf

From Grame Lunt:
Attached is a patch that updates - 

* DOP - This has now been successfully tested and so is now enabled by default and workaround code removed. 
Also now uses the correct EXPORTs from the other modules/dissectors.

* X509SAT - Most of the selected attributes are now supported in addition to the DirectoryString syntax attributes. This includes restoring the correct DirectoryString syntax and also providing the basic syntaxes (e.g. OBJECT IDENTIFIER, PrintableString). The latter requires a sed line in the Makefile which I assume should be OK? Not all the SAT can be defined in x509sat - so some have been included in x509if and x509af - though x509sat.cnf contains the master list and references the other dissectors where appropriate.

(I still prefer a syntax registration approach but I don't think that is going to be agreed in the short term.)

* X509IF - a mechanism to register some formating, based upon the hf_index, that is used in the cnf file.

* A couple of fixes identified by Stig.

Note the patc for dop did not apply don't regenerate dissectors yet.
------------------------------------------------------------------------
r16798 | etxrab | 2005-12-14 14:45:15 -0600 (Wed, 14 Dec 2005) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ber.c

From Graeme Lunt:
Here is a patch for packet-ber.c that only includes the upgraded dissect_unknown_ber()
------------------------------------------------------------------------
r16797 | etxrab | 2005-12-14 14:43:39 -0600 (Wed, 14 Dec 2005) | 10 lines
Changed paths:
   M /trunk/epan/dissectors/packet-stun.c

From Marc Petit-Huguenin

This is a patch that add support for the latest drafts[1] in the STUN dissectors. I choose to add TURN directly in the STUN dissector instead of creating a new dissector because of the decision at the latest IETF meeting[2] to redefine TURN as an use case of STUN.


[1] ftp://ftp.rfc-editor.org/in-notes/internet-drafts/draft-ietf-behave-rfc3489bis-02.txt
ftp://ftp.rfc-editor.org/in-notes/internet-drafts/draft-rosenberg-midcom-turn-08.txt
ftp://ftp.rfc-editor.org/in-notes/internet-drafts/draft-camarillo-midcom-turn-ipv6-00.txt
[2] http://www3.ietf.org/proceedings/05nov/minutes/behave.txt

------------------------------------------------------------------------
r16796 | etxrab | 2005-12-14 14:01:21 -0600 (Wed, 14 Dec 2005) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-mtp3.c
   M /trunk/epan/dissectors/packet-sccp.c

Use src and dst instead of net_src.
------------------------------------------------------------------------
r16795 | lego | 2005-12-14 03:50:11 -0600 (Wed, 14 Dec 2005) | 3 lines
Changed paths:
   M /trunk/epan/radius_dict.l

Close the dictionary files after reading from them.


------------------------------------------------------------------------
r16794 | ulfl | 2005-12-14 03:43:16 -0600 (Wed, 14 Dec 2005) | 1 line
Changed paths:
   M /trunk/docbook/eug_src/EUG_chapter_customize.xml

update Ethereal command line options -D and -i
------------------------------------------------------------------------
r16793 | ulfl | 2005-12-14 03:16:30 -0600 (Wed, 14 Dec 2005) | 6 lines
Changed paths:
   M /trunk/doc/ethereal.pod

document latest command line changes:

new: -D to list interfaces
changed: -i will also accept indices (rather than complete names only)

text copied from the tethereal.pod file
------------------------------------------------------------------------
r16792 | guy | 2005-12-14 01:33:07 -0600 (Wed, 14 Dec 2005) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-isup.c

"a & b == c" is, in C, parsed as "a & (b == c)" - and if b and c are the
same, and have only one bit set, "(a & b) == c", which is what is
intended, is the same as "a & b".

In addition, we don't want to do desegmentation if "isup_apm_desegment"
isn't set, so that test should be ANDed with the other two tests.

------------------------------------------------------------------------
r16791 | guy | 2005-12-14 01:29:38 -0600 (Wed, 14 Dec 2005) | 14 lines
Changed paths:
   M /trunk/capture-pcap-util.c
   M /trunk/capture-pcap-util.h
   M /trunk/capture_loop.c
   M /trunk/capture_loop.h
   M /trunk/capture_ui_utils.c
   M /trunk/capture_ui_utils.h
   M /trunk/gtk/capture_dlg.c
   M /trunk/gtk/capture_info_dlg.c
   M /trunk/tethereal.c

Constify a bunch of arguments and variables, to squelch compiler
warnings.

Include "wiretap/libpcap.h" in "capture_loop.h", to get its declarations
of data structures for headers in libpcap files.  This lets us remove
the includes of "wiretap/libpcap.h from files including
"capture_loop.h".

Make "log_func_ignore()" in "tethereal.c" static, and declare some of
its arguments unused.  Also get rid of an unused variable.

Include <pcap.h> before including "wiretap/wtap-capture.h", to declare
"struct pcap_pkthdr".

------------------------------------------------------------------------
r16790 | ulfl | 2005-12-13 19:45:09 -0600 (Tue, 13 Dec 2005) | 1 line
Changed paths:
   M /trunk/gtk/capture_info_dlg.c

hmmm, the include sequence might be important too ...
------------------------------------------------------------------------
r16789 | ulfl | 2005-12-13 18:10:23 -0600 (Tue, 13 Dec 2005) | 1 line
Changed paths:
   M /trunk/gtk/capture_info_dlg.c

add missing include
------------------------------------------------------------------------
r16788 | ulfl | 2005-12-13 17:15:20 -0600 (Tue, 13 Dec 2005) | 1 line
Changed paths:
   A /trunk/test
   A /trunk/test/README.test
   A /trunk/test/config.sh
   A /trunk/test/dhcp.pcap
   A /trunk/test/suite-capture.sh
   A /trunk/test/suite-clopts.sh
   A /trunk/test/test-backend.sh
   A /trunk/test/test.sh

add a new directory 'test', currently containing an alpha test (using some simple bash scripts) of the ethereal/tethereal command line parameters. See the file README.test for details.
------------------------------------------------------------------------
r16787 | ulfl | 2005-12-13 16:48:58 -0600 (Tue, 13 Dec 2005) | 9 lines
Changed paths:
   M /trunk/Makefile.common
   M /trunk/capture_loop.c
   M /trunk/capture_loop.h
   M /trunk/capture_opts.c
   M /trunk/capture_opts.h
   M /trunk/dumpcap.c
   M /trunk/gtk/main.c
   M /trunk/tethereal.c

HUGE STEP (hopefully toward the right direction):
remove a lot of redundant code from tethereal and use (move) stuff from capture_loop.c instead.

concentrate common capture related code in capture_opts.c, e.g. trying to find the right interface to capture from (command line option, preference, first usable) instead of duplicating this code over several files.

remove redundant code from dumpcap.c

this also implements command line option -D (and indexed interfaces at -i) for Wireshark and Dumpcap (as we have it in Tethereal already for a while)

------------------------------------------------------------------------
r16786 | ulfl | 2005-12-13 16:35:28 -0600 (Tue, 13 Dec 2005) | 1 line
Changed paths:
   M /trunk/capture_sync.c

we don't use the command line option -W any longer, remove it from a comment
------------------------------------------------------------------------
r16785 | ulfl | 2005-12-13 16:33:55 -0600 (Tue, 13 Dec 2005) | 1 line
Changed paths:
   M /trunk/capture_ui_utils.c
   M /trunk/capture_ui_utils.h

make get_if_name() parameter if_text const, it's not changed inside
------------------------------------------------------------------------
r16784 | lego | 2005-12-13 16:08:37 -0600 (Tue, 13 Dec 2005) | 3 lines
Changed paths:
   M /trunk/plugins/mate/mate_grammar.lemon

we are opening the file for writing....


------------------------------------------------------------------------
r16783 | lego | 2005-12-13 16:07:09 -0600 (Tue, 13 Dec 2005) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-sccp.c

handle sccp connections.
(first step towards RANAP analysis).



------------------------------------------------------------------------
r16782 | lego | 2005-12-13 16:04:02 -0600 (Tue, 13 Dec 2005) | 3 lines
Changed paths:
   M /trunk/asn1/tcap/packet-tcap-template.c
   M /trunk/epan/dissectors/packet-tcap.c

Avoid the default sccp.ssn range to overwrite sccp.ssns of other dissectors.


------------------------------------------------------------------------
r16781 | etxrab | 2005-12-13 15:14:54 -0600 (Tue, 13 Dec 2005) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-isup.c
   M /trunk/epan/dissectors/packet-m3ua.c

Change reassembly to include first empty segment, check if SLR exists.
Change pinfo->src/dst to use SS7 address for reassembly to use the correct key.
------------------------------------------------------------------------
r16780 | gerald | 2005-12-13 11:00:03 -0600 (Tue, 13 Dec 2005) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ncp2222.inc

Throw an exception if we have an invalid offset.  Fixes bug 585.

------------------------------------------------------------------------
r16779 | guy | 2005-12-13 04:59:33 -0600 (Tue, 13 Dec 2005) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-isup.c

Fix some bit mask tests - & has lower priority than !=, so "a & b != c"
means "a & (b != c)", not "(a & b) != c".

Put in a comment noting a potential problem with defragmentation,
pointed out by a compiler warning that apm_Segmentation_local_ref might
not be set before it's used.

------------------------------------------------------------------------
r16778 | guy | 2005-12-13 04:54:11 -0600 (Tue, 13 Dec 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-3com-njack.c

Escape question marks when they could be interpreted as part of a
trigraph.

------------------------------------------------------------------------
r16777 | guy | 2005-12-13 04:09:52 -0600 (Tue, 13 Dec 2005) | 2 lines
Changed paths:
   M /trunk/epan/libethereal.def

Add tvb_fake_unicode().

------------------------------------------------------------------------
r16776 | jmayer | 2005-12-13 03:30:09 -0600 (Tue, 13 Dec 2005) | 11 lines
Changed paths:
   M /trunk/tools/pidl/lib/Parse/Pidl/Ethereal/Conformance.pm
   M /trunk/tools/pidl/lib/Parse/Pidl/Ethereal/NDR.pm

Update from samba tree revision 12185 to 12205
============================ Samba log start ============
------------------------------------------------------------------------
r12205 | jelmer | 2005-12-13 02:56:04 +0100 (Tue, 13 Dec 2005) | 2 lines

Support 'TFS' command in conformance files

------------------------------------------------------------------------
============================ Samba log end ==============


------------------------------------------------------------------------
r16775 | sahlberg | 2005-12-13 01:53:52 -0600 (Tue, 13 Dec 2005) | 4 lines
Changed paths:
   A /trunk/epan/dissectors/pidl/wkssvc.cnf
   M /trunk/epan/dissectors/pidl/wkssvc.idl

update the work-in-progress pidl generated wkssvc dissector and add a conformance file using the new nice TFS conformance file directive



------------------------------------------------------------------------
r16774 | sahlberg | 2005-12-13 00:36:30 -0600 (Tue, 13 Dec 2005) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dnp.c

swap Trip/Close as per bug 579



------------------------------------------------------------------------
r16773 | gerald | 2005-12-12 21:48:26 -0600 (Mon, 12 Dec 2005) | 9 lines
Changed paths:
   M /trunk/asn1/h248/h248.cnf
   M /trunk/epan/dissectors/packet-h248.c
   M /trunk/tools/asn2eth.py

asn2eth.py:

Catch a TypeError that gets thrown if we don't use any conversion
specifiers during string formatting.

H.248:

Don't dereference a null pointer.  Fixes bug 626.

------------------------------------------------------------------------
r16772 | ulfl | 2005-12-12 20:09:14 -0600 (Mon, 12 Dec 2005) | 3 lines
Changed paths:
   M /trunk/gtk/main.c

We should really do quit Ethereal if user asked us to do so with the -Q option!

Update the window title, right after the fixed capture finished. This might be required if the loading of the capture file afterwards just fails, leaving the title unchanged.
------------------------------------------------------------------------
r16771 | ulfl | 2005-12-12 19:17:36 -0600 (Mon, 12 Dec 2005) | 1 line
Changed paths:
   M /trunk/capture_info.c

don't try to close wtap, if we couldn't load the wiretap file
------------------------------------------------------------------------
r16770 | jmayer | 2005-12-12 17:38:04 -0600 (Mon, 12 Dec 2005) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-3com-njack.c

Convert to new style dissector (hopefully done right)
------------------------------------------------------------------------
r16769 | lego | 2005-12-12 17:23:32 -0600 (Mon, 12 Dec 2005) | 4 lines
Changed paths:
   M /trunk/plugins/mate/mate_grammar.lemon
   M /trunk/plugins/mate/mate_parser.l
   M /trunk/plugins/mate/mate_runtime.c
   M /trunk/plugins/mate/mate_setup.c
   M /trunk/plugins/mate/packet-mate.c

- add Debug and Default declarations.
- supress unwanted console printouts.


------------------------------------------------------------------------
r16768 | jmayer | 2005-12-12 17:14:41 -0600 (Mon, 12 Dec 2005) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-3com-njack.c

Dissect type 0x0c as 'remove tag' flag
------------------------------------------------------------------------
r16767 | ulfl | 2005-12-12 16:29:00 -0600 (Mon, 12 Dec 2005) | 5 lines
Changed paths:
   M /trunk/docbook/edg_src/EDG_chapter_tools.xml

Add a note that the Win32 tool recommendations should be strictly followed.

Change tool headers: "UNIX:" -> "UNIX or Win32 Cygwin:"

Update output of verify_tools target
------------------------------------------------------------------------
r16766 | gerald | 2005-12-12 10:49:49 -0600 (Mon, 12 Dec 2005) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-juniper.c

Use "guint" instead of "u_int".

------------------------------------------------------------------------
r16765 | etxrab | 2005-12-12 09:17:53 -0600 (Mon, 12 Dec 2005) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-isup.c

Reassmble apm messages.
------------------------------------------------------------------------
r16764 | etxrab | 2005-12-12 04:28:57 -0600 (Mon, 12 Dec 2005) | 8 lines
Changed paths:
   M /trunk/epan/dissectors/packet-juniper.c

From Hannes Gredler

-add codepoint to name resolution for Juniper IFMT, IFLE extension TLVs
-bugfix: DLT_JUNIPER_PPP, correct the calculate offset for PPP payload
-bugfix: DLT_JUNIPER_CHDLC, add CHDLC handler
-bugfix: add a more flexible TLV value extraction function which
   does not bail if the assumed TLV length does not match

------------------------------------------------------------------------
r16763 | guy | 2005-12-12 04:15:56 -0600 (Mon, 12 Dec 2005) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/pidl/atsvc.idl
   M /trunk/epan/dissectors/pidl/dssetup.idl

OK, if we're not going to have our "idl_types.h" different from Samba's,
we have to put the definition of "unistr" as "[string] wchar_t *" into
the IDL files that use "unistr".

------------------------------------------------------------------------
r16762 | lego | 2005-12-11 19:32:31 -0600 (Sun, 11 Dec 2005) | 3 lines
Changed paths:
   M /trunk/plugins/mate/mate_setup.c

Avoid to crash if we are given an unexistent field.


------------------------------------------------------------------------
r16761 | lego | 2005-12-11 19:27:51 -0600 (Sun, 11 Dec 2005) | 4 lines
Changed paths:
   M /trunk/plugins/mate/mate_grammar.lemon

Done is not needed anymore; 
in Pdus transforms go before Criteria (because they are evaluated before)


------------------------------------------------------------------------
r16760 | jmayer | 2005-12-11 18:07:54 -0600 (Sun, 11 Dec 2005) | 3 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-3com-njack.c

Dissect the management protocol between 3com Netjack200 devices and the
Windows managment application.

------------------------------------------------------------------------
r16759 | lego | 2005-12-11 17:22:14 -0600 (Sun, 11 Dec 2005) | 3 lines
Changed paths:
   M /trunk/plugins/mate/mate_grammar.lemon

Cleanup the grammar.


------------------------------------------------------------------------
r16758 | jmayer | 2005-12-11 16:54:43 -0600 (Sun, 11 Dec 2005) | 1 line
Changed paths:
   M /trunk/epan/dissectors/pidl/idl_types.h

Updates from samba svn
------------------------------------------------------------------------
r16757 | jmayer | 2005-12-11 16:53:25 -0600 (Sun, 11 Dec 2005) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-skinny.c

Start the function name on a new line to make it easier to search
------------------------------------------------------------------------
r16756 | jmayer | 2005-12-11 16:52:20 -0600 (Sun, 11 Dec 2005) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dtp.c

Port some information from yersinia
(http://yersinia.sourceforge.net/index.html)
by Alfredo Andres and David Barroso. There's more information to be put
into Ethereal but it's a start.

------------------------------------------------------------------------
r16755 | sahlberg | 2005-12-11 16:29:39 -0600 (Sun, 11 Dec 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb.c

implement SMB_FILE_ALL_INFO properly once and for all


------------------------------------------------------------------------
r16754 | guy | 2005-12-10 16:42:19 -0600 (Sat, 10 Dec 2005) | 10 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc-atsvc.c
   M /trunk/epan/dissectors/packet-dcerpc-dssetup.c
   M /trunk/epan/dissectors/packet-dcerpc-initshutdown.c
   M /trunk/epan/dissectors/packet-dcerpc-winreg.c
   M /trunk/epan/dissectors/pidl/idl_types.h
   M /trunk/epan/dissectors/pidl/packet-dcerpc-atsvc.c
   M /trunk/epan/dissectors/pidl/packet-dcerpc-initshutdown.c
   M /trunk/epan/dissectors/pidl/packet-dcerpc-winreg.c
   M /trunk/tools/pidl/lib/Parse/Pidl/Ethereal/NDR.pm

The Bitmap routine in lib/Parse/Pidl/Ethereal/NDR.pm in Pidl generates
fields as BASE_DEC; bitmaps are typically displayed in hex in Wireshark,
so it should generate BASE_HEX instead.  (Submitted to
bugzilla.samba.org as bug 3313.)

A couple of the IDL files use "unistr"; define it as "[string] uint16",
so that the resulting dissectors work correctly.

Regenerate dissectors.

------------------------------------------------------------------------
r16753 | ulfl | 2005-12-10 05:14:36 -0600 (Sat, 10 Dec 2005) | 3 lines
Changed paths:
   M /trunk/Makefile.nmake

the verify_tool target should check for /usr/bin/find (I errorneously did changed it a while ago)

add a comment why we should check for exactly that version
------------------------------------------------------------------------
r16752 | sahlberg | 2005-12-09 16:06:38 -0600 (Fri, 09 Dec 2005) | 11 lines
Changed paths:
   M /trunk/epan/emem.c

if passed a NULL string, make se_strdup() return the static string
"<NULL>" instead of dumping.

This allows callers to not have to check if the string is NULL or not.


This fixes bugs 614 615 617 620 621 and 623




------------------------------------------------------------------------
r16751 | etxrab | 2005-12-09 12:02:18 -0600 (Fri, 09 Dec 2005) | 1 line
Changed paths:
   M /trunk/epan/dissectors/Makefile.common

Add packet-nhrp.h
------------------------------------------------------------------------
r16750 | jmayer | 2005-12-09 10:51:56 -0600 (Fri, 09 Dec 2005) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-iuup.c
   M /trunk/epan/dtd.h
   M /trunk/epan/dtd_parse.h
   M /trunk/plugins/mate/examples/pasv_ftp.mate
   M /trunk/plugins/mate/examples/tcp.mate
   M /trunk/plugins/mate/examples/web.mate
   M /trunk/plugins/mate/mate_grammar.lemon
   M /trunk/plugins/tpg/http.tpg
   M /trunk/tools/tpg/V2P.pm
   M /trunk/tools/tpg/tpg.pl
   M /trunk/tools/tpg/tpg.yp

Fix ...$ to : $
------------------------------------------------------------------------
r16749 | jmayer | 2005-12-09 10:46:24 -0600 (Fri, 09 Dec 2005) | 1 line
Changed paths:
   M /trunk/asn1/ldap/Lightweight-Directory-Access-Protocol-V3.asn
   M /trunk/asn1/ldap/Lightweight-Directory-Access-Protocol-V3.asn.orig
   M /trunk/asn1/ldap/Makefile.nmake
   M /trunk/asn1/ldap/README
   M /trunk/asn1/ldap/ldap.cnf
   M /trunk/asn1/ldap/packet-ldap-template.c
   M /trunk/asn1/ldap/packet-ldap-template.h

Add missing propset ...
------------------------------------------------------------------------
r16748 | jmayer | 2005-12-09 10:40:06 -0600 (Fri, 09 Dec 2005) | 1 line
Changed paths:
   M /trunk/epan/make-sminmpec.pl

Maybe Id will work now
------------------------------------------------------------------------
r16747 | jmayer | 2005-12-09 10:24:05 -0600 (Fri, 09 Dec 2005) | 1 line
Changed paths:
   M /trunk/epan/enterprise-numbers

Update enterprise-numbers
------------------------------------------------------------------------
r16746 | etxrab | 2005-12-09 10:19:49 -0600 (Fri, 09 Dec 2005) | 1 line
Changed paths:
   M /trunk/AUTHORS

Add  Deepak Jain as author of Next Hop Resolution Protocol
------------------------------------------------------------------------
r16745 | etxrab | 2005-12-09 10:15:25 -0600 (Fri, 09 Dec 2005) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-tipc.c

Minor bug fixes.
------------------------------------------------------------------------
r16744 | etxrab | 2005-12-09 10:14:42 -0600 (Fri, 09 Dec 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/Makefile.common
   M /trunk/epan/dissectors/packet-gre.c
   A /trunk/epan/dissectors/packet-nhrp.c
   A /trunk/epan/dissectors/packet-nhrp.h
   M /trunk/epan/greproto.h

From: Deepak Jain

changes/addition to support decode for Next Hop Resolution Protocol
------------------------------------------------------------------------
r16743 | jmayer | 2005-12-09 09:56:07 -0600 (Fri, 09 Dec 2005) | 1 line
Changed paths:
   M /trunk/epan/make-sminmpec.pl

propset svn:executable *
------------------------------------------------------------------------
r16742 | jmayer | 2005-12-09 09:53:40 -0600 (Fri, 09 Dec 2005) | 3 lines
Changed paths:
   M /trunk/FAQ
   M /trunk/help/faq.txt
   M /trunk/manuf


Regenerate manuf and FAQ

------------------------------------------------------------------------
r16741 | jmayer | 2005-12-09 09:49:57 -0600 (Fri, 09 Dec 2005) | 5 lines
Changed paths:
   M /trunk/wka.tmpl

Add Cisco-ISL MAC-addresses

Remove IETF-VRRP: This is a generic multicast address, and there are 31
other IP-multicast addresses mapping to the same mac address.

------------------------------------------------------------------------
r16740 | jmayer | 2005-12-09 09:47:50 -0600 (Fri, 09 Dec 2005) | 1 line
Changed paths:
   M /trunk/manuf.tmpl

Whitespace change
------------------------------------------------------------------------
r16739 | jmayer | 2005-12-09 09:46:09 -0600 (Fri, 09 Dec 2005) | 1 line
Changed paths:
   M /trunk/epan/make-sminmpec.pl

Add comment how to regenerate the file
------------------------------------------------------------------------
r16738 | guy | 2005-12-08 21:24:52 -0600 (Thu, 08 Dec 2005) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-MAP_DialoguePDU.c
   M /trunk/epan/dissectors/packet-MAP_DialoguePDU.h

Re-generate one more BER dissector.

------------------------------------------------------------------------
r16737 | guy | 2005-12-08 20:59:36 -0600 (Thu, 08 Dec 2005) | 5 lines
Changed paths:
   M /trunk/doc/tethereal.pod

Repeatedly indicate that "-w" is for writing binary packet data, and
that if you want to send text to a file, just redirect the standard
output.  I've seen at least one message on the Ethereal lists from
somebody who didn't realize that, and I think I've seen more.

------------------------------------------------------------------------
r16736 | guy | 2005-12-08 17:29:21 -0600 (Thu, 08 Dec 2005) | 2 lines
Changed paths:
   M /trunk/asn1/pkixcmp/cmp-exp.cnf
   M /trunk/asn1/x509ce/x509ce-exp.cnf
   M /trunk/asn1/x509if/x509if-exp.cnf
   M /trunk/epan/dissectors/packet-acse.c
   M /trunk/epan/dissectors/packet-acse.h
   M /trunk/epan/dissectors/packet-cdt.c
   M /trunk/epan/dissectors/packet-cdt.h
   M /trunk/epan/dissectors/packet-cmip.c
   M /trunk/epan/dissectors/packet-cmip.h
   M /trunk/epan/dissectors/packet-cmp.c
   M /trunk/epan/dissectors/packet-cmp.h
   M /trunk/epan/dissectors/packet-crmf.c
   M /trunk/epan/dissectors/packet-crmf.h
   M /trunk/epan/dissectors/packet-ess.c
   M /trunk/epan/dissectors/packet-ess.h
   M /trunk/epan/dissectors/packet-ftam.c
   M /trunk/epan/dissectors/packet-ftam.h
   M /trunk/epan/dissectors/packet-ftbp.c
   M /trunk/epan/dissectors/packet-ftbp.h
   M /trunk/epan/dissectors/packet-gnm.c
   M /trunk/epan/dissectors/packet-gnm.h
   M /trunk/epan/dissectors/packet-gsm_map.c
   M /trunk/epan/dissectors/packet-gsm_map.h
   M /trunk/epan/dissectors/packet-gsm_ss.c
   M /trunk/epan/dissectors/packet-gsm_ss.h
   M /trunk/epan/dissectors/packet-h225.c
   M /trunk/epan/dissectors/packet-h225.h
   M /trunk/epan/dissectors/packet-h235.c
   M /trunk/epan/dissectors/packet-h235.h
   M /trunk/epan/dissectors/packet-h450.c
   M /trunk/epan/dissectors/packet-h450.h
   M /trunk/epan/dissectors/packet-inap.c
   M /trunk/epan/dissectors/packet-inap.h
   M /trunk/epan/dissectors/packet-logotypecertextn.c
   M /trunk/epan/dissectors/packet-logotypecertextn.h
   M /trunk/epan/dissectors/packet-mms.c
   M /trunk/epan/dissectors/packet-mms.h
   M /trunk/epan/dissectors/packet-nbap.c
   M /trunk/epan/dissectors/packet-nbap.h
   M /trunk/epan/dissectors/packet-ns_cert_exts.c
   M /trunk/epan/dissectors/packet-ocsp.c
   M /trunk/epan/dissectors/packet-ocsp.h
   M /trunk/epan/dissectors/packet-pkcs1.c
   M /trunk/epan/dissectors/packet-pkcs1.h
   M /trunk/epan/dissectors/packet-pkinit.c
   M /trunk/epan/dissectors/packet-pkinit.h
   M /trunk/epan/dissectors/packet-pkix1explicit.c
   M /trunk/epan/dissectors/packet-pkix1explicit.h
   M /trunk/epan/dissectors/packet-pkix1implicit.c
   M /trunk/epan/dissectors/packet-pkix1implicit.h
   M /trunk/epan/dissectors/packet-pkixproxy.c
   M /trunk/epan/dissectors/packet-pkixproxy.h
   M /trunk/epan/dissectors/packet-pkixqualified.c
   M /trunk/epan/dissectors/packet-pkixqualified.h
   M /trunk/epan/dissectors/packet-pkixtsp.c
   M /trunk/epan/dissectors/packet-pkixtsp.h
   M /trunk/epan/dissectors/packet-pres.c
   M /trunk/epan/dissectors/packet-pres.h
   M /trunk/epan/dissectors/packet-ranap.c
   M /trunk/epan/dissectors/packet-ranap.h
   M /trunk/epan/dissectors/packet-ros.c
   M /trunk/epan/dissectors/packet-ros.h
   M /trunk/epan/dissectors/packet-rtse.c
   M /trunk/epan/dissectors/packet-rtse.h
   M /trunk/epan/dissectors/packet-s4406.c
   M /trunk/epan/dissectors/packet-s4406.h
   M /trunk/epan/dissectors/packet-smrse.c
   M /trunk/epan/dissectors/packet-smrse.h
   M /trunk/epan/dissectors/packet-spnego.c
   M /trunk/epan/dissectors/packet-spnego.h
   M /trunk/epan/dissectors/packet-tcap.c
   M /trunk/epan/dissectors/packet-tcap.h
   M /trunk/epan/dissectors/packet-wlancertextn.c
   M /trunk/epan/dissectors/packet-wlancertextn.h
   M /trunk/epan/dissectors/packet-x509if.c
   M /trunk/epan/dissectors/packet-x509if.h
   M /trunk/epan/dissectors/packet-x509sat.c
   M /trunk/epan/dissectors/packet-x509sat.h

Regenerate with the latest asn2eth, to get FT_OID used, and to add #line.

------------------------------------------------------------------------
r16735 | guy | 2005-12-08 17:21:26 -0600 (Thu, 08 Dec 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ber.c

"get_oid_name()" can return a null pointer; don't try to add the name if
it does.

------------------------------------------------------------------------
r16734 | guy | 2005-12-08 05:27:14 -0600 (Thu, 08 Dec 2005) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ber.c

Clean up indentation.

For OID fields of type FT_STRING, put back the code to append the OID
name.  (Ultimately, we should probably convert them all to type FT_OID.)

------------------------------------------------------------------------
r16733 | guy | 2005-12-08 04:56:51 -0600 (Thu, 08 Dec 2005) | 8 lines
Changed paths:
   M /trunk/epan/dissectors/packet-cigi.c

When checking whether a packet is for a protocol or not, make sure the
bytes you'll be checking are available in the tvbuff first.

Don't require *all* of the packet data to be available, however.

Heuristic dissectors should return TRUE or FALSE.  Non-heuristic
"new-style" dissectors should return the amount of data dissected or 0. 

------------------------------------------------------------------------
r16732 | guy | 2005-12-08 03:56:19 -0600 (Thu, 08 Dec 2005) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-x509ce.c
   M /trunk/epan/dissectors/packet-x509ce.h

Regenerate, so that it handles OIDs as FT_OID.

------------------------------------------------------------------------
r16731 | guy | 2005-12-08 03:05:23 -0600 (Thu, 08 Dec 2005) | 2 lines
Changed paths:
   M /trunk/asn1/dop/packet-dop-template.c
   M /trunk/epan/dissectors/packet-dop.c
   M /trunk/epan/dissectors/packet-dop.h

Squelch a const vs. non-const pointer warning.

------------------------------------------------------------------------
r16730 | guy | 2005-12-08 02:55:15 -0600 (Thu, 08 Dec 2005) | 9 lines
Changed paths:
   M /trunk/epan/dissectors/packet-cigi.c

From Kyle J. Harms:

	Fix a few problems.

	CIGI 1 and 2 are only big-endian; CIGI 3 can be little-endian or
	big-endian.

	Remove the port preferences.

------------------------------------------------------------------------
r16729 | sahlberg | 2005-12-08 01:54:13 -0600 (Thu, 08 Dec 2005) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

add decoding of the share type   that metze found in the tree connect response


prettify tid and uid 


------------------------------------------------------------------------
r16728 | etxrab | 2005-12-08 01:29:15 -0600 (Thu, 08 Dec 2005) | 1 line
Changed paths:
   A /trunk/epan/dissectors/packet-dop.c
   A /trunk/epan/dissectors/packet-dop.h

Also add the new dissectors
------------------------------------------------------------------------
r16727 | etxrab | 2005-12-08 00:43:01 -0600 (Thu, 08 Dec 2005) | 9 lines
Changed paths:
   M /trunk/epan/dissectors/Makefile.common
   M /trunk/epan/dissectors/packet-dap.c
   M /trunk/epan/dissectors/packet-dap.h
   M /trunk/epan/dissectors/packet-disp.c
   M /trunk/epan/dissectors/packet-disp.h
   M /trunk/epan/dissectors/packet-dsp.c
   M /trunk/epan/dissectors/packet-dsp.h
   D /trunk/epan/dissectors/packet-x501.c
   D /trunk/epan/dissectors/packet-x501.h

Commit the actual diissectors:
Log:
 From Grame Lunt:
  updated X.500 dissectors to include DOP support.
 
 The "dop" dissector is the renamed "x501" dissector consequently the asn/x501 directory should be removed. The patch includes the changes to epan/dissectors/Makefile.common to reflect this.
 
 As the DOP dissection is not fully tested, I have disabled it by default for now (like DSP) but it can be enabled by the user.

------------------------------------------------------------------------
r16726 | etxrab | 2005-12-07 17:20:11 -0600 (Wed, 07 Dec 2005) | 8 lines
Changed paths:
   M /trunk/asn1/Makefile.nmake
   A /trunk/asn1/dap/Makefile.nmake
   M /trunk/asn1/dap/packet-dap-template.c
   A /trunk/asn1/disp/Makefile.nmake
   M /trunk/asn1/disp/disp.asn
   M /trunk/asn1/disp/disp.cnf
   M /trunk/asn1/disp/packet-disp-template.c
   A /trunk/asn1/dop
   A /trunk/asn1/dop/Makefile
   A /trunk/asn1/dop/Makefile.nmake
   A /trunk/asn1/dop/dop-exp.cnf
   A /trunk/asn1/dop/dop.asn
   A /trunk/asn1/dop/dop.cnf
   A /trunk/asn1/dop/packet-dop-template.c
   A /trunk/asn1/dop/packet-dop-template.h
   A /trunk/asn1/dsp/Makefile.nmake
   M /trunk/asn1/dsp/dsp-exp.cnf
   M /trunk/asn1/dsp/dsp.asn
   M /trunk/asn1/dsp/dsp.cnf
   M /trunk/asn1/dsp/packet-dsp-template.c
   D /trunk/asn1/x501/Makefile
   D /trunk/asn1/x501/packet-x501-template.c
   D /trunk/asn1/x501/packet-x501-template.h
   D /trunk/asn1/x501/x501-exp.cnf
   D /trunk/asn1/x501/x501.asn
   D /trunk/asn1/x501/x501.cnf

From Grame Lunt:
 updated X.500 dissectors to include DOP support.

The "dop" dissector is the renamed "x501" dissector consequently the asn/x501 directory should be removed. The patch includes the changes to epan/dissectors/Makefile.common to reflect this.

As the DOP dissection is not fully tested, I have disabled it by default for now (like DSP) but it can be enabled by the user.


------------------------------------------------------------------------
r16725 | lego | 2005-12-07 15:08:51 -0600 (Wed, 07 Dec 2005) | 3 lines
Changed paths:
   M /trunk/asn1/h248/packet-h248-template.c
   M /trunk/epan/dissectors/packet-h248.c

Avoid dereferencing pointers to the message, context and transaction object if they have not been created.


------------------------------------------------------------------------
r16724 | etxrab | 2005-12-07 14:07:14 -0600 (Wed, 07 Dec 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-tipc.c
   M /trunk/epan/libethereal.def

libethereal: add capture_enc

tipc: First stab at reassembly, as tipc reasembly is based on reading the message length from the first segmented packet and then just add the bytes received I didn't find a better way of doing it. 
------------------------------------------------------------------------
r16723 | sahlberg | 2005-12-07 07:14:09 -0600 (Wed, 07 Dec 2005) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c
   M /trunk/epan/dissectors/packet-smb2.h

tap the ntlmssp protocol and extract the account/domain names when users authenticate.

If known   put the account name, domain name, host name and which frame the suer authenticated in in an expansion below UID in the SMB2 header




------------------------------------------------------------------------
r16722 | sahlberg | 2005-12-07 07:12:39 -0600 (Wed, 07 Dec 2005) | 11 lines
Changed paths:
   M /trunk/epan/tap.c
   M /trunk/epan/tap.h

new function fetch_tapped_data()

This function can be called from a dissector to fetch (if any) tapped data from a tap.
This can offer an alternative method of passing data between different dissectors much cleaner than the pinfo pollition and private_data design mistake.


The SMB2 dissector uses this method to extract vital data such as Account_Name from the ntlmssp dissector (that is 3 leveld down from smb2)




------------------------------------------------------------------------
r16721 | sahlberg | 2005-12-07 07:09:42 -0600 (Wed, 07 Dec 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ntlmssp.c
   M /trunk/epan/dissectors/packet-ntlmssp.h

make ntlmssp tappable


------------------------------------------------------------------------
r16720 | guy | 2005-12-07 04:44:55 -0600 (Wed, 07 Dec 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-cigi.c

Fix some more scaled-fixed-point values, and have a 2-byte spare field
followed by a 2-byte event count.  Fixes bug 609.

------------------------------------------------------------------------
r16719 | guy | 2005-12-07 03:51:31 -0600 (Wed, 07 Dec 2005) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-pvfs2.c

Fix oroperties, get rid of CRs.

------------------------------------------------------------------------
r16718 | guy | 2005-12-07 03:48:08 -0600 (Wed, 07 Dec 2005) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-cigi.c

Squelch a narrowing-conversion warning.

------------------------------------------------------------------------
r16717 | guy | 2005-12-07 03:38:57 -0600 (Wed, 07 Dec 2005) | 2 lines
Changed paths:
   M /trunk/util.c

Clear up const vs. non-const warnings.

------------------------------------------------------------------------
r16716 | guy | 2005-12-06 21:03:37 -0600 (Tue, 06 Dec 2005) | 9 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rtcp.c

Why duplicate the code of "tvb_get_string()" when you could just use
"tvb_get_string()"?

Why even bother with "tvb_get_string()" when you can just use
"proto_tree_add_item()" with a string item?

Make sure that the prefix in a PRIV item isn't bigger than the item
itself.  That fixes bug 603.

------------------------------------------------------------------------
r16715 | guy | 2005-12-06 19:45:44 -0600 (Tue, 06 Dec 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-cigi.c

Don't export stuff if no other dissector uses it.  "Static unless
otherwise required."

------------------------------------------------------------------------
r16714 | guy | 2005-12-06 19:31:43 -0600 (Tue, 06 Dec 2005) | 11 lines
Changed paths:
   M /trunk/epan/dissectors/packet-cigi.c

Fix indentation.

Gate X and Y Offset are 16-bit integral numbers of degrees, not 32-bit
IEEE floating-point numbers, and the numbers in collision detection
segment definitions and collision detection volume definitions are
16-bit fixed-point numbers, not 32-bit IEEE floating-point numbers;
handle them as such - this fixes bug 605.

When displaying the packet length in the Info column, display the *real*
length, not the sliced length.

------------------------------------------------------------------------
r16713 | guy | 2005-12-06 18:43:17 -0600 (Tue, 06 Dec 2005) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-cigi.c

Unicode considered unnecessary and non-portable.  Avoid using non-ASCII
characters in field names.

Fix indentation, and fix a typo.

------------------------------------------------------------------------
r16712 | sahlberg | 2005-12-06 18:35:16 -0600 (Tue, 06 Dec 2005) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ppp.c
   M /trunk/epan/dissectors/packet-pppoe.c
   M /trunk/epan/dissectors/packet-rtcp.c

From Martin M   various updates and fixes

Hi,Some tiddly changes:pppoe- don't create an empty discovery tags tree when the payload length is 0chap- make chap.value work as a filterable fieldrtcp-append the packet typeto the protocol tree name


------------------------------------------------------------------------
r16711 | sahlberg | 2005-12-06 18:27:17 -0600 (Tue, 06 Dec 2005) | 10 lines
Changed paths:
   M /trunk/epan/dissectors/packet-aim.c

From Jelmer V   AIM bugfix

Hi,

The attached patch fixes the name of the version field, which I
previously mistook for an authorization cookie (which is in fact in a
TLV that follows this field).



------------------------------------------------------------------------
r16710 | guy | 2005-12-06 16:59:30 -0600 (Tue, 06 Dec 2005) | 2 lines
Changed paths:
   M /trunk/asn1/cms/cms.cnf
   M /trunk/asn1/x411/packet-x411-template.c
   M /trunk/asn1/x411/x411.cnf
   M /trunk/asn1/x420/x420.cnf
   M /trunk/asn1/x509af/x509af.cnf
   M /trunk/epan/dissectors/packet-cms.c
   M /trunk/epan/dissectors/packet-cms.h
   M /trunk/epan/dissectors/packet-x411.c
   M /trunk/epan/dissectors/packet-x411.h
   M /trunk/epan/dissectors/packet-x420.c
   M /trunk/epan/dissectors/packet-x420.h
   M /trunk/epan/dissectors/packet-x509af.c
   M /trunk/epan/dissectors/packet-x509af.h

Squelch some compiler const vs. non-const warnings.

------------------------------------------------------------------------
r16709 | guy | 2005-12-06 16:56:37 -0600 (Tue, 06 Dec 2005) | 2 lines
Changed paths:
   M /trunk/capture_info.c
   M /trunk/epan/dissectors/Makefile.common
   M /trunk/epan/dissectors/packet-enc.c
   A /trunk/epan/dissectors/packet-enc.h

Clean up capture_enc(), export it, and use it in the capture window.

------------------------------------------------------------------------
r16708 | guy | 2005-12-06 16:26:10 -0600 (Tue, 06 Dec 2005) | 3 lines
Changed paths:
   M /trunk/epan/oid_resolv.c

The keys for entries in the OID-to-name hash table are g_mallocated, so
we have to g_free them when destroying the hash table.

------------------------------------------------------------------------
r16707 | guy | 2005-12-06 15:07:50 -0600 (Tue, 06 Dec 2005) | 5 lines
Changed paths:
   M /trunk/epan/oid_resolv.c
   M /trunk/epan/oid_resolv.h

Set svn:keywords to Id to get RCS IDs expanded.

Set svn:eol-style to native to handle line endings appropriately, and
trim off CRs.

------------------------------------------------------------------------
r16706 | sahlberg | 2005-12-06 14:29:46 -0600 (Tue, 06 Dec 2005) | 3 lines
Changed paths:
   M /trunk/epan/oid_resolv.c

g_hash_table_new_full() does not exist for glib1


------------------------------------------------------------------------
r16705 | lego | 2005-12-06 13:47:22 -0600 (Tue, 06 Dec 2005) | 3 lines
Changed paths:
   M /trunk/asn1/h248/h248.cnf
   M /trunk/asn1/h248/packet-h248-template.c
   M /trunk/epan/dissectors/packet-h248.c

It crashed when keep_persistent_data == FALSE


------------------------------------------------------------------------
r16704 | ulfl | 2005-12-06 13:41:45 -0600 (Tue, 06 Dec 2005) | 3 lines
Changed paths:
   M /trunk/capture.c

we can even get error messages while we are capturing (e.g. when a network cable is unplugged)

problem found by Joerg Mayer
------------------------------------------------------------------------
r16703 | lego | 2005-12-06 12:52:17 -0600 (Tue, 06 Dec 2005) | 6 lines
Changed paths:
   M /trunk/asn1/h248/h248.cnf
   M /trunk/asn1/h248/packet-h248-template.c
   M /trunk/asn1/h248/packet-h248-template.h
   M /trunk/epan/dissectors/packet-h248.c
   M /trunk/epan/dissectors/packet-h248.h

- Fix few issues with context analysis
- Add used terminations tree to the context analysis tree

Regenerate Dissector


------------------------------------------------------------------------
r16702 | etxrab | 2005-12-06 11:54:40 -0600 (Tue, 06 Dec 2005) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-tipc.c

Fill in Column info, Dissect some more user info.
------------------------------------------------------------------------
r16701 | etxrab | 2005-12-06 11:53:28 -0600 (Tue, 06 Dec 2005) | 1 line
Changed paths:
   M /trunk/asn1/camel/camel.asn
   M /trunk/asn1/camel/camel.cnf
   M /trunk/epan/dissectors/packet-camel.c
   M /trunk/epan/dissectors/packet-camel.h

Dissect Cause  and use %(DEFAULT_BODY)s use import for IMSI.
------------------------------------------------------------------------
r16700 | kukosa | 2005-12-06 06:50:11 -0600 (Tue, 06 Dec 2005) | 1 line
Changed paths:
   M /trunk/epan/ftypes/ftype-bytes.c

mark unused parameter
------------------------------------------------------------------------
r16699 | kukosa | 2005-12-06 05:45:55 -0600 (Tue, 06 Dec 2005) | 1 line
Changed paths:
   M /trunk/epan/Makefile.common
   M /trunk/epan/dissectors/packet-ber.c
   M /trunk/epan/dissectors/packet-ber.h
   M /trunk/epan/dissectors/packet-per.c
   M /trunk/epan/epan.c
   A /trunk/epan/oid_resolv.c
   A /trunk/epan/oid_resolv.h
   M /trunk/epan/proto.c

OBJECT IDENTIFIER name resolution moved to oid_resolv.c
------------------------------------------------------------------------
r16698 | kukosa | 2005-12-06 04:50:21 -0600 (Tue, 06 Dec 2005) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-q931.c

protocol discriminator byte has to be taken into info_element_len
------------------------------------------------------------------------
r16697 | ulfl | 2005-12-06 02:40:17 -0600 (Tue, 06 Dec 2005) | 7 lines
Changed paths:
   M /trunk/Makefile.nmake

both the buildbot and I have problems with setargv.obj

trying to comment it out, so the build should work again.

don't know what this file is all about :-( 

I just don't have that file and it doesn't seem to be generated ... 
------------------------------------------------------------------------
r16696 | guy | 2005-12-06 00:09:28 -0600 (Tue, 06 Dec 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-cigi.c

Note what we have to be careful of before we start using Unicode in the
packet list or packet details.

------------------------------------------------------------------------
r16695 | guy | 2005-12-06 00:03:34 -0600 (Tue, 06 Dec 2005) | 8 lines
Changed paths:
   M /trunk/Makefile.nmake

Make $(command_line_OBJECTS) a dependency of the stuff that links with
it.

Link dumpcap with mkstemp.obj, as it needs mkstemp().

Make dumpcap depend only on its resource file, as we do with other
programs, not on all of them.

------------------------------------------------------------------------
r16694 | sahlberg | 2005-12-05 19:05:48 -0600 (Mon, 05 Dec 2005) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-cigi.c

from Kyle Harms

CIGI updates


------------------------------------------------------------------------
r16693 | ulfl | 2005-12-05 19:04:55 -0600 (Mon, 05 Dec 2005) | 1 line
Changed paths:
   M /trunk/capture_errs.h
   M /trunk/gtk/capture_dlg.c

add a short comment to cant_load_winpcap_err() and use it in gtk/capture_dlg.c
------------------------------------------------------------------------
r16692 | sahlberg | 2005-12-05 18:27:51 -0600 (Mon, 05 Dec 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

objectid updates


------------------------------------------------------------------------
r16691 | ulfl | 2005-12-05 18:07:13 -0600 (Mon, 05 Dec 2005) | 5 lines
Changed paths:
   M /trunk/Makefile.am
   M /trunk/Makefile.common
   A /trunk/capture-pcap-util-int.h (from /trunk/pcap-util-int.h:16690)
   A /trunk/capture-pcap-util-unix.c (from /trunk/pcap-util-unix.c:16690)
   A /trunk/capture-pcap-util.c (from /trunk/pcap-util.c:16690)
   A /trunk/capture-pcap-util.h (from /trunk/pcap-util.h:16690)
   M /trunk/capture-wpcap.c
   M /trunk/capture.c
   M /trunk/capture_loop.c
   M /trunk/capture_ui_utils.c
   M /trunk/doc/README.capture
   M /trunk/dumpcap.c
   M /trunk/gtk/capture_dlg.c
   M /trunk/gtk/capture_if_dlg.c
   M /trunk/gtk/capture_info_dlg.c
   M /trunk/gtk/capture_prefs.c
   M /trunk/gtk/main.c
   D /trunk/pcap-util-int.h
   D /trunk/pcap-util-unix.c
   D /trunk/pcap-util.c
   D /trunk/pcap-util.h
   M /trunk/tethereal.c
   M /trunk/version_info.c

rename pcap-....c/.h files to capture-pcap-....c/.h

this way, the capture prefix will "logically" group the files together and file browsers will also group them

we may want to move the files into a subdir capture later
------------------------------------------------------------------------
r16690 | ulfl | 2005-12-05 17:22:59 -0600 (Mon, 05 Dec 2005) | 2 lines
Changed paths:
   M /trunk/ringbuffer.h

requested by Cory Perry:
increase the maximum number of ringbuffer files from 1024 to 10000.
------------------------------------------------------------------------
r16689 | etxrab | 2005-12-05 17:00:03 -0600 (Mon, 05 Dec 2005) | 9 lines
Changed paths:
   A /trunk/asn1/Makefile.nmake
   M /trunk/asn1/cms/cms-exp.cnf
   M /trunk/asn1/cms/cms.cnf
   M /trunk/asn1/x411/x411-exp.cnf
   M /trunk/asn1/x411/x411.asn
   M /trunk/asn1/x411/x411.cnf
   M /trunk/asn1/x420/Makefile.nmake
   M /trunk/asn1/x420/packet-x420-template.c
   M /trunk/asn1/x420/x420.asn
   M /trunk/asn1/x420/x420.cnf
   M /trunk/epan/dissectors/packet-cms.c
   M /trunk/epan/dissectors/packet-cms.h
   M /trunk/epan/dissectors/packet-x411.c
   M /trunk/epan/dissectors/packet-x411.h
   M /trunk/epan/dissectors/packet-x420.c
   M /trunk/epan/dissectors/packet-x420.h

From Grame Lunt:
a patch for the X.411, X420 and CMS dissectors to implement the remaining heading extensions and bodyparts.

This includes GeneralText BP, forwarded content BP (forwarded p22 and forwarded p772), PKCS#7 BP, and "business class" messaging extensions.

The X.411 extensions using the SIGNATURE macro have also been implemented. There is also a fix for a bug in the dissection of integer 22 content type.

Graeme

------------------------------------------------------------------------
r16688 | ulfl | 2005-12-05 16:49:10 -0600 (Mon, 05 Dec 2005) | 1 line
Changed paths:
   M /trunk/tethereal.c

fixed a typo
------------------------------------------------------------------------
r16687 | ulfl | 2005-12-05 16:45:54 -0600 (Mon, 05 Dec 2005) | 1 line
Changed paths:
   M /trunk/gtk/file_dlg.h
   M /trunk/gtk/main.c
   M /trunk/gtk/packet_win.h
   M /trunk/gtk/proto_draw.h
   M /trunk/ui_util.h

move some GTK only function declarations from ui_util.h to the appropriate header files in the gtk dir, as these declarations are obsolete and only confuses (at least me)
------------------------------------------------------------------------
r16686 | ulfl | 2005-12-05 16:28:42 -0600 (Mon, 05 Dec 2005) | 1 line
Changed paths:
   M /trunk/util.h

enhance the comments
------------------------------------------------------------------------
r16685 | ulfl | 2005-12-05 15:32:12 -0600 (Mon, 05 Dec 2005) | 6 lines
Changed paths:
   M /trunk/tethereal.c

replace all appearances of 'fprintf(stderr, "tethereal: ' with 'cmdarg_err("', this is:
a) smaller
b) makes it possible to use some functions for Wireshark too
c) is the wrong name now, as some outputs are not command line related :-(

use capture_opts_trim()
------------------------------------------------------------------------
r16684 | ulfl | 2005-12-05 15:28:34 -0600 (Mon, 05 Dec 2005) | 3 lines
Changed paths:
   M /trunk/Makefile.common
   M /trunk/Makefile.nmake
   M /trunk/dumpcap.c

no more usage of Ethereal.lib in dumpcap any longer :-)
use capture_opts_trim()
output of command line usage and version "enhanced"
------------------------------------------------------------------------
r16683 | ulfl | 2005-12-05 15:26:01 -0600 (Mon, 05 Dec 2005) | 1 line
Changed paths:
   M /trunk/capture_opts.c
   M /trunk/capture_opts.h
   M /trunk/gtk/main.c

add capture_opts_trim(), as this sequence is used three times now (will replace the other appearances later) ...
------------------------------------------------------------------------
r16682 | sahlberg | 2005-12-05 15:22:06 -0600 (Mon, 05 Dec 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb.c
   M /trunk/epan/dissectors/packet-smb2.c
   M /trunk/epan/dissectors/packet-smb2.h

updates for FILE_OBJECTID_BUFFER   and have smb call this (no more unknown bytes in smb for objectid)


------------------------------------------------------------------------
r16681 | sahlberg | 2005-12-05 14:54:42 -0600 (Mon, 05 Dec 2005) | 17 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-cigi.c

From Kyle J Harms

New protocol : CIGI  (with minor updates to make it heuristic)

Hi,

This patch is for a CIGI dissector (complete versions 2 and 3). It has
been [fuzz] tested on GNU/Linux using the Ethereal 0.10.13 codebase.
However, the patch here is against the svn repository.

More information about CIGI can be found at http://cigi.sourceforge.net/

Kyle Harms




------------------------------------------------------------------------
r16680 | etxrab | 2005-12-05 11:24:19 -0600 (Mon, 05 Dec 2005) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-ber.c
   M /trunk/epan/dissectors/packet-per.c

If we don't have the OID name let the SNMP dissector try to get it from the MIB:s
------------------------------------------------------------------------
r16679 | ulfl | 2005-12-04 20:30:04 -0600 (Sun, 04 Dec 2005) | 1 line
Changed paths:
   M /trunk/capture_loop.c

I've forgot to put one line under _WIN32, should fix the unix build
------------------------------------------------------------------------
r16678 | lego | 2005-12-04 19:46:07 -0600 (Sun, 04 Dec 2005) | 3 lines
Changed paths:
   M /trunk/asn1/h248/packet-h248-template.c

Analysis starts to work


------------------------------------------------------------------------
r16677 | ulfl | 2005-12-04 19:23:18 -0600 (Sun, 04 Dec 2005) | 1 line
Changed paths:
   M /trunk/capture_loop.c

Win32: fix signal_pipe handling if we run dumpcap as a standalone application (no signal_pipe)
------------------------------------------------------------------------
r16676 | jmayer | 2005-12-04 17:50:57 -0600 (Sun, 04 Dec 2005) | 5 lines
Changed paths:
   M /trunk
   M /trunk/dumpcap.c

We need AF_INET6 on linux, so include netdb.h if available.

Add dumpcap to svn:ignore.


------------------------------------------------------------------------
r16675 | etxrab | 2005-12-04 15:50:31 -0600 (Sun, 04 Dec 2005) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-tipc.c

Connection and name manager uses data type hdr
------------------------------------------------------------------------
r16674 | etxrab | 2005-12-04 15:45:38 -0600 (Sun, 04 Dec 2005) | 1 line
Changed paths:
   A /trunk/asn1/snmp
   A /trunk/asn1/snmp/Makefile
   A /trunk/asn1/snmp/Makefile.nmake
   A /trunk/asn1/snmp/README.txt
   A /trunk/asn1/snmp/packet-snmp-template.c
   A /trunk/asn1/snmp/packet-snmp-template.h
   A /trunk/asn1/snmp/snmp.asn
   A /trunk/asn1/snmp/snmp.cnf

Work in progress an asn2eth generated snmp dissector.
------------------------------------------------------------------------
r16673 | jmayer | 2005-12-04 02:48:38 -0600 (Sun, 04 Dec 2005) | 38 lines
Changed paths:
   M /trunk/tools/pidl/lib/Parse/Pidl/Ethereal/NDR.pm
   M /trunk/tools/pidl/lib/Parse/Pidl/NDR.pm
   M /trunk/tools/pidl/lib/Parse/Pidl/Samba/EJS.pm
   M /trunk/tools/pidl/lib/Parse/Pidl/Samba/NDR/Parser.pm

Update to samba svn revision 12055:
========== Samba changelog start ========================
r11959 | jelmer | 2005-11-29 14:54:51 +0100 (Tue, 29 Nov 2005) | 2 lines

Use DOS_errors array for displaying WERROR values

------------------------------------------------------------------------
r11972 | metze | 2005-11-30 13:40:26 +0100 (Wed, 30 Nov 2005) | 3 lines

handle [noejs] property also on functions

metze
------------------------------------------------------------------------
r11974 | metze | 2005-11-30 18:07:02 +0100 (Wed, 30 Nov 2005) | 3 lines

only look at $pl->{POINTER_TYPE} when $pl is defined

metze
------------------------------------------------------------------------
r11997 | metze | 2005-12-01 13:39:33 +0100 (Thu, 01 Dec 2005) | 14 lines

for multidimentional array like this:
uint32 [num_level2][num_level1][num_level0]

fix the order they're pushed and pulled, it should be like this

for (l2=0; l2 < num_level2; l2++) {
        for (l1=0; l1 < num_level1; l1++) {
                for (l0=0; l0 < num_level0; l0++) {
                        ndr_pull_uint32(...);
                }
        }
}

metze
========== Samba changelog end ========================


------------------------------------------------------------------------
r16672 | guy | 2005-12-03 22:22:43 -0600 (Sat, 03 Dec 2005) | 4 lines
Changed paths:
   M /trunk/epan/proto.c
   M /trunk/gtk/supported_protos_dlg.c

Check for a null blurb pointer for a field, as is done in some other
locations, and initialize the blurb field to NULL for protocols, now
that we support the blurb being a null pointer.

------------------------------------------------------------------------
r16671 | guy | 2005-12-03 22:20:18 -0600 (Sat, 03 Dec 2005) | 6 lines
Changed paths:
   M /trunk/capture_info.c

Declare "capture_info_packet()"'s as static, to match the definition.

Declare the "pd" argument to be "const guchar *", to match the way
packet data is declared elsewhere, and so that if the headers
"capture_info.c" includes don't define "u_char" it still compiles.

------------------------------------------------------------------------
r16670 | guy | 2005-12-03 22:13:07 -0600 (Sat, 03 Dec 2005) | 2 lines
Changed paths:
   M /trunk/epan/strutil.c

Squelch a GCC complaint.

------------------------------------------------------------------------
r16669 | ulfl | 2005-12-03 20:04:18 -0600 (Sat, 03 Dec 2005) | 6 lines
Changed paths:
   M /trunk/Makefile.common
   M /trunk/capture.c
   M /trunk/capture_info.c
   M /trunk/capture_info.h
   M /trunk/capture_loop.c
   M /trunk/capture_sync.c
   M /trunk/capture_sync.h
   M /trunk/dumpcap.c
   M /trunk/gtk/capture_info_dlg.c

move the complete functionality of the capture info dialog from capture_loop.c to capture_info.c and call it from capture.c (instead of capture_loop.c).

This way, the capture child don't need to now any of the packet_counter things (no epan/packet.h and all alike).

Currently the capture_info code will always open another wiretap file instance to build it's own counter values. This isn't optimized for now (next step: use data from cf_continue_tail() somehow).

------------------------------------------------------------------------
r16668 | ulfl | 2005-12-03 16:38:50 -0600 (Sat, 03 Dec 2005) | 2 lines
Changed paths:
   M /trunk/Makefile.common
   A /trunk/capture_info.c
   A /trunk/capture_info.h
   M /trunk/capture_loop.c
   M /trunk/capture_loop.h
   M /trunk/dumpcap.c
   M /trunk/gtk/capture_info_dlg.c
   M /trunk/gtk/dlg_utils.h

split some parts of the packet counting functions into their own files capture_info(.c/.h),
so we can use it from the main program
------------------------------------------------------------------------
r16667 | ulfl | 2005-12-03 15:12:59 -0600 (Sat, 03 Dec 2005) | 1 line
Changed paths:
   M /trunk/capture.c

clarify a comment
------------------------------------------------------------------------
r16666 | ulfl | 2005-12-03 15:09:56 -0600 (Sat, 03 Dec 2005) | 1 line
Changed paths:
   M /trunk/Makefile.common

forgot to checkin that file ... so buildbot became unhappy!
------------------------------------------------------------------------
r16665 | lego | 2005-12-03 13:41:18 -0600 (Sat, 03 Dec 2005) | 3 lines
Changed paths:
   M /trunk/epan/make-sminmpec.pl

Escape non ascii characters


------------------------------------------------------------------------
r16664 | ulfl | 2005-12-03 13:32:54 -0600 (Sat, 03 Dec 2005) | 1 line
Changed paths:
   M /trunk/capture.h
   M /trunk/capture_loop.c
   A /trunk/capture_loop.h
   M /trunk/capture_opts.c
   A /trunk/capture_opts.h
   M /trunk/capture_sync.h
   M /trunk/dumpcap.c
   M /trunk/gtk/capture_info_dlg.c
   M /trunk/gtk/main.c

split capture.h into capture.h, capture_loop.h and capture_opts.h and place the parts into the corresponding files
------------------------------------------------------------------------
r16663 | ulfl | 2005-12-03 12:15:02 -0600 (Sat, 03 Dec 2005) | 6 lines
Changed paths:
   M /trunk/capture.c
   M /trunk/capture.h
   M /trunk/capture_sync.c

add missing functions (to complete/cleanup of interface):

capture_input_drops
capture_input_error_message

and move the functionality from capture_sync.c to capture.c (just where it belongs)
------------------------------------------------------------------------
r16662 | ulfl | 2005-12-03 06:56:57 -0600 (Sat, 03 Dec 2005) | 3 lines
Changed paths:
   M /trunk/capture_loop.c

the function capture_loop_popup_errmsg seems to be useless and misleading, 
simply call sync_pipe_errmsg_to_parent directly instead

------------------------------------------------------------------------
r16661 | ulfl | 2005-12-03 06:42:25 -0600 (Sat, 03 Dec 2005) | 1 line
Changed paths:
   M /trunk/docbook/edg_graphics/ethereal-capture-sync.dia
   M /trunk/docbook/edg_graphics/ethereal-capture-sync.png

add the (Win32 only) signal pipe
------------------------------------------------------------------------
r16660 | ulfl | 2005-12-03 06:32:41 -0600 (Sat, 03 Dec 2005) | 1 line
Changed paths:
   M /trunk/capture_sync.c

precise some pipe message comments
------------------------------------------------------------------------
r16659 | ulfl | 2005-12-03 05:47:48 -0600 (Sat, 03 Dec 2005) | 1 line
Changed paths:
   M /trunk/docbook/edg_graphics/ethereal-capture-sync.dia
   M /trunk/docbook/edg_graphics/ethereal-capture-sync.png

the capture child don't use capture.c, remove it from the drawing
------------------------------------------------------------------------
r16658 | lego | 2005-12-03 05:43:19 -0600 (Sat, 03 Dec 2005) | 5 lines
Changed paths:
   M /trunk/asn1/h248/Makefile
   M /trunk/asn1/h248/h248.cnf
   M /trunk/asn1/h248/packet-h248-template.c
   M /trunk/asn1/h248/packet-h248-template.h

Rewrite of the analisys and summary code.

Analysis code is still  not working so it is disabled.


------------------------------------------------------------------------
r16657 | sahlberg | 2005-12-02 16:01:00 -0600 (Fri, 02 Dec 2005) | 8 lines
Changed paths:
   M /trunk/asn1/x411/packet-x411-template.c
   M /trunk/epan/dissectors/packet-p_mul.c
   M /trunk/epan/dissectors/packet-x411.c
   M /trunk/epan/dissectors/packet-x411.h

from Stig B:

I have made a small change in packet-x411-template.c to make the X.
411 message heading in CDT look like in COTP.




------------------------------------------------------------------------
r16656 | sahlberg | 2005-12-02 15:12:22 -0600 (Fri, 02 Dec 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rtcp.c

rtcp fix for sdes_prefix_string


------------------------------------------------------------------------
r16655 | etxrab | 2005-12-02 13:33:40 -0600 (Fri, 02 Dec 2005) | 3 lines
Changed paths:
   M /trunk/epan/t35.c

From  Lukasz Apiecionek
Add Vendor id 
0x8a000003, "Teldat H. Kruszynski, M. Cichocki Sp. J." } ,
------------------------------------------------------------------------
r16654 | lego | 2005-12-02 11:49:47 -0600 (Fri, 02 Dec 2005) | 5 lines
Changed paths:
   M /trunk/tools/asn2eth.py

Add #line directives to the genertated dissector.

Now the compiler knows where a line comes from and errors point to the .cnf or -template.[ch] file instead of the generated code.


------------------------------------------------------------------------
r16653 | kukosa | 2005-12-02 07:21:43 -0600 (Fri, 02 Dec 2005) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-h225.c
   M /trunk/epan/dissectors/packet-h235.c
   M /trunk/epan/dissectors/packet-h245.c
   M /trunk/epan/dissectors/packet-h450.c

PER dissectors regenerated with FT_OID
------------------------------------------------------------------------
r16652 | kukosa | 2005-12-02 07:16:58 -0600 (Fri, 02 Dec 2005) | 1 line
Changed paths:
   M /trunk/epan/dfilter/semcheck.c
   M /trunk/epan/dissectors/packet-ber.c
   M /trunk/epan/dissectors/packet-per.c
   M /trunk/epan/ftypes/ftype-bytes.c
   M /trunk/epan/ftypes/ftypes.h
   M /trunk/epan/proto.c
   M /trunk/epan/proto.h
   M /trunk/epan/strutil.c
   M /trunk/epan/strutil.h
   M /trunk/epan/to_str.c
   M /trunk/tools/asn2eth.py

new field type FT_OID for OBJECT IDENTIFIERs
------------------------------------------------------------------------
r16651 | sahlberg | 2005-12-02 05:33:34 -0600 (Fri, 02 Dec 2005) | 5 lines
Changed paths:
   A /trunk/epan/dissectors/pidl/wkssvc.idl

check in a version of wkssvc that contains all the constructs of the etehreal dissector.

the generated dissector is still "ugly" compared to the handwritten one so there needs a bit of conformance file magic and maybe pidl enhancements before it can go in.


------------------------------------------------------------------------
r16650 | sahlberg | 2005-12-02 04:54:05 -0600 (Fri, 02 Dec 2005) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc-dssetup.c
   M /trunk/epan/dissectors/packet-dcerpc-initshutdown.c
   M /trunk/epan/dissectors/packet-dcerpc-initshutdown.h
   M /trunk/epan/dissectors/packet-dcerpc-winreg.c
   M /trunk/epan/dissectors/pidl/packet-dcerpc-initshutdown.c
   M /trunk/epan/dissectors/pidl/packet-dcerpc-initshutdown.h
   M /trunk/epan/dissectors/pidl/packet-dcerpc-winreg.c

regenerate the pidl dissectors with the latest version of pidl   so it will put the text representation of DOS errors in the decode as well.


(the hf field for doserrors did not come with the value_string)



------------------------------------------------------------------------
r16649 | sahlberg | 2005-12-02 04:41:46 -0600 (Fri, 02 Dec 2005) | 7 lines
Changed paths:
   A /trunk/asn1/ldap
   A /trunk/asn1/ldap/Lightweight-Directory-Access-Protocol-V3.asn
   A /trunk/asn1/ldap/Lightweight-Directory-Access-Protocol-V3.asn.orig
   A /trunk/asn1/ldap/Makefile.nmake
   A /trunk/asn1/ldap/README
   A /trunk/asn1/ldap/ldap.cnf
   A /trunk/asn1/ldap/packet-ldap-template.c
   A /trunk/asn1/ldap/packet-ldap-template.h

add work in progress asn2eth generated ldap dissector from AndersB's email of
Nov 15

it is checked in but not copied to epan/dissectors so that those interested can work on it until it gets ready to replace the old one.



------------------------------------------------------------------------
r16648 | sahlberg | 2005-12-02 04:25:05 -0600 (Fri, 02 Dec 2005) | 5 lines
Changed paths:
   M /trunk/epan/ipproto.c
   M /trunk/epan/ipproto.h

add two new ip protocol numbers

from Jaap K


------------------------------------------------------------------------
r16647 | ulfl | 2005-12-02 03:24:55 -0600 (Fri, 02 Dec 2005) | 1 line
Changed paths:
   M /trunk/capture_loop.c

performance improvement: if the packet info dialog is hidden, we don't need to call the capture_... packet count functions
------------------------------------------------------------------------
r16646 | sahlberg | 2005-12-02 03:19:05 -0600 (Fri, 02 Dec 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

add some more ioctls


------------------------------------------------------------------------
r16645 | sahlberg | 2005-12-02 00:49:52 -0600 (Fri, 02 Dec 2005) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

add dissection of 
FSCTL_CREATE_OR_GET_OBJECT_ID


------------------------------------------------------------------------
r16644 | etxrab | 2005-12-01 14:29:24 -0600 (Thu, 01 Dec 2005) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-isup.c

Handle empty APM message
------------------------------------------------------------------------
r16643 | ulfl | 2005-12-01 14:19:30 -0600 (Thu, 01 Dec 2005) | 1 line
Changed paths:
   M /trunk/dumpcap.c

fix OPTINIT string, help output and add an exit_main function
------------------------------------------------------------------------
r16642 | ulfl | 2005-12-01 14:04:55 -0600 (Thu, 01 Dec 2005) | 1 line
Changed paths:
   M /trunk/gtk/main.c
   M /trunk/tethereal.c

fix alphabetical order of OPTINIT string, v seems to be a controversial character :-)
------------------------------------------------------------------------
r16641 | etxrab | 2005-12-01 14:02:45 -0600 (Thu, 01 Dec 2005) | 1 line
Changed paths:
   M /trunk/epan/address.h
   M /trunk/epan/dissectors/packet-tipc.c
   M /trunk/epan/to_str.c
   M /trunk/epan/to_str.h

Add TIPC address as address type and use it in TIPC.
------------------------------------------------------------------------
r16640 | etxrab | 2005-12-01 12:43:26 -0600 (Thu, 01 Dec 2005) | 2 lines
Changed paths:
   A /trunk/diameter/chargecontrol.xml
   M /trunk/diameter/dictionary.xml

From Thomas Steffen:
Add chargecontrol.xml 
------------------------------------------------------------------------
r16639 | tuexen | 2005-12-01 09:15:42 -0600 (Thu, 01 Dec 2005) | 2 lines
Changed paths:
   M /trunk/gtk/sctp_byte_graph_dlg.c

Bug fixes from Irene.

------------------------------------------------------------------------
r16638 | sahlberg | 2005-12-01 07:06:20 -0600 (Thu, 01 Dec 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

add dissection of FSCTL_GET_SHADOW_COPY_DATA


------------------------------------------------------------------------
r16637 | sahlberg | 2005-12-01 06:34:53 -0600 (Thu, 01 Dec 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

swap in/out to be more consistent with sane naming conventions


------------------------------------------------------------------------
r16636 | sahlberg | 2005-12-01 04:34:00 -0600 (Thu, 01 Dec 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

start implementing an ioctl dispatcher for different ioctl functions


------------------------------------------------------------------------
r16635 | sahlberg | 2005-12-01 04:18:14 -0600 (Thu, 01 Dec 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

add decoding of some ioctl names    copied from packet-smb.c


------------------------------------------------------------------------
r16634 | sahlberg | 2005-12-01 03:42:39 -0600 (Thu, 01 Dec 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c
   M /trunk/epan/dissectors/packet-smb2.h

move the ioctl function code to the si structure so we can switch on this later in the ioctl_data dissector


------------------------------------------------------------------------
r16633 | sahlberg | 2005-12-01 03:20:29 -0600 (Thu, 01 Dec 2005) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

0x0b is ioctl not transaction

------------------------------------------------------------------------
r16632 | etxrab | 2005-12-01 00:28:04 -0600 (Thu, 01 Dec 2005) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ses.c
   M /trunk/epan/dissectors/packet-ses.h

From Stig Bjrlykke

Added "Activity Identifier" PI in the OSI Session Protocol dissector. 

------------------------------------------------------------------------
r16631 | etxrab | 2005-12-01 00:20:17 -0600 (Thu, 01 Dec 2005) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-q931.c

From Jaap Keuter:
Q.931 fails to pass long message to H.225
------------------------------------------------------------------------
r16630 | etxrab | 2005-12-01 00:18:30 -0600 (Thu, 01 Dec 2005) | 1 line
Changed paths:
   M /trunk/asn1/inap/packet-inap-template.c
   M /trunk/epan/dissectors/packet-inap.c

Fix a typo
------------------------------------------------------------------------
r16629 | etxrab | 2005-11-30 14:14:18 -0600 (Wed, 30 Nov 2005) | 1 line
Changed paths:
   M /trunk/asn1/inap/inap.asn
   M /trunk/asn1/inap/inap.cnf
   M /trunk/asn1/inap/packet-inap-template.c
   M /trunk/epan/dissectors/packet-inap.c

Connec all op types to the asn1 code. Use #.PDU to get hf fields auto generated.
------------------------------------------------------------------------
r16628 | etxrab | 2005-11-30 14:12:44 -0600 (Wed, 30 Nov 2005) | 1 line
Changed paths:
   M /trunk/epan/address.h

Add circuit ID BICC_CIC
------------------------------------------------------------------------
r16627 | etxrab | 2005-11-30 14:11:45 -0600 (Wed, 30 Nov 2005) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-uma.c

Dissct Ptotocol Id 0
------------------------------------------------------------------------
r16626 | tuexen | 2005-11-29 17:09:01 -0600 (Tue, 29 Nov 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-sctp.c

Add support for
- http://www.ietf.org/internet-drafts/draft-stewart-sctpstrrst-01.txt

------------------------------------------------------------------------
r16625 | etxrab | 2005-11-29 12:58:18 -0600 (Tue, 29 Nov 2005) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-etheric.c

Change the name of 'isup_calling_partys_category_value'.
------------------------------------------------------------------------
r16624 | etxrab | 2005-11-29 11:23:50 -0600 (Tue, 29 Nov 2005) | 5 lines
Changed paths:
   M /trunk/asn1/camel/camel.asn
   M /trunk/asn1/camel/camel.cnf
   M /trunk/asn1/gsmmap/gsm_map-exp.cnf
   M /trunk/asn1/inap/inap.asn
   M /trunk/asn1/inap/inap.cnf
   M /trunk/asn1/inap/packet-inap-template.c
   M /trunk/epan/dissectors/packet-camel.c
   M /trunk/epan/dissectors/packet-gsm_map.c
   M /trunk/epan/dissectors/packet-gsm_map.h
   M /trunk/epan/dissectors/packet-inap.c
   M /trunk/epan/dissectors/packet-isup.c
   M /trunk/epan/dissectors/packet-isup.h

ISUP - Export functions used by INAP and Camel
Gsmmap - Export asn1 structs used by Camel
Camel - Use functions from GSMMAp and ISUP
INAP - Rewrite of the asn1 code to correspond more to CS1 data types
          Let ISUP and Q931 dissect apropriate stuff.
------------------------------------------------------------------------
r16623 | guy | 2005-11-29 03:38:45 -0600 (Tue, 29 Nov 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

"dcerpc_smb_fetch_pol()" doesn't necessarily return a name, as we might
not have seen anything that would let us give a name to a handle.

------------------------------------------------------------------------
r16622 | sahlberg | 2005-11-28 21:19:52 -0600 (Mon, 28 Nov 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc-winreg.c
   M /trunk/epan/dissectors/packet-dcerpc-winreg.h
   M /trunk/epan/dissectors/pidl/packet-dcerpc-winreg.c
   M /trunk/epan/dissectors/pidl/packet-dcerpc-winreg.h
   M /trunk/epan/dissectors/pidl/winreg.cnf
   M /trunk/epan/dissectors/pidl/winreg.idl

prettification and updates to winreg


------------------------------------------------------------------------
r16621 | ulfl | 2005-11-28 15:12:50 -0600 (Mon, 28 Nov 2005) | 1 line
Changed paths:
   M /trunk/Makefile.common

seems like autogen doesn't like empty lines in the makefile
------------------------------------------------------------------------
r16620 | ulfl | 2005-11-28 14:51:27 -0600 (Mon, 28 Nov 2005) | 5 lines
Changed paths:
   M /trunk/Makefile.common
   M /trunk/capture_loop.c
   M /trunk/dumpcap.c

dumpcap.c doesn't need to link with file.c!

this fortunately removes *a lot* of dependencies and make the resulting binary a lot smaller (and hopefully faster to load :-)

some more cleanup (like replacing // by /**/)
------------------------------------------------------------------------
r16619 | sharpe | 2005-11-28 11:32:30 -0600 (Mon, 28 Nov 2005) | 8 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ldap.c


Change the way we handle realloc so that we now compute all the space required
up front and realloc once ...

This will probably be the last changes I make on this dissector, as I want to
concentrate on using asn2eth for LDAP, as time permits.


------------------------------------------------------------------------
r16618 | guy | 2005-11-28 05:40:28 -0600 (Mon, 28 Nov 2005) | 2 lines
Changed paths:
   M /trunk/Makefile.am
   M /trunk/configure.in
   M /trunk/dumpcap.c

Add support for building dumpcap, and fix dumpcap to build on UN*X.

------------------------------------------------------------------------
r16617 | guy | 2005-11-28 04:28:31 -0600 (Mon, 28 Nov 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-sndcp.c

Update the offset correctly regardless of whether we're building a
protocol tree or not.

------------------------------------------------------------------------
r16616 | guy | 2005-11-28 04:26:21 -0600 (Mon, 28 Nov 2005) | 11 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ppp.c

Give the RFC number for CHAP.

Don't fetch CHAP fields until we need them, so that we can at least
partially dissect a short frame.

Even if the CHAP length is wrong, put it into the protocol tree using
the registered field.

Use "tvb_format_text()" to put text into the Info column, so we handle
non-printable characters by escaping them.

------------------------------------------------------------------------
r16615 | ulfl | 2005-11-28 02:54:52 -0600 (Mon, 28 Nov 2005) | 9 lines
Changed paths:
   M /trunk/Makefile.am
   M /trunk/Makefile.common
   M /trunk/Makefile.nmake
   M /trunk/capture_loop.c
   A /trunk/dumpcap.c
   M /trunk/image/Makefile.nmake
   A /trunk/image/dumpcap.rc.in

first steps towards a separated capture tool, working title "dumpcap"
personal backup only, not meant for public testing!

I've copied main.c into dumpcap.c and carved out all things not needed

currently won't work as a command line tool, capture_loop.c wants an input pipe
console output is also very ugly and the whole code needs a lot of further cleanup

shouldn't break the unix build as I've only changed the nmake files so far, but who knows ...
------------------------------------------------------------------------
r16614 | sharpe | 2005-11-28 02:31:11 -0600 (Mon, 28 Nov 2005) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ldap.c


Make sure that we reset the filter pointer after we realloc the filter.

This should be simplified ... calc all the space required once and then realloc once etc.


------------------------------------------------------------------------
r16613 | sahlberg | 2005-11-28 02:20:12 -0600 (Mon, 28 Nov 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

name some infolevels


------------------------------------------------------------------------
r16612 | guy | 2005-11-27 18:48:17 -0600 (Sun, 27 Nov 2005) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-pppoe.c

Don't show the tag twice.

------------------------------------------------------------------------
r16611 | guy | 2005-11-27 18:41:01 -0600 (Sun, 27 Nov 2005) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-pppoe.c

Host-Uniq is binary, not text.

FT_BYTES items don't have a base - the bytes are always dumped in hex -
so use BASE_NONE with them.

------------------------------------------------------------------------
r16610 | guy | 2005-11-27 06:10:03 -0600 (Sun, 27 Nov 2005) | 3 lines
Changed paths:
   M /trunk/wiretap/hcidump.c

Fail if *any* of the fields in the per-packet header of the first record
aren't sane, rather than requiring them *all* to have invalid values.

------------------------------------------------------------------------
r16609 | guy | 2005-11-26 20:42:29 -0600 (Sat, 26 Nov 2005) | 10 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ldap.c

Don't do anything to the filter string until we've successfully parsed
the extensibleMatch.

Make sure the filter string is always null-terminated, as we use
"strlen()" to skip to the end of it.

On the (illegal, but not impossible) chance that we have more than one
matching rule ID, attributeDescription, or matchValue, free any we
already have before fetching a new one.

------------------------------------------------------------------------
r16608 | sahlberg | 2005-11-26 16:49:18 -0600 (Sat, 26 Nov 2005) | 5 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/dissectors/packet-ppp.c

from Martin M

ppp chap updates


------------------------------------------------------------------------
r16607 | sahlberg | 2005-11-26 15:59:48 -0600 (Sat, 26 Nov 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb.c
   M /trunk/epan/dissectors/packet-smb.h
   M /trunk/epan/dissectors/packet-smb2.c

add endoffile infolevel


------------------------------------------------------------------------
r16606 | sahlberg | 2005-11-26 15:44:37 -0600 (Sat, 26 Nov 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb.c
   M /trunk/epan/dissectors/packet-smb.h
   M /trunk/epan/dissectors/packet-smb2.c

more infolevels


------------------------------------------------------------------------
r16605 | sahlberg | 2005-11-26 15:09:53 -0600 (Sat, 26 Nov 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

update setinfo response dissection


------------------------------------------------------------------------
r16604 | ulfl | 2005-11-26 05:57:54 -0600 (Sat, 26 Nov 2005) | 1 line
Changed paths:
   M /trunk/gtk/range_utils.c

fix #568: disable event "activate" handler for the range entry field. see the added comment for details
------------------------------------------------------------------------
r16603 | jmayer | 2005-11-26 04:05:14 -0600 (Sat, 26 Nov 2005) | 1 line
Changed paths:
   M /trunk/asn1/dap/Makefile
   M /trunk/asn1/dap/dap-exp.cnf
   M /trunk/asn1/dap/dap.asn
   M /trunk/asn1/dap/dap.cnf
   M /trunk/asn1/dap/packet-dap-template.c
   M /trunk/asn1/dap/packet-dap-template.h
   M /trunk/asn1/disp/Makefile
   M /trunk/asn1/disp/disp.asn
   M /trunk/asn1/disp/disp.cnf
   M /trunk/asn1/disp/packet-disp-template.c
   M /trunk/asn1/disp/packet-disp-template.h
   M /trunk/asn1/dsp/Makefile
   M /trunk/asn1/dsp/dsp-exp.cnf
   M /trunk/asn1/dsp/dsp.asn
   M /trunk/asn1/dsp/dsp.cnf
   M /trunk/asn1/dsp/packet-dsp-template.c
   M /trunk/asn1/dsp/packet-dsp-template.h
   M /trunk/asn1/x501/Makefile
   M /trunk/asn1/x501/packet-x501-template.c
   M /trunk/asn1/x501/packet-x501-template.h
   M /trunk/asn1/x501/x501-exp.cnf
   M /trunk/asn1/x501/x501.asn
   M /trunk/asn1/x501/x501.cnf
   M /trunk/epan/dissectors/packet-dap.c
   M /trunk/epan/dissectors/packet-dap.h
   M /trunk/epan/dissectors/packet-disp.c
   M /trunk/epan/dissectors/packet-disp.h
   M /trunk/epan/dissectors/packet-dsp.c
   M /trunk/epan/dissectors/packet-dsp.h
   M /trunk/epan/dissectors/packet-x501.c
   M /trunk/epan/dissectors/packet-x501.h

Porperties: replace executable by eol-style and keywords
------------------------------------------------------------------------
r16602 | guy | 2005-11-25 22:16:40 -0600 (Fri, 25 Nov 2005) | 13 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ber.c

Fix typoes in comments.

Update a comment, and get rid of a commented-out unused variable.

Use "get_ber_identifier()" and "get_ber_length()", rather than
"dissect_ber_identifier()" and "dissect_ber_length()", if we're just
fetching the values, rather than dissecting them.  As we're just
fetching the values, if we get an error, put the identifer and length
into the protocol tree (if we've enabled that) with
"dissect_ber_identifier()" and "dissect_ber_length()".

Properly declare class and tag variables as signed.

------------------------------------------------------------------------
r16601 | guy | 2005-11-25 21:09:40 -0600 (Fri, 25 Nov 2005) | 2 lines
Changed paths:
   M /trunk/asn1/tcap/packet-tcap-template.c
   M /trunk/epan/dissectors/packet-tcap.c
   M /trunk/epan/dissectors/packet-tcap.h

Get rid of unused global variables.

------------------------------------------------------------------------
r16600 | guy | 2005-11-25 21:08:17 -0600 (Fri, 25 Nov 2005) | 2 lines
Changed paths:
   M /trunk/epan/stats_tree.c

Get rid of unused function.

------------------------------------------------------------------------
r16599 | guy | 2005-11-25 21:06:25 -0600 (Fri, 25 Nov 2005) | 14 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rmt-norm.c

Fix RFC number.

Use "tvb_reported_length_remaining()" for all length checks and values,
so we get the *actual* packet length, not the *captured* packet length
(it's a *feature* if it reports a "packet cut short" error if the packet
really *was* cut short by slicing).

Set subtree lengths to -1, so that if an exception is throws while
dissecting them, the length includes all the data.

Get rid of unused variables, and mark unused parameters.

In heuristic checks, give up if we don't have enough data to check.

------------------------------------------------------------------------
r16598 | sahlberg | 2005-11-25 21:06:21 -0600 (Fri, 25 Nov 2005) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

many commands return a short 8 byte pdu when errors occur.
make ethereal handle these better instead of showing them as unreassembled packet



------------------------------------------------------------------------
r16597 | ulfl | 2005-11-25 19:56:22 -0600 (Fri, 25 Nov 2005) | 5 lines
Changed paths:
   M /trunk/gtk/print_dlg.c

fix #358: instead of simply using tpmnam() for the Win32 print function, use the "official" function to create a temporary file

Well, we actually only need the filename here, so create a temp file with the "official" create_tempfile function, keep that tempfile name and then delete this file again, leaving only the name.

I know that's a bit uncommon, but should work and uses the same mechanisms as with other temporary files. So if there are still problems with the official function, we only have one place to fix :-)
------------------------------------------------------------------------
r16596 | sahlberg | 2005-11-25 18:34:22 -0600 (Fri, 25 Nov 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb.c
   M /trunk/epan/dissectors/packet-smb.h
   M /trunk/epan/dissectors/packet-smb2.c

assume the four bytes after the fid in notify request is the completion mask


------------------------------------------------------------------------
r16595 | ulfl | 2005-11-25 17:54:19 -0600 (Fri, 25 Nov 2005) | 1 line
Changed paths:
   M /trunk/gtk/expert_comp_table.c

fix a simple GTK1 warning
------------------------------------------------------------------------
r16594 | sahlberg | 2005-11-25 17:52:47 -0600 (Fri, 25 Nov 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

add decoding of some more opcodes


------------------------------------------------------------------------
r16593 | ulfl | 2005-11-25 17:42:52 -0600 (Fri, 25 Nov 2005) | 4 lines
Changed paths:
   M /trunk/epan/expert.c
   M /trunk/epan/expert.h
   M /trunk/gtk/Makefile.am
   M /trunk/gtk/Makefile.common
   A /trunk/gtk/expert_comp_dlg.c
   A /trunk/gtk/expert_comp_table.c
   A /trunk/gtk/expert_comp_table.h

from Greg Morris:
Composite Expert statistics, see: 
http://www.ethereal.com/lists/ethereal-dev/200511/msg00002.html
and the following discussions
------------------------------------------------------------------------
r16592 | ulfl | 2005-11-25 16:38:02 -0600 (Fri, 25 Nov 2005) | 4 lines
Changed paths:
   M /trunk/capture_loop.c
   M /trunk/tethereal.c

rephrase the error dialog if an interface couldn't be opened.

made the CaptureSetup wiki page more prominent
added some "headings" so some of the help subtopics are easier for "human grep" IMHO
------------------------------------------------------------------------
r16591 | ulfl | 2005-11-25 16:27:27 -0600 (Fri, 25 Nov 2005) | 8 lines
Changed paths:
   M /trunk/capture.c

add some more help text to the "no packets captured" error dialog:

link to CaptureSetup wiki page
Win32 only: wireless: "try switch off promicuous mode"

This way we might get less user questions on the users-mailing list ...

Especially the second one hopefully could save us from a lot of support mails :-)
------------------------------------------------------------------------
r16590 | sahlberg | 2005-11-25 16:06:56 -0600 (Fri, 25 Nov 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

add decoding of some more opcodes


------------------------------------------------------------------------
r16589 | sahlberg | 2005-11-25 15:55:34 -0600 (Fri, 25 Nov 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb.c
   M /trunk/epan/dissectors/packet-smb2.c

from metze   and modified,   fix for in offset/length for transaction request


------------------------------------------------------------------------
r16588 | etxrab | 2005-11-25 14:30:42 -0600 (Fri, 25 Nov 2005) | 2 lines
Changed paths:
   M /trunk/wiretap/Makefile.common
   M /trunk/wiretap/file_access.c
   A /trunk/wiretap/iseries.c
   A /trunk/wiretap/iseries.h
   M /trunk/wiretap/wtap-int.h
   M /trunk/wiretap/wtap.h

From Martin Warnes:
Add Support for reading of IBM iSeries (AS/400) Comms traces
------------------------------------------------------------------------
r16587 | etxrab | 2005-11-25 14:18:36 -0600 (Fri, 25 Nov 2005) | 1 line
Changed paths:
   M /trunk/asn1/camel/camel.asn
   M /trunk/asn1/camel/camel.cnf
   M /trunk/asn1/camel/packet-camel-template.c
   M /trunk/asn1/gsmmap/Makefile.nmake
   M /trunk/asn1/gsmmap/gsmmap.cnf
   M /trunk/epan/dissectors/packet-camel.c
   M /trunk/epan/dissectors/packet-gsm_map.c
   M /trunk/epan/dissectors/packet-gsm_map.h

Update the Camel asn1 spec to 3GPP TS 29.078 version 6.4.0 and export needed stuff from gsmmap
------------------------------------------------------------------------
r16586 | sahlberg | 2005-11-25 02:26:02 -0600 (Fri, 25 Nov 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

add dissection of treedisconnect


------------------------------------------------------------------------
r16585 | sahlberg | 2005-11-25 02:02:40 -0600 (Fri, 25 Nov 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb.c
   M /trunk/epan/dissectors/packet-smb.h
   M /trunk/epan/dissectors/packet-smb2.c

add some more infolevels


------------------------------------------------------------------------
r16584 | sahlberg | 2005-11-25 00:45:50 -0600 (Fri, 25 Nov 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

fix typo   it is one in buffer and one out buffer in transaction request   not two out buffers


------------------------------------------------------------------------
r16583 | sahlberg | 2005-11-25 00:30:47 -0600 (Fri, 25 Nov 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

transaction update


------------------------------------------------------------------------
r16582 | etxrab | 2005-11-25 00:23:04 -0600 (Fri, 25 Nov 2005) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-pppoe.c

From Martin Mathieson:
Here is a patch to the PPPoED and PPPoES dissectors.
- All fields are now filterable
- General prettification
- I've added a preference to PPoED to set whether or not tag values and data lengths should be shown in the tree (default is OFF)

------------------------------------------------------------------------
r16581 | sahlberg | 2005-11-25 00:19:41 -0600 (Fri, 25 Nov 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb.c
   M /trunk/epan/dissectors/packet-smb.h
   M /trunk/epan/dissectors/packet-smb2.c

add dissection of the smb2   impersionationlevel field


------------------------------------------------------------------------
r16580 | sahlberg | 2005-11-25 00:04:11 -0600 (Fri, 25 Nov 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb.c
   M /trunk/epan/dissectors/packet-smb.h
   M /trunk/epan/dissectors/packet-smb2.c

some info level updates


------------------------------------------------------------------------
r16579 | sahlberg | 2005-11-24 23:41:00 -0600 (Thu, 24 Nov 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb.c
   M /trunk/epan/dissectors/packet-smb.h
   M /trunk/epan/dissectors/packet-smb2.c

some info level updates


------------------------------------------------------------------------
r16578 | sahlberg | 2005-11-24 18:28:02 -0600 (Thu, 24 Nov 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

update the transaction code


------------------------------------------------------------------------
r16577 | sahlberg | 2005-11-24 09:24:30 -0600 (Thu, 24 Nov 2005) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

dissect some more of SMB2 Transaction command

------------------------------------------------------------------------
r16576 | sahlberg | 2005-11-24 08:49:46 -0600 (Thu, 24 Nov 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

dissect some of opcode 0x0b Transaction


------------------------------------------------------------------------
r16575 | etxrab | 2005-11-23 23:55:18 -0600 (Wed, 23 Nov 2005) | 25 lines
Changed paths:
   M /trunk/epan/dissectors/ncp2222.py
   M /trunk/epan/dissectors/packet-ncp-int.h
   M /trunk/epan/dissectors/packet-ncp.c
   M /trunk/epan/dissectors/packet-ncp2222.inc

From Greg Morris:
ncp2222.py.diff
Fixed decoding of NCP 89,10 reply packet. Fixes malformed packet.
 
packet-ncp.c.diff
Adds NCP protocol preference options for enabling/disabling the echoing of data to the expert table.
Expert: EID to Name Lookups
Expert: NCP Connections
Expert: NCP Errors
Expert: Server Information
 
packet-ncp2222.inc.diff
Adds decoding of ZEN attribute values
zendmSearchType
zendmSearchOrder
Fixes blank name stored in EID to Name table if tuned name was returned in resolve name reply packet
Adds capability of reading hf values from NCP tree for exporting specific NCP info to expert table
Adds support for new NCP protocol preference options
Adds expert options for EID to Name Lookups, NCP connections, and Server Information
Change nwconnection from 16bit value to 32bit
 
Packet-ncp-int.h.diff
Fix function prototypes to match new 32bit nwconnection
Add global variables to allow for new NCP protocol preference options

------------------------------------------------------------------------
r16574 | etxrab | 2005-11-23 15:32:07 -0600 (Wed, 23 Nov 2005) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-tipc.c

Pretify TIPC addr.
------------------------------------------------------------------------
r16573 | etxrab | 2005-11-23 15:27:39 -0600 (Wed, 23 Nov 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ncp-nmas.c

From greg Morris:
Fixes proper decoding of extended error 2 values
Also adds a number of additional error codes/values
------------------------------------------------------------------------
r16572 | etxrab | 2005-11-23 15:25:24 -0600 (Wed, 23 Nov 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ndps.c

From Greg Morris:
Fixes proper decoding of extended error 2 values
Also adds a number of additional error codes/values
------------------------------------------------------------------------
r16571 | etxrab | 2005-11-23 15:17:58 -0600 (Wed, 23 Nov 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-srvloc.c

From Greg Morris:
This update adds info column data for srvloc request/reply to display SLP version and XID information.
Also adds expert data for srvloc error conditions
------------------------------------------------------------------------
r16570 | kukosa | 2005-11-23 03:41:43 -0600 (Wed, 23 Nov 2005) | 1 line
Changed paths:
   M /trunk/epan/dissectors/Makefile.common

fixed typo
------------------------------------------------------------------------
r16569 | kukosa | 2005-11-23 01:47:22 -0600 (Wed, 23 Nov 2005) | 1 line
Changed paths:
   M /trunk/epan/libethereal.def

export dissect_per_object_identifier_str() and dissect_ber_object_identifier_str() from libethereal
------------------------------------------------------------------------
r16568 | etxrab | 2005-11-23 01:38:42 -0600 (Wed, 23 Nov 2005) | 1 line
Changed paths:
   M /trunk/AUTHORS

Add Stig Bjrlykke as author of CDT (CompressedDataType) support 
------------------------------------------------------------------------
r16567 | etxrab | 2005-11-23 01:33:03 -0600 (Wed, 23 Nov 2005) | 11 lines
Changed paths:
   M /trunk/epan/dissectors/Makefile.common
   M /trunk/epan/dissectors/packet-p_mul.c
   M /trunk/epan/dissectors/packet-x411.c
   M /trunk/epan/dissectors/packet-x411.h

From Stig Bjrlykke
Added a new dissector for CDT (CompressedDataType) as
 defined in STANAG 4406 Annex E.  This dissector is used in P_Mul to  
 decode encapsulated X.411 content.  I have added a function in the  
 X.411 dissector to decode a MTS APDU without having a ROS

 Changes in this patch:
 * Added CDT dissector
 * Use CDT dissector in P_Mul
 * Added function to decode MTS APDU in the X.411 dissector

------------------------------------------------------------------------
r16566 | etxrab | 2005-11-23 01:32:24 -0600 (Wed, 23 Nov 2005) | 11 lines
Changed paths:
   A /trunk/epan/dissectors/packet-cdt.c
   A /trunk/epan/dissectors/packet-cdt.h

From Stig Bjrlykke
Added a new dissector for CDT (CompressedDataType) as
 defined in STANAG 4406 Annex E.  This dissector is used in P_Mul to  
 decode encapsulated X.411 content.  I have added a function in the  
 X.411 dissector to decode a MTS APDU without having a ROS

 Changes in this patch:
 * Added CDT dissector
 * Use CDT dissector in P_Mul
 * Added function to decode MTS APDU in the X.411 dissector

------------------------------------------------------------------------
r16565 | etxrab | 2005-11-23 01:29:45 -0600 (Wed, 23 Nov 2005) | 11 lines
Changed paths:
   M /trunk/asn1/x411/packet-x411-template.c
   M /trunk/asn1/x411/packet-x411-template.h

From Stig Bjrlykke
Added a new dissector for CDT (CompressedDataType) as
 defined in STANAG 4406 Annex E.  This dissector is used in P_Mul to  
 decode encapsulated X.411 content.  I have added a function in the  
 X.411 dissector to decode a MTS APDU without having a ROS

 Changes in this patch:
 * Added CDT dissector
 * Use CDT dissector in P_Mul
 * Added function to decode MTS APDU in the X.411 dissector

------------------------------------------------------------------------
r16564 | etxrab | 2005-11-23 01:24:18 -0600 (Wed, 23 Nov 2005) | 1 line
Changed paths:
   A /trunk/asn1/cdt
   A /trunk/asn1/cdt/Makefile
   A /trunk/asn1/cdt/Makefile.nmake
   A /trunk/asn1/cdt/cdt-exp.cnf
   A /trunk/asn1/cdt/cdt.asn
   A /trunk/asn1/cdt/cdt.cnf
   A /trunk/asn1/cdt/packet-cdt-template.c
   A /trunk/asn1/cdt/packet-cdt-template.h

Add cdt
------------------------------------------------------------------------
r16563 | guy | 2005-11-22 18:53:37 -0600 (Tue, 22 Nov 2005) | 5 lines
Changed paths:
   M /trunk/AUTHORS

Fix a couple of mangled UTF-8 names.

"cfs 2895" was a typo - combine the two entries for cjs2895 [AT]
hotmail.com.

------------------------------------------------------------------------
r16562 | etxrab | 2005-11-22 15:48:10 -0600 (Tue, 22 Nov 2005) | 1 line
Changed paths:
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-tipc.c

Add dissection of Transparent Inter Process Communication (TIPC). 
------------------------------------------------------------------------
r16561 | jmayer | 2005-11-22 06:51:14 -0600 (Tue, 22 Nov 2005) | 1 line
Changed paths:
   M /trunk/asn1/h245/packet-h245-template.h
   M /trunk/asn1/h248/packet-h248-template.h
   M /trunk/asn1/x509if/packet-x509if-template.c
   M /trunk/asn1/x509if/packet-x509if-template.h
   M /trunk/epan/dissectors/packet-cmp.c
   M /trunk/epan/dissectors/packet-dcerpc-nt.c
   M /trunk/epan/dissectors/packet-dcp.c
   M /trunk/epan/dissectors/packet-giop.c
   M /trunk/epan/dissectors/packet-gnm.c
   M /trunk/epan/dissectors/packet-h245.c
   M /trunk/epan/dissectors/packet-h245.h
   M /trunk/epan/dissectors/packet-h248.h
   M /trunk/epan/dissectors/packet-iuup.c
   M /trunk/epan/dissectors/packet-kerberos.c
   M /trunk/epan/dissectors/packet-pres.c
   M /trunk/epan/dissectors/packet-pvfs2.c
   M /trunk/epan/dissectors/packet-rmt-norm.c
   M /trunk/epan/dissectors/packet-rmt-norm.h
   M /trunk/epan/dissectors/packet-x509if.c
   M /trunk/epan/dissectors/packet-x509if.h
   M /trunk/epan/dissectors/packet-xml.c
   M /trunk/epan/tvbparse.c
   M /trunk/gtk/voip_calls_dlg.c
   M /trunk/plugins/h223/packet-h223.c
   M /trunk/plugins/h223/packet-srp.c

Trivial warning fixes
------------------------------------------------------------------------
r16560 | sharpe | 2005-11-22 00:36:06 -0600 (Tue, 22 Nov 2005) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ldap.c


Remove unnecessary code to add NULLs to strings obtained with ASN1_STRING_VALUE_DECODE, as they are already there.


------------------------------------------------------------------------
r16559 | sharpe | 2005-11-21 21:55:02 -0600 (Mon, 21 Nov 2005) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ldap.c


Remove a comment that says we don't support extensibleMatch, because we now do. Also, remove an unused static.


------------------------------------------------------------------------
r16558 | sharpe | 2005-11-21 20:19:52 -0600 (Mon, 21 Nov 2005) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ldap.c


A first pass at providing a dissector for extensibleMatch filters.

More work to come on the whole filters shtick and more clean-up required here.


------------------------------------------------------------------------
r16557 | sahlberg | 2005-11-21 14:37:43 -0600 (Mon, 21 Nov 2005) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

from Metze
generalize the offset/length/buffer   handling
and make some code much nicer


------------------------------------------------------------------------
r16556 | etxrab | 2005-11-21 13:01:52 -0600 (Mon, 21 Nov 2005) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-ethertype.c

Add ethertype for TIPC
------------------------------------------------------------------------
r16555 | etxrab | 2005-11-21 13:01:07 -0600 (Mon, 21 Nov 2005) | 1 line
Changed paths:
   M /trunk/epan/etypes.h

Add ethertype for TIPC
------------------------------------------------------------------------
r16554 | guy | 2005-11-19 22:34:58 -0600 (Sat, 19 Nov 2005) | 7 lines
Changed paths:
   M /trunk/asn1/pres/packet-pres-template.c
   M /trunk/epan/dissectors/packet-pres.c

When registering a context ID and OID, set the OID to NULL if we don't
have an OID to register.

If our table of context identifiers and OIDs is to keep that association
on a per-conversation basis, it should use conversations, not
address/port, as we aren't necessarily running over TCP or UDP.

------------------------------------------------------------------------
r16553 | sahlberg | 2005-11-19 20:48:26 -0600 (Sat, 19 Nov 2005) | 6 lines
Changed paths:
   M /trunk/asn1/pres/packet-pres-template.c
   M /trunk/asn1/pres/pres.cnf
   M /trunk/epan/dissectors/packet-pres.c
   M /trunk/epan/dissectors/packet-pres.h

if the packet is mangled   the oid string might be NULL.

dont try to register a NULL oid



------------------------------------------------------------------------
r16552 | etxrab | 2005-11-19 09:59:30 -0600 (Sat, 19 Nov 2005) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-diameter.c

Use VendorID from sminmpec.
------------------------------------------------------------------------
r16551 | etxrab | 2005-11-19 09:58:16 -0600 (Sat, 19 Nov 2005) | 1 line
Changed paths:
   M /trunk/diameter/dictionary.xml
   M /trunk/diameter/mobileipv4.xml
   M /trunk/diameter/nasreq.xml

Use the correct Application Id:s fix a typo.
------------------------------------------------------------------------
r16550 | sahlberg | 2005-11-19 04:27:16 -0600 (Sat, 19 Nov 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb.c

fix for bug 570,   the domain name is present in sessionsetupandx replies even for wc==4
 

------------------------------------------------------------------------
r16549 | sahlberg | 2005-11-19 04:03:16 -0600 (Sat, 19 Nov 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

fix bug 588 and friends


------------------------------------------------------------------------
r16548 | sahlberg | 2005-11-18 21:19:56 -0600 (Fri, 18 Nov 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

the 4 bytes in MxAc   are access maxk   not file attributes


------------------------------------------------------------------------
r16547 | sahlberg | 2005-11-18 21:15:39 -0600 (Fri, 18 Nov 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

prettification


------------------------------------------------------------------------
r16546 | sahlberg | 2005-11-18 20:24:22 -0600 (Fri, 18 Nov 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

decode the extra blob at the end of Create calls


------------------------------------------------------------------------
r16545 | sahlberg | 2005-11-18 15:59:05 -0600 (Fri, 18 Nov 2005) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

update to SMB2_FILE_ALL_INFO dissection

prettify dissection of some strings


------------------------------------------------------------------------
r16544 | guy | 2005-11-18 04:06:47 -0600 (Fri, 18 Nov 2005) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ber.c

Don't crash if a null OID pointer is passed to
"call_ber_oid_callback()".  (Arguably, the caller of
"call_ber_oid_callback()" should check for that, and report that a
presumably-required field is missing.)

------------------------------------------------------------------------
r16543 | sahlberg | 2005-11-18 01:31:18 -0600 (Fri, 18 Nov 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb.c
   M /trunk/epan/dissectors/packet-smb.h
   M /trunk/epan/dissectors/packet-smb2.c

dissect some more infolevels


------------------------------------------------------------------------
r16542 | guy | 2005-11-18 00:12:17 -0600 (Fri, 18 Nov 2005) | 2 lines
Changed paths:
   M /trunk/doc/tethereal.pod
   M /trunk/tethereal.c

Add support for the "-B" flag to Tethereal on Windows.

------------------------------------------------------------------------
r16541 | guy | 2005-11-17 18:34:11 -0600 (Thu, 17 Nov 2005) | 12 lines
Changed paths:
   M /trunk/capture_sync.c

Make the message length in the sync pipe message header 3 bytes of
binary data, so the maximum message length can be up to 2^24-1.

Add a #define for that message size, and have it be 4096, for now, as
that was the size of the buffer used to read sync pipe messages.

Clean up white space.

When displaying an error message from the capture child, don't use it as
a format string - it could conceivably contain "%"s.  Instead, format it
with "%s".

------------------------------------------------------------------------
r16540 | guy | 2005-11-17 17:50:08 -0600 (Thu, 17 Nov 2005) | 4 lines
Changed paths:
   M /trunk/epan/sha1.c

The fopen() is used only if you build this as a stand-alone SHA-1 test
program, not as a library routine; just leave it as fopen(), to simplify
the build process.

------------------------------------------------------------------------
r16539 | sahlberg | 2005-11-17 16:30:19 -0600 (Thu, 17 Nov 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb.c
   M /trunk/epan/dissectors/packet-smb.h
   M /trunk/epan/dissectors/packet-smb2.c

add dissection of more infolevels for smb2


------------------------------------------------------------------------
r16538 | sahlberg | 2005-11-17 08:22:11 -0600 (Thu, 17 Nov 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb.c
   M /trunk/epan/dissectors/packet-smb.h
   M /trunk/epan/dissectors/packet-smb2.c

add dissection of fs_[objectid|full_size]_info


------------------------------------------------------------------------
r16537 | sahlberg | 2005-11-17 08:00:07 -0600 (Thu, 17 Nov 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb.c
   M /trunk/epan/dissectors/packet-smb.h
   M /trunk/epan/dissectors/packet-smb2.c

 add dissection of fs quota info


------------------------------------------------------------------------
r16536 | sahlberg | 2005-11-17 07:43:22 -0600 (Thu, 17 Nov 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb.c
   M /trunk/epan/dissectors/packet-smb.h
   M /trunk/epan/dissectors/packet-smb2.c

add full dissection of fs_[volume|size|device|atrtibute]_info


------------------------------------------------------------------------
r16535 | sahlberg | 2005-11-17 06:30:36 -0600 (Thu, 17 Nov 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb.c
   M /trunk/epan/dissectors/packet-smb.h
   M /trunk/epan/dissectors/packet-smb2.c

add dissection of the security descriptor mask


------------------------------------------------------------------------
r16534 | guy | 2005-11-17 05:50:36 -0600 (Thu, 17 Nov 2005) | 8 lines
Changed paths:
   M /trunk/asn1/cms/packet-cms-template.c
   M /trunk/epan/dissectors/packet-cms.c
   M /trunk/epan/dissectors/packet-cms.h

The SHA-1 routines now take const pointers; don't cast away constness.

tvb_get_ptr() returns a "const guint8 *"; don't bother casting its
return value to "const guint8 *".

"cms_verify_msg_digest()" can be passed a const pointer for "alg"; make
its argument a "const char *".

------------------------------------------------------------------------
r16533 | guy | 2005-11-17 05:48:30 -0600 (Thu, 17 Nov 2005) | 2 lines
Changed paths:
   M /trunk/epan/sha1.c
   M /trunk/epan/sha1.h

Constify arguments.

------------------------------------------------------------------------
r16532 | guy | 2005-11-17 05:16:37 -0600 (Thu, 17 Nov 2005) | 3 lines
Changed paths:
   M /trunk/asn1/x509af/packet-x509af-template.c
   M /trunk/asn1/x509af/packet-x509af-template.h
   M /trunk/epan/dissectors/packet-x509af.c
   M /trunk/epan/dissectors/packet-x509af.h

Get rid of some char * vs. const char * warnings, and declare a function
with no arguments as such.

------------------------------------------------------------------------
r16531 | guy | 2005-11-17 05:15:26 -0600 (Thu, 17 Nov 2005) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-tcp.c

Get rid of an unused variable.

------------------------------------------------------------------------
r16530 | guy | 2005-11-17 05:14:38 -0600 (Thu, 17 Nov 2005) | 3 lines
Changed paths:
   M /trunk/cmdarg_err.h

With GCC 2.x and later, mark cmdarg_err() and cmdarg_err_cont() as being
printf-like.

------------------------------------------------------------------------
r16529 | sahlberg | 2005-11-17 02:21:53 -0600 (Thu, 17 Nov 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

decode the create flags


------------------------------------------------------------------------
r16528 | sahlberg | 2005-11-17 01:32:17 -0600 (Thu, 17 Nov 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

add more updates from the wiki


------------------------------------------------------------------------
r16527 | sahlberg | 2005-11-17 01:04:41 -0600 (Thu, 17 Nov 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

start updating the dissector from wiki updates done


------------------------------------------------------------------------
r16526 | guy | 2005-11-16 23:59:21 -0600 (Wed, 16 Nov 2005) | 13 lines
Changed paths:
   M /trunk/Makefile.common
   M /trunk/capture.h
   M /trunk/capture_opts.c
   M /trunk/clopts_common.c
   M /trunk/clopts_common.h
   A /trunk/cmdarg_err.h
   M /trunk/gtk/main.c
   M /trunk/tethereal.c

Handle "-G" only in Tethereal - it doesn't work in Wireshark, and isn't
necessary there.

Add a "cmdarg_err()" routine to report command-line option errors; it
creates a console if necessary, and prints the command name and the
trailing newline.  Also add "cmdarg_err_cont()", which also creates a
console if necessary, and prints a trailing newline but no command name;
it's used to continue the message.  Use those, rather than
"g_warning()", for errors.

That means that we no longer need to pass the command name to various
command-line argument parsing routines.

------------------------------------------------------------------------
r16525 | guy | 2005-11-16 23:02:30 -0600 (Wed, 16 Nov 2005) | 2 lines
Changed paths:
   M /trunk/asn1/x411/x411.cnf
   M /trunk/asn1/x509if/x509if.cnf
   M /trunk/epan/dissectors/packet-x411.c
   M /trunk/epan/dissectors/packet-x509if.c

Squelch some const vs. non-const warnings.

------------------------------------------------------------------------
r16524 | guy | 2005-11-16 22:54:25 -0600 (Wed, 16 Nov 2005) | 2 lines
Changed paths:
   M /trunk/asn1/x509if/packet-x509if-template.c
   M /trunk/epan/dissectors/packet-x509if.c

Include <epan/emem.h> to declare ep_alloc().

------------------------------------------------------------------------
r16523 | guy | 2005-11-16 22:47:41 -0600 (Wed, 16 Nov 2005) | 3 lines
Changed paths:
   M /trunk/asn1/x411/packet-x411-template.c
   M /trunk/epan/dissectors/packet-x411.c

"dissect_ber_object_identifier_str" expects a "const char **" as its
last argument; make it so.

------------------------------------------------------------------------
r16522 | guy | 2005-11-16 22:15:01 -0600 (Wed, 16 Nov 2005) | 4 lines
Changed paths:
   M /trunk/epan/strutil.h

g_strlcat() and g_ascii_isprint() don't exist in GTK+ at all - they
exist in GLib 2.x, but not in 1.2[.x].  Check the version number of
GLIB, not of GTK+, to decide whether to #define them.

------------------------------------------------------------------------
r16521 | guy | 2005-11-16 22:10:31 -0600 (Wed, 16 Nov 2005) | 11 lines
Changed paths:
   M /trunk/gtk/main.c

Don't list "-B" on UN*X - it's not available there.

On Windows, show it using the same usage-message syntax as other
options.

Clean up the usage message.

When doing the "pre-scan" of command-line arguments, suppress error
messages - that suppresses bogus messages for GTK+ command-line flags,
and gets rid of double messages for other errors.

------------------------------------------------------------------------
r16520 | sahlberg | 2005-11-16 17:17:21 -0600 (Wed, 16 Nov 2005) | 4 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/asn1/dap/packet-dap-template.c
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-dap.c
   A /trunk/epan/dissectors/packet-dap.h
   A /trunk/epan/dissectors/packet-disp.c
   A /trunk/epan/dissectors/packet-disp.h
   A /trunk/epan/dissectors/packet-dsp.c
   A /trunk/epan/dissectors/packet-dsp.h
   A /trunk/epan/dissectors/packet-x501.c
   A /trunk/epan/dissectors/packet-x501.h

add the rest of Graeme Lunts patch



------------------------------------------------------------------------
r16519 | sahlberg | 2005-11-16 17:15:04 -0600 (Wed, 16 Nov 2005) | 3 lines
Changed paths:
   M /trunk/epan/strutil.h

add a g_ascii_isprint() macro so that this symbol can be used for gtk1 platforms as well


------------------------------------------------------------------------
r16518 | sahlberg | 2005-11-16 16:53:33 -0600 (Wed, 16 Nov 2005) | 10 lines
Changed paths:
   A /trunk/asn1/dap
   A /trunk/asn1/dap/Makefile
   A /trunk/asn1/dap/dap-exp.cnf
   A /trunk/asn1/dap/dap.asn
   A /trunk/asn1/dap/dap.cnf
   A /trunk/asn1/dap/packet-dap-template.c
   A /trunk/asn1/dap/packet-dap-template.h
   A /trunk/asn1/disp
   A /trunk/asn1/disp/Makefile
   A /trunk/asn1/disp/disp.asn
   A /trunk/asn1/disp/disp.cnf
   A /trunk/asn1/disp/packet-disp-template.c
   A /trunk/asn1/disp/packet-disp-template.h
   A /trunk/asn1/dsp
   A /trunk/asn1/dsp/Makefile
   A /trunk/asn1/dsp/dsp-exp.cnf
   A /trunk/asn1/dsp/dsp.asn
   A /trunk/asn1/dsp/dsp.cnf
   A /trunk/asn1/dsp/packet-dsp-template.c
   A /trunk/asn1/dsp/packet-dsp-template.h
   A /trunk/asn1/x501
   A /trunk/asn1/x501/Makefile
   A /trunk/asn1/x501/packet-x501-template.c
   A /trunk/asn1/x501/packet-x501-template.h
   A /trunk/asn1/x501/x501-exp.cnf
   A /trunk/asn1/x501/x501.asn
   A /trunk/asn1/x501/x501.cnf

from Graeme Lunt

4 new asn based protocols
X501
DISP
DAP
DSP



------------------------------------------------------------------------
r16517 | ulfl | 2005-11-16 16:08:50 -0600 (Wed, 16 Nov 2005) | 2 lines
Changed paths:
   M /trunk/gtk/main.c

hmmm, buggy bugfix
capture_child isn't initialized already here, so remove the whole error reaction check for now
------------------------------------------------------------------------
r16516 | ulfl | 2005-11-16 15:46:24 -0600 (Wed, 16 Nov 2005) | 1 line
Changed paths:
   M /trunk/gtk/main.c

the "pre-scan" of the command line parameters shouldn't stop the capture child. The child uses a slightly different parameter pattern, so this isn't an error here. Fixes the reported capture problem
------------------------------------------------------------------------
r16515 | etxrab | 2005-11-16 14:25:29 -0600 (Wed, 16 Nov 2005) | 1 line
Changed paths:
   D /trunk/diameter/3GPPSh.xml
   A /trunk/diameter/TGPPSh.xml
   M /trunk/diameter/dictionary.xml

A digit as first letter does not work fix some cut-and-paste errors.
------------------------------------------------------------------------
r16514 | etxrab | 2005-11-16 14:03:09 -0600 (Wed, 16 Nov 2005) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-isup.c

Decose APN messages correctly.
------------------------------------------------------------------------
r16513 | jmayer | 2005-11-16 12:44:05 -0600 (Wed, 16 Nov 2005) | 4 lines
Changed paths:
   M /trunk/manuf.tmpl


Graeme Hewson: Continue to use the old Netscreen name - it makes it
        easier to identify the Juniper firewall products.

------------------------------------------------------------------------
r16512 | sahlberg | 2005-11-16 04:59:41 -0600 (Wed, 16 Nov 2005) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

 add dissection of buffercode
according to
wiki.etehreal.com/SMB2/BufferCode



------------------------------------------------------------------------
r16511 | sahlberg | 2005-11-16 03:27:43 -0600 (Wed, 16 Nov 2005) | 3 lines
Changed paths:
   M /trunk/asn1/x411/packet-x411-template.c
   M /trunk/asn1/x509if/packet-x509if-template.c
   M /trunk/epan/dissectors/packet-x411.c
   M /trunk/epan/dissectors/packet-x411.h
   M /trunk/epan/dissectors/packet-x509if.c
   M /trunk/epan/dissectors/packet-x509if.h
   M /trunk/epan/strutil.h

 add a simple g_strlcat define in strutil   for gtk==1  where this symbol does not exist


------------------------------------------------------------------------
r16510 | etxrab | 2005-11-16 01:21:48 -0600 (Wed, 16 Nov 2005) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-diameter-defs.h
   M /trunk/epan/dissectors/packet-diameter.c

Display AVP:s of Dimater type Unsigned32 as such even when they have "value translation".
------------------------------------------------------------------------
r16509 | etxrab | 2005-11-16 01:16:34 -0600 (Wed, 16 Nov 2005) | 8 lines
Changed paths:
   M /trunk/epan/dissectors/ncp2222.py

From Greg Morris;
The following diff (based on current SVN) fixes the following...
1. Adds additional return value 0xa901 
"Invalid Data Type Flag (outdated return value - replaced in NSS as 0x89aa error)" 
for 87/xx NCP's.
2. Fixes decode for NCP 87/20 reply packets
3. Fixes decode for NCP 89/53 request packets

------------------------------------------------------------------------
r16508 | etxrab | 2005-11-16 01:13:12 -0600 (Wed, 16 Nov 2005) | 39 lines
Changed paths:
   M /trunk/asn1/acse/Makefile.nmake
   M /trunk/asn1/acse/acse.cnf
   M /trunk/asn1/acse/packet-acse-template.c
   M /trunk/asn1/cms/Makefile.nmake
   M /trunk/asn1/cms/cms.cnf
   M /trunk/asn1/cms/packet-cms-template.c
   M /trunk/asn1/ess/ExtendedSecurityServices.asn
   M /trunk/asn1/ess/Makefile.nmake
   M /trunk/asn1/ess/ess.cnf
   M /trunk/asn1/rtse/Makefile.nmake
   M /trunk/asn1/rtse/packet-rtse-template.c
   M /trunk/asn1/rtse/rtse.cnf
   M /trunk/asn1/s4406/Makefile.nmake
   M /trunk/asn1/s4406/s4406.asn
   M /trunk/asn1/s4406/s4406.cnf
   M /trunk/asn1/x411/Makefile.nmake
   M /trunk/asn1/x411/packet-x411-template.c
   M /trunk/asn1/x411/x411.cnf
   M /trunk/asn1/x420/x420.cnf
   M /trunk/asn1/x509af/AuthenticationFramework.asn
   M /trunk/asn1/x509af/Makefile.nmake
   M /trunk/asn1/x509af/packet-x509af-template.c
   M /trunk/asn1/x509af/packet-x509af-template.h
   M /trunk/asn1/x509af/x509af.cnf
   M /trunk/asn1/x509if/Makefile.nmake
   M /trunk/asn1/x509if/packet-x509if-template.c
   M /trunk/asn1/x509if/packet-x509if-template.h
   M /trunk/asn1/x509if/x509if-exp.cnf
   M /trunk/asn1/x509if/x509if.cnf
   M /trunk/asn1/x509sat/Makefile.nmake
   M /trunk/asn1/x509sat/SelectedAttributeTypes.asn
   M /trunk/asn1/x509sat/x509sat.cnf
   M /trunk/epan/dissectors/packet-acse.c
   M /trunk/epan/dissectors/packet-cms.c
   M /trunk/epan/dissectors/packet-ess.c
   M /trunk/epan/dissectors/packet-rtse.c
   M /trunk/epan/dissectors/packet-rtse.h
   M /trunk/epan/dissectors/packet-s4406.c
   M /trunk/epan/dissectors/packet-s5066.c
   M /trunk/epan/dissectors/packet-x411.c
   M /trunk/epan/dissectors/packet-x411.h
   M /trunk/epan/dissectors/packet-x509af.c
   M /trunk/epan/dissectors/packet-x509af.h
   M /trunk/epan/dissectors/packet-x509if.c
   M /trunk/epan/dissectors/packet-x509if.h
   M /trunk/epan/dissectors/packet-x509sat.c
   M /trunk/epan/dissectors/packet-x509sat.h

From Graeme Lunt:
Here are a number of small patches for asn1 based dissectors:

acse:
  release request/response column information (many X.400/X.500 unbinds are
empty)
  "standardised" PNAME to "ISO 8650-1 OSI Association Control Service"
  fix for crash when using EXTERNAL dissector

rtse:
  column information when attempting a resume

x509if:
  generation of LDAP-style DNs from RDNSequences 
  new function x509if_get_last_dn() to get the last DN generated.

x509af:
  DSS parameters
  certificate extension naming
  subject naming of certificate

x509sat:
  Guide syntax (as SET now supported)
  PDU exports.
  
cms:
  verification of message digest attribute (SHA-1 and MD5)
  
ess:
  enumerated/restrictive/permissive/informative security categories

x411:
  generation of string encoding of X.400 addresses, trace information and message identifiers.

s4406:
  separate types for primary and copy precedence to allow better filtering (e.g. primary precedence = flash)
  priority-level-qualifier


------------------------------------------------------------------------
r16507 | guy | 2005-11-15 04:56:18 -0600 (Tue, 15 Nov 2005) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ospf.c

Handle OSPF V3 prefixes similarly to the way other IPv6 prefixes are
handled (but not the same, as the prefix length in OSPF is rounded up to
a multiple of 4 bytes, not just a byte).  This simplifies the code, and
keeps us from overflowing the buffer we allocate if the prefix length is
> 128 (we now just report that as an error).

------------------------------------------------------------------------
r16506 | sahlberg | 2005-11-15 02:49:34 -0600 (Tue, 15 Nov 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

add decoding of extended attributes


------------------------------------------------------------------------
r16505 | kukosa | 2005-11-14 07:05:17 -0600 (Mon, 14 Nov 2005) | 3 lines
Changed paths:
   M /trunk/asn1/h450/packet-h450-template.c
   M /trunk/epan/dissectors/packet-h225.c
   M /trunk/epan/dissectors/packet-h235.c
   M /trunk/epan/dissectors/packet-h245.c
   M /trunk/epan/dissectors/packet-h450.c
   M /trunk/epan/dissectors/packet-per.c
   M /trunk/epan/dissectors/packet-per.h
   M /trunk/epan/dissectors/packet-t38.c
   M /trunk/tools/asn2eth.py

improvements in value constraint support
- NO_BOUND is defined instead of usage -1
- negative bound is handled properly for INTEGER
------------------------------------------------------------------------
r16504 | sahlberg | 2005-11-14 07:02:23 -0600 (Mon, 14 Nov 2005) | 6 lines
Changed paths:
   M /trunk/asn1/x411/packet-x411-template.c
   M /trunk/epan/dissectors/packet-x411.c
   M /trunk/epan/dissectors/packet-x411.h

move the include of emem.h a bit further down
so it does know what size_t is when emem is included.

i needed this change to get it to compile on my box


------------------------------------------------------------------------
r16503 | sahlberg | 2005-11-14 06:06:39 -0600 (Mon, 14 Nov 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

some more infol;evels decoded


------------------------------------------------------------------------
r16502 | guy | 2005-11-14 04:49:13 -0600 (Mon, 14 Nov 2005) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gssapi.h

Fix the declaration of gssapi_lookup_oid_str() to match its definition.

------------------------------------------------------------------------
r16501 | kukosa | 2005-11-14 04:02:31 -0600 (Mon, 14 Nov 2005) | 3 lines
Changed paths:
   M /trunk/asn1/acse/acse.cnf
   M /trunk/asn1/acse/packet-acse-template.c
   M /trunk/asn1/cmip/cmip.cnf
   M /trunk/asn1/cmip/packet-cmip-template.c
   M /trunk/asn1/cms/cms.cnf
   M /trunk/asn1/cms/packet-cms-template.c
   M /trunk/asn1/ess/ess.cnf
   M /trunk/asn1/ess/packet-ess-template.c
   M /trunk/asn1/ftam/ftam.cnf
   M /trunk/asn1/ftam/packet-ftam-template.c
   M /trunk/asn1/ocsp/ocsp.cnf
   M /trunk/asn1/ocsp/packet-ocsp-template.c
   M /trunk/asn1/pkix1explicit/packet-pkix1explicit-template.c
   M /trunk/asn1/pkix1explicit/pkix1explicit.cnf
   M /trunk/asn1/pkixcmp/cmp.cnf
   M /trunk/asn1/pkixcmp/packet-cmp-template.c
   M /trunk/asn1/pkixcrmf/crmf.cnf
   M /trunk/asn1/pkixcrmf/packet-crmf-template.c
   M /trunk/asn1/pkixqualified/packet-pkixqualified-template.c
   M /trunk/asn1/pkixqualified/pkixqualified.cnf
   M /trunk/asn1/pres/packet-pres-template.c
   M /trunk/asn1/pres/pres.cnf
   M /trunk/asn1/spnego/packet-spnego-template.c
   M /trunk/asn1/spnego/spnego.cnf
   M /trunk/asn1/tcap/packet-tcap-template.c
   M /trunk/asn1/tcap/tcap.cnf
   M /trunk/asn1/x411/packet-x411-template.c
   M /trunk/asn1/x411/x411.cnf
   M /trunk/asn1/x420/packet-x420-template.c
   M /trunk/asn1/x420/x420.cnf
   M /trunk/asn1/x509af/packet-x509af-template.c
   M /trunk/asn1/x509af/x509af.cnf
   M /trunk/asn1/x509ce/packet-x509ce-template.c
   M /trunk/asn1/x509ce/x509ce.cnf
   M /trunk/asn1/x509if/packet-x509if-template.c
   M /trunk/asn1/x509if/x509if.cnf
   M /trunk/epan/dissectors/packet-acse.c
   M /trunk/epan/dissectors/packet-ber.c
   M /trunk/epan/dissectors/packet-ber.h
   M /trunk/epan/dissectors/packet-cmip.c
   M /trunk/epan/dissectors/packet-cmp.c
   M /trunk/epan/dissectors/packet-cms.c
   M /trunk/epan/dissectors/packet-crmf.c
   M /trunk/epan/dissectors/packet-ess.c
   M /trunk/epan/dissectors/packet-ftam.c
   M /trunk/epan/dissectors/packet-gssapi.c
   M /trunk/epan/dissectors/packet-ocsp.c
   M /trunk/epan/dissectors/packet-pkix1explicit.c
   M /trunk/epan/dissectors/packet-pkixqualified.c
   M /trunk/epan/dissectors/packet-pres.c
   M /trunk/epan/dissectors/packet-spnego.c
   M /trunk/epan/dissectors/packet-tcap.c
   M /trunk/epan/dissectors/packet-x411.c
   M /trunk/epan/dissectors/packet-x420.c
   M /trunk/epan/dissectors/packet-x509af.c
   M /trunk/epan/dissectors/packet-x509ce.c
   M /trunk/epan/dissectors/packet-x509if.c

 - dissect_ber_object_identifier() returns value as tvb
 - new dissect_ber_object_identifier_str() function
 - BER dissectors adapted and regenerated
------------------------------------------------------------------------
r16500 | etxrab | 2005-11-13 14:53:24 -0600 (Sun, 13 Nov 2005) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-h263.c

Fix Bug 566  H.263: in display filters, ftype bit masked by sbit 

------------------------------------------------------------------------
r16499 | etxrab | 2005-11-13 12:09:44 -0600 (Sun, 13 Nov 2005) | 1 line
Changed paths:
   M /trunk/asn1/ranap/Makefile.nmake
   M /trunk/asn1/ranap/packet-ranap-template.c
   M /trunk/asn1/ranap/ranap.asn
   M /trunk/epan/dissectors/packet-ranap.c

Fix the lenght calculation.
------------------------------------------------------------------------
r16498 | etxrab | 2005-11-13 10:40:55 -0600 (Sun, 13 Nov 2005) | 1 line
Changed paths:
   A /trunk/diameter/3GPPSh.xml
   M /trunk/diameter/dictionary.xml
   M /trunk/diameter/imscxdx.xml
   M /trunk/diameter/mobileipv4.xml
   M /trunk/diameter/nasreq.xml

Update some 3GPP AVP:s
------------------------------------------------------------------------
r16497 | sahlberg | 2005-11-12 17:17:06 -0600 (Sat, 12 Nov 2005) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

prettify read/write



------------------------------------------------------------------------
r16496 | sahlberg | 2005-11-12 17:05:29 -0600 (Sat, 12 Nov 2005) | 11 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

prettify smb2

always put the filename in col_info if it is known

for getinfo/setinfo  put the class/level in colinfo as well.


this makes it very easy to see in the packet summary which file a icommand applies to and what kind of info is requested



------------------------------------------------------------------------
r16495 | sahlberg | 2005-11-12 16:05:53 -0600 (Sat, 12 Nov 2005) | 16 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rlogin.c

from martin marthieson

updates to rlogin

Hi, this patch:
- uses value_string for control message field
- doesn't use a single global time value to mark start of all conversations!
- corrects client-user-name, server-user-name order in initial user-info
message
- adds data (text input/output) into the protocol tree
- makes lots more things filterable
- improves info column text (always calls rlogin_display() now)
- cleans up some whitespace



------------------------------------------------------------------------
r16494 | sahlberg | 2005-11-12 15:56:02 -0600 (Sat, 12 Nov 2005) | 16 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb.c

from Laurent Constantin

updates to smb
A patch for packet-smb.c is attached:
- it improves timeout decoding
- it defines common NT transaction IOCTL functions
- it corrects decoding of resume key in search queries
- it defines a new function dissect_4_2_16_8_unsure() to replace
  dissect_4_2_16_8(). I'm unsure if it is correct. As said in
  comments, it works for me, but I find strange that nobody noticed
  dissect_4_2_16_8() was wrong. So, it is between "#if 0".
  Someone else should confirm dissect_4_2_16_8_unsure() works
  before activating it.



------------------------------------------------------------------------
r16493 | sahlberg | 2005-11-12 15:14:17 -0600 (Sat, 12 Nov 2005) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

if we get the error BUTTER_TOO_SMALL coming back in a getinfo reply   the data will just be 4 bytes and will contain the required buffer size

------------------------------------------------------------------------
r16492 | ulfl | 2005-11-12 10:44:54 -0600 (Sat, 12 Nov 2005) | 3 lines
Changed paths:
   M /trunk/wiretap/file_util.h

minor mkdir bugfix from Gisle Vanem


------------------------------------------------------------------------
r16491 | sahlberg | 2005-11-12 05:42:06 -0600 (Sat, 12 Nov 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

the timestamps of negprot are known


------------------------------------------------------------------------
r16490 | sahlberg | 2005-11-12 05:27:34 -0600 (Sat, 12 Nov 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb.c
   M /trunk/epan/dissectors/packet-smb.h
   M /trunk/epan/dissectors/packet-smb2.c

 improve the dissection of Create and fill in most of the fields


------------------------------------------------------------------------
r16489 | guy | 2005-11-12 05:05:02 -0600 (Sat, 12 Nov 2005) | 12 lines
Changed paths:
   M /trunk/file.c
   M /trunk/gtk/packet_list.c
   M /trunk/gtk/progress_dlg.c
   M /trunk/gtk/proto_draw.c
   M /trunk/gtk/rtp_analysis.c
   M /trunk/progress_dlg.h
   M /trunk/proto_hier_stats.c

Allow a progress dialog to have "Stop" or "Cancel" as the "terminate
button"; "Stop" should be used for operations that can only be stopped
(meaning that what it's already done isn't undone), not cancelled
(meaning that whatever it's already done *is* undone), for which
"Cancel" is used.

Allow the merging process to be cancelled.

Clean up indentation.

Update some comments.

------------------------------------------------------------------------
r16488 | ulfl | 2005-11-12 04:09:02 -0600 (Sat, 12 Nov 2005) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-lldp.c
   M /trunk/epan/oui.h

(on behalf of the PROFIBUS Nutzerorganisation e.V. Deutschland):
add some PROFINET specific LLDP extensions
------------------------------------------------------------------------
r16487 | sahlberg | 2005-11-12 04:07:12 -0600 (Sat, 12 Nov 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb.c
   M /trunk/epan/dissectors/packet-smb.h
   M /trunk/epan/dissectors/packet-smb2.c

dissect more of Close request/response


------------------------------------------------------------------------
r16486 | ulfl | 2005-11-12 04:01:35 -0600 (Sat, 12 Nov 2005) | 1 line
Changed paths:
   M /trunk/capture_opts.c

including io.h isn't needed
------------------------------------------------------------------------
r16485 | ulfl | 2005-11-12 03:39:24 -0600 (Sat, 12 Nov 2005) | 1 line
Changed paths:
   M /trunk/plugins/profinet/packet-pn-dcp.c

minor enhancements
------------------------------------------------------------------------
r16484 | sahlberg | 2005-11-12 02:48:02 -0600 (Sat, 12 Nov 2005) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc.c
   M /trunk/epan/dissectors/packet-smb2.c
   M /trunk/epan/dissectors/packet-smb2.h

add initial decode of dcerpc over smb2


it does not yet multiplex between different files   but it is better than nothing


------------------------------------------------------------------------
r16483 | sahlberg | 2005-11-12 01:45:01 -0600 (Sat, 12 Nov 2005) | 11 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c
   M /trunk/epan/dissectors/packet-smb2.h

in order to handle dcerpc over smb2 later and to make the heuristics stronger for determining what might and what might not be a pipe


add   TID tracking.   for all TreeConnect requests/resposnes seen,   store the name->tid mapping and other metadata.


as a freebee    the disswection of the tid in the ehader is aware of this table so when a tid value is dissected in the header and we known the name for this tid   then put it in an expansion below the tid.




------------------------------------------------------------------------
r16482 | sahlberg | 2005-11-11 22:23:52 -0600 (Fri, 11 Nov 2005) | 10 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c
   M /trunk/epan/dissectors/packet-smb2.h

start separating things out into structures
we can regenerate from the header
we need to remember between request/response
we need on a per conersation bases

to reduce the amount of data we store in the per req/resp  pair  since there will be many of them and we want that struct as small as possible.




------------------------------------------------------------------------
r16481 | sahlberg | 2005-11-11 19:21:43 -0600 (Fri, 11 Nov 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc-nt.c

 a guid is only 16  bytes  so dont highlight 20 bytes in the hexpane


------------------------------------------------------------------------
r16480 | jmayer | 2005-11-11 18:42:45 -0600 (Fri, 11 Nov 2005) | 1 line
Changed paths:
   M /trunk/epan/dissectors/pidl/idl_types.h

Update to samba 11681
------------------------------------------------------------------------
r16479 | jmayer | 2005-11-11 18:42:03 -0600 (Fri, 11 Nov 2005) | 24 lines
Changed paths:
   M /trunk/tools/pidl/TODO
   M /trunk/tools/pidl/lib/Parse/Pidl/NDR.pm
   M /trunk/tools/pidl/lib/Parse/Pidl/Samba/NDR/Header.pm
   M /trunk/tools/pidl/lib/Parse/Pidl/Samba/NDR/Server.pm
   M /trunk/tools/pidl/lib/Parse/Pidl/Samba/Template.pm

Update to samba 11691:
------------------------------------------------------------------------
r11535 | jelmer | 2005-11-06 14:53:37 +0100 (Sun, 06 Nov 2005) | 2 lines
Changed paths:
   M /branches/SAMBA_4_0/source/pidl/lib/Parse/Pidl/Samba/Template.pm

Support void functions when generating templates.

------------------------------------------------------------------------
r11539 | jelmer | 2005-11-06 15:31:01 +0100 (Sun, 06 Nov 2005) | 4 lines
Changed paths:
   M /branches/SAMBA_4_0/source/pidl/TODO
   M /branches/SAMBA_4_0/source/pidl/lib/Parse/Pidl/NDR.pm
   M /branches/SAMBA_4_0/source/pidl/lib/Parse/Pidl/Samba/NDR/Header.pm
   M /branches/SAMBA_4_0/source/pidl/lib/Parse/Pidl/Samba/NDR/Server.pm
   M /branches/SAMBA_4_0/source/pidl/lib/Parse/Pidl/Samba/Template.pm

Fix indentation in templates. Always generate lower-case
UUID strings as GUID_from_string seems to have trouble with
uppercased ones.

------------------------------------------------------------------------


------------------------------------------------------------------------
r16478 | jmayer | 2005-11-11 18:25:27 -0600 (Fri, 11 Nov 2005) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c
   M /trunk/epan/dissectors/packet-smb2.h

Propset svn:...
------------------------------------------------------------------------
r16477 | sahlberg | 2005-11-11 16:12:10 -0600 (Fri, 11 Nov 2005) | 10 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc-nt.c
   M /trunk/epan/dissectors/packet-dcerpc-nt.h
   M /trunk/epan/dissectors/packet-smb2.c

in smb2   the file handles are not normal context handles    they are just a guid

make them a guid in smb2 dissector and make tim pottesr excellent conmtext handle tracking also able to do the same thing for GUIDs


( a context handle is just a 32 biut attribute field followed by a uuid anyway)




------------------------------------------------------------------------
r16476 | etxrab | 2005-11-11 16:05:21 -0600 (Fri, 11 Nov 2005) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-isup.c

fix:
Malformed packet IAM, Calling party number 
Application transport -  some code clean up. 
bug 551 Nor Med PC ethereal-bugs@ethereal.com NEW SS7, ISUP, IAM-signal, malformed packet (not) 
Bug 554 Min Low PC ethereal-bugs@ethereal.com NEW ETSI codec dissection error in BICC 
------------------------------------------------------------------------
r16475 | sahlberg | 2005-11-11 06:49:42 -0600 (Fri, 11 Nov 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

start decoding notify requests


------------------------------------------------------------------------
r16474 | sahlberg | 2005-11-11 05:35:10 -0600 (Fri, 11 Nov 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

dissect READ packets


------------------------------------------------------------------------
r16473 | sahlberg | 2005-11-11 05:14:14 -0600 (Fri, 11 Nov 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

write offset is 32 bits   so is write length


------------------------------------------------------------------------
r16472 | sahlberg | 2005-11-11 05:03:00 -0600 (Fri, 11 Nov 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

 add allocation size


------------------------------------------------------------------------
r16471 | sahlberg | 2005-11-11 04:26:36 -0600 (Fri, 11 Nov 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

add decode of endoffile for file infolevel 0x12


------------------------------------------------------------------------
r16470 | sahlberg | 2005-11-11 03:09:31 -0600 (Fri, 11 Nov 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

class:3  level:0 is just a normal nt security descvriptor


------------------------------------------------------------------------
r16469 | sahlberg | 2005-11-11 02:23:11 -0600 (Fri, 11 Nov 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

opcode 0x0c is Cancel


------------------------------------------------------------------------
r16468 | sahlberg | 2005-11-11 02:14:59 -0600 (Fri, 11 Nov 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

opcode 0x0f is Notify


------------------------------------------------------------------------
r16467 | sahlberg | 2005-11-11 02:04:32 -0600 (Fri, 11 Nov 2005) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

SMB2_FILE_INFO_0a  structure   which is used with SetInfo  to rename a file



------------------------------------------------------------------------
r16466 | sahlberg | 2005-11-11 01:49:13 -0600 (Fri, 11 Nov 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

dont dereference null pointers


------------------------------------------------------------------------
r16465 | sahlberg | 2005-11-11 01:41:09 -0600 (Fri, 11 Nov 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

the uid is 64 bits


------------------------------------------------------------------------
r16464 | sahlberg | 2005-11-10 22:35:22 -0600 (Thu, 10 Nov 2005) | 6 lines
Changed paths:
   M /trunk/epan/stream.c

from albert chin


remove some c99-isms


------------------------------------------------------------------------
r16463 | sahlberg | 2005-11-10 21:50:53 -0600 (Thu, 10 Nov 2005) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/Makefile.common
   M /trunk/epan/dissectors/packet-smb2.c
   A /trunk/epan/dissectors/packet-smb2.h

break out some structures into packet-smb2.h   so we can start tapping in later

we will do service-response-time   statistics before other inferior products have even noticed a new protocol is in town.




------------------------------------------------------------------------
r16462 | gerald | 2005-11-10 18:04:37 -0600 (Thu, 10 Nov 2005) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-p_mul.c

Don't use null values for blurbs in header fields.

------------------------------------------------------------------------
r16461 | sahlberg | 2005-11-10 16:46:10 -0600 (Thu, 10 Nov 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

start decoding SMB2_FILE_INFO_22


------------------------------------------------------------------------
r16460 | sahlberg | 2005-11-10 15:52:55 -0600 (Thu, 10 Nov 2005) | 5 lines
Changed paths:
   M /trunk/epan/dtd_preparse.l

from albert chan

dont use a variable with the name dirname since it will collide with symbols on some hosts


------------------------------------------------------------------------
r16459 | sahlberg | 2005-11-10 15:50:30 -0600 (Thu, 10 Nov 2005) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-cimd.c
   M /trunk/epan/dissectors/packet-dcp.c

from albert chin


dont use c++ style comments


------------------------------------------------------------------------
r16458 | sahlberg | 2005-11-10 04:08:32 -0600 (Thu, 10 Nov 2005) | 11 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

use the policy_handle framework for dcerpc    to trach which frame a policy handle is opened in and which one it is closed in.


also attempt to store a name for it   like File:foo


but this does not work yet.




------------------------------------------------------------------------
r16457 | guy | 2005-11-10 01:42:23 -0600 (Thu, 10 Nov 2005) | 2 lines
Changed paths:
   M /trunk/epan/prefs.c
   M /trunk/epan/proto.c

Don't pass signed characters to the <ctype.h> macros.

------------------------------------------------------------------------
r16456 | guy | 2005-11-10 01:26:30 -0600 (Thu, 10 Nov 2005) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-slimp3.c

Include <ctype.h> to declare "isprint()".

------------------------------------------------------------------------
r16455 | guy | 2005-11-09 21:16:25 -0600 (Wed, 09 Nov 2005) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ipv6.h

There's no guarantee that BYTE_ORDER is defined as anything useful, and
the BYTE_ORDER == BIG_ENDIAN values for FMIP_HI_FLAG_ASSIGNED and
FMIP_HI_FLAG_BUFFER are bogus for the way they're used anyway (they're
used to check bits in a one-byte value), so throw away those values, and
get rid of the leading 00 in the BYTE_ORDER == LITTLE_ENDIAN values.

------------------------------------------------------------------------
r16454 | guy | 2005-11-09 21:00:43 -0600 (Wed, 09 Nov 2005) | 2 lines
Changed paths:
   M /trunk/gtk/toolbar.c

Skip some toolbar #includes if we're not using GTK+ 2.x.

------------------------------------------------------------------------
r16453 | guy | 2005-11-09 20:49:54 -0600 (Wed, 09 Nov 2005) | 4 lines
Changed paths:
   M /trunk/wiretap/file_wrappers.c

Include <unistd.h> if available, to get "close()" declared.

Update the big comment to reflect current reality.

------------------------------------------------------------------------
r16452 | etxrab | 2005-11-09 15:50:39 -0600 (Wed, 09 Nov 2005) | 2 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/dissectors/packet-rtcp.c

From Andrei Emeltchenko
I have added new RTCP POC fields as OMA standard says. With some additions. 
------------------------------------------------------------------------
r16451 | sahlberg | 2005-11-09 15:06:06 -0600 (Wed, 09 Nov 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

add initial decode for SMB2_FS_INFO_01


------------------------------------------------------------------------
r16450 | sahlberg | 2005-11-09 14:57:56 -0600 (Wed, 09 Nov 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

add decode of SMB2_FS_INFO_05 


------------------------------------------------------------------------
r16449 | sahlberg | 2005-11-09 14:37:49 -0600 (Wed, 09 Nov 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

add decoding of the create request


------------------------------------------------------------------------
r16448 | gerald | 2005-11-09 10:01:35 -0600 (Wed, 09 Nov 2005) | 10 lines
Changed paths:
   M /trunk/epan/dissectors/packet-p_mul.c

From Stig Bjrlykke:

I just learned how easy it is to reassemble multiple UDP packets, so  I
had to implement this for the P_Mul protocol :)

This patch fixes:
* Reassemble multiple data packets
* Add packet length check
* Fix for PDU type in tree entry

------------------------------------------------------------------------
r16447 | sahlberg | 2005-11-09 07:19:57 -0600 (Wed, 09 Nov 2005) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

some more of the never ending stream of smb2 updates



------------------------------------------------------------------------
r16446 | sahlberg | 2005-11-09 04:18:31 -0600 (Wed, 09 Nov 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

add decode of Write commands


------------------------------------------------------------------------
r16445 | sahlberg | 2005-11-09 03:29:41 -0600 (Wed, 09 Nov 2005) | 10 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

add support for Close   and the new guess that the FID is present in the Find request.


Ohoy sailor,    we have spotted the concept of current working directory.

does this mean we also get rid of the silly 200-256 byte path length limitation?




------------------------------------------------------------------------
r16444 | sahlberg | 2005-11-09 03:14:11 -0600 (Wed, 09 Nov 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

dissect more of the SMB2/Close function


------------------------------------------------------------------------
r16443 | guy | 2005-11-09 02:46:24 -0600 (Wed, 09 Nov 2005) | 5 lines
Changed paths:
   M /trunk/gtk/main.c

Remove comment that no longer applies.

If we get a getopt() error in the pre-scanning, quit - don't do all the
GUI stuff and re-scan the arguments (and print the error message twice).

------------------------------------------------------------------------
r16442 | ulfl | 2005-11-08 18:39:20 -0600 (Tue, 08 Nov 2005) | 1 line
Changed paths:
   M /trunk/docbook/release-notes.xml

Updated feature: When cancelling a file load operation...
------------------------------------------------------------------------
r16441 | ulfl | 2005-11-08 16:24:53 -0600 (Tue, 08 Nov 2005) | 9 lines
Changed paths:
   M /trunk/file.c

from Jaap Keuter:
Anyone having objections to idea of stopping the load of a capture file
i.s.o. cancelling it? I'm refering to WishList Data I/O item #6.
It seems a very reasonable idea and easy to implement.

I've done some extensions:
-Improve the corresponding comment on the implications why this is useful
-added a new simple_dialog text to explain what's really going on (simply using the WTAP truncated packet message was a bit misleading)

------------------------------------------------------------------------
r16440 | etxrab | 2005-11-08 16:18:06 -0600 (Tue, 08 Nov 2005) | 1 line
Changed paths:
   M /trunk/epan/asn1.h
   M /trunk/epan/dissectors/format-oid.h
   M /trunk/epan/dissectors/packet-cops.c

Move def of subid_t to format-oid.h don't include asn1.h in cops any more.
------------------------------------------------------------------------
r16439 | sahlberg | 2005-11-08 15:16:36 -0600 (Tue, 08 Nov 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

 start dissecting SMB2_FILE_INFO_12


------------------------------------------------------------------------
r16438 | gerald | 2005-11-08 09:28:15 -0600 (Tue, 08 Nov 2005) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gtp.c

From Peter Kovar: Fix the typo referenced in bug 577.

------------------------------------------------------------------------
r16437 | gerald | 2005-11-08 09:23:20 -0600 (Tue, 08 Nov 2005) | 2 lines
Changed paths:
   M /trunk/docbook/release-notes.xml

Fix a cut-and-pasteo.

------------------------------------------------------------------------
r16436 | gerald | 2005-11-08 09:22:38 -0600 (Tue, 08 Nov 2005) | 7 lines
Changed paths:
   M /trunk/docbook/release-notes.xml
   M /trunk/epan/dissectors/packet-gtp.c

You don't tug on Superman's cape.  You don't spit into the wind.
You don't pull the mask off the old Lone Ranger, and you don't
overflow a guint8.  Fixes the infinite loop in bug 576.

Fix up whitespace.  Add an entry to the release notes.  Apologies
to Jim Croce.

------------------------------------------------------------------------
r16435 | sahlberg | 2005-11-08 03:20:04 -0600 (Tue, 08 Nov 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

dissect some of GetInfo requests and Replies


------------------------------------------------------------------------
r16434 | sahlberg | 2005-11-08 02:53:55 -0600 (Tue, 08 Nov 2005) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

add a comment to keep the dissector in sync with the wiki

rename functions 0x10 and 0x11 to follow the names in the wiki



------------------------------------------------------------------------
r16433 | sahlberg | 2005-11-08 02:41:42 -0600 (Tue, 08 Nov 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

add a pointer to the wiki for documentation of this protocol


------------------------------------------------------------------------
r16432 | sahlberg | 2005-11-08 02:40:32 -0600 (Tue, 08 Nov 2005) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

 add dissection of the known parts of negotiate protocol



------------------------------------------------------------------------
r16431 | guy | 2005-11-07 22:03:50 -0600 (Mon, 07 Nov 2005) | 3 lines
Changed paths:
   M /trunk/configure.in

When using GCC, compile with -Wpointer-arith, to catch code that some
other C compilers can't handle.

------------------------------------------------------------------------
r16430 | guy | 2005-11-07 16:50:34 -0600 (Mon, 07 Nov 2005) | 8 lines
Changed paths:
   M /trunk/epan/dissectors/packet-s5066.c

Use "proto_tree_add_item()", not "proto_tree_add_bytes()", if you're
just supplying the result of "tvb_get_ptr()" with the same tvbuff,
offset, and length as the byte array.

Get rid of an unused variable.

Set svn:keywords and svn:eol-style appropriately.

------------------------------------------------------------------------
r16429 | gerald | 2005-11-07 15:58:27 -0600 (Mon, 07 Nov 2005) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dec-dnart.c

Fix an ftsanity.py error.

------------------------------------------------------------------------
r16428 | gerald | 2005-11-07 15:54:08 -0600 (Mon, 07 Nov 2005) | 9 lines
Changed paths:
   M /trunk/epan/dissectors/packet-s5066.c

Fix bug 575, from Menno Andriesse:

  In two functions that call proto_tree_add_bytes I forgot the
  'tvb_get_ptr' function, the argument was 'FALSE' instead.  This gave
  a predictable 'NULL' pointer bug...

Fix an ftsanity.py error.  Fixup whitespace.


------------------------------------------------------------------------
r16427 | sahlberg | 2005-11-07 15:19:59 -0600 (Mon, 07 Nov 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

begin dissecting the Find response packet


------------------------------------------------------------------------
r16426 | guy | 2005-11-07 15:10:52 -0600 (Mon, 07 Nov 2005) | 8 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rtcp.c

The return value of tvb_get_ptr() is a const ptr; assign it to a const
ptr.

The answer to the question
"??????????????????????????????????????????????????????????????????" is
"No - the return value of tvb_get_ptr() is a reference, not an allocated
copy, and it cannot be freed and doesn't need to be freed."

------------------------------------------------------------------------
r16425 | sahlberg | 2005-11-07 15:00:09 -0600 (Mon, 07 Nov 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

dissect the treeconnect request packet


------------------------------------------------------------------------
r16424 | sahlberg | 2005-11-07 14:32:27 -0600 (Mon, 07 Nov 2005) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

add request response matching so we can start passing info levels around from request to response and start dissecting some of the commands



------------------------------------------------------------------------
r16423 | guy | 2005-11-07 14:14:40 -0600 (Mon, 07 Nov 2005) | 4 lines
Changed paths:
   M /trunk/wiretap/ascend.c

The problem wasn't that <sys/stat.h> wasn't being included, the problem
was that file_util.h wasn't in the distribution tarball, so it couldn't
be included - it handles including <sys/stat.h>.

------------------------------------------------------------------------
r16422 | ulfl | 2005-11-07 13:51:16 -0600 (Mon, 07 Nov 2005) | 1 line
Changed paths:
   M /trunk/wiretap/Makefile.common

add file_util.h so distcheck might work
------------------------------------------------------------------------
r16421 | etxrab | 2005-11-07 13:40:55 -0600 (Mon, 07 Nov 2005) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-rtcp.c

Display MSW and LSW as NTP timestamp as well.
------------------------------------------------------------------------
r16420 | etxrab | 2005-11-07 13:39:38 -0600 (Mon, 07 Nov 2005) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-alcap.c

Dissect NSAP
------------------------------------------------------------------------
r16419 | etxrab | 2005-11-07 13:39:02 -0600 (Mon, 07 Nov 2005) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-isup.c

Bug fix to dissection of NSAP E164 Country codes
------------------------------------------------------------------------
r16418 | etxrab | 2005-11-07 13:37:10 -0600 (Mon, 07 Nov 2005) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dec-dnart.c

Martin Hill has examined packet-dec-dnart.c and found some errors and made some improvements.

------------------------------------------------------------------------
r16417 | etxrab | 2005-11-07 13:35:48 -0600 (Mon, 07 Nov 2005) | 4 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-p_mul.c

From Stig Bjrlykke

A new dissector for P_Mul (ACP142) http://www.jcs.mil/j6/cceb/acps/Acp142.pdf

------------------------------------------------------------------------
r16416 | guy | 2005-11-07 11:18:52 -0600 (Mon, 07 Nov 2005) | 2 lines
Changed paths:
   M /trunk/wiretap/ascend.c

You need <sys/stat.h>, if present, to use fstat().

------------------------------------------------------------------------
r16415 | guy | 2005-11-07 11:12:43 -0600 (Mon, 07 Nov 2005) | 5 lines
Changed paths:
   M /trunk/wiretap/file_util.h

The standard <dirent.h> routines to rewind and close a directory are
rewinddir() and closedir().

Clean up indentation.

------------------------------------------------------------------------
r16414 | sahlberg | 2005-11-07 02:57:04 -0600 (Mon, 07 Nov 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

put the error code in col info


------------------------------------------------------------------------
r16413 | sahlberg | 2005-11-07 02:39:23 -0600 (Mon, 07 Nov 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

smb2 updates,    most of the header is now decoded properly


------------------------------------------------------------------------
r16412 | guy | 2005-11-07 02:36:25 -0600 (Mon, 07 Nov 2005) | 3 lines
Changed paths:
   M /trunk/epan/plugins.c
   M /trunk/fileset.c

Use eth_dir_open(), not g_dir_open(); g_dir_open() isn't available in
GLib 1.2[.x].

------------------------------------------------------------------------
r16411 | guy | 2005-11-07 02:35:28 -0600 (Mon, 07 Nov 2005) | 3 lines
Changed paths:
   M /trunk/pcap-util-unix.c

This is UN*X-only, so it doesn't need to use the eth_close() wrapper;
close() will be available.

------------------------------------------------------------------------
r16410 | guy | 2005-11-06 20:47:09 -0600 (Sun, 06 Nov 2005) | 6 lines
Changed paths:
   M /trunk/epan/addr_resolv.c
   M /trunk/epan/filesystem.c
   M /trunk/epan/plugins.c
   M /trunk/epan/prefs.c
   M /trunk/plugins/asn1/packet-asn1.c
   M /trunk/plugins/mate/mate_util.c

Use <wiretap/file_util.h> to include "file_util.h"; otherwise, the
include fails as we don't do -Iwiretap.

If we have it, include <sys/stat.h> in epan/filesystem.c - we need it
for stat() and the macros and structures it uses.

------------------------------------------------------------------------
r16409 | guy | 2005-11-06 20:45:19 -0600 (Sun, 06 Nov 2005) | 8 lines
Changed paths:
   M /trunk/wiretap/file_access.c
   M /trunk/wiretap/file_wrappers.c
   M /trunk/wiretap/file_wrappers.h

If we're using libz, make file_open() construct the open() flag
argument, rather than requiring the caller to get the open() flag and
the fopen() flag in sync.  That also means that if we're *not* using
libz, it can just be a wrapper around eth_fopen().

We need to include <fcntl.h>, at least on UN*X, to get open() declared
and the O_ flags defined.

------------------------------------------------------------------------
r16408 | guy | 2005-11-06 20:38:34 -0600 (Sun, 06 Nov 2005) | 2 lines
Changed paths:
   M /trunk/capture_loop.c

Fix a typo.

------------------------------------------------------------------------
r16407 | guy | 2005-11-06 20:35:02 -0600 (Sun, 06 Nov 2005) | 2 lines
Changed paths:
   M /trunk/tethereal.c

Include <wiretap/file_util.h> to declare the eth_ routines.

------------------------------------------------------------------------
r16406 | ulfl | 2005-11-06 18:20:20 -0600 (Sun, 06 Nov 2005) | 3 lines
Changed paths:
   M /trunk/util.c
   M /trunk/wiretap/file_util.h

as mkstemp makes trouble and is only used once in util.c, move definition from file_util.h to util.c for now

this hopefully fixes the mkstemp problem
------------------------------------------------------------------------
r16405 | guy | 2005-11-06 17:21:03 -0600 (Sun, 06 Nov 2005) | 4 lines
Changed paths:
   M /trunk/wiretap/file_util.h

Get rid of CRs and set svn:eol-style to native, so that Windows machines
get the CRs and UN*X machines don't.  Also set svn:keywords to Id to
expand RCS IDs.

------------------------------------------------------------------------
r16404 | ulfl | 2005-11-06 17:11:49 -0600 (Sun, 06 Nov 2005) | 1 line
Changed paths:
   M /trunk/wiretap/file_util.h

Obviously, <glib/gstdio.h> is available since GLib version 2.6 only ...
------------------------------------------------------------------------
r16403 | ulfl | 2005-11-06 16:43:25 -0600 (Sun, 06 Nov 2005) | 7 lines
Changed paths:
   M /trunk/capture.c
   M /trunk/capture_loop.c
   M /trunk/capture_sync.c
   M /trunk/color_filters.c
   M /trunk/config.h.win32
   M /trunk/disabled_protos.c
   M /trunk/epan/addr_resolv.c
   M /trunk/epan/column.c
   M /trunk/epan/dissectors/packet-kerberos.c
   M /trunk/epan/filesystem.c
   M /trunk/epan/plugins.c
   M /trunk/epan/prefs.c
   M /trunk/epan/sha1.c
   M /trunk/file.c
   M /trunk/fileset.c
   M /trunk/filters.c
   M /trunk/gtk/capture_if_dlg.c
   M /trunk/gtk/drag_and_drop.c
   M /trunk/gtk/file_dlg.c
   M /trunk/gtk/fileset_dlg.c
   M /trunk/gtk/filter_dlg.h
   M /trunk/gtk/follow_dlg.c
   M /trunk/gtk/graph_analysis.c
   M /trunk/gtk/gui_utils.c
   M /trunk/gtk/help_dlg.c
   M /trunk/gtk/main.c
   M /trunk/gtk/print_dlg.c
   M /trunk/gtk/print_mswin.c
   M /trunk/gtk/proto_draw.c
   M /trunk/gtk/recent.c
   M /trunk/gtk/rtp_analysis.c
   M /trunk/gtk/rtp_stream.c
   M /trunk/gtk/text_page.c
   M /trunk/mergecap.c
   M /trunk/mkstemp.c
   M /trunk/pcap-util-unix.c
   M /trunk/plugins/asn1/packet-asn1.c
   M /trunk/plugins/mate/mate_util.c
   M /trunk/print.c
   M /trunk/ringbuffer.c
   M /trunk/tethereal.c
   M /trunk/util.c
   M /trunk/wiretap/ascend.c
   M /trunk/wiretap/config.h.win32
   M /trunk/wiretap/file_access.c
   A /trunk/wiretap/file_util.h
   M /trunk/wiretap/file_wrappers.c
   M /trunk/wiretap/file_wrappers.h
   M /trunk/wiretap/k12.c
   M /trunk/wiretap/wtap.c

replace *a lot* of file related calls by their GLib counterparts. This is necessary for the switch to GTK 2.6 (at least on WIN32).

to do this, I've added file_util.h to wiretap (would file_compat.h be a better name?), and provide compat_macros like eth_open() instead of open(). While at it, move other file related things there, like #include <io.h>, definition of O_BINARY and alike, so it's all in one place.

deleted related things from config.h.win32

As of these massive changes, I'm almost certain that this will break the Unix build. I'll keep an eye on the buildbot so hopefully everything is working again soon.
------------------------------------------------------------------------
r16402 | sahlberg | 2005-11-06 07:04:57 -0600 (Sun, 06 Nov 2005) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

dissect some of the session setup and the security blob for smb2



------------------------------------------------------------------------
r16401 | sahlberg | 2005-11-06 05:55:17 -0600 (Sun, 06 Nov 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

dissect the smb2 request/response flag


------------------------------------------------------------------------
r16400 | sahlberg | 2005-11-06 05:46:10 -0600 (Sun, 06 Nov 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

dissect the smb2 tree id


------------------------------------------------------------------------
r16399 | sahlberg | 2005-11-05 23:32:01 -0600 (Sat, 05 Nov 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb2.c

some smb2 updates


------------------------------------------------------------------------
r16398 | sahlberg | 2005-11-05 22:18:13 -0600 (Sat, 05 Nov 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-smb2.c

add an empty dissector for SMB2


------------------------------------------------------------------------
r16397 | etxrab | 2005-11-05 15:38:22 -0600 (Sat, 05 Nov 2005) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-amr.c
   M /trunk/epan/dissectors/packet-rtp.c
   M /trunk/epan/dissectors/packet-rtp.h
   M /trunk/gtk/rtp_analysis.c

Packet-amr Register as  "AMR" not "amr".

Add Dynamic PT:s mimestring  to rtp_info if avalable.
Use Dynamic PT:s mime string to find clock rate.
------------------------------------------------------------------------
r16396 | sahlberg | 2005-11-05 14:32:33 -0600 (Sat, 05 Nov 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-clnp.c

get rid of some strcat


------------------------------------------------------------------------
r16395 | sahlberg | 2005-11-04 20:03:21 -0600 (Fri, 04 Nov 2005) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-brdwlk.c

get rid of an array and dissect a bitmask properly
get rid of some strcat()s


------------------------------------------------------------------------
r16394 | sahlberg | 2005-11-04 19:23:06 -0600 (Fri, 04 Nov 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ncp.c

remove an array and some strcat from ncp


------------------------------------------------------------------------
r16393 | sahlberg | 2005-11-04 17:03:26 -0600 (Fri, 04 Nov 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ospf.c

remove an array and the remaining strcat from ospf


------------------------------------------------------------------------
r16392 | sahlberg | 2005-11-04 15:55:23 -0600 (Fri, 04 Nov 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ospf.c

get rid of some strcat  and a stackbased array


------------------------------------------------------------------------
r16391 | sahlberg | 2005-11-04 15:22:21 -0600 (Fri, 04 Nov 2005) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-winsrepl.c

from Metze

some winsrepl updates


------------------------------------------------------------------------
r16390 | sahlberg | 2005-11-04 15:14:33 -0600 (Fri, 04 Nov 2005) | 8 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-s5066.c

From Menno Andriesse

New protocol : STANAG 5066

I changed it from being a plugin to a builtin dissector
and also changed a couple of small bugs


------------------------------------------------------------------------
r16389 | etxrab | 2005-11-03 13:14:52 -0600 (Thu, 03 Nov 2005) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_a.c

Fix a typo and change TLLI representation to HEX.
------------------------------------------------------------------------
r16388 | jmayer | 2005-11-03 09:23:09 -0600 (Thu, 03 Nov 2005) | 1 line
Changed paths:
   M /trunk/tools/pidl/TODO
   M /trunk/tools/pidl/lib/Parse/Pidl/Ethereal/NDR.pm
   M /trunk/tools/pidl/lib/Parse/Pidl/NDR.pm
   M /trunk/tools/pidl/lib/Parse/Pidl/Samba/NDR/Parser.pm

Update to samba svn 11484
------------------------------------------------------------------------
r16387 | guy | 2005-11-02 22:35:39 -0600 (Wed, 02 Nov 2005) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-cmp.c

"dissect_cmp_http()" doesn't check for a valid packet (it doesn't need
to, it's selected by the media-type string, not something unreliable
such as a port number), and doesn't return anything, so give it the
right type and don't declare it as a "new-style" dissector.

------------------------------------------------------------------------
r16386 | guy | 2005-11-02 22:33:51 -0600 (Wed, 02 Nov 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bacapp.c

Get rid of (valid) warning about uninitialized variable, and clean up
indentation.

------------------------------------------------------------------------
r16385 | guy | 2005-11-02 22:32:11 -0600 (Wed, 02 Nov 2005) | 3 lines
Changed paths:
   M /trunk/gtk/plugins_dlg.c

Get rid of no-longer-used code (the list of plugins is now just a tab in
Help->About, not a separate dialog from Help->About Plugins).

------------------------------------------------------------------------
r16384 | guy | 2005-11-02 22:30:35 -0600 (Wed, 02 Nov 2005) | 3 lines
Changed paths:
   M /trunk/epan/ftypes/ftype-integer.c

Fix usage of PRI[du]64 - they just replace the "letter" part of the
format, they don't include the "%".

------------------------------------------------------------------------
r16383 | lego | 2005-11-02 17:01:15 -0600 (Wed, 02 Nov 2005) | 6 lines
Changed paths:
   M /trunk/asn1/h248/h248.cnf
   M /trunk/asn1/h248/packet-h248-template.c
   M /trunk/epan/dissectors/packet-h248.c

Some cleanup,
- Improve expert info
- Remove the debug tree (one warning unused function, will go)
- Make Sure Pending messages have a cmdmsg (and so a colinfo label)


------------------------------------------------------------------------
r16382 | etxrab | 2005-11-02 15:49:24 -0600 (Wed, 02 Nov 2005) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-isup.c

Handle a optional parameter length of zero.
------------------------------------------------------------------------
r16381 | ulfl | 2005-11-02 14:50:54 -0600 (Wed, 02 Nov 2005) | 2 lines
Changed paths:
   M /trunk/epan/proto.c

MSVC warning fixed:
proto.c(4694) : warning C4101: 'stringified' : unreferenced local variable
------------------------------------------------------------------------
r16380 | etxrab | 2005-11-02 14:28:58 -0600 (Wed, 02 Nov 2005) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-scsi.c

From David Wysochanski fix a typo.
------------------------------------------------------------------------
r16379 | etxrab | 2005-11-02 14:24:42 -0600 (Wed, 02 Nov 2005) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-sip.c

Use dissect_sip_tcp_heur for TCP to make re-assembly work on hueristics.
------------------------------------------------------------------------
r16378 | lego | 2005-11-02 13:46:47 -0600 (Wed, 02 Nov 2005) | 4 lines
Changed paths:
   M /trunk/asn1/h248/h248.cnf
   M /trunk/asn1/h248/packet-h248-template.c
   M /trunk/epan/dissectors/packet-h248.c

- terminate a value_string
- wildcard field subdissector


------------------------------------------------------------------------
r16377 | ulfl | 2005-11-02 13:33:46 -0600 (Wed, 02 Nov 2005) | 2 lines
Changed paths:
   M /trunk/plugins/profinet/ChangeLog
   M /trunk/plugins/profinet/moduleinfo.h
   M /trunk/plugins/profinet/packet-pn-dcp.c

minor enhancement (raised plugin version to 0.1.2):
PN-DCP: dissection of "DHCP/DHCP client identifier" suboption was added
------------------------------------------------------------------------
r16376 | etxrab | 2005-11-02 01:51:55 -0600 (Wed, 02 Nov 2005) | 6 lines
Changed paths:
   M /trunk/asn1/camel/Makefile.nmake
   M /trunk/asn1/camel/camel.asn
   M /trunk/asn1/camel/packet-camel-template.c
   M /trunk/asn1/inap/packet-inap-template.c
   M /trunk/epan/dissectors/packet-camel.c
   M /trunk/epan/dissectors/packet-camel.h
   M /trunk/epan/dissectors/packet-inap.c
   M /trunk/epan/dissectors/packet-inap.h

From Tim

A small patch for camel and inap, where the linkedid doesn't get dissected correctly in camel or inap
and some tidy up in the camel asn.1 which now compiles with no warnings.

also fix the copy_file target (/y)
------------------------------------------------------------------------
r16375 | lego | 2005-11-01 15:09:28 -0600 (Tue, 01 Nov 2005) | 5 lines
Changed paths:
   M /trunk/asn1/h248/packet-h248-template.c
   M /trunk/asn1/h248/packet-h248-template.h
   M /trunk/epan/dissectors/packet-h248.c
   M /trunk/epan/dissectors/packet-h248.h

- add a counter for pending messages
- do not use a value string for context ids
- remove the plugin registration as it is not supposedd to be a plugin


------------------------------------------------------------------------
r16374 | etxrab | 2005-11-01 13:50:25 -0600 (Tue, 01 Nov 2005) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-xml.c

Add "application/resource-lists+xml" to xml types
------------------------------------------------------------------------
r16373 | obiot | 2005-11-01 12:18:46 -0600 (Tue, 01 Nov 2005) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-image-gif.c
   M /trunk/epan/dissectors/packet-image-jfif.c
   M /trunk/epan/dissectors/packet-mmse.c
   M /trunk/epan/dissectors/packet-smpp.c
   M /trunk/epan/dissectors/packet-wbxml.c
   M /trunk/epan/dissectors/packet-wsp.c

Use g_print() instead of fprintf() to write messages to the debug console.

------------------------------------------------------------------------
r16372 | lego | 2005-11-01 10:28:13 -0600 (Tue, 01 Nov 2005) | 3 lines
Changed paths:
   M /trunk/asn1/h248/h248.cnf
   M /trunk/asn1/h248/packet-h248-template.c
   M /trunk/asn1/h248/packet-h248-template.h
   M /trunk/epan/dissectors/packet-h248.c
   M /trunk/epan/dissectors/packet-h248.h

- Embryonic Transaction & Context tracing


------------------------------------------------------------------------
r16371 | guy | 2005-10-30 21:45:11 -0600 (Sun, 30 Oct 2005) | 2 lines
Changed paths:
   M /trunk/doc/ethereal-filter.pod.template

Improve the description of "contains" and "matches" a bit.

------------------------------------------------------------------------
r16370 | guy | 2005-10-30 21:33:14 -0600 (Sun, 30 Oct 2005) | 2 lines
Changed paths:
   M /trunk/epan/dfilter/dfvm.c

Dump the range when printing an MK_RANGE operator.

------------------------------------------------------------------------
r16369 | guy | 2005-10-30 20:42:22 -0600 (Sun, 30 Oct 2005) | 18 lines
Changed paths:
   M /trunk/epan/dfilter/dfvm.c
   M /trunk/epan/ftypes/ftype-bytes.c
   M /trunk/epan/ftypes/ftype-integer.c
   M /trunk/epan/ftypes/ftype-pcre.c
   M /trunk/epan/ftypes/ftype-string.c
   M /trunk/epan/ftypes/ftype-tvbuff.c
   M /trunk/epan/proto.c
   M /trunk/plugins/mate/mate_util.c

When printing the code for a display filter:

	print register numbers as unsigned (they're guint32);

	when printing a PUT_FVALUE instruction, show the value as well
	as the type of the value.

That requires that a bunch of types get to_repr methods; add them for
PCRE (FTREPR_DFILTER-only - show the regular expression as text),
tvbuffs (FTREPR_DFILTER_only - show the data as a hex string), integral
types, string types other than FT_STRING, and FT_IPv6.

That means we can use fvalue_to_string_repr() for FT_IPXNET and FT_IPv6
in proto_construct_dfilter_string(), and that we don't need to handle
integer and floating types specially in MATE.

Fix some problems with the PCRE execution code for tvbuff types.

------------------------------------------------------------------------
r16368 | guy | 2005-10-30 20:21:02 -0600 (Sun, 30 Oct 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

Get rid of an unused variable, and declare a variable that points into a
tvbuff's data const.

------------------------------------------------------------------------
r16367 | guy | 2005-10-30 17:01:12 -0600 (Sun, 30 Oct 2005) | 2 lines
Changed paths:
   M /trunk/epan/libethereal.def

Export fvalue_get_integer64(), for completeness.

------------------------------------------------------------------------
r16366 | guy | 2005-10-30 16:55:30 -0600 (Sun, 30 Oct 2005) | 2 lines
Changed paths:
   M /trunk/epan/ftypes/ftype-ipv4.c

"XXX.XXX.XXX.XXX" is 15 characters, not 14 characters.

------------------------------------------------------------------------
r16365 | guy | 2005-10-30 14:16:01 -0600 (Sun, 30 Oct 2005) | 4 lines
Changed paths:
   M /trunk/capture_loop.c

Make capture filter (and capture filter error message) strings "safe" as
necessary before putting them into an error message dialog.  Fixes bug
564.

------------------------------------------------------------------------
r16364 | ulfl | 2005-10-30 07:46:40 -0600 (Sun, 30 Oct 2005) | 1 line
Changed paths:
   M /trunk/doc/ethereal-filter.pod.template

very minor enhancements
------------------------------------------------------------------------
r16363 | jmayer | 2005-10-30 03:14:38 -0600 (Sun, 30 Oct 2005) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

- Split dissect_wendor_specific_ie into
  dissect_vendor_ie_wpawme and dissect_vendor_ie_rsn
- Display the vendor code on the top level of vendor specific IEs
- Make the vendor code of vendor specific IEs filterable
  (wlan_mgt.tag.oui)


------------------------------------------------------------------------
r16362 | jmayer | 2005-10-30 03:13:27 -0600 (Sun, 30 Oct 2005) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ieee80211.c

- Remove trailing whitespace
- IS_WEP is now (11i) called IS_PROTECTED
- Remove duplicate (and commented out) code
- Add reson code 0x24 to reason_codes


------------------------------------------------------------------------
r16361 | guy | 2005-10-29 18:22:13 -0500 (Sat, 29 Oct 2005) | 12 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mip6.c
   M /trunk/epan/dissectors/packet-mip6.h

Give RFC numbers for MIPv6, NEMO, and FMIPv6.

Fix up NEMO #defines for field offsets, and field and option lengths, to
match #defines for other options.

Handle the padding in the FMIPv6 LLA option internally to the option
parser, and don't include the link-layer address unless it's present. 
Don't handle the length of the LLA option specially in the generic
option parser.

Clean up white space.

------------------------------------------------------------------------
r16360 | sahlberg | 2005-10-29 17:47:20 -0500 (Sat, 29 Oct 2005) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ospf.c

remove some strcat   and dissect the options bitfield properly



------------------------------------------------------------------------
r16359 | guy | 2005-10-29 16:48:37 -0500 (Sat, 29 Oct 2005) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-alcap.c

Use NULL for pointers, 0 for integers, to squelch compiler warnings.

------------------------------------------------------------------------
r16358 | guy | 2005-10-29 16:43:53 -0500 (Sat, 29 Oct 2005) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rmt-fec.c

Set "ti" in all code paths, to squelch a compiler warning.

------------------------------------------------------------------------
r16357 | guy | 2005-10-29 16:43:00 -0500 (Sat, 29 Oct 2005) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ncp2222.inc

Get rid of an unused variable.

------------------------------------------------------------------------
r16356 | etxrab | 2005-10-29 10:34:16 -0500 (Sat, 29 Oct 2005) | 2 lines
Changed paths:
   M /trunk/gtk/rtp_analysis.c

From Jaap Keuter
Improvments to PCMA and PCMU handling-
------------------------------------------------------------------------
r16355 | ulfl | 2005-10-29 04:48:29 -0500 (Sat, 29 Oct 2005) | 1 line
Changed paths:
   M /trunk/Makefile.am
   M /trunk/README.win32
   D /trunk/cleanbld.bat

remove cleanbld.bat (use the distclean target instead)
------------------------------------------------------------------------
r16354 | sahlberg | 2005-10-28 22:07:26 -0500 (Fri, 28 Oct 2005) | 8 lines
Changed paths:
   M /trunk/epan/dissectors/packet-pvfs2.c

add some simple heuristics for PVFS

make PVFS use tcp_dissect_pdus   so it will handle
reassembly,   pdu boundary tracking, pdu transfer time atc.




------------------------------------------------------------------------
r16353 | sahlberg | 2005-10-28 17:13:13 -0500 (Fri, 28 Oct 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-pvfs2.c

comment out the heuristics registration until we actually implement some heuristics


------------------------------------------------------------------------
r16352 | sahlberg | 2005-10-28 17:08:15 -0500 (Fri, 28 Oct 2005) | 8 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-pvfs2.c

From Mike Frisch

New protocol : PVFS2


Example captures for fuzz testing can be found in Mikes email of Oct 7


------------------------------------------------------------------------
r16351 | etxrab | 2005-10-28 14:27:13 -0500 (Fri, 28 Oct 2005) | 5 lines
Changed paths:
   M /trunk/epan/libethereal.def
   M /trunk/ethereal_gen.py

1. replace "and" with "&&" in wireshark_gen.py:2103

2. add make_printable_string in libethereal.def


------------------------------------------------------------------------
r16350 | gerald | 2005-10-28 10:08:14 -0500 (Fri, 28 Oct 2005) | 5 lines
Changed paths:
   M /trunk/epan/to_str.c

If bytes_to_str() is passed a zero length value, return an empty string
instead of asserting.  Fixes bug 560.

Fix up whitespace.

------------------------------------------------------------------------
r16349 | gerald | 2005-10-28 09:20:18 -0500 (Fri, 28 Oct 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dec-dnart.c

Fix the bit mask for dec_dna.ctl.router_state.  This should fix the
"check ftsanity.py output" error in Buildbot.  Fix up whitespace.

------------------------------------------------------------------------
r16348 | lego | 2005-10-28 07:02:13 -0500 (Fri, 28 Oct 2005) | 8 lines
Changed paths:
   M /trunk/epan/dissectors/packet-alcap.c
   M /trunk/epan/dissectors/packet-alcap.h

Came up to be an almost complete rewrite:

- decode up to Q.2630.3
- (almost) all parameter fields have its own filter expression
- remove buffers from the stack
- add some color (expert info) to the tree


------------------------------------------------------------------------
r16347 | guy | 2005-10-27 15:18:50 -0500 (Thu, 27 Oct 2005) | 6 lines
Changed paths:
   M /trunk/file.c
   M /trunk/gtk/packet_list.c
   M /trunk/gtk/proto_draw.c
   M /trunk/proto_hier_stats.c

Fix uninitialized variable errors.

Rename some variables to make the names used in progress bars more
common.  (Should more of that functionality be moved into common
progress bar code?)

------------------------------------------------------------------------
r16346 | guy | 2005-10-27 14:42:24 -0500 (Thu, 27 Oct 2005) | 7 lines
Changed paths:
   M /trunk/gtk/io_stat.c
   M /trunk/tap-iostat.c

Make the processing of "-z" arguments in the Tethereal I/O stat tap more
like that of the Ethereal I/O stat tap.  Improve error messages in both
taps.

Use nstime() routines and structure assignment to do operations on
nstime_t values.

------------------------------------------------------------------------
r16345 | gerald | 2005-10-27 08:46:32 -0500 (Thu, 27 Oct 2005) | 2 lines
Changed paths:
   M /trunk/docbook/release-notes.xml

Add a CVE item for the IRC bug.

------------------------------------------------------------------------
r16344 | sahlberg | 2005-10-27 06:54:55 -0500 (Thu, 27 Oct 2005) | 3 lines
Changed paths:
   M /trunk/asn1/pkixcrmf/crmf.cnf
   M /trunk/asn1/pkixcrmf/packet-crmf-template.c
   M /trunk/epan/dissectors/packet-crmf.c

register 1.2.840.113533.7.66.13 as passwordbasedmac from CRMF


------------------------------------------------------------------------
r16343 | sahlberg | 2005-10-27 06:27:40 -0500 (Thu, 27 Oct 2005) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ber.c

add decoding of some more universal types for the opportunistic decode of unknown ber blobs.



------------------------------------------------------------------------
r16342 | sahlberg | 2005-10-27 05:11:22 -0500 (Thu, 27 Oct 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-nfs.c

get rid of the last two strcpy   from epan/dissectors


------------------------------------------------------------------------
r16341 | sahlberg | 2005-10-27 04:58:16 -0500 (Thu, 27 Oct 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-nbns.c

remove some strcpy


------------------------------------------------------------------------
r16340 | sahlberg | 2005-10-27 04:48:19 -0500 (Thu, 27 Oct 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mount.c
   M /trunk/epan/dissectors/packet-ncp.c

get rid of some strcpy


------------------------------------------------------------------------
r16339 | sahlberg | 2005-10-27 04:43:32 -0500 (Thu, 27 Oct 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-syslog.c

get rid of a strcpy


------------------------------------------------------------------------
r16338 | sahlberg | 2005-10-27 04:35:14 -0500 (Thu, 27 Oct 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-fclctl.c

get rid of some strcpy


------------------------------------------------------------------------
r16337 | sahlberg | 2005-10-27 04:26:35 -0500 (Thu, 27 Oct 2005) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ppp.c

remove some strcpy



------------------------------------------------------------------------
r16336 | sahlberg | 2005-10-27 04:17:10 -0500 (Thu, 27 Oct 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-t38.c

remove a strcpy() call


------------------------------------------------------------------------
r16335 | sahlberg | 2005-10-27 04:14:07 -0500 (Thu, 27 Oct 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-sip.c

remove a strcpy


------------------------------------------------------------------------
r16334 | sahlberg | 2005-10-27 04:11:00 -0500 (Thu, 27 Oct 2005) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rdt.c

get rid of a strcpy

------------------------------------------------------------------------
r16333 | sahlberg | 2005-10-27 04:07:22 -0500 (Thu, 27 Oct 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rtp.c

remove a strcpy call


------------------------------------------------------------------------
r16332 | sahlberg | 2005-10-27 03:50:42 -0500 (Thu, 27 Oct 2005) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ldap.c

remove a strcpy
make the code A LOT nicer
and get rid of unchecked memcpy



------------------------------------------------------------------------
r16331 | sahlberg | 2005-10-27 03:35:44 -0500 (Thu, 27 Oct 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-fcfzs.c

remove some strcpy


------------------------------------------------------------------------
r16330 | ulfl | 2005-10-27 03:27:46 -0500 (Thu, 27 Oct 2005) | 1 line
Changed paths:
   M /trunk/doc/editcap.pod

simply use 4 spaces for example indentation and formatting
------------------------------------------------------------------------
r16329 | sahlberg | 2005-10-27 03:18:59 -0500 (Thu, 27 Oct 2005) | 8 lines
Changed paths:
   M /trunk/epan/dissectors/packet-fcdns.c

remove some strcpy() and some buffers.


boy o boy   the fc dissector family is in really poor shape and should be rewritten 




------------------------------------------------------------------------
r16328 | ulfl | 2005-10-27 03:09:32 -0500 (Thu, 27 Oct 2005) | 1 line
Changed paths:
   M /trunk/doc/editcap.pod

Synopsis: don't prepend an optional - before the first record number, it won't work
------------------------------------------------------------------------
r16327 | guy | 2005-10-27 01:45:37 -0500 (Thu, 27 Oct 2005) | 5 lines
Changed paths:
   M /trunk/file.c
   M /trunk/gtk/packet_list.c
   M /trunk/gtk/proto_draw.c
   M /trunk/proto_hier_stats.c

Check on every iteration of a loop whether to pop up a dialog box,
rather than checking only on every progress bar update quantum, so that
if the update quantum is *very* large, we don't end up waiting longer
than the standard time for a dialog box before checking.

------------------------------------------------------------------------
r16326 | guy | 2005-10-26 18:10:20 -0500 (Wed, 26 Oct 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ncp2222.inc

Don't run "process_ptvc_record()" on replies unless we're building a
protocol tree.

------------------------------------------------------------------------
r16325 | ulfl | 2005-10-26 16:08:24 -0500 (Wed, 26 Oct 2005) | 9 lines
Changed paths:
   M /trunk/doc/editcap.pod

from Jaap Keuter:
The attached patch extends the synopsys and adds an 'Examples' chapter to
the editcap documentation.

I've edited this a bit, without the real knowledge :-(, to make it:

a. look better
b. make more sense (at least to me)

------------------------------------------------------------------------
r16324 | guy | 2005-10-26 15:21:28 -0500 (Wed, 26 Oct 2005) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ncp2222.inc

Add a comment.

------------------------------------------------------------------------
r16323 | sahlberg | 2005-10-26 15:17:40 -0500 (Wed, 26 Oct 2005) | 5 lines
Changed paths:
   M /trunk/asn1/pkixcmp/packet-cmp-template.c
   M /trunk/epan/dissectors/packet-cmp.c

updates to CMP

implement the glue to dissect CMP oer TCP


------------------------------------------------------------------------
r16322 | etxrab | 2005-10-26 14:52:00 -0500 (Wed, 26 Oct 2005) | 1 line
Changed paths:
   M /trunk/asn1/nbap/packet-nbap-template.c
   M /trunk/epan/dissectors/packet-nbap.c
   M /trunk/epan/dissectors/packet-nbap.h

Add the rest of the IE:s
------------------------------------------------------------------------
r16321 | etxrab | 2005-10-26 14:08:37 -0500 (Wed, 26 Oct 2005) | 3 lines
Changed paths:
   M /trunk/epan/to_str.c

From Mike Duigou
Safer handling for building address string for AT_STRINGZ and AT_URI.

------------------------------------------------------------------------
r16320 | etxrab | 2005-10-26 14:01:29 -0500 (Wed, 26 Oct 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-nettl.c
   M /trunk/wiretap/wtap.h

From  Mark C Brown, 
Small patch correcting nettl.uid to unsigned and adding pduin/pduout as nettl.kind values...

------------------------------------------------------------------------
r16319 | etxrab | 2005-10-26 13:52:46 -0500 (Wed, 26 Oct 2005) | 1 line
Changed paths:
   M /trunk/asn1/gsm_ss/SS-Operations.asn
   M /trunk/asn1/gsm_ss/packet-gsm_ss-template.c
   M /trunk/epan/dissectors/packet-gsm_ss.c

Set correct offset fore some signals, use dummy funtion to get hf fields auto generated.
------------------------------------------------------------------------
r16318 | gerald | 2005-10-26 09:27:12 -0500 (Wed, 26 Oct 2005) | 2 lines
Changed paths:
   M /trunk/docbook/release-notes.xml

Add the recent IRC bug to the release notes.

------------------------------------------------------------------------
r16317 | ulfl | 2005-10-26 03:32:21 -0500 (Wed, 26 Oct 2005) | 3 lines
Changed paths:
   M /trunk/gtk/file_dlg.c

bugfix: don't crash the file open dialog, if the preview gets confused by "invalid" timestamps.

The localtime call will return NULL on invalid input which results in a NULL pointer exception. Simply print '?' if localtime returned NULL.
------------------------------------------------------------------------
r16316 | etxrab | 2005-10-25 15:30:43 -0500 (Tue, 25 Oct 2005) | 1 line
Changed paths:
   M /trunk/asn1/gsm_ss/SS-Operations.asn
   M /trunk/epan/dissectors/packet-gsm_ss.c
   M /trunk/epan/dissectors/packet-gsm_ss.h

Tags should be implicit.
------------------------------------------------------------------------
r16315 | etxrab | 2005-10-25 15:29:50 -0500 (Tue, 25 Oct 2005) | 1 line
Changed paths:
   M /trunk/asn1/ranap/packet-ranap-template.c
   M /trunk/epan/dissectors/packet-ranap.c

As there are more Procedure codes the hueristics need to be updated.
------------------------------------------------------------------------
r16314 | lego | 2005-10-25 14:41:01 -0500 (Tue, 25 Oct 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-iuup.c

some ies in the init proc weren't propperly decoded.


------------------------------------------------------------------------
r16313 | guy | 2005-10-25 14:39:50 -0500 (Tue, 25 Oct 2005) | 2 lines
Changed paths:
   M /trunk/asn1/gsmmap/gsm_map-exp.cnf

Check in re-generated version from Graeme Lunt's fix to asn2eth.

------------------------------------------------------------------------
r16312 | guy | 2005-10-25 14:37:38 -0500 (Tue, 25 Oct 2005) | 5 lines
Changed paths:
   M /trunk/asn1/rtse/packet-rtse-template.c
   M /trunk/epan/dissectors/packet-rtse.c
   M /trunk/epan/dissectors/packet-rtse.h

Don't declare "dissect_rtse_EXTERNAL()" in "packet-rtse.c" - let it get
it from "packet-rtse.h" (which, at least on some platforms, doesn't
declare it as static, so GCC 4.0, at least, fails because the static and
non-static declarations collide).

------------------------------------------------------------------------
r16311 | guy | 2005-10-25 14:35:33 -0500 (Tue, 25 Oct 2005) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-nbap.c
   M /trunk/epan/dissectors/packet-nbap.h

Check in the re-generated NBAP dissector.

------------------------------------------------------------------------
r16310 | lego | 2005-10-25 13:38:47 -0500 (Tue, 25 Oct 2005) | 3 lines
Changed paths:
   M /trunk/asn1/nbap/packet-nbap-template.c
   M /trunk/asn1/ranap/packet-ranap-template.c
   M /trunk/epan/dissectors/packet-ranap.c

Avoid a conflict in global symbols by declaring some variables static.


------------------------------------------------------------------------
r16309 | guy | 2005-10-25 12:49:08 -0500 (Tue, 25 Oct 2005) | 2 lines
Changed paths:
   M /trunk/asn1/ranap/Makefile

We don't have an SS-Operations.asn file, and don't use one.

------------------------------------------------------------------------
r16308 | gram | 2005-10-25 12:10:04 -0500 (Tue, 25 Oct 2005) | 2 lines
Changed paths:
   M /trunk/doc/README.developer

Document ptvcursors.

------------------------------------------------------------------------
r16307 | sahlberg | 2005-10-25 06:24:24 -0500 (Tue, 25 Oct 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-fcdns.c

remove a bunch of arrays, some strcpy() and make it dissect the fc4 type bitmask better


------------------------------------------------------------------------
r16306 | sahlberg | 2005-10-25 05:38:36 -0500 (Tue, 25 Oct 2005) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-fcsb3.c

remove a buffer from the stack and some strcpy()

the previous code had a bug in that it would never display one of the flags unless the other flag was also set.



------------------------------------------------------------------------
r16305 | sahlberg | 2005-10-25 05:24:40 -0500 (Tue, 25 Oct 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-fcsb3.c

remove a stack based array and some strcpy()


------------------------------------------------------------------------
r16304 | guy | 2005-10-25 03:58:27 -0500 (Tue, 25 Oct 2005) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/Makefile.common

Fix a typo.

------------------------------------------------------------------------
r16303 | guy | 2005-10-25 01:20:46 -0500 (Tue, 25 Oct 2005) | 10 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ncp2222.inc

Put the code to handle NDS ping replies and NDS replies into routines of
their own.

Do the tapping as early as possible, so it's done even if exceptions are
thrown - and do it regardless of whether the tree argument is null or
not, because a tap might be run without generating protocol trees.

Generate the expert info regardless of whether the tree arugment is null
or not, as that's also used with taps.

------------------------------------------------------------------------
r16302 | etxrab | 2005-10-25 01:00:53 -0500 (Tue, 25 Oct 2005) | 8 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/dissectors/packet-icmpv6.c
   M /trunk/epan/dissectors/packet-ipv6.h
   M /trunk/epan/dissectors/packet-llc.c
   M /trunk/epan/dissectors/packet-mip6.c
   M /trunk/epan/dissectors/packet-mip6.h

From Martin Andr

the attached patch implements a dissector for the Fast Handovers for Mobile IPv6 protocol (RFC4068). This patch was produced against version 0.10.13 and extends the following files:
- packet-icmpv6.c
- packet-ipv6.h
- packet-mip6.c
- packet-mip6.h

------------------------------------------------------------------------
r16301 | etxrab | 2005-10-25 00:56:21 -0500 (Tue, 25 Oct 2005) | 4 lines
Changed paths:
   M /trunk/epan/llcsaps.h

From Jochen Friedrich 

this patch adds the description for LLC SAP 0xB4 and adds a dissector for basic format XID frames as documented in IEEE802.2. These frames are independent on the SAP / protocol and mandatory to all implementations.

------------------------------------------------------------------------
r16300 | etxrab | 2005-10-25 00:53:12 -0500 (Tue, 25 Oct 2005) | 1 line
Changed paths:
   M /trunk/epan/dissectors/Makefile.common

Add missing file ( packet-ftbp.ch)
------------------------------------------------------------------------
r16299 | etxrab | 2005-10-25 00:52:20 -0500 (Tue, 25 Oct 2005) | 4 lines
Changed paths:
   M /trunk/packaging/nsis/Makefile.nmake

From Jaap Keuter:
Ethereal 0.10.13 and trunk have a glitch in the NSIS Makefile.nmake. It still works with WinPcap_3_1_beta4.exe. The attached patch resolves this.


------------------------------------------------------------------------
r16298 | guy | 2005-10-24 19:28:40 -0500 (Mon, 24 Oct 2005) | 9 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ndps.c

Clean up "print_address()" - fix the indentation, do the check for a
too-large address in common code, and *don't* use tvb_get_letohl() to
get IPv4 addresses (just use proto_tree_add_item(), it works Just Fine).

For integral values, always do the tvb_ensure_bytes_exist() test; don't
just do it if the length is the expected value (the real problem is with
bogus too-large lengths, so it's more important to do the check if the
length *isn't* the expected value!).  Fixes bug 549.

------------------------------------------------------------------------
r16297 | lego | 2005-10-24 16:52:14 -0500 (Mon, 24 Oct 2005) | 3 lines
Changed paths:
   M /trunk/wiretap/wtap.h

forgot this from the last commit


------------------------------------------------------------------------
r16296 | etxrab | 2005-10-24 16:42:19 -0500 (Mon, 24 Oct 2005) | 14 lines
Changed paths:
   M /trunk/asn1/acse/acse-exp.cnf
   M /trunk/asn1/acse/acse.cnf
   M /trunk/asn1/ftam/ftam.cnf
   M /trunk/asn1/ftam/packet-ftam-template.h
   A /trunk/asn1/ftbp
   A /trunk/asn1/ftbp/Makefile
   A /trunk/asn1/ftbp/Makefile.nmake
   A /trunk/asn1/ftbp/ftbp.asn
   A /trunk/asn1/ftbp/ftbp.cnf
   A /trunk/asn1/ftbp/packet-ftbp-template.c
   A /trunk/asn1/ftbp/packet-ftbp-template.h
   M /trunk/asn1/ros/packet-ros-template.c
   M /trunk/asn1/ros/packet-ros-template.h
   M /trunk/asn1/ros/ros.asn
   M /trunk/asn1/ros/ros.cnf
   M /trunk/asn1/rtse/packet-rtse-template.c
   M /trunk/asn1/rtse/packet-rtse-template.h
   M /trunk/asn1/rtse/rtse.cnf
   M /trunk/asn1/s4406/packet-s4406-template.c
   M /trunk/asn1/s4406/s4406.cnf
   M /trunk/asn1/x411/packet-x411-template.c
   M /trunk/asn1/x411/x411.cnf
   M /trunk/asn1/x420/packet-x420-template.c
   M /trunk/asn1/x420/x420-exp.cnf
   M /trunk/asn1/x420/x420.asn
   M /trunk/asn1/x420/x420.cnf
   M /trunk/epan/dissectors/packet-acse.c
   M /trunk/epan/dissectors/packet-acse.h
   M /trunk/epan/dissectors/packet-ftam.c
   M /trunk/epan/dissectors/packet-ftam.h
   A /trunk/epan/dissectors/packet-ftbp.c
   A /trunk/epan/dissectors/packet-ftbp.h
   M /trunk/epan/dissectors/packet-ldap.c
   M /trunk/epan/dissectors/packet-ros.c
   M /trunk/epan/dissectors/packet-ros.h
   M /trunk/epan/dissectors/packet-rtse.c
   M /trunk/epan/dissectors/packet-rtse.h
   M /trunk/epan/dissectors/packet-s4406.c
   M /trunk/epan/dissectors/packet-s4406.h
   M /trunk/epan/dissectors/packet-x411.c
   M /trunk/epan/dissectors/packet-x411.h
   M /trunk/epan/dissectors/packet-x420.c
   M /trunk/epan/dissectors/packet-x420.h
   M /trunk/tools/asn2eth.py

From Graeme Lunt:

The ftbp.patch file includes:
a) A fix to acse.cnf which works around an asn2eth bug (it is the AE-qualifier EXPORT I want, but asn2eth doesn't generate the appropriate extern for the values). Also a small cosmetic change for EXTERNAL decodings.
b) New EXPORTs for the FTAM dissector for use in FTBP.
c) A fix to asn2eth to solve the problem if you EXPORT types that include a '-' character in the name (e.g. "AE-qualifier" from acse.cnf, "Date-and-Time-Attribute" from ftam.cnf). The problem is that asn2eth generates the "xxxx-exp.cnf" file using the 'C' name (which has replaced '-' with '_') rather than the original 'ASN' name. The fix just undoes the replacement as I couldn't see the original name being preserved anywhere. There still remains a problem if the type has a '.' in the name - but generally I don't think they do.

* Better ROS handling and registration
* Simplified RTSE registration
* X411 column information, extension naming and use of new RTSE/ROS registration
* X420 notification extensions, warnings removal and export of ExtensionsField (missed from recent FTBP patch).
* Better highlighting of S4406 protocol.


------------------------------------------------------------------------
r16295 | lego | 2005-10-24 16:26:25 -0500 (Mon, 24 Oct 2005) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-iuup.c

- optionally decode data pdus
- optionally decode a 2 byte pseudo-header
- Beautify colinfo


------------------------------------------------------------------------
r16294 | lego | 2005-10-24 16:20:03 -0500 (Mon, 24 Oct 2005) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-k12.c
   M /trunk/wiretap/k12.c

- packet records with AAL5 Pdus or AAL2 Sdus contain VP/VC and CID info in the packet record, use that instead of the one in the intreface description record.
- Fix Timestamps that got broken with nanoseconds.
- Add some more disabled code for debugging.


------------------------------------------------------------------------
r16293 | etxrab | 2005-10-24 16:16:44 -0500 (Mon, 24 Oct 2005) | 2 lines
Changed paths:
   A /trunk/asn1/nbap
   A /trunk/asn1/nbap/Makefile
   A /trunk/asn1/nbap/Makefile.nmake
   A /trunk/asn1/nbap/nbap.asn
   A /trunk/asn1/nbap/nbap.cnf
   A /trunk/asn1/nbap/packet-nbap-template.c
   A /trunk/asn1/nbap/packet-nbap-template.h
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-nbap.c
   A /trunk/epan/dissectors/packet-nbap.h

UMTS Node B Application Part(NBAP) packet dissection(3GPP TS 25.433 version 6.6.0 Release 6)
All IE:s not dissected yet.
------------------------------------------------------------------------
r16292 | sahlberg | 2005-10-24 03:44:36 -0500 (Mon, 24 Oct 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-fcfzs.c

get rid of a few strcpy and an array from the stack


------------------------------------------------------------------------
r16291 | guy | 2005-10-23 21:49:32 -0500 (Sun, 23 Oct 2005) | 15 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ncp2222.inc

Add #defines for NDS tag values, and use them in the definition of
nds_tags[] and in switch statements.  (Also, catch a case where we
didn't use NDS_PTYPE_ values.)

Use the existing #defines for MVTYPE_ values.

Make the handling of NDS_PTYPE_{IP,UDP,TCP} in one case match the
handling of the other cases (don't advance "ioffset", as it's advanced
by the length of the item).

When checking whether an NDS reply has a completion code, don't check
the fragment size, check the reassembled packet size.

Fix the handling of referrals in one case.

------------------------------------------------------------------------
r16290 | guy | 2005-10-23 21:35:43 -0500 (Sun, 23 Oct 2005) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-irc.c

Don't get caught in an infinite loop if we're stuck at the end of the
captured data.  Fixes bug 548.  (Also note that we need a better general
solution.)

------------------------------------------------------------------------
r16289 | guy | 2005-10-23 21:05:19 -0500 (Sun, 23 Oct 2005) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ncp.c

Clean up indentation.

Hand NCP_ALLOCATE_SLOT and NCP_DEALLOCATE_SLOT packets to
"dissect_ncp_request()", so we match up requests and replies, fill in
the Info column properly, etc..

------------------------------------------------------------------------
r16288 | guy | 2005-10-22 01:25:14 -0500 (Sat, 22 Oct 2005) | 16 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ncp2222.inc

Add #defines of NDS protocol types, and use them in the value_string and
switch statements.

Add some sanity checking for ptvcursor_advance calls.

proto_tree_add_item() works fine for IPv4 addresses; use it for them. 
(tvb_get_letohl() doesn't work fine for them, even though it appears to
do so on little-endian machines.)

Only set the "visible" flag on the protocol tree when we're sure we have
one, so that it gets set even if we create a temporary tree.

Catch exceptions when dissecting requests, and compute and save the
results of conditional tests before rethrowing the exception, so the
results get saved even if the dissection gets an exception.

------------------------------------------------------------------------
r16287 | guy | 2005-10-22 00:43:09 -0500 (Sat, 22 Oct 2005) | 5 lines
Changed paths:
   M /trunk/epan/Makefile.common
   M /trunk/epan/proto.c
   D /trunk/epan/ptvcursor.c

Move the ptvcursor.c code to epan/proto, and make ptvcursor_add() handle
FT_UINT_BYTES and FT_UINT_STRING correctly when the tree argument is
null (which involves carving proto_tree_add_item() into bits and having
both ptvcursor_add() and proto_tree_add_item() call those bits).

------------------------------------------------------------------------
r16286 | guy | 2005-10-22 00:27:48 -0500 (Sat, 22 Oct 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-isis-lsp.c

Use the somewhat-misnamed "ipv4_addr_and_mask()" and
"ipv6_addr_and_mask()" to handle address+prefix bit length combinations.

------------------------------------------------------------------------
r16285 | guy | 2005-10-21 23:09:37 -0500 (Fri, 21 Oct 2005) | 2 lines
Changed paths:
   M /trunk/wiretap/ngsniffer.c

Update URL for Sniffer manual, and expand a comment a bit.

------------------------------------------------------------------------
r16284 | guy | 2005-10-21 22:52:06 -0500 (Fri, 21 Oct 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-iapp.c

Don't roll your own code for showing the usual display of bits in a
bitfield, use the code we already have.

------------------------------------------------------------------------
r16283 | guy | 2005-10-21 22:49:23 -0500 (Fri, 21 Oct 2005) | 7 lines
Changed paths:
   M /trunk/wiretap/ngsniffer.c
   M /trunk/wiretap/wtap-int.h

Add #defines for the DOS Sniffer network types and for various frame
status field bits".

Check for "Internetwork analyzer" captures by checking the Sniffer
network type, and save that type rather than just an "ATM or not" flag
in the private data.

------------------------------------------------------------------------
r16282 | ulfl | 2005-10-21 13:47:04 -0500 (Fri, 21 Oct 2005) | 1 line
Changed paths:
   M /trunk/Makefile.nmake
   M /trunk/config.nmake

Win32: first steps towards using GTK2.6, add zipfile and dir name definitions
------------------------------------------------------------------------
r16281 | gram | 2005-10-21 08:11:04 -0500 (Fri, 21 Oct 2005) | 2 lines
Changed paths:
   M /trunk/gtk/expert_dlg.c

Revert 16279.

------------------------------------------------------------------------
r16280 | etxrab | 2005-10-20 13:51:47 -0500 (Thu, 20 Oct 2005) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rmt-fec.c
   M /trunk/epan/dissectors/packet-rmt-lct.c
   M /trunk/epan/dissectors/packet-rmt-lct.h
   M /trunk/epan/dissectors/packet-rmt-norm.c
   M /trunk/epan/dissectors/packet-rmt-norm.h

From Julian Onions

- some improvements to the NORM decoder, and the ability to
(optionally) heuristically detect NORM.
- some improvements to FEC block labelling.
- making the LCT header extension handler more generic and to decode more header extensions.

------------------------------------------------------------------------
r16279 | gram | 2005-10-20 13:07:03 -0500 (Thu, 20 Oct 2005) | 4 lines
Changed paths:
   M /trunk/gtk/expert_dlg.c

From Greg Morris.
Expert data must perform a re-dissection to trigger the NCP dissector.
Change the call cf_retap_packets() to cf_redissect_packets().

------------------------------------------------------------------------
r16278 | gram | 2005-10-20 13:04:11 -0500 (Thu, 20 Oct 2005) | 3 lines
Changed paths:
   M /trunk/gtk/conversations_table.c

From Greg Morris, patch to allow proper search/filtering of
NCP conversations.

------------------------------------------------------------------------
r16277 | etxrab | 2005-10-20 10:51:39 -0500 (Thu, 20 Oct 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mip6.c
   M /trunk/epan/dissectors/packet-mip6.h

From Bruno Deniaud:
Handle NEMO (RFC  3963).

------------------------------------------------------------------------
r16276 | etxrab | 2005-10-20 10:49:03 -0500 (Thu, 20 Oct 2005) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-uma.c

Use the right offset when calling packet-gsm_a.c functions.
------------------------------------------------------------------------
r16275 | etxrab | 2005-10-20 00:29:53 -0500 (Thu, 20 Oct 2005) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bootp.c

From Stephen Donovan:
Allow Ethereal to decode the IP address inside of Option 118
------------------------------------------------------------------------
r16274 | guy | 2005-10-19 21:45:52 -0500 (Wed, 19 Oct 2005) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/ncp2222.py

Put back some comments that got removed and that note issues seen with
some captures.

------------------------------------------------------------------------
r16273 | ulfl | 2005-10-19 16:08:34 -0500 (Wed, 19 Oct 2005) | 8 lines
Changed paths:
   M /trunk/docbook/edg_src/EDG_chapter_dissection.xml

from Jaap Keuter:
Working with the reassembly functionality Ethereal provides I've found
some additional changes had to be made to the EDG 8.4.1:
- a typo (made by myself)
- fragment_add_seq_check() doesn't take -1 as length remaining
- process_reassembled_data() can be called with or without tree, and
  is required in both dissection runs
- some whitespace stuff
------------------------------------------------------------------------
r16272 | guy | 2005-10-19 14:40:55 -0500 (Wed, 19 Oct 2005) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ncp2222.inc

At least on Tiger, multiple definitions of an external don't work.

------------------------------------------------------------------------
r16270 | gerald | 2005-10-19 10:36:59 -0500 (Wed, 19 Oct 2005) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-slsk.c

Ethereal doesn't like it when you try to tell it that integers are
either -1 or 0 bytes long.  Use proto_tree_add_text() instead of
proto_tree_add_uint_format().  Fixes bug 542.

------------------------------------------------------------------------
r16269 | gram | 2005-10-19 09:45:24 -0500 (Wed, 19 Oct 2005) | 3 lines
Changed paths:
   M /trunk/gtk/Makefile.common
   A /trunk/gtk/conversations_ncp.c
   A /trunk/gtk/ncp_stat.c

From Greg Morris.
Adds NCP data to conversations and SRT.

------------------------------------------------------------------------
r16268 | gram | 2005-10-19 09:39:09 -0500 (Wed, 19 Oct 2005) | 8 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ncp-nmas.c

From Greg Morris:

Updates to the NMAS dissector.
 
1. Fixes error checking fragments
2. Adds expert data


------------------------------------------------------------------------
r16267 | gram | 2005-10-19 09:32:05 -0500 (Wed, 19 Oct 2005) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ndps.c

From Greg Morris:

Adds expert data to the NDPS dissector


------------------------------------------------------------------------
r16266 | gram | 2005-10-19 09:28:26 -0500 (Wed, 19 Oct 2005) | 36 lines
Changed paths:
   M /trunk/epan/dissectors/Makefile.common
   M /trunk/epan/dissectors/ncp2222.py
   M /trunk/epan/dissectors/packet-ncp-int.h
   A /trunk/epan/dissectors/packet-ncp-sss.c
   A /trunk/epan/dissectors/packet-ncp-sss.h
   M /trunk/epan/dissectors/packet-ncp.c
   M /trunk/epan/dissectors/packet-ncp2222.inc

From Greg Morris:

makefile.common.diff - epan directory
1. Adds new packet-ncp-sss.c and packet-ncp-sss.h for new Secret Store dissector
 
New Novell Secret Store Services dissector
packet-ncp-sss.c
packet-ncp-sss.h
 
ncp2222.py.diff
1. Adds a number of return values
2. Adds 64bit file size support
3. Add NCP 89,xx NCP's for UTF8 support
4. Fixes a number of field values for proper dissection
5. Adds support for Secret Store dissector
 
packet-ncp2222.inc.diff
1. Skwelches some compiler warnings
2. Redo of fix for bug 535 which original fix broke dissection of NDS verb 5
3. Adds support for Secret Store dissector
4. Adds expert data
5. Adds tap for service response time
6. Fixes dissection of stream attribute
7. Fixes defragmentation problem with more then 10 fragments
8. Fixes NDS dissection if reply buffer was less then 7
 
packet-ncp.c.diff
1. Adds tap data
2. Adds expert data
3. Fixes calculation for NCP connection number
4. Fixes malformed packet for destroy service connection
 
packet-ncp.c.diff
1. Adds tap data


------------------------------------------------------------------------
r16265 | guy | 2005-10-19 02:57:38 -0500 (Wed, 19 Oct 2005) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-cdp.c

Point specifically to the CDP information on the various Cisco pages.

------------------------------------------------------------------------
r16264 | jmayer | 2005-10-18 09:59:30 -0500 (Tue, 18 Oct 2005) | 1 line
Changed paths:
   M /trunk/tools/pidl/TODO
   M /trunk/tools/pidl/idl.yp
   M /trunk/tools/pidl/lib/Parse/Pidl/Dump.pm
   M /trunk/tools/pidl/lib/Parse/Pidl/Ethereal/Conformance.pm
   M /trunk/tools/pidl/lib/Parse/Pidl/Ethereal/NDR.pm
   M /trunk/tools/pidl/lib/Parse/Pidl/IDL.pm
   M /trunk/tools/pidl/lib/Parse/Pidl/NDR.pm
   M /trunk/tools/pidl/lib/Parse/Pidl/Samba/NDR/Client.pm
   M /trunk/tools/pidl/lib/Parse/Pidl/Samba/NDR/Parser.pm
   M /trunk/tools/pidl/lib/Parse/Pidl/Samba3/Client.pm
   M /trunk/tools/pidl/lib/Parse/Pidl/Samba3/Header.pm
   M /trunk/tools/pidl/lib/Parse/Pidl/Samba3/Parser.pm
   M /trunk/tools/pidl/lib/Parse/Pidl/Samba3/Server.pm
   M /trunk/tools/pidl/lib/Parse/Pidl/Samba3/Types.pm
   M /trunk/tools/pidl/pidl

Update from samba tree
------------------------------------------------------------------------
