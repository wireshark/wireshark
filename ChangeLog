------------------------------------------------------------------------
r12759 | gerald | 2004-12-15 11:03:33 -0600 (Wed, 15 Dec 2004) | 3 lines
Changed paths:
   M /releases/ethereal-0.10.8/gtk/h323_conversations.c
   M /releases/ethereal-0.10.8/gtk/sctp_assoc_analyse.c
   M /releases/ethereal-0.10.8/gtk/sctp_byte_graph_dlg.c
   M /releases/ethereal-0.10.8/gtk/sctp_error_dlg.c
   M /releases/ethereal-0.10.8/gtk/sctp_graph_dlg.c
   M /releases/ethereal-0.10.8/gtk/sctp_stat.c
   M /releases/ethereal-0.10.8/gtk/sctp_stat.h
   M /releases/ethereal-0.10.8/gtk/sctp_stat_dlg.c
   M /releases/ethereal-0.10.8/plugins/enttec/packet-enttec.c

Copy over some indentation and C/C++ comment fixes from r12710 that
didn't make it the first time around.

------------------------------------------------------------------------
r12758 | gerald | 2004-12-15 10:29:34 -0600 (Wed, 15 Dec 2004) | 2 lines
Changed paths:
   M /releases/ethereal-0.10.8/NEWS

Final changes for 0.10.8.

------------------------------------------------------------------------
r12754 | gerald | 2004-12-14 17:15:46 -0600 (Tue, 14 Dec 2004) | 2 lines
Changed paths:
   M /releases/ethereal-0.10.8/ChangeLog
   M /releases/ethereal-0.10.8/NEWS

Updates for the 0.10.8 release.

------------------------------------------------------------------------
r12753 | gerald | 2004-12-14 14:25:11 -0600 (Tue, 14 Dec 2004) | 19 lines
Changed paths:
   M /releases/ethereal-0.10.8/AUTHORS
   M /releases/ethereal-0.10.8/epan/dissectors/packet-gsm_sms.c

Copy revisions from the trunk:

r12718:

 From Victor Stratan:
 
 GSM SMS fixes:
 
  - Made Timezone view human readable based on 3GPP TS 23.040 V6.5.0 (9.2.3.11).
 
  - TP-UDHI field - located within bit no 6 one more place was left over from
    previous patch by Viorel Suman made on 9 Dec 2004.

r12750:

 From Victor Stratan: correct offset calculation and add TP-PID decoding
 in SMS-SUBMIT-REPORT decoding based on 3GPP TS 23.040 V6.5.0 9.2.3.11.


------------------------------------------------------------------------
r12752 | gerald | 2004-12-14 14:06:17 -0600 (Tue, 14 Dec 2004) | 12 lines
Changed paths:
   M /releases/ethereal-0.10.8/epan/dissectors/packet-bssgp.c

Copy revisions from the trunk:

r12717:

Fix another lengt issue, and comment out some other faulty code - to
tired to fix it now.

r12727:

Add IMSI to the tree if it's built.


------------------------------------------------------------------------
r12714 | gerald | 2004-12-10 12:26:12 -0600 (Fri, 10 Dec 2004) | 2 lines
Changed paths:
   M /releases/ethereal-0.10.8/epan/dissectors/packet-bssgp.c
   M /releases/ethereal-0.10.8/epan/dissectors/packet-cops.c
   M /releases/ethereal-0.10.8/epan/dissectors/packet-dcerpc-pn-io.c
   M /releases/ethereal-0.10.8/epan/dissectors/packet-gsm_a.c
   M /releases/ethereal-0.10.8/epan/dissectors/packet-gsm_sms.c
   M /releases/ethereal-0.10.8/epan/dissectors/packet-pn-rt.c

Copy over revisions 12710 - 12713 from the trunk.

------------------------------------------------------------------------
r12709 | gerald | 2004-12-09 17:26:33 -0600 (Thu, 09 Dec 2004) | 2 lines
Changed paths:
   M /releases/ethereal-0.10.8/epan/dissectors/packet-cops.c

Copy over r12708 from the trunk.

------------------------------------------------------------------------
r12707 | gerald | 2004-12-09 16:18:49 -0600 (Thu, 09 Dec 2004) | 14 lines
Changed paths:
   M /releases/ethereal-0.10.8/AUTHORS
   M /releases/ethereal-0.10.8/epan/dissectors/packet-windows-common.c

From Brian Caswell:

The ACL parser will attempt to decode as many ACE structures as are
specified in the ACL structure.  If the number of ACE structures is
sufficiently large with one of the ACE structures specifying a size of
0, then the ACL parser will parse that ACE structure repeatedly,
eventually causing a denial of service to Ethereal.

I've attached a diff against HEAD that corrects the problem.  The diff
also corrects a few decoding errors in the NT ACL & ACE structures.  A
pcap is attached that reproduces the problem.

This is a duplicate checkin of r12706 from the main trunk.

------------------------------------------------------------------------
r12705 | gerald | 2004-12-09 16:01:22 -0600 (Thu, 09 Dec 2004) | 2 lines
Changed paths:
   M /releases/ethereal-0.10.8/AUTHORS
   M /releases/ethereal-0.10.8/epan/dissectors/packet-aim.c
   M /releases/ethereal-0.10.8/epan/dissectors/packet-aoe.c
   M /releases/ethereal-0.10.8/epan/dissectors/packet-bssgp.c
   M /releases/ethereal-0.10.8/epan/dissectors/packet-dcerpc-pn-io.c
   M /releases/ethereal-0.10.8/epan/dissectors/packet-etheric.c
   M /releases/ethereal-0.10.8/epan/dissectors/packet-gsm_sms.c
   M /releases/ethereal-0.10.8/epan/dissectors/packet-ipmi.c
   M /releases/ethereal-0.10.8/epan/dissectors/packet-isup.c
   M /releases/ethereal-0.10.8/epan/dissectors/packet-isup.h
   M /releases/ethereal-0.10.8/epan/dissectors/packet-pn-dcp.c
   M /releases/ethereal-0.10.8/epan/dissectors/packet-pn-rt.c
   M /releases/ethereal-0.10.8/epan/dissectors/packet-radius.c
   M /releases/ethereal-0.10.8/epan/dissectors/packet-tds.c
   M /releases/ethereal-0.10.8/epan/dissectors/packet-x25.c
   M /releases/ethereal-0.10.8/wiretap/libpcap.c

Copy over revisions 12685 - 12704 from the main trunk.

------------------------------------------------------------------------
r12684 | gerald | 2004-12-07 16:28:01 -0600 (Tue, 07 Dec 2004) | 2 lines
Changed paths:
   A /releases/ethereal-0.10.8 (from /trunk:12683)

Create the 0.10.8 release branch.

------------------------------------------------------------------------
r12683 | gerald | 2004-12-07 16:26:10 -0600 (Tue, 07 Dec 2004) | 2 lines
Changed paths:
   M /trunk/ChangeLog
   M /trunk/config.nmake
   M /trunk/configure.in

Updates for 0.10.8.

------------------------------------------------------------------------
r12682 | guy | 2004-12-07 15:09:05 -0600 (Tue, 07 Dec 2004) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_a.c

From Rene Pilz:

	add the protocols GPRS Mobility Managment and GPRS Session
	Mangement to gsm_a (dtap);

	bug fix (RAND->128Bits=16Bytes != 12 Bytes).

------------------------------------------------------------------------
r12681 | gerald | 2004-12-07 15:06:55 -0600 (Tue, 07 Dec 2004) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-snmp.c

The standard environment separator character under Windows is ";".
Net-SNMP expects this in the MIBS environment variable, so don't use
":" in the default MIB list if we're running under Windows.

------------------------------------------------------------------------
r12680 | guy | 2004-12-07 12:21:21 -0600 (Tue, 07 Dec 2004) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dhcpv6.c

Get rid of an unused true_false_string value.

------------------------------------------------------------------------
r12679 | guy | 2004-12-07 11:59:58 -0600 (Tue, 07 Dec 2004) | 2 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/dissectors/packet-http.c

From Brett Kuskie: add more HTTP headers as filterable fields.

------------------------------------------------------------------------
r12678 | guy | 2004-12-07 11:54:08 -0600 (Tue, 07 Dec 2004) | 5 lines
Changed paths:
   M /trunk/wiretap/libpcap.c
   M /trunk/wiretap/wtap.c
   M /trunk/wiretap/wtap.h

Add an entry for the new DLT_GPRS_LLC (so that nobody working on
Ethereal, unaware that the Ethereal team does *NOT* control libpcap
format, thinks they can just grab 169 and use it for their own
purposes).

------------------------------------------------------------------------
r12677 | gerald | 2004-12-07 10:17:50 -0600 (Tue, 07 Dec 2004) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bvlc.c

Check for a bogus length value.

------------------------------------------------------------------------
r12676 | jmayer | 2004-12-07 05:13:58 -0600 (Tue, 07 Dec 2004) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-aoe.c
   M /trunk/epan/dissectors/packet-dcerpc-pn-io.c
   M /trunk/epan/dissectors/packet-pn-dcp.c
   M /trunk/epan/dissectors/packet-pn-rt.c

svn propset svn:keywords Id svn:eol-style native .....
Add $Id: $ where missing

------------------------------------------------------------------------
r12675 | sahlberg | 2004-12-06 22:28:37 -0600 (Mon, 06 Dec 2004) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-aoe.c

update one of the command names


------------------------------------------------------------------------
r12674 | sahlberg | 2004-12-06 21:16:34 -0600 (Mon, 06 Dec 2004) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-aoe.c
   M /trunk/epan/dissectors/packet-ethertype.c
   M /trunk/etypes.h

create a proper ETHERTYPE for ATAoverEthernet


------------------------------------------------------------------------
r12673 | sahlberg | 2004-12-06 21:00:21 -0600 (Mon, 06 Dec 2004) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-aoe.c

new protocol:  ATAoverETHERNET  (AoE)



------------------------------------------------------------------------
r12672 | gerald | 2004-12-06 17:12:32 -0600 (Mon, 06 Dec 2004) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ppp.c

Add more suboption length checks to dissect_bap_phone_delta_opt().

------------------------------------------------------------------------
r12671 | gerald | 2004-12-06 16:32:50 -0600 (Mon, 06 Dec 2004) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-sap.c

Check for a bogus authentication subheader length.

------------------------------------------------------------------------
r12670 | ulfl | 2004-12-06 12:05:14 -0600 (Mon, 06 Dec 2004) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-dcerpc-pn-io.c
   A /trunk/epan/dissectors/packet-pn-dcp.c
   A /trunk/epan/dissectors/packet-pn-rt.c

(on behalf of the PROFIBUS Nutzerorganisation e.V. Deutschland):
first part of the PROFINET dissectors (PN-RT, PN-DCP and PN-IO) still some work to be done ...
------------------------------------------------------------------------
r12669 | sahlberg | 2004-12-05 15:47:49 -0600 (Sun, 05 Dec 2004) | 6 lines
Changed paths:
   M /trunk/asn1/pkix1implicit/PKIX1IMPLICIT93.asn
   M /trunk/asn1/pkix1implicit/packet-pkix1implicit-template.c
   M /trunk/asn1/pkix1implicit/packet-pkix1implicit-template.h
   M /trunk/asn1/pkix1implicit/pkix1implicit.cnf
   M /trunk/asn1/pkix1implicit/pkix1implicit_exp.cnf
   A /trunk/asn1/pkixtsp
   A /trunk/asn1/pkixtsp/Makefile
   A /trunk/asn1/pkixtsp/PKIXTSP.asn
   A /trunk/asn1/pkixtsp/packet-pkixtsp-template.c
   A /trunk/asn1/pkixtsp/packet-pkixtsp-template.h
   A /trunk/asn1/pkixtsp/pkixtsp.cnf
   M /trunk/epan/dissectors/Makefile.common
   M /trunk/epan/dissectors/packet-pkix1implicit.c
   M /trunk/epan/dissectors/packet-pkix1implicit.h
   A /trunk/epan/dissectors/packet-pkixtsp.c
   A /trunk/epan/dissectors/packet-pkixtsp.h

updates to pkix1implicit   (we have to think about how to rewrite both pkix1eplicit and pkix1implicit  to avoid the crap with duplicate definitions from x509)

New protocol : RFC3161  PKIX TimeStamp Protocol



------------------------------------------------------------------------
r12668 | gerald | 2004-12-05 12:40:35 -0600 (Sun, 05 Dec 2004) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-http.c

Grab the last (and null) byte of the content type value.

------------------------------------------------------------------------
r12667 | jmayer | 2004-12-04 09:42:18 -0600 (Sat, 04 Dec 2004) | 1 line
Changed paths:
   M /trunk/wiretap/README.airmagnet

Fix some typos
------------------------------------------------------------------------
r12666 | jmayer | 2004-12-04 09:35:51 -0600 (Sat, 04 Dec 2004) | 1 line
Changed paths:
   M /trunk/wiretap/README.airmagnet

Updates by Martin Regner
------------------------------------------------------------------------
r12665 | jmayer | 2004-12-04 03:12:24 -0600 (Sat, 04 Dec 2004) | 1 line
Changed paths:
   M /trunk/wiretap/README.airmagnet

Add a bit of info that should be present in a capture
------------------------------------------------------------------------
r12664 | guy | 2004-12-03 14:51:10 -0600 (Fri, 03 Dec 2004) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bittorrent.c

Add a URL for the BitTorrent protocol spec.

------------------------------------------------------------------------
r12663 | guy | 2004-12-03 03:51:16 -0600 (Fri, 03 Dec 2004) | 12 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/dissectors/packet-dhcpv6.c

From Tomasz Mrugalski:

- option values updated to match RFC3898 (NIS/NIS+ options)
- FQDN option added (draft-ietf-dhc-dhcpv6-opt-fqdn-00.txt)
- Lifetime option added (draft-ietf-dhc-dhcpv6-opt-lifetime-00.txt)
- Long lasting typo corrected (those are identiTy associations, not
  identiFy associations)
- Fixed bug always reporting SIP DOMAIN option to be malformed (break was
  missing)
- Domains names are now parsed (in DOMAIN_LIST, SIP_SERVER_A, NIS_DOMAIN
  and NISPLUS_DOMAIN options). 

------------------------------------------------------------------------
r12662 | sahlberg | 2004-12-02 23:53:09 -0600 (Thu, 02 Dec 2004) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-tcp.c

make the tcp dissector distinguish between duplicate acks and window updates


------------------------------------------------------------------------
r12661 | guy | 2004-12-02 15:24:12 -0600 (Thu, 02 Dec 2004) | 2 lines
Changed paths:
   M /trunk/README.hpux

Add some additional notes based on comments by Rick Jones.

------------------------------------------------------------------------
r12660 | lroland | 2004-12-02 14:16:17 -0600 (Thu, 02 Dec 2004) | 1 line
Changed paths:
   M /trunk/epan/libethereal.def

Don't export flags_set_truth from libethereal.dll. It can't be used in a plugin on win32 to initialize static variables, e.g. hf_register_info arrays.
------------------------------------------------------------------------
r12659 | lroland | 2004-12-02 13:41:56 -0600 (Thu, 02 Dec 2004) | 1 line
Changed paths:
   M /trunk/gtk/main.c

Don't ethclist.h in main.c, when we don't need it.
------------------------------------------------------------------------
r12658 | guy | 2004-12-02 13:17:40 -0600 (Thu, 02 Dec 2004) | 2 lines
Changed paths:
   M /trunk/gtk/main.c

We don't use our own clist for GTK+ 1.3[.x], either.

------------------------------------------------------------------------
r12657 | guy | 2004-12-02 05:30:24 -0600 (Thu, 02 Dec 2004) | 3 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/prefs.c
   M /trunk/epan/prefs.h
   M /trunk/gtk/capture_dlg.c
   M /trunk/gtk/capture_info_dlg.c
   M /trunk/gtk/gui_prefs.c
   M /trunk/gtk/main.c
   M /trunk/gtk/ui_util.c
   M /trunk/gtk/ui_util.h

From Nathan Jennings: add a preference that supplies a prefix for window
titles.

------------------------------------------------------------------------
r12656 | guy | 2004-12-02 02:38:59 -0600 (Thu, 02 Dec 2004) | 2 lines
Changed paths:
   M /trunk/gtk/rtp_analysis.c

From Francisco Alcoba: handle inverted time stamps without hanging.

------------------------------------------------------------------------
r12655 | guy | 2004-12-02 02:28:10 -0600 (Thu, 02 Dec 2004) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dns.c

From David Fort: the DNS RR type number for IPSECKEY will be changing to
45, so update the dissector.

------------------------------------------------------------------------
r12654 | guy | 2004-12-02 01:53:59 -0600 (Thu, 02 Dec 2004) | 3 lines
Changed paths:
   M /trunk/gtk/main.c

We're not using our own clist for GTK+ 2.x, so call
"init_eth_clist_type()" only for GTK+ 1.2[.x].

------------------------------------------------------------------------
r12653 | sahlberg | 2004-12-01 21:12:24 -0600 (Wed, 01 Dec 2004) | 5 lines
Changed paths:
   M /trunk/gtk/ethclist.c
   M /trunk/gtk/ethclist.h
   M /trunk/gtk/main.c

performance enhancement:
 in some profiling runs   eth_clist_get_type() took ~6%   change this to just a variable and initialize it explicitely from main.c



------------------------------------------------------------------------
r12652 | sahlberg | 2004-12-01 18:12:54 -0600 (Wed, 01 Dec 2004) | 3 lines
Changed paths:
   M /trunk/gtk/main.c
   M /trunk/gtk/menu.c

make ethereal compile with   --without-pcap  configuration option


------------------------------------------------------------------------
r12651 | guy | 2004-12-01 17:55:43 -0600 (Wed, 01 Dec 2004) | 3 lines
Changed paths:
   M /trunk/tethereal.c

Move the #ifdef/#endif a bit so that the entire chunk of
live-capture-related-code is inside it.

------------------------------------------------------------------------
r12650 | sahlberg | 2004-12-01 17:47:14 -0600 (Wed, 01 Dec 2004) | 4 lines
Changed paths:
   M /trunk/tethereal.c

minor fix to tethereal to allow it to compile with  --without-pcap



------------------------------------------------------------------------
r12649 | gerald | 2004-12-01 17:18:20 -0600 (Wed, 01 Dec 2004) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-fr.c

Replace GRE_FR with ETHERTYPE_RAW_FR.

------------------------------------------------------------------------
r12648 | etxrab | 2004-12-01 15:59:03 -0600 (Wed, 01 Dec 2004) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-nsip.c

Make the Ericsson internal decode of IP addresses a preference instead of IF DEFS, default off.
------------------------------------------------------------------------
r12647 | guy | 2004-12-01 15:13:39 -0600 (Wed, 01 Dec 2004) | 2 lines
Changed paths:
   M /trunk/etypes.h

Clean up a comment.

------------------------------------------------------------------------
r12646 | guy | 2004-12-01 15:11:48 -0600 (Wed, 01 Dec 2004) | 7 lines
Changed paths:
   M /trunk/etypes.h

Explain the two IEEE URLs.

Get rid of a non-ASCII character in a comment - it might or might not
display as a "registered trademark" symbol, depending on your editor and
on the character set and character encoding it's using, so just use
"(R)" instead.

------------------------------------------------------------------------
r12645 | etxrab | 2004-12-01 15:06:30 -0600 (Wed, 01 Dec 2004) | 1 line
Changed paths:
   M /trunk/greproto.h

Get rid of a not needed define.
------------------------------------------------------------------------
r12644 | guy | 2004-12-01 15:05:45 -0600 (Wed, 01 Dec 2004) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ethertype.c
   M /trunk/epan/dissectors/packet-gre.c

Fix a typo.

------------------------------------------------------------------------
r12643 | etxrab | 2004-12-01 14:58:22 -0600 (Wed, 01 Dec 2004) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-ethertype.c
   M /trunk/epan/dissectors/packet-gre.c

Add some ethertypes
------------------------------------------------------------------------
r12642 | etxrab | 2004-12-01 14:57:27 -0600 (Wed, 01 Dec 2004) | 1 line
Changed paths:
   M /trunk/etypes.h

Add some ethertypes
------------------------------------------------------------------------
r12641 | gerald | 2004-12-01 14:51:19 -0600 (Wed, 01 Dec 2004) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-tds.c

Catch a couple of integer overflows.

------------------------------------------------------------------------
r12640 | gerald | 2004-12-01 13:34:51 -0600 (Wed, 01 Dec 2004) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-http.c

Don't access memory that may have been freed.

------------------------------------------------------------------------
r12639 | gerald | 2004-12-01 10:56:37 -0600 (Wed, 01 Dec 2004) | 5 lines
Changed paths:
   M /trunk/Makefile.nmake
   M /trunk/tools/win32-setup.sh

If bash is run as a non-login shell, it doesn't read /etc/profile.  Under 
Cygwin this has the side effect of making the Windows "find" command appear 
first in the path instead of Cygwin's "find" command.  Call /usr/bin/find
explicitly in win32-setup.sh.

------------------------------------------------------------------------
r12638 | guy | 2004-12-01 06:41:43 -0600 (Wed, 01 Dec 2004) | 2 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-bittorrent.c

From Jelmer Vernooij: BitTorrent support.

------------------------------------------------------------------------
r12637 | guy | 2004-12-01 06:15:16 -0600 (Wed, 01 Dec 2004) | 4 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/dissectors/packet-dhcpv6.c

From Marc Poulhies: fix the handling of the authentication option when
the authentication information is missing (which it can be), and fix a
typo.

------------------------------------------------------------------------
r12636 | guy | 2004-12-01 05:54:41 -0600 (Wed, 01 Dec 2004) | 6 lines
Changed paths:
   M /trunk/gtk/rtp_analysis.c
   M /trunk/gtk/rtp_analysis.h
   M /trunk/gtk/rtp_stream.c
   M /trunk/gtk/rtp_stream.h
   M /trunk/gtk/rtp_stream_dlg.c

From Francisco Alcoba:

	add IPv6 support;

	replace "delay" with "delta".

------------------------------------------------------------------------
r12635 | guy | 2004-12-01 05:35:27 -0600 (Wed, 01 Dec 2004) | 3 lines
Changed paths:
   M /trunk/Makefile.nmake

From Francisco Alcoba: link with setargv.obj so that wildcards are
expanded in the command line.

------------------------------------------------------------------------
r12634 | guy | 2004-12-01 05:29:57 -0600 (Wed, 01 Dec 2004) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-h245.c

From Martin Regner: support for the parts of H.245 version 10 that are
related to H.239.

------------------------------------------------------------------------
r12633 | guy | 2004-12-01 05:19:04 -0600 (Wed, 01 Dec 2004) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ssl.c

From Yaniv Kaul: adds LZS as a compression method, per 'Transport Layer
Security (TLS) Protocol Compression UsingLempel-Ziv-Stac (LZS)' RFC (RFC
3943).

------------------------------------------------------------------------
r12632 | guy | 2004-12-01 00:48:52 -0600 (Wed, 01 Dec 2004) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-radius.c

Squelch some compiler warnings.

------------------------------------------------------------------------
r12631 | guy | 2004-12-01 00:44:54 -0600 (Wed, 01 Dec 2004) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc.c

According to the part of the DCE RPC spec at

	http://www.opengroup.org/onlinepubs/009629399/chap12.htm#tagcjh_17_06_01

the number of transfer syntaxes is a u_int8, with an alignment pad byte
following it, not a u_int16.

------------------------------------------------------------------------
r12630 | guy | 2004-11-30 21:42:55 -0600 (Tue, 30 Nov 2004) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb-common.c

Get rid of a long-obsolete comment.

------------------------------------------------------------------------
r12629 | gerald | 2004-11-30 19:21:22 -0600 (Tue, 30 Nov 2004) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-sigcomp.c

bytes_to_str() returns a static value.  Don't g_free() it.

------------------------------------------------------------------------
r12628 | etxrab | 2004-11-30 16:11:56 -0600 (Tue, 30 Nov 2004) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-nsip.c

Fix port preference handling.
------------------------------------------------------------------------
r12627 | etxrab | 2004-11-30 15:32:47 -0600 (Tue, 30 Nov 2004) | 1 line
Changed paths:
   M /trunk/AUTHORS

Add Susanne Edlund to authors file.
------------------------------------------------------------------------
r12626 | etxrab | 2004-11-30 15:19:25 -0600 (Tue, 30 Nov 2004) | 1 line
Changed paths:
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-nsip.c

New dissector for NSIP from Susanne Edlund, default port2 changed to unallocated port 19999
------------------------------------------------------------------------
r12625 | gerald | 2004-11-30 10:52:21 -0600 (Tue, 30 Nov 2004) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-wsp.c
   M /trunk/epan/dissectors/packet-wtp.c

Replace a few instances of match_strval() with val_to_str().

------------------------------------------------------------------------
r12624 | sahlberg | 2004-11-29 22:08:16 -0600 (Mon, 29 Nov 2004) | 4 lines
Changed paths:
   M /trunk/asn1/x509af/packet-x509af-template.c
   M /trunk/epan/dissectors/packet-x509af.c
   M /trunk/epan/dissectors/packet-x509af.h

Make ethereal dissect  application/pkix-crl  CertificateRevocationLists over HTTP.



------------------------------------------------------------------------
r12623 | sahlberg | 2004-11-29 21:39:34 -0600 (Mon, 29 Nov 2004) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ber.c

when creating a new subset tvb for a field for further dissection by child dissectors,  then if the original tvb is short and doesnt contain enough data, try to create a new subset tvb with as much data we do have instead of just bailing out.



------------------------------------------------------------------------
r12622 | lroland | 2004-11-29 17:48:26 -0600 (Mon, 29 Nov 2004) | 2 lines
Changed paths:
   M /trunk/plugins/rtnet/packet-rtnet.c

Make rtnet plugin compile again with MSVC
and some white space cleanup.
------------------------------------------------------------------------
r12621 | gerald | 2004-11-29 13:30:12 -0600 (Mon, 29 Nov 2004) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-isakmp.c

Add another length check.

------------------------------------------------------------------------
r12620 | guy | 2004-11-29 12:02:07 -0600 (Mon, 29 Nov 2004) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-isakmp.c

Get rid of a debug message.

------------------------------------------------------------------------
r12619 | gerald | 2004-11-29 11:52:38 -0600 (Mon, 29 Nov 2004) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-isakmp.c

Check for an overly large header length value in order to avoid an integer 
overflow.

------------------------------------------------------------------------
r12618 | sahlberg | 2004-11-29 03:58:16 -0600 (Mon, 29 Nov 2004) | 4 lines
Changed paths:
   A /trunk/asn1/ocsp
   A /trunk/asn1/ocsp/Makefile
   A /trunk/asn1/ocsp/OCSP.asn
   A /trunk/asn1/ocsp/ocsp.cnf
   A /trunk/asn1/ocsp/packet-ocsp-template.c
   A /trunk/asn1/ocsp/packet-ocsp-template.h
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-ocsp.c
   A /trunk/epan/dissectors/packet-ocsp.h

new protocol : RFC2560  Online Certificate Status Protocol



------------------------------------------------------------------------
r12617 | sahlberg | 2004-11-29 02:43:19 -0600 (Mon, 29 Nov 2004) | 4 lines
Changed paths:
   M /trunk/asn1/pkix1explicit/PKIX1EXPLICIT93.asn
   M /trunk/asn1/pkix1explicit/packet-pkix1explicit-template.c
   M /trunk/asn1/pkix1explicit/packet-pkix1explicit-template.h
   M /trunk/asn1/pkix1explicit/pkix1explicit.cnf
   M /trunk/asn1/pkix1explicit/pkix1explicit_exp.cnf
   M /trunk/epan/dissectors/packet-pkix1explicit.c
   M /trunk/epan/dissectors/packet-pkix1explicit.h
   M /trunk/epan/dissectors/packet-x509if.c
   M /trunk/epan/dissectors/packet-x509if.h

export some more sympols from PKIX1EXPLICIT



------------------------------------------------------------------------
r12616 | sahlberg | 2004-11-29 01:57:19 -0600 (Mon, 29 Nov 2004) | 3 lines
Changed paths:
   M /trunk/asn1/pkix1implicit/pkix1implicit.cnf
   M /trunk/asn1/pkix1implicit/pkix1implicit_exp.cnf
   M /trunk/epan/dissectors/packet-pkix1implicit.c
   M /trunk/epan/dissectors/packet-pkix1implicit.h

Export AuthorityInfoAccessSyntax from pkix1implicit


------------------------------------------------------------------------
r12615 | etxrab | 2004-11-28 14:52:52 -0600 (Sun, 28 Nov 2004) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-frame.c

From LEGO if Mate is pressent call it.
------------------------------------------------------------------------
r12614 | etxrab | 2004-11-28 13:41:17 -0600 (Sun, 28 Nov 2004) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-sigcomp.c

Bugfixes- handle zero length bytecode, handle end-off-message with implied parameters(udvm initialised to zero).
------------------------------------------------------------------------
r12613 | etxrab | 2004-11-28 13:39:19 -0600 (Sun, 28 Nov 2004) | 1 line
Changed paths:
   M /trunk/epan/sigcomp-udvm.c

Bugfixes
------------------------------------------------------------------------
r12612 | etxrab | 2004-11-28 13:35:21 -0600 (Sun, 28 Nov 2004) | 1 line
Changed paths:
   M /trunk/epan/strutil.c

Change number of bytes displayed in bytes_to_string to 48 to facilitate display of sha1 digest of 20 bytes.
------------------------------------------------------------------------
r12611 | jmayer | 2004-11-28 11:30:18 -0600 (Sun, 28 Nov 2004) | 1 line
Changed paths:
   M /trunk/FAQ
   M /trunk/help/faq.txt
   M /trunk/manuf

Update manuf and FAQ
------------------------------------------------------------------------
r12610 | sahlberg | 2004-11-27 22:26:27 -0600 (Sat, 27 Nov 2004) | 2 lines
Changed paths:
   A /trunk/asn1/pkixproxy
   A /trunk/asn1/pkixproxy/Makefile
   A /trunk/asn1/pkixproxy/PKIXProxy.asn
   A /trunk/asn1/pkixproxy/packet-pkixproxy-template.c
   A /trunk/asn1/pkixproxy/packet-pkixproxy-template.h
   A /trunk/asn1/pkixproxy/pkixproxy.cnf
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-pkixproxy.c
   A /trunk/epan/dissectors/packet-pkixproxy.h

new protocol : RFC3820   PKIXProxy

------------------------------------------------------------------------
r12609 | gerald | 2004-11-27 22:21:30 -0600 (Sat, 27 Nov 2004) | 4 lines
Changed paths:
   M /trunk/asn1.c
   M /trunk/epan/dissectors/packet-snmp.c

The recent length check added to proto_tree_add_string() revealed a
couple of problems when reading the PROTOS SNMP captures.  Check for
integer overflows in dissect_snmp_pdu and asn1_null_decode.

------------------------------------------------------------------------
r12608 | sahlberg | 2004-11-26 18:11:52 -0600 (Fri, 26 Nov 2004) | 4 lines
Changed paths:
   M /trunk/asn1/cmip/packet-cmip-template.c
   M /trunk/epan/dissectors/packet-cmip.c

it appears that a SES_REFUSE spdu  actually contains a CMIP-A-ASSOCIATE and not a CMIP-A-ABORT



------------------------------------------------------------------------
r12607 | sahlberg | 2004-11-26 17:14:30 -0600 (Fri, 26 Nov 2004) | 3 lines
Changed paths:
   A /trunk/asn1/smrse/Makefile
   M /trunk/asn1/smrse/packet-smrse-template.c
   M /trunk/asn1/smrse/smrse.cnf
   M /trunk/epan/dissectors/packet-smrse.c
   M /trunk/epan/dissectors/packet-smrse.h

prettify the printing of the octet_format field which is really just a BCD


------------------------------------------------------------------------
r12606 | sahlberg | 2004-11-25 18:56:22 -0600 (Thu, 25 Nov 2004) | 3 lines
Changed paths:
   A /trunk/asn1/logotype-cert-extn
   A /trunk/asn1/logotype-cert-extn/LogotypeCertExtn.asn
   A /trunk/asn1/logotype-cert-extn/Makefile
   A /trunk/asn1/logotype-cert-extn/logotype-cert-extn.cnf
   A /trunk/asn1/logotype-cert-extn/packet-logotype-cert-extn-template.c
   A /trunk/asn1/logotype-cert-extn/packet-logotype-cert-extn-template.h
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-logotypecertextn.c
   A /trunk/epan/dissectors/packet-logotypecertextn.h

New protocol: RFC3709  LogotypeCertificateExtensions


------------------------------------------------------------------------
r12605 | sahlberg | 2004-11-25 16:27:52 -0600 (Thu, 25 Nov 2004) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ber.c

update dissection of unknown blobs to try to dissect even more stuff.


------------------------------------------------------------------------
r12604 | sahlberg | 2004-11-25 15:30:38 -0600 (Thu, 25 Nov 2004) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ber.c

 updates to prettify a bit when attempting to dissect an unknown blob


------------------------------------------------------------------------
r12603 | sahlberg | 2004-11-25 15:00:17 -0600 (Thu, 25 Nov 2004) | 3 lines
Changed paths:
   M /trunk/asn1/x509ce/packet-x509ce-template.c
   M /trunk/asn1/x509ce/x509ce.cnf
   M /trunk/epan/dissectors/packet-x509ce.c
   M /trunk/epan/dissectors/packet-x509ce.h

try to print an IPAddress as an ip address and not as a 4 byte octet string


------------------------------------------------------------------------
r12602 | sahlberg | 2004-11-25 14:44:17 -0600 (Thu, 25 Nov 2004) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-isakmp.c

from Stig: change the draft number for NAT-D


------------------------------------------------------------------------
r12601 | sahlberg | 2004-11-25 14:38:10 -0600 (Thu, 25 Nov 2004) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-nt-sonmp.c

From Giles Scott : updates to packet-nt-sonmp.c



------------------------------------------------------------------------
r12600 | etxrab | 2004-11-24 15:55:30 -0600 (Wed, 24 Nov 2004) | 1 line
Changed paths:
   M /trunk/epan/sigcomp-udvm.c

Somethimes its difficult to get it right *sigh
------------------------------------------------------------------------
r12599 | sahlberg | 2004-11-24 15:26:52 -0600 (Wed, 24 Nov 2004) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-giop.c

From LEGO: make the request id and operation filterable


------------------------------------------------------------------------
r12598 | jmayer | 2004-11-24 10:37:38 -0600 (Wed, 24 Nov 2004) | 1 line
Changed paths:
   M /trunk/epan/sigcomp-udvm.c

The code didn't even compile: removed a superfluous (
------------------------------------------------------------------------
r12597 | jmayer | 2004-11-24 10:30:52 -0600 (Wed, 24 Nov 2004) | 1 line
Changed paths:
   M /trunk/epan/sigcomp-udvm.c
   M /trunk/epan/sigcomp-udvm.h

Set svn properties - without them, compilation with gcc would fail on Unix
------------------------------------------------------------------------
r12596 | etxrab | 2004-11-24 07:53:27 -0600 (Wed, 24 Nov 2004) | 1 line
Changed paths:
   M /trunk/epan/sigcomp-udvm.c

Fix a faulty IF statement, deflate should work now.
------------------------------------------------------------------------
r12595 | etxrab | 2004-11-24 06:25:37 -0600 (Wed, 24 Nov 2004) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-3g-a11.c
   M /trunk/epan/dissectors/packet-radius.c

add some 3gpp2 AVP:s to packet-radius.c and use "vendor" table packet-3g-a11.c
------------------------------------------------------------------------
r12594 | etxrab | 2004-11-24 06:23:26 -0600 (Wed, 24 Nov 2004) | 1 line
Changed paths:
   M /trunk/epan/sminmpec.c
   M /trunk/epan/sminmpec.h

Change "Ericsson" string 
------------------------------------------------------------------------
r12593 | guy | 2004-11-24 03:13:52 -0600 (Wed, 24 Nov 2004) | 9 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ascend.c
   M /trunk/epan/dissectors/packet-atm.c
   M /trunk/epan/dissectors/packet-cosine.c
   M /trunk/epan/dissectors/packet-eth.c
   M /trunk/epan/dissectors/packet-etherip.c
   M /trunk/epan/dissectors/packet-fr.c
   M /trunk/epan/dissectors/packet-ieee80211.c
   M /trunk/epan/dissectors/packet-isl.c
   M /trunk/epan/dissectors/packet-isl.h
   M /trunk/epan/dissectors/packet-llc.c
   M /trunk/epan/dissectors/packet-lwapp.c
   M /trunk/epan/dissectors/packet-mpls.c
   M /trunk/epan/dissectors/packet-sflow.c
   M /trunk/epan/dissectors/packet-wfleet-hdlc.c
   M /trunk/plugins/docsis/packet-docsis.c

Export two versions of the Ethereal dissector, for use with encapsulated
Ethernet frames, one for encapsulated frames that include an FCS and one
for encapsulated frames that don't include an FCS.  Use the appropriate
versions.

In the ISL dissector, do the same sort of processing we do in the
Ethernet dissector to figure out whether the frame has a trailer or not
and whether it has an FCS or not.

------------------------------------------------------------------------
r12592 | guy | 2004-11-24 03:00:23 -0600 (Wed, 24 Nov 2004) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ipmi.c

Fix some typoes.

------------------------------------------------------------------------
r12591 | guy | 2004-11-24 02:55:40 -0600 (Wed, 24 Nov 2004) | 2 lines
Changed paths:
   M /trunk/epan/libethereal.def

We export flags_set_truth - add it to libethereal.def.

------------------------------------------------------------------------
r12590 | guy | 2004-11-24 00:04:43 -0600 (Wed, 24 Nov 2004) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-eth.c

Only interpret a frame as an FW1 header if it looks like one, as per a
patch from Yaniv Kaul.

------------------------------------------------------------------------
r12589 | guy | 2004-11-23 22:14:56 -0600 (Tue, 23 Nov 2004) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-tds.c

From Yaniv Kaul: the authentication token might be NTLMSSP or it might
be GSS-API.

------------------------------------------------------------------------
r12588 | guy | 2004-11-23 21:54:40 -0600 (Tue, 23 Nov 2004) | 2 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/dissectors/packet-ipmi.c

From Lane Hu: add support for more IPMI commands.

------------------------------------------------------------------------
r12587 | guy | 2004-11-23 21:35:17 -0600 (Tue, 23 Nov 2004) | 2 lines
Changed paths:
   M /trunk/plugins/enttec/ChangeLog
   M /trunk/plugins/enttec/moduleinfo.h
   M /trunk/plugins/enttec/packet-enttec.c

From Erwin Rol: Dissect DMX in a readable format, and other updates.

------------------------------------------------------------------------
r12586 | guy | 2004-11-23 21:18:30 -0600 (Tue, 23 Nov 2004) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-sdp.c

From Francisco Alcoba: handle RTP over IPv6.

------------------------------------------------------------------------
r12585 | guy | 2004-11-23 20:59:49 -0600 (Tue, 23 Nov 2004) | 2 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/dissectors/Makefile.common
   M /trunk/epan/dissectors/packet-mtp3.c
   M /trunk/epan/dissectors/packet-mtp3mg.c
   A /trunk/epan/dissectors/packet-sscf-nni.c
   M /trunk/epan/dissectors/packet-sscop.c
   M /trunk/epan/range.h

From Jeff Morriss: SSCOP over UDP and SSCF-NNI support.

------------------------------------------------------------------------
r12584 | guy | 2004-11-23 20:36:14 -0600 (Tue, 23 Nov 2004) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ethertype.c
   M /trunk/etypes.h
   M /trunk/plugins/rtnet/moduleinfo.h
   M /trunk/plugins/rtnet/packet-rtnet.c

Updates from Erwin Rol.

------------------------------------------------------------------------
r12583 | etxrab | 2004-11-23 16:03:28 -0600 (Tue, 23 Nov 2004) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-sigcomp.c

Make it possible to fileter on partial_state create and access.
------------------------------------------------------------------------
r12582 | etxrab | 2004-11-23 16:02:00 -0600 (Tue, 23 Nov 2004) | 1 line
Changed paths:
   M /trunk/epan/sigcomp-udvm.c
   M /trunk/epan/sigcomp-udvm.h
   M /trunk/epan/sigcomp_state_hdlr.c
   M /trunk/epan/sigcomp_state_hdlr.h

Don't free string that don't need it. Added filter possibillity on Partial state
------------------------------------------------------------------------
r12581 | gerald | 2004-11-23 11:31:16 -0600 (Tue, 23 Nov 2004) | 2 lines
Changed paths:
   M /trunk/Makefile.nmake
   M /trunk/tools/win32-setup.sh

Update to GTK+ 2.4.13.

------------------------------------------------------------------------
r12580 | etxrab | 2004-11-22 16:19:03 -0600 (Mon, 22 Nov 2004) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-sigcomp.c

Fix some memmory leaks
------------------------------------------------------------------------
r12579 | etxrab | 2004-11-22 16:18:18 -0600 (Mon, 22 Nov 2004) | 1 line
Changed paths:
   M /trunk/epan/sigcomp-udvm.c
   M /trunk/epan/sigcomp-udvm.h
   M /trunk/epan/sigcomp_state_hdlr.c
   M /trunk/epan/sigcomp_state_hdlr.h

Fix some memmory leaks
------------------------------------------------------------------------
r12578 | jmayer | 2004-11-22 10:36:26 -0600 (Mon, 22 Nov 2004) | 1 line
Changed paths:
   A /trunk/wiretap/README.airmagnet

Backup some notes on Airmagnet capture file format into Ethereal - I'm NOT going to write an importer in the near future though
------------------------------------------------------------------------
r12577 | guy | 2004-11-22 04:26:45 -0600 (Mon, 22 Nov 2004) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-fw1.c

Get rid of an unused variable.

------------------------------------------------------------------------
r12576 | guy | 2004-11-22 02:23:00 -0600 (Mon, 22 Nov 2004) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dns.c

From Yaniv Kaul: increment the offset pointer *after* you use it to put
into the protocol tree the field you're incrementing past.

Update a comment.

------------------------------------------------------------------------
r12575 | guy | 2004-11-22 02:12:42 -0600 (Mon, 22 Nov 2004) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-tds.c

Fix a spelling error.

------------------------------------------------------------------------
r12574 | guy | 2004-11-22 02:11:31 -0600 (Mon, 22 Nov 2004) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-tds.c

Put the value of the length field in a variable-length token, not the
length of the token, into the protocol tree as the length value.

------------------------------------------------------------------------
r12573 | sahlberg | 2004-11-21 21:36:26 -0600 (Sun, 21 Nov 2004) | 7 lines
Changed paths:
   A /trunk/asn1/cms/Makefile
   A /trunk/asn1/cms/cms-exp.cnf
   M /trunk/asn1/cms/cms.cnf
   D /trunk/asn1/cms/cms_exp.cnf
   M /trunk/asn1/cms/packet-cms-template.c
   M /trunk/asn1/cms/packet-cms-template.h
   A /trunk/asn1/ess
   A /trunk/asn1/ess/ExtendedSecurityServices.asn
   A /trunk/asn1/ess/Makefile
   A /trunk/asn1/ess/ess.cnf
   A /trunk/asn1/ess/packet-ess-template.c
   A /trunk/asn1/ess/packet-ess-template.h
   M /trunk/asn1/ns-cert-exts/packet-ns_cert_exts-template.c
   M /trunk/asn1/ns-cert-exts/packet-ns_cert_exts-template.h
   M /trunk/asn1/pkcs1/packet-pkcs1-template.c
   M /trunk/asn1/pkcs1/packet-pkcs1-template.h
   M /trunk/asn1/pkinit/packet-pkinit-template.c
   M /trunk/asn1/pkinit/packet-pkinit-template.h
   M /trunk/asn1/pkinit/pkinit.cnf
   M /trunk/asn1/pkixqualified/packet-pkixqualified-template.h
   M /trunk/asn1/x509af/packet-x509af-template.c
   M /trunk/asn1/x509af/packet-x509af-template.h
   M /trunk/asn1/x509ce/packet-x509ce-template.c
   M /trunk/asn1/x509ce/packet-x509ce-template.h
   M /trunk/asn1/x509if/packet-x509if-template.c
   M /trunk/asn1/x509if/packet-x509if-template.h
   M /trunk/asn1/x509sat/packet-x509sat-template.c
   M /trunk/asn1/x509sat/packet-x509sat-template.h
   M /trunk/epan/dissectors/Makefile.common
   M /trunk/epan/dissectors/packet-cms.c
   M /trunk/epan/dissectors/packet-cms.h
   A /trunk/epan/dissectors/packet-ess.c
   A /trunk/epan/dissectors/packet-ess.h
   M /trunk/epan/dissectors/packet-pkinit.c
   M /trunk/epan/dissectors/packet-pkinit.h

New protocol:  RFC2634  ExtendedSecurityServices

updates to cms to accomodate the new protocol

add author to some files


------------------------------------------------------------------------
r12572 | guy | 2004-11-21 20:12:43 -0600 (Sun, 21 Nov 2004) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ppp.c

Tag the compression protocol item as such.

The compression option isn't just the compression protocol, it can
include options for the protocol, so name the ett_ variable for its tree
appropriately.

------------------------------------------------------------------------
r12571 | guy | 2004-11-21 19:58:21 -0600 (Sun, 21 Nov 2004) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smrse.c

In code that checks whether to accept a packet, first check to make sure
the data being checked exists.

------------------------------------------------------------------------
r12570 | sahlberg | 2004-11-21 17:25:04 -0600 (Sun, 21 Nov 2004) | 3 lines
Changed paths:
   M /trunk/asn1/cmip/CMIP.asn
   M /trunk/asn1/cmip/cmip.cnf
   M /trunk/asn1/cmip/packet-cmip-template.c
   M /trunk/epan/dissectors/packet-cmip.c

cmip update add all remaining functions Arguments and Results


------------------------------------------------------------------------
r12569 | guy | 2004-11-21 17:02:36 -0600 (Sun, 21 Nov 2004) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ber.c

Set the length of the tvbuff to be handed to the subdissector
appropriately (minimum of reported length and length of data left
in the parent).

------------------------------------------------------------------------
r12568 | etxrab | 2004-11-21 16:26:53 -0600 (Sun, 21 Nov 2004) | 1 line
Changed paths:
   M /trunk/epan/sigcomp_state_hdlr.c

Clean-up hash table at reloading of file.
------------------------------------------------------------------------
r12567 | etxrab | 2004-11-21 16:08:40 -0600 (Sun, 21 Nov 2004) | 1 line
Changed paths:
   M /trunk/epan/sigcomp_state_hdlr.c

Free the statebuff and the string
------------------------------------------------------------------------
r12566 | guy | 2004-11-21 16:03:33 -0600 (Sun, 21 Nov 2004) | 66 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/dissectors/packet-tds.c

From Bill Meier:

1. Add Preferences:

   a. To allow specification of a hint as to TDS protocol being decoded 
      (Unspecified/TDS4/TDS5/TDS7/TDS8); Default: 'unspecified'

      The 'hint' is used only when needed to do a correct decode.

      If the protocol is unspecified, the decode is as previous.

   b. To allow specification of 'ranges' of TCP ports to be treated as 
      'TDS tcp ports'; i.e. if the source or destination port of a tcp
      connection matches a specified range, then the connection should be
      considered to be TDS.

   c. To allow specification of a hint as to whether TDS being decoded is 
      'little-endian' or 'big-endian'. Default: 'little-endian'.

      A hint is just that; E.G. if TDS7+ packets are encountered the decode
      is always 'little-endian'.

2, Register tcp MS SQL default ports (1433, 2433) as TDS ports
   ('dissector_add'). This also enables TDS as a choice for 'decode as'.

3. 'netlib_check_login_pkt' changed to check 'TDS tcp port' range(s) as 
    entered in preferences;

4. Change 'dissect_tds_query_packet' to handle TDS4 ascii in addition to
   TDS7/8 UCS-16.

5. Change 'dissect_tds_rpc' to:

   a. handle TDS4 ascii RPC in addition to TDS7/8 UCS-16 RPC;
   b. handle Microsoft 'encoded' rpc_name;
   c. fix memory leak (not freeing memory obtained using
      'tvb_fake_unicode');

6. Change 'dissect_tds_response' to:

   a. handle tds4 tokens 'tds_col_name' and 'tds_col_info';
   b. dissect tokens 'tds_doneinproc' and tds 'doneproc' similarly to
      'tds_done'
   c. reclaim memory allocated for 'tds_col' structures when finished 
      processing response
           (Additional memory was being allocated each time a 
            tokenized tds5 response was processed)

7. New function 'dissect_tds_col_info_token' (similar to
   'read_results_tds5') associated with handling TDS4 responses.

8. New functions 'dissect_tds_query5_packet', 'dissect_tds5_lang_token'

9. Rework TDS token size calculation; Some TDS tokens have a length field
   of other than 2 bytes. (e.g.: the length field 
   for TDS_LANG_TOKEN is 4 bytes)

10. Update token definitions and usages;

   a. Update based upon info from current version of FreeTDS 'tds.h' 
      as well as info from Sybase TDS5 document;
      example: TDS_124_TOKEN renamed to TDS_PROCID_TOKEN

   b. TDS_124_TOKEN [TDS_PROCID] was incorrectly not considered 
      a 'fixed-size' token in function 'tds_is_fixed_token'

------------------------------------------------------------------------
r12565 | etxrab | 2004-11-21 15:47:51 -0600 (Sun, 21 Nov 2004) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-sip.c

If message for SIP port starts with F8 it's a SIGCOMP message - decode it.
------------------------------------------------------------------------
r12564 | sahlberg | 2004-11-21 15:29:10 -0600 (Sun, 21 Nov 2004) | 4 lines
Changed paths:
   M /trunk/asn1/cmip/CMIP.asn
   M /trunk/asn1/cmip/cmip.cnf
   M /trunk/asn1/cmip/packet-cmip-template.c
   M /trunk/epan/dissectors/packet-cmip.c

update to cmip
add functions  m-action and m-action-confirmed


------------------------------------------------------------------------
r12563 | guy | 2004-11-21 15:23:30 -0600 (Sun, 21 Nov 2004) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dns.c

From Yaniv Kaul: yet *another* place where an NTLMSSP rather than GSSAPI
blob can appear.

------------------------------------------------------------------------
r12562 | guy | 2004-11-21 15:05:16 -0600 (Sun, 21 Nov 2004) | 25 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/dissectors/packet-aodv.c

From Shingo Horisawa:

	add the "unknown sequence number" flag;

	fix dissection of unreachable destinations in RERR messages;

	fix prefix size in draft-perkins-manet-aodv6-01 RREP
	messages to be 7 bits, not 5 bits;

	put the message dissection under the top-level AODV tree rather
	than at the top level;

	fix labeling of source IPv6 address in RREP messages.

Update the comments at the beginning (AODV is now RFC 3561), and note
that RFC 3561 says that, for IPv6, the only change is that the address
fields are enlarged.

Rename RREQ_DEST and RREQ_GRAT to more fully indicate what they are.

Fix the name of the draft in the description of the
draft-perkins-manet-aodv6-01 messages.

Fix description of Gratuitous RREP flag in RREQ messages.

------------------------------------------------------------------------
r12561 | ulfl | 2004-11-21 05:52:34 -0600 (Sun, 21 Nov 2004) | 1 line
Changed paths:
   M /trunk/epan/addr_resolv.c

removed an MSVC warning
------------------------------------------------------------------------
r12560 | sahlberg | 2004-11-21 05:12:20 -0600 (Sun, 21 Nov 2004) | 2 lines
Changed paths:
   M /trunk/asn1/pkix1explicit/pkix1explicit.cnf
   M /trunk/epan/dissectors/packet-pkix1explicit.c

add a new oid 

------------------------------------------------------------------------
r12559 | sahlberg | 2004-11-21 04:34:08 -0600 (Sun, 21 Nov 2004) | 8 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ber.c

with the autogenerated export conformance files we need a small change to packet-ber.c

asn2eth  generates exports for CHOICE as of BER_CLASS_UNI  while the handgenerated ones specified the calss as BER_CLASS_ANY.

make dissect_ber_sequence()  look at the tag as well and if -1 its a wildcard and anything goes.



------------------------------------------------------------------------
r12558 | sahlberg | 2004-11-21 04:16:06 -0600 (Sun, 21 Nov 2004) | 3 lines
Changed paths:
   M /trunk/asn1/cms/cms.cnf
   M /trunk/asn1/pkcs1/pkcs1.cnf
   M /trunk/asn1/pkixqualified/pkixqualified.cnf
   A /trunk/asn1/x509af/Makefile
   A /trunk/asn1/x509af/x509af-exp.cnf
   M /trunk/asn1/x509af/x509af.cnf
   D /trunk/asn1/x509af/x509af_exp.cnf
   M /trunk/asn1/x509ce/x509ce.cnf
   M /trunk/epan/dissectors/packet-cms.c
   M /trunk/epan/dissectors/packet-pkcs1.c
   M /trunk/epan/dissectors/packet-x509af.c
   M /trunk/epan/dissectors/packet-x509af.h
   M /trunk/epan/dissectors/packet-x509ce.c

cleanup for x509af


------------------------------------------------------------------------
r12557 | sahlberg | 2004-11-21 04:00:40 -0600 (Sun, 21 Nov 2004) | 3 lines
Changed paths:
   M /trunk/asn1/pkixqualified/pkixqualified.cnf
   M /trunk/asn1/x509af/x509af.cnf
   M /trunk/asn1/x509ce/CertificateExtensions.asn
   A /trunk/asn1/x509ce/Makefile
   M /trunk/asn1/x509ce/packet-x509ce-template.c
   A /trunk/asn1/x509ce/x509ce-exp.cnf
   M /trunk/asn1/x509ce/x509ce.cnf
   D /trunk/asn1/x509ce/x509ce_exp.cnf
   M /trunk/epan/dissectors/packet-pkixqualified.c
   M /trunk/epan/dissectors/packet-x509af.c
   M /trunk/epan/dissectors/packet-x509ce.c
   M /trunk/epan/dissectors/packet-x509ce.h

cleanup for x509ce


------------------------------------------------------------------------
r12556 | sahlberg | 2004-11-21 02:56:09 -0600 (Sun, 21 Nov 2004) | 3 lines
Changed paths:
   M /trunk/asn1/x509af/x509af.cnf
   M /trunk/asn1/x509ce/x509ce.cnf
   M /trunk/asn1/x509if/Makefile
   M /trunk/asn1/x509if/x509if.cnf
   A /trunk/asn1/x509sat/Makefile
   M /trunk/asn1/x509sat/SelectedAttributeTypes.asn
   M /trunk/asn1/x509sat/packet-x509sat-template.c
   A /trunk/asn1/x509sat/x509sat-exp.cnf
   M /trunk/asn1/x509sat/x509sat.cnf
   D /trunk/asn1/x509sat/x509sat_exp.cnf
   M /trunk/epan/dissectors/packet-x509if.c
   M /trunk/epan/dissectors/packet-x509sat.c
   M /trunk/epan/dissectors/packet-x509sat.h

SelectedAttributeTypes are now almost completely implemented    also here i added a small makefile to reduce boring typing on the commandline


------------------------------------------------------------------------
r12555 | sahlberg | 2004-11-21 02:22:21 -0600 (Sun, 21 Nov 2004) | 3 lines
Changed paths:
   M /trunk/asn1/cmip/cmip.cnf
   M /trunk/asn1/cms/cms.cnf
   M /trunk/asn1/x509af/x509af.cnf
   M /trunk/asn1/x509ce/x509ce.cnf
   A /trunk/asn1/x509if/Makefile
   A /trunk/asn1/x509if/x509if-exp.cnf
   D /trunk/asn1/x509if/x509if_exp.cnf
   M /trunk/epan/dissectors/packet-x509if.c
   M /trunk/epan/dissectors/packet-x509if.h

update to x509if   autogenerate the exports conformance file  and create a small makefile  since i am tired of typing that long command line every time


------------------------------------------------------------------------
r12554 | sahlberg | 2004-11-21 01:21:17 -0600 (Sun, 21 Nov 2004) | 3 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-app-pkix-cert.c

From Yaniv Kaul : New Protocol:   X509 Certificates over HTTP


------------------------------------------------------------------------
r12553 | sahlberg | 2004-11-21 00:40:02 -0600 (Sun, 21 Nov 2004) | 5 lines
Changed paths:
   M /trunk/asn1/x509if/InformationFramework.asn
   M /trunk/asn1/x509if/x509if.cnf
   M /trunk/asn1/x509if/x509if_exp.cnf
   M /trunk/epan/dissectors/packet-x509if.c
   M /trunk/epan/dissectors/packet-x509if.h

Add a whole bunch of dissector to X509IF  and export them.
X509if is now almost complete.



------------------------------------------------------------------------
r12552 | sahlberg | 2004-11-20 23:21:26 -0600 (Sat, 20 Nov 2004) | 3 lines
Changed paths:
   M /trunk/asn1/pkix1explicit/PKIX1EXPLICIT93.asn
   M /trunk/asn1/pkix1explicit/pkix1explicit.cnf
   M /trunk/asn1/pkix1explicit/pkix1explicit_exp.cnf
   M /trunk/asn1/pkix1implicit/PKIX1IMPLICIT93.asn
   M /trunk/asn1/pkix1implicit/packet-pkix1implicit-template.c
   M /trunk/asn1/pkix1implicit/pkix1implicit.cnf
   M /trunk/epan/dissectors/packet-pkix1explicit.c
   M /trunk/epan/dissectors/packet-pkix1explicit.h
   M /trunk/epan/dissectors/packet-pkix1implicit.c

add dissection of AuthorityInfoAccessSyntax


------------------------------------------------------------------------
r12551 | guy | 2004-11-20 21:21:02 -0600 (Sat, 20 Nov 2004) | 2 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/dissectors/packet-aodv.c

From Bart Braem: add support for the "destination only" flag.

------------------------------------------------------------------------
r12550 | guy | 2004-11-20 21:01:15 -0600 (Sat, 20 Nov 2004) | 2 lines
Changed paths:
   M /trunk/plugins/gryphon/packet-gryphon.c

Update a URL.

------------------------------------------------------------------------
r12549 | sahlberg | 2004-11-20 15:26:08 -0600 (Sat, 20 Nov 2004) | 3 lines
Changed paths:
   M /trunk/asn1/pkix1implicit/PKIX1IMPLICIT93.asn
   M /trunk/asn1/pkix1implicit/packet-pkix1implicit-template.c
   M /trunk/asn1/pkix1implicit/pkix1implicit.cnf
   M /trunk/epan/dissectors/packet-pkix1implicit.c

add the oids for id-kp-xxx    key purpose identifier to the pkix dissector


------------------------------------------------------------------------
r12548 | sahlberg | 2004-11-20 01:11:08 -0600 (Sat, 20 Nov 2004) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-cms.c
   M /trunk/epan/dissectors/packet-x509af.c
   M /trunk/epan/dissectors/packet-x509if.c

get rid of some compiler warnings


------------------------------------------------------------------------
r12547 | sahlberg | 2004-11-20 01:03:27 -0600 (Sat, 20 Nov 2004) | 3 lines
Changed paths:
   M /trunk/tools/asn2eth.py

add _U_ to int hf_index to reduce number of compiler warnings


------------------------------------------------------------------------
r12546 | sahlberg | 2004-11-20 00:54:45 -0600 (Sat, 20 Nov 2004) | 3 lines
Changed paths:
   M /trunk/asn1/x509sat/SelectedAttributeTypes.asn
   M /trunk/asn1/x509sat/packet-x509sat-template.c
   M /trunk/asn1/x509sat/x509sat.cnf
   M /trunk/epan/dissectors/packet-x509sat.c
   M /trunk/epan/dissectors/packet-x509sat.h

updates to sat  to make the template smaller.


------------------------------------------------------------------------
r12545 | sahlberg | 2004-11-19 23:58:13 -0600 (Fri, 19 Nov 2004) | 4 lines
Changed paths:
   M /trunk/asn1/x509sat/SelectedAttributeTypes.asn
   M /trunk/asn1/x509sat/packet-x509sat-template.c
   M /trunk/asn1/x509sat/packet-x509sat-template.h
   M /trunk/asn1/x509sat/x509sat.cnf
   M /trunk/asn1/x509sat/x509sat_exp.cnf
   M /trunk/epan/dissectors/packet-x509sat.c
   M /trunk/epan/dissectors/packet-x509sat.h

ean up SAT a bit    remove the unneccesary implementation of DirectoryStr4ing in the template  and make the export of it correct.



------------------------------------------------------------------------
r12544 | sahlberg | 2004-11-18 04:46:27 -0600 (Thu, 18 Nov 2004) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ber.c

When we have a BER blob but we dont have the dissector for that oid implemented in ethereal (yet),
call a new function to start dissecting what unknown fields we can dissect.

Currently only PrintableString and INTEGER implemented but it will be easy to add other BER Universal types as needed later



------------------------------------------------------------------------
r12543 | guy | 2004-11-17 21:35:43 -0600 (Wed, 17 Nov 2004) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-gprs-llc.c

Don't create a dissector handle that we don't use.

------------------------------------------------------------------------
r12542 | guy | 2004-11-17 14:09:11 -0600 (Wed, 17 Nov 2004) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mq.c

Don't set a string pointer to point to a constant string if that pointer
will later be handed to a free-memory routine - g_strdup() the constant
string.

------------------------------------------------------------------------
r12541 | guy | 2004-11-17 13:46:34 -0600 (Wed, 17 Nov 2004) | 3 lines
Changed paths:
   M /trunk/epan/addr_resolv.c

Fix some problems when compiling on Windows and when compiling on
systems where INET6 isn't defined.

------------------------------------------------------------------------
r12540 | guy | 2004-11-17 13:41:56 -0600 (Wed, 17 Nov 2004) | 2 lines
Changed paths:
   M /trunk/epan/addr_resolv.c

Don't assume that IPv6 addresses are aligned on 32-bit boundaries.

------------------------------------------------------------------------
r12539 | etxrab | 2004-11-17 13:33:31 -0600 (Wed, 17 Nov 2004) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-isup.c

From Martin Regner add the possibillity to disscet BICC over SCTP
------------------------------------------------------------------------
r12538 | guy | 2004-11-17 04:03:14 -0600 (Wed, 17 Nov 2004) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dns.c

Add IPv6 address<->name mappings for AAAA records.

------------------------------------------------------------------------
r12537 | guy | 2004-11-17 03:44:41 -0600 (Wed, 17 Nov 2004) | 4 lines
Changed paths:
   M /trunk/epan/addr_resolv.c
   M /trunk/epan/addr_resolv.h

Add a hash table for IPv6 addresses, and add an "add_ipv6_name()"
routine to add IPv6-address/name pairings to that table; use that when
reading the hosts file.

------------------------------------------------------------------------
r12536 | guy | 2004-11-17 02:53:20 -0600 (Wed, 17 Nov 2004) | 3 lines
Changed paths:
   M /trunk/epan/addr_resolv.c
   M /trunk/epan/addr_resolv.h
   M /trunk/epan/dissectors/packet-dns.c

Rename some routines and structures to reflect that they're specific to
IPv4; use different data structures for port numbers.

------------------------------------------------------------------------
r12535 | sahlberg | 2004-11-17 02:42:31 -0600 (Wed, 17 Nov 2004) | 3 lines
Changed paths:
   A /trunk/asn1/smrse
   A /trunk/asn1/smrse/SMRSE.asn
   A /trunk/asn1/smrse/packet-smrse-template.c
   A /trunk/asn1/smrse/packet-smrse-template.h
   A /trunk/asn1/smrse/smrse.cnf
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-smrse.c
   A /trunk/epan/dissectors/packet-smrse.h

New protocol : SMRSE   ShortMessageRelayService


------------------------------------------------------------------------
r12534 | guy | 2004-11-17 02:34:36 -0600 (Wed, 17 Nov 2004) | 7 lines
Changed paths:
   M /trunk/epan/addr_resolv.c

Based on code from Francisco Alcoba, read the hosts file on startup if
we're using ADNS, so that we can resolve host names from the hosts file
as well as from DNS.

"fgetline()" strips newlines from the line, so don't bother looking for
them when tokenizing the line.

------------------------------------------------------------------------
r12533 | gerald | 2004-11-16 17:29:09 -0600 (Tue, 16 Nov 2004) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-radius.c

Fix a cut/paste error.

------------------------------------------------------------------------
r12532 | etxrab | 2004-11-16 16:15:58 -0600 (Tue, 16 Nov 2004) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-sigcomp.c

Implemented state-create, handling of g_hash_table at redesection needs more work.
------------------------------------------------------------------------
r12531 | etxrab | 2004-11-16 16:15:14 -0600 (Tue, 16 Nov 2004) | 1 line
Changed paths:
   M /trunk/epan/sigcomp-udvm.c
   M /trunk/epan/sigcomp-udvm.h
   M /trunk/epan/sigcomp_state_hdlr.c
   M /trunk/epan/sigcomp_state_hdlr.h

Implemented state-create, handling of g_hash_table at redesection needs more work.
------------------------------------------------------------------------
r12530 | guy | 2004-11-16 02:21:32 -0600 (Tue, 16 Nov 2004) | 5 lines
Changed paths:
   M /trunk/gtk/follow_dlg.c

Don't redisplay the "Follow TCP Stream" window on every toggle event for
the display style (ASCII/EBCDIC/char[]/hex) radio button set - pushing a
radio button generates *two* events, one for the button that gets turned
off and one for the button that gets turned on.

------------------------------------------------------------------------
r12529 | etxrab | 2004-11-15 13:06:10 -0600 (Mon, 15 Nov 2004) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-h245.c

Add some more OID string translations
------------------------------------------------------------------------
r12528 | sahlberg | 2004-11-14 03:50:24 -0600 (Sun, 14 Nov 2004) | 3 lines
Changed paths:
   A /trunk/asn1/pkixqualified
   A /trunk/asn1/pkixqualified/PKIXqualified.asn
   A /trunk/asn1/pkixqualified/packet-pkixqualified-template.c
   A /trunk/asn1/pkixqualified/packet-pkixqualified-template.h
   A /trunk/asn1/pkixqualified/pkixqualified.cnf
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-pkixqualified.c
   A /trunk/epan/dissectors/packet-pkixqualified.h

New protocol  PKIXQualified  from RFC3739


------------------------------------------------------------------------
r12527 | sahlberg | 2004-11-14 03:48:11 -0600 (Sun, 14 Nov 2004) | 5 lines
Changed paths:
   M /trunk/asn1/x509if/InformationFramework.asn
   M /trunk/asn1/x509if/x509if.cnf
   M /trunk/epan/dissectors/packet-x509if.c

Since we can now handle SEQUENCE OF ANY   uncomment this "difficult" field from
the Attribute SEQUENCE to make it more complete.



------------------------------------------------------------------------
r12526 | sahlberg | 2004-11-14 03:45:04 -0600 (Sun, 14 Nov 2004) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ber.c

make SEQUENCE OF understand a sequence of ANY


------------------------------------------------------------------------
r12525 | sahlberg | 2004-11-14 02:51:49 -0600 (Sun, 14 Nov 2004) | 3 lines
Changed paths:
   M /trunk/asn1/x509ce/x509ce.cnf
   M /trunk/asn1/x509ce/x509ce_exp.cnf
   M /trunk/epan/dissectors/packet-x509ce.c
   M /trunk/epan/dissectors/packet-x509ce.h

export GeneralName from X509CE


------------------------------------------------------------------------
r12524 | sahlberg | 2004-11-14 02:50:37 -0600 (Sun, 14 Nov 2004) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ber.c

make octet string also allow for utf8strings


------------------------------------------------------------------------
r12523 | sahlberg | 2004-11-14 00:13:15 -0600 (Sun, 14 Nov 2004) | 4 lines
Changed paths:
   A /trunk/epan/dissectors/packet-cmip.c
   A /trunk/epan/dissectors/packet-cmip.h

theis is the actual dissector for the new protocol : CMIP



------------------------------------------------------------------------
r12522 | sahlberg | 2004-11-13 23:15:09 -0600 (Sat, 13 Nov 2004) | 10 lines
Changed paths:
   M /trunk/epan/dissectors/packet-MAP_DialoguePDU.c
   M /trunk/epan/dissectors/packet-cms.c
   M /trunk/epan/dissectors/packet-gsm_map.c
   M /trunk/epan/dissectors/packet-ns_cert_exts.c
   M /trunk/epan/dissectors/packet-pkcs1.c
   M /trunk/epan/dissectors/packet-pkinit.c
   M /trunk/epan/dissectors/packet-pkix1explicit.c
   M /trunk/epan/dissectors/packet-x509af.c
   M /trunk/epan/dissectors/packet-x509ce.c
   M /trunk/epan/dissectors/packet-x509if.c

various changes in the generated dissectors after asn2eth was patched.

i think it is high time to put makefiles down in asn1/   since this autogenerating dissectors "experiment" have payed off so well   and it actual;ly works!


i dont know anything about how autogen stuff works  :-(




------------------------------------------------------------------------
r12521 | sahlberg | 2004-11-13 23:12:49 -0600 (Sat, 13 Nov 2004) | 6 lines
Changed paths:
   A /trunk/asn1/cmip
   A /trunk/asn1/cmip/CMIP.asn
   A /trunk/asn1/cmip/cmip.cnf
   A /trunk/asn1/cmip/packet-cmip-template.c
   A /trunk/asn1/cmip/packet-cmip-template.h
   M /trunk/epan/dissectors/Makefile.common

New protocol for the telco people to play with : CMIP

Only one function is implemented so fat   M-Get   but it would be trivial to add all the missing ones once there are example captures.



------------------------------------------------------------------------
r12520 | sahlberg | 2004-11-13 23:10:44 -0600 (Sat, 13 Nov 2004) | 16 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ber.c
   M /trunk/tools/asn2eth.py

Major update of the ber helpers  to fix a lot of bugs and make the handling of implicit_tags more sane.
It worked reasonably well   mainly, I suspect, due to implicit tags are reasonably uncommon in the dissectors we have already implemented and that the bugs were masking eachothers.


my regression tests (limited test samples though) decodes this new one exactly the same as the old one.


As a bonus by not changing anythiong in the decode  is that now it is possible to get dissection of implice items to work properly,  hence CMIP
(and also x509 Extensions work now)


make heaps of dissector helpers implicit_tag  aware.

change asn2eth to generate code to call the implicit_tag aware integer dissector helper.


------------------------------------------------------------------------
r12519 | sahlberg | 2004-11-13 08:16:06 -0600 (Sat, 13 Nov 2004) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ber.c
   M /trunk/epan/dissectors/packet-ber.h

add new integer dissector helper that is aware of implicit tags


------------------------------------------------------------------------
r12518 | sahlberg | 2004-11-13 04:06:15 -0600 (Sat, 13 Nov 2004) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ber.c

fix bug in handling an optional item



------------------------------------------------------------------------
r12517 | guy | 2004-11-12 17:14:49 -0600 (Fri, 12 Nov 2004) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-tcp.c

Get rid of an unused prameter and an unused variable.

Use %u, not %d, for unsigned variables.

------------------------------------------------------------------------
r12516 | sahlberg | 2004-11-12 16:04:19 -0600 (Fri, 12 Nov 2004) | 9 lines
Changed paths:
   M /trunk/epan/dissectors/packet-tcp.c

By popular request,
make ethereal be able to measure the time it took to transfer a PDU atop TCP.

This is great for analyzing performance issues caused by network/frame loss/congestion.


See  http://wiki.ethereal.com/TcpPduTime


------------------------------------------------------------------------
r12515 | guy | 2004-11-12 04:26:56 -0600 (Fri, 12 Nov 2004) | 3 lines
Changed paths:
   M /trunk/epan/tvbuff.c

From Charles Levert: in "tvb_fake_unicode()", convert non-ASCII
characters to '.'.

------------------------------------------------------------------------
r12514 | guy | 2004-11-12 04:17:13 -0600 (Fri, 12 Nov 2004) | 4 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/dissectors/packet-ppp.c

From Ignacio Goyret: decode RFC 2509 and RFC 3544 IPCP options.

Fix up the AUTHORS file.

------------------------------------------------------------------------
r12513 | guy | 2004-11-12 04:03:53 -0600 (Fri, 12 Nov 2004) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ipsec.c

From Mark Phillips: optionally support decoding the payload of ESP
packets using null encryption (with a heuristic to detect null
encryption).

------------------------------------------------------------------------
r12512 | guy | 2004-11-12 03:56:12 -0600 (Fri, 12 Nov 2004) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-acse.c

From Yuriy Sidelnikov: remove some unused value_string tables, and fix
typos in other tables.

------------------------------------------------------------------------
r12511 | guy | 2004-11-12 03:46:31 -0600 (Fri, 12 Nov 2004) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dns.c

For dynamic DNS updates, give the counts in the message the appropriate
names.

For RRs with a data length of 0 - as can appear in dynamic DNS updates -
don't attempt to display the data.

------------------------------------------------------------------------
r12510 | etxrab | 2004-11-12 01:02:36 -0600 (Fri, 12 Nov 2004) | 1 line
Changed paths:
   M /trunk/AUTHORS

Add Nils Ohlmeier to authors list(SIP patch)
------------------------------------------------------------------------
r12509 | guy | 2004-11-11 23:36:25 -0600 (Thu, 11 Nov 2004) | 5 lines
Changed paths:
   M /trunk/gtk/rpc_progs.c

Put the file name into the window title, so if you have more than one of
them open, you know which one corresponds to which file.

Clean up white space.

------------------------------------------------------------------------
r12508 | guy | 2004-11-11 05:50:26 -0600 (Thu, 11 Nov 2004) | 10 lines
Changed paths:
   M /trunk/tethereal.c

As per Sebastian Felis, don't assume that doubling the size of the line
buffer will necessarily be sufficient to make it big enough to handle
what's being added to the buffer - continue doubling the size until it
is.

Put the code to maintain the line buffer into a routine.

As that buffer is maintained as being large enough to handle what's
being put into it, there's no need to use "snprintf()" to print into it.

------------------------------------------------------------------------
r12507 | etxrab | 2004-11-10 16:15:58 -0600 (Wed, 10 Nov 2004) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-sip.c

From Nils Ohlmeier : patch for packet-sip.c which looks if the 
Contact header in the REGISTER reply contains more then one binding.  
Details: up to now each Contact header was counted as one binding. But that 
is not correct, because several Contact headers (as several other SIP headers 
as well) can be written in one line separated by commatas.

------------------------------------------------------------------------
r12506 | ulfl | 2004-11-10 11:58:16 -0600 (Wed, 10 Nov 2004) | 1 line
Changed paths:
   M /trunk/capture.c

bugfix: button in capture info dialog has to stop capturing
------------------------------------------------------------------------
r12505 | guy | 2004-11-10 04:46:40 -0600 (Wed, 10 Nov 2004) | 2 lines
Changed paths:
   M /trunk/plugins/opsi/packet-opsi.c

Check for bogus attribute lengths.

------------------------------------------------------------------------
r12504 | guy | 2004-11-10 04:28:43 -0600 (Wed, 10 Nov 2004) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcm.c

From Rich Coe:

	fix the heuristic code -- sometimes a conversation already
	    exists;
	fix the dissect code to display all the tags in the PDU.

------------------------------------------------------------------------
r12503 | guy | 2004-11-10 04:03:42 -0600 (Wed, 10 Nov 2004) | 16 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ncp-nmas.c

From Greg Morris:

	support 6 additional login message verbs;

	correct a problem with displaying proper return code values in
	the reply packets.

Clean up white space.

Use "tvb_reported_length_remaining()" instead of
"tvb_length_remaining()", and don't use either one to avoid throwing an
exception on a short or malformed packet.

Use "val_to_str()" rather than "match_strval()", so we don't crash if a
value happens not to be valid.

------------------------------------------------------------------------
r12502 | ulfl | 2004-11-10 00:50:55 -0600 (Wed, 10 Nov 2004) | 1 line
Changed paths:
   M /trunk/epan/addr_resolv.c

fix a typo
------------------------------------------------------------------------
r12501 | guy | 2004-11-09 23:01:09 -0600 (Tue, 09 Nov 2004) | 2 lines
Changed paths:
   M /trunk/epan/addr_resolv.c

Don't shut down GNU ADNS if it wasn't initialized.

------------------------------------------------------------------------
r12500 | guy | 2004-11-09 22:57:34 -0600 (Tue, 09 Nov 2004) | 6 lines
Changed paths:
   M /trunk/epan/addr_resolv.c

Check for errors in "adns_init()", and don't enable ADNS if we get an
error in "adns_init()".  (I suspect this is what's causing the crashes
somebody's seeing when they run Ethereal on a Windows system with no
networking protocols installed - no networking protocols -> no Internet
protocols probably -> no ability to set ADNS up.)

------------------------------------------------------------------------
r12499 | etxrab | 2004-11-09 14:16:17 -0600 (Tue, 09 Nov 2004) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-isup.c

From Luis Ontanon: Use hf_isup_parameter_type insted of hf_isup_message_type.
------------------------------------------------------------------------
r12498 | etxrab | 2004-11-09 01:04:12 -0600 (Tue, 09 Nov 2004) | 1 line
Changed paths:
   M /trunk/asn1/gsmmap/gsmmap.cnf

Rename some fields to get rid of warnings, will regenerate the files later.
------------------------------------------------------------------------
r12497 | etxrab | 2004-11-09 01:03:04 -0600 (Tue, 09 Nov 2004) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-h225.c
   M /trunk/epan/dissectors/packet-h245.c

Add some OID string names
------------------------------------------------------------------------
r12496 | etxrab | 2004-11-09 00:49:35 -0600 (Tue, 09 Nov 2004) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-ber.c
   M /trunk/epan/dissectors/packet-ber.h
   M /trunk/epan/dissectors/packet-per.c

Make it possible to print name of OID strings for PER coded OID:s as well.
------------------------------------------------------------------------
r12495 | sahlberg | 2004-11-06 14:09:00 -0600 (Sat, 06 Nov 2004) | 3 lines
Changed paths:
   M /trunk/asn1/x509if/x509if_exp.cnf

declare the types for DistinguishedName and RDNSequence


------------------------------------------------------------------------
r12494 | sahlberg | 2004-11-05 23:31:03 -0600 (Fri, 05 Nov 2004) | 3 lines
Changed paths:
   M /trunk/asn1/x509if/x509if.cnf
   M /trunk/epan/dissectors/packet-x509if.c
   M /trunk/epan/dissectors/packet-x509if.h

export RDNSequence from x509if


------------------------------------------------------------------------
r12493 | sahlberg | 2004-11-05 23:26:31 -0600 (Fri, 05 Nov 2004) | 3 lines
Changed paths:
   M /trunk/asn1/x509if/x509if.cnf
   M /trunk/epan/dissectors/packet-x509if.c
   M /trunk/epan/dissectors/packet-x509if.h

export DistinguishedName from x509if


------------------------------------------------------------------------
r12492 | sahlberg | 2004-11-05 20:13:38 -0600 (Fri, 05 Nov 2004) | 3 lines
Changed paths:
   M /trunk/asn1/x509if/InformationFramework.asn
   M /trunk/asn1/x509if/x509if.cnf
   D /trunk/asn1/x509if/x509if_dummy.cnf
   M /trunk/epan/dissectors/packet-x509if.c
   M /trunk/epan/dissectors/packet-x509if.h

make x509if use the new ANY type and get rid of the workaround


------------------------------------------------------------------------
r12491 | sahlberg | 2004-11-05 20:06:55 -0600 (Fri, 05 Nov 2004) | 3 lines
Changed paths:
   M /trunk/asn1/cms/CryptographicMessageSyntax.asn
   M /trunk/asn1/cms/cms.cnf
   D /trunk/asn1/cms/cms_dummy.cnf
   M /trunk/epan/dissectors/packet-cms.c
   M /trunk/epan/dissectors/packet-cms.h

make CMS use the new ANY type and get rid of the workaround


------------------------------------------------------------------------
r12490 | sahlberg | 2004-11-05 20:03:14 -0600 (Fri, 05 Nov 2004) | 3 lines
Changed paths:
   M /trunk/asn1/x509af/AuthenticationFramework.asn
   M /trunk/asn1/x509af/x509af.cnf
   D /trunk/asn1/x509af/x509af_dummy.cnf
   M /trunk/epan/dissectors/packet-x509af.c

Make X509AF use the new support for ANY type and remove the workaround


------------------------------------------------------------------------
r12489 | guy | 2004-11-05 15:39:31 -0600 (Fri, 05 Nov 2004) | 10 lines
Changed paths:
   M /trunk/epan/dissectors/packet-smb.c

Move smb.trans2.cmd and smb.nt.function near the top of the hf[] array,
so they show up near the top of the list of fields in the dialog box for
adding a field to a filter - those are probably quite likely to be used
in filter expressions where you don't happen to remember the name of the
field, and those should show up at the top so you don't have to scroll
through the entire list of fields to find them.  (I suspect most other
fields either will rarely be filtered on at all, or would be filtered
only mainly with the "Match" or "Prepare" filter items, where you don't
need to know the name or even the text of the field.)

------------------------------------------------------------------------
r12488 | guy | 2004-11-03 17:44:08 -0600 (Wed, 03 Nov 2004) | 8 lines
Changed paths:
   M /trunk/gtk/packet_history.c

When clearing the list, use "history_list", just in case
"history_current" happens to be null (that might not be possible, but
this is still perhaps a bit clearer).

Clear "history_current" after clearing the list, as the current entry no
longer exists, so that "packet_history_add()" doesn't use the now-bogus
value.

------------------------------------------------------------------------
r12487 | guy | 2004-11-03 17:19:09 -0600 (Wed, 03 Nov 2004) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-diameter-defs.h

Fix some typoes and clean up whitespace a bit.

------------------------------------------------------------------------
r12486 | etxrab | 2004-11-03 16:32:07 -0600 (Wed, 03 Nov 2004) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-diameter-defs.h

Added some value strings and started to add mobile-ip changes from latest draft.
------------------------------------------------------------------------
r12485 | etxrab | 2004-11-03 16:16:20 -0600 (Wed, 03 Nov 2004) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-sip.c

Add SIP headers from: http://www.ietf.org/internet-drafts/draft-ietf-sip-resource-priority-05.txt 
------------------------------------------------------------------------
r12484 | guy | 2004-11-03 14:20:45 -0600 (Wed, 03 Nov 2004) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-eth.c

Check for ISL frames before checking for ETHERTYPE_UNK, as ISL fields
might have 0 in what would be the Ethernet type field.

Also, handle the first 5 octets of the destination address of an ISL
frame being 0C-00-0C-00-00.

------------------------------------------------------------------------
r12483 | guy | 2004-11-03 14:18:30 -0600 (Wed, 03 Nov 2004) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-isl.c

Add a new URL for ISL information.

------------------------------------------------------------------------
r12482 | guy | 2004-11-03 14:01:53 -0600 (Wed, 03 Nov 2004) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-http.c

From Giles Scott: make the chunk size and data length unsigned so we
handle values > 2^31-1.

------------------------------------------------------------------------
r12481 | guy | 2004-11-03 13:52:24 -0600 (Wed, 03 Nov 2004) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ftam.c

From Yuriy Sidelnikov:

	take stuff that has to be done regardless of whether a protocol
	tree is being built outside "if (tree)";

	handle PDUs with both data and control units.

------------------------------------------------------------------------
r12480 | guy | 2004-11-03 13:46:09 -0600 (Wed, 03 Nov 2004) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-pres.c

From Yuriy Sidelnikov: take stuff that has to be done regardless of
whether a protocol tree is being built outside "if (tree)".

------------------------------------------------------------------------
r12479 | guy | 2004-11-03 13:39:44 -0600 (Wed, 03 Nov 2004) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-acse.c

Fix some strings.

------------------------------------------------------------------------
r12478 | guy | 2004-11-03 13:34:44 -0600 (Wed, 03 Nov 2004) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-acse.c

From Yuriy Sidelnikov: take stuff that has to be done regardless of
whether a protocol tree is being built outside "if (tree)".

------------------------------------------------------------------------
r12477 | guy | 2004-11-03 13:23:07 -0600 (Wed, 03 Nov 2004) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-edonkey.c

Use the #define for the eDonkey-over-TCP header length.

------------------------------------------------------------------------
r12476 | guy | 2004-11-03 13:12:49 -0600 (Wed, 03 Nov 2004) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-edonkey.c

Add support for desegmentation of eDonkey-over-TCP.

Clean up indentation.
 
Give edonkey.protocol a value_string table.

------------------------------------------------------------------------
r12475 | gerald | 2004-11-02 13:19:04 -0600 (Tue, 02 Nov 2004) | 2 lines
Changed paths:
   M /trunk/README.win32

zlib121-dll -> zlib122-dll.

------------------------------------------------------------------------
r12474 | gerald | 2004-11-02 13:07:52 -0600 (Tue, 02 Nov 2004) | 4 lines
Changed paths:
   M /trunk/Makefile.nmake
   M /trunk/config.nmake
   M /trunk/tools/win32-setup.sh

Update the Windows build to zlib 1.2.2.

Have win32-setup.sh download from "2004-11-02" tag directory.

------------------------------------------------------------------------
r12473 | guy | 2004-11-01 19:25:05 -0600 (Mon, 01 Nov 2004) | 2 lines
Changed paths:
   M /trunk/asn1/gsmmap/packet-gsm_map-template.c
   M /trunk/epan/dissectors/packet-gsm_map.c
   M /trunk/epan/dissectors/packet-gsm_map.h

Close a comment, and re-generate the GSM MAP dissector files.

------------------------------------------------------------------------
r12472 | guy | 2004-11-01 19:19:23 -0600 (Mon, 01 Nov 2004) | 6 lines
Changed paths:
   M /trunk/asn1/gsmmap/GSMMAP.asn
   M /trunk/asn1/gsmmap/gsmmap.cnf
   M /trunk/asn1/gsmmap/packet-gsm_map-template.c
   M /trunk/asn1/gsmmap/packet-gsm_map-template.h

Get rid of CRs, and set svn:eol-style to native.

Set svn:keywords to ID.

Delete the eol-style property (it's svn:eol-style).

------------------------------------------------------------------------
r12471 | gerald | 2004-11-01 17:54:05 -0600 (Mon, 01 Nov 2004) | 6 lines
Changed paths:
   M /trunk/config.h.win32
   M /trunk/epan/dissectors/packet-kerberos.c

When we dynamically discover a Kerberos key, it helps to add it to the
key list.  In the Nettle code, clear the key list and re-read the key
file when the key file preference changes.

Remove a redundant define in config.h.win32.

------------------------------------------------------------------------
r12470 | etxrab | 2004-11-01 16:33:09 -0600 (Mon, 01 Nov 2004) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-gsm_map.c
   M /trunk/epan/dissectors/packet-gsm_map.h

New GSM MAP files based on the asn2eth compiler.
------------------------------------------------------------------------
r12469 | etxrab | 2004-11-01 16:18:14 -0600 (Mon, 01 Nov 2004) | 1 line
Changed paths:
   M /trunk/asn1/gsmmap/packet-gsm_map-template.h

Fix a typo
------------------------------------------------------------------------
r12468 | etxrab | 2004-11-01 16:06:43 -0600 (Mon, 01 Nov 2004) | 1 line
Changed paths:
   M /trunk/asn1/gsmmap/gsmmap.cnf
   M /trunk/asn1/gsmmap/packet-gsm_map-template.c
   M /trunk/asn1/gsmmap/packet-gsm_map-template.h

Change eol-style to native(?)
------------------------------------------------------------------------
r12467 | etxrab | 2004-11-01 16:03:57 -0600 (Mon, 01 Nov 2004) | 1 line
Changed paths:
   A /trunk/asn1/gsmmap/GSMMAP.asn
   A /trunk/asn1/gsmmap/gsmmap.cnf
   A /trunk/asn1/gsmmap/packet-gsm_map-template.c
   A /trunk/asn1/gsmmap/packet-gsm_map-template.h

Preparations for addition of GSM MAP dissector created by the asn2eth compiler.
------------------------------------------------------------------------
r12466 | etxrab | 2004-11-01 16:03:12 -0600 (Mon, 01 Nov 2004) | 1 line
Changed paths:
   A /trunk/asn1/gsmmap

Preparations for addition of GSM MAP dissector created by the asn2eth compiler.
------------------------------------------------------------------------
r12465 | gerald | 2004-11-01 12:11:48 -0600 (Mon, 01 Nov 2004) | 2 lines
Changed paths:
   M /trunk/asn1/pkix1explicit/PKIX1EXPLICIT93.asn
   M /trunk/asn1/pkix1explicit/packet-pkix1explicit-template.c
   M /trunk/asn1/pkix1explicit/pkix1explicit.cnf
   M /trunk/epan/dissectors/packet-pkix1explicit.c

Add support for the dhpublicnumber OID.

------------------------------------------------------------------------
r12464 | guy | 2004-11-01 11:51:07 -0600 (Mon, 01 Nov 2004) | 8 lines
Changed paths:
   M /trunk/tools/asn2eth.py

From Tomas Kukosa:

	add support for ANY type;

	add support for DEFAULT { } (empty sequence);

	some minor changes.

------------------------------------------------------------------------
r12463 | gerald | 2004-11-01 11:49:53 -0600 (Mon, 01 Nov 2004) | 2 lines
Changed paths:
   M /trunk/asn1/pkinit/packet-pkinit-template.c
   M /trunk/asn1/pkinit/pkinit.cnf
   M /trunk/epan/dissectors/packet-pkinit.c

Register OID dissectors correctly.

------------------------------------------------------------------------
r12462 | guy | 2004-11-01 11:48:36 -0600 (Mon, 01 Nov 2004) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-3g-a11.c

From Ryuji Somegawa: dissect the Registration Update Authentication
Extension.

------------------------------------------------------------------------
r12461 | gerald | 2004-11-01 11:04:05 -0600 (Mon, 01 Nov 2004) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-kerberos.c

Create a conversation only when we see a KDC_REQ.  

------------------------------------------------------------------------
r12460 | ulfl | 2004-11-01 05:42:08 -0600 (Mon, 01 Nov 2004) | 1 line
Changed paths:
   M /trunk/gtk/Makefile.am
   M /trunk/gtk/Makefile.common
   M /trunk/gtk/menu.c
   M /trunk/gtk/menu.h
   A /trunk/gtk/packet_history.c
   A /trunk/gtk/packet_history.h
   M /trunk/gtk/packet_list.c
   M /trunk/gtk/toolbar.c
   M /trunk/gtk/toolbar.h

first implementation of the packet history function
------------------------------------------------------------------------
r12459 | guy | 2004-10-31 17:38:34 -0600 (Sun, 31 Oct 2004) | 3 lines
Changed paths:
   M /trunk

Change the list of files to handle "capinfo" being renamed to
"capinfos".

------------------------------------------------------------------------
r12458 | guy | 2004-10-31 17:36:21 -0600 (Sun, 31 Oct 2004) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-icmpv6.c

Make the protocol tree item for ICMPv6 cover the entire ICMPv6 packet,
including any included packet.

------------------------------------------------------------------------
r12457 | guy | 2004-10-31 17:22:14 -0600 (Sun, 31 Oct 2004) | 3 lines
Changed paths:
   M /trunk/epan/packet.c

Make sure we don't return a random value in an unset variable if an
exception is thrown while dissecting an "error packet".

------------------------------------------------------------------------
r12456 | ulfl | 2004-10-31 05:15:12 -0600 (Sun, 31 Oct 2004) | 1 line
Changed paths:
   M /trunk/docbook/edg_src/EDG_chapter_works.xml

add some more content to the overview section
------------------------------------------------------------------------
r12455 | guy | 2004-10-30 21:47:07 -0500 (Sat, 30 Oct 2004) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc-rs_pgo.c

Get rid of a bunch of trailing spaces.

------------------------------------------------------------------------
r12454 | guy | 2004-10-30 21:39:39 -0500 (Sat, 30 Oct 2004) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc-rs_pgo.c

Add a "hf_sec_rgy_pname_t_size" hf_ value and corresponding field, and
use it ("sec_rgy_pname_t_size" had been used as an hf_ value, but it's
just a #define).

Fix the code for some strings to advance the offset by the string size
regardless of whether it's > 1 or not.

------------------------------------------------------------------------
r12453 | guy | 2004-10-30 18:26:47 -0500 (Sat, 30 Oct 2004) | 5 lines
Changed paths:
   M /trunk/capture.c
   M /trunk/capture_loop.c
   M /trunk/capture_sync.c

Move some #defines and #includes around, and add some other #includes,
to make it compile on UN*X.  Get rid of some #includes that don't appear
to be needed, at least on OS X 10.3 (they might be needed on other
platforms).

------------------------------------------------------------------------
r12452 | guy | 2004-10-30 18:05:48 -0500 (Sat, 30 Oct 2004) | 2 lines
Changed paths:
   M /trunk/capture.c

Get rid of forward declarations of functions not defined in this file.

------------------------------------------------------------------------
r12451 | ulfl | 2004-10-30 12:50:51 -0500 (Sat, 30 Oct 2004) | 1 line
Changed paths:
   M /trunk/Makefile.common
   M /trunk/capture.c
   M /trunk/capture.h
   A /trunk/capture_loop.c
   M /trunk/epan/packet.h
   M /trunk/gtk/capture_info_dlg.c
   M /trunk/gtk/main.c

split capture_loop from capture.c, some more code cleanup
------------------------------------------------------------------------
r12450 | ulfl | 2004-10-30 11:28:00 -0500 (Sat, 30 Oct 2004) | 1 line
Changed paths:
   M /trunk/docbook/edg_graphics/ethereal-capture-normal.dia
   M /trunk/docbook/edg_graphics/ethereal-capture-normal.png
   M /trunk/docbook/edg_graphics/ethereal-capture-sync.dia
   M /trunk/docbook/edg_graphics/ethereal-capture-sync.png

update capture dia's
------------------------------------------------------------------------
r12449 | ulfl | 2004-10-30 09:30:52 -0500 (Sat, 30 Oct 2004) | 1 line
Changed paths:
   M /trunk/capture.c
   M /trunk/capture.h
   M /trunk/gtk/main.c

move quit_after_cap into capture_opts
------------------------------------------------------------------------
r12448 | ulfl | 2004-10-30 08:26:15 -0500 (Sat, 30 Oct 2004) | 1 line
Changed paths:
   M /trunk/docbook/edg_src/EDG_chapter_sources.xml

from Olivier Biot: how to add a new file to Subversion
------------------------------------------------------------------------
r12447 | ulfl | 2004-10-30 07:54:53 -0500 (Sat, 30 Oct 2004) | 2 lines
Changed paths:
   M /trunk/docbook/Makefile
   M /trunk/docbook/developer-guide.xml
   M /trunk/docbook/edg_src/EDG_chapter_works.xml

add a simplified overview section about the Ethereal function blocks.
Some cleanup in the docbook Makefile
------------------------------------------------------------------------
r12446 | ulfl | 2004-10-30 07:52:34 -0500 (Sat, 30 Oct 2004) | 1 line
Changed paths:
   A /trunk/docbook/edg_graphics/ethereal-capture_internals.dia
   A /trunk/docbook/edg_graphics/ethereal-capture_internals.png

add a dia about the capture internals
------------------------------------------------------------------------
r12445 | ulfl | 2004-10-30 06:44:06 -0500 (Sat, 30 Oct 2004) | 2 lines
Changed paths:
   M /trunk/Makefile.common
   M /trunk/capture.c
   A /trunk/capture_sync.c
   A /trunk/capture_sync.h

code cleanup: split capture_sync from capture.c into it's own file. 
That's the part used, when "Update list of packets in real time" is used while capturing.
------------------------------------------------------------------------
r12444 | guy | 2004-10-30 05:04:35 -0500 (Sat, 30 Oct 2004) | 15 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/dissectors/packet-udp.c

from Mark Phillips: the length field in the UDP header includes the
length of the UDP header itself, so subtract the length of the header
when using it to limit the length of the payload tvbuff.

Clean up the computing of the captured length of the payload tvbuff (we
really should get rid of the "length" argument to "tvb_new_subset()",
and have it compute the captured length based on the supplied reported
length and the amount of that data actually present in the parent
tvbuff).

Don't fetch the length and checksum fields until we use them (so that we
don't throw an exception until then, and fail to process the source and
destination ports), and check whether the length is bogus regardless of
whether we're building a protocol tree or not.

------------------------------------------------------------------------
r12443 | guy | 2004-10-30 04:19:14 -0500 (Sat, 30 Oct 2004) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-image-jfif.c

Squelch some compile warnings.

------------------------------------------------------------------------
r12442 | guy | 2004-10-30 04:14:36 -0500 (Sat, 30 Oct 2004) | 6 lines
Changed paths:
   M /trunk/wiretap/pppdump.c

Check for errors from all calls to "file_getc()".

If we get such an error, always call "file_error()" to get an indication
of what the error was and, if it returns 0, set the error to
WTAP_ERR_SHORT_READ.

------------------------------------------------------------------------
r12441 | guy | 2004-10-30 03:45:10 -0500 (Sat, 30 Oct 2004) | 9 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ppp.c

The length of the protocol tree item passed to "dissect_ppp_common()"
should be the length of the packet being dissected, so that if we throw
an exception dissecting it, the item covers the entire packet (because
it's incomplete, and thus *all* of it is the beginning of the header).

Instead, we should pass the length of the part of the header prior to
the protocol field as an argument to "dissect_ppp_common()", and it
should use that to set the length of that item.

------------------------------------------------------------------------
r12440 | guy | 2004-10-30 02:47:50 -0500 (Sat, 30 Oct 2004) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-fw1.c

The interface name field is 6 bytes if we *do* have UUID information in
the file and 10 bytes if we *don't*.

Small language edits in preference text and blurb.

------------------------------------------------------------------------
r12439 | guy | 2004-10-30 02:23:55 -0500 (Sat, 30 Oct 2004) | 3 lines
Changed paths:
   M /trunk/AUTHORS
   M /trunk/epan/dissectors/packet-symantec.c

From Martin Pichlmaier: the first 4 bytes of the Symantec firewall
header are the IP address of the interface that saw the packet.

------------------------------------------------------------------------
r12438 | sahlberg | 2004-10-29 21:36:58 -0500 (Fri, 29 Oct 2004) | 3 lines
Changed paths:
   M /trunk/asn1/x509af/AuthenticationFramework.asn
   M /trunk/asn1/x509af/packet-x509af-template.c
   M /trunk/asn1/x509af/x509af.cnf
   M /trunk/epan/dissectors/packet-x509af.c
   M /trunk/epan/dissectors/packet-x509af.h

change Extension to be implemented inside the conformance file and remove it from the template


------------------------------------------------------------------------
r12437 | sahlberg | 2004-10-29 21:18:44 -0500 (Fri, 29 Oct 2004) | 3 lines
Changed paths:
   M /trunk/asn1/x509af/AuthenticationFramework.asn
   M /trunk/asn1/x509af/packet-x509af-template.c
   M /trunk/asn1/x509af/packet-x509af-template.h
   M /trunk/asn1/x509af/x509af.cnf
   A /trunk/asn1/x509af/x509af_dummy.cnf
   M /trunk/epan/dissectors/packet-x509af.c
   M /trunk/epan/dissectors/packet-x509af.h

implement AlgorithmIdentifier using the conformance file and remove it from the template


------------------------------------------------------------------------
r12436 | sahlberg | 2004-10-29 20:54:40 -0500 (Fri, 29 Oct 2004) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ber.c

fix call_ber_iod_callback() to move offset past the end of the current blob.



------------------------------------------------------------------------
r12435 | gram | 2004-10-29 10:09:00 -0500 (Fri, 29 Oct 2004) | 3 lines
Changed paths:
   M /trunk/tools/Makefile.am
   A /trunk/tools/netscreen2dump.py

Add netscreen2dump.py, to convert netscreen packet-trace hex dumps
to hex dumps that can be read by text2pcap.

------------------------------------------------------------------------
r12434 | sahlberg | 2004-10-29 07:11:42 -0500 (Fri, 29 Oct 2004) | 3 lines
Changed paths:
   M /trunk/asn1/cms/CryptographicMessageSyntax.asn
   M /trunk/asn1/cms/cms.cnf
   A /trunk/asn1/cms/cms_dummy.cnf
   M /trunk/asn1/cms/packet-cms-template.c
   M /trunk/asn1/cms/packet-cms-template.h
   M /trunk/epan/dissectors/packet-cms.c
   M /trunk/epan/dissectors/packet-cms.h

update to cms to use workaround to lack of ANY and reducing the template significantly


------------------------------------------------------------------------
r12433 | sahlberg | 2004-10-29 06:39:58 -0500 (Fri, 29 Oct 2004) | 3 lines
Changed paths:
   M /trunk/asn1/x509if/InformationFramework.asn
   M /trunk/asn1/x509if/packet-x509if-template.c
   M /trunk/asn1/x509if/packet-x509if-template.h
   M /trunk/asn1/x509if/x509if.cnf
   M /trunk/epan/dissectors/packet-x509if.c
   M /trunk/epan/dissectors/packet-x509if.h

more updates of x509if


------------------------------------------------------------------------
r12432 | sahlberg | 2004-10-29 06:11:11 -0500 (Fri, 29 Oct 2004) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-x509if.c

new generated version of x509if


------------------------------------------------------------------------
r12431 | sahlberg | 2004-10-29 06:10:31 -0500 (Fri, 29 Oct 2004) | 3 lines
Changed paths:
   M /trunk/asn1/x509if/InformationFramework.asn
   M /trunk/asn1/x509if/packet-x509if-template.c
   M /trunk/asn1/x509if/x509if.cnf
   A /trunk/asn1/x509if/x509if_dummy.cnf

Update to x509if  use a workaround to emulate the type ANY and remove stuff from teh template


------------------------------------------------------------------------
r12430 | guy | 2004-10-29 03:01:11 -0500 (Fri, 29 Oct 2004) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-http.c

From Yaniv Kaul: dissect authentication data as NTLMSSP only if it
starts with "NTLMSSP", otherwise dissect it as GSS-API.

------------------------------------------------------------------------
r12429 | guy | 2004-10-28 21:40:01 -0500 (Thu, 28 Oct 2004) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-radiotap.c
   M /trunk/wiretap/libpcap.c
   M /trunk/wiretap/wtap.c
   M /trunk/wiretap/wtap.h

As Sam Leffler notes, the radiotap header isn't BSD-only, it's also used
by his madwifi Atheros driver on Linux; rename
WTAP_ENCAP_IEEE_802_11_WLAN_BSD to WTAP_ENCAP_IEEE_802_11_WLAN_RADIOTAP,
and change its text name from "ieee-802-11-bsd" to
"ieee-802-11-radiotap".

------------------------------------------------------------------------
r12428 | guy | 2004-10-28 19:39:56 -0500 (Thu, 28 Oct 2004) | 3 lines
Changed paths:
   M /trunk/epan/strutil.c

Have the usual three separate buffers for "format_text()", so that it
can be used multiple times in a single formatting call.

------------------------------------------------------------------------
r12427 | guy | 2004-10-28 19:36:52 -0500 (Thu, 28 Oct 2004) | 10 lines
Changed paths:
   M /trunk/file.c
   M /trunk/merge.c
   M /trunk/merge.h
   M /trunk/mergecap.c

The common merge code merely needs to offer the abstraction of routines
that return the next packet from a set of {chronologically sorted,
sequential-by-file} packets; it doesn't need to have a loop over all
those packets, or any code to write packets.

Supply those abstractions, change the code that merges packets to do its
own writing, and have the Ethereal version manage a progress bar and
have the mergecap version print packet numbers in verbose mode, as the
common merge code used to do.

------------------------------------------------------------------------
r12426 | gerald | 2004-10-28 17:06:55 -0500 (Thu, 28 Oct 2004) | 2 lines
Changed paths:
   M /trunk/asn1/cms/CryptographicMessageSyntax.asn
   M /trunk/asn1/cms/cms.cnf
   M /trunk/asn1/cms/packet-cms-template.c
   M /trunk/asn1/cms/packet-cms-template.h
   M /trunk/asn1/pkinit/PKINIT.asn
   M /trunk/asn1/pkinit/packet-pkinit-template.c
   M /trunk/asn1/pkinit/pkinit.cnf
   M /trunk/epan/dissectors/packet-cms.c
   M /trunk/epan/dissectors/packet-cms.h
   M /trunk/epan/dissectors/packet-kerberos.c
   M /trunk/epan/dissectors/packet-kerberos.h
   M /trunk/epan/dissectors/packet-pkinit.c

Add support for pkauthdata and pkdhkeydata OIDs.

------------------------------------------------------------------------
r12425 | sahlberg | 2004-10-28 06:35:43 -0500 (Thu, 28 Oct 2004) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ber.c

fix small bug that gets offset confused for CHOICE { } OPTIONAL if there were no arms that matched



------------------------------------------------------------------------
r12424 | guy | 2004-10-28 02:50:07 -0500 (Thu, 28 Oct 2004) | 11 lines
Changed paths:
   M /trunk/epan/dissectors/packet-image-jfif.c

The offset to the first IFD in a TIFF file is 4 bytes long, not 2 bytes
long.

The offset is relative to the first byte of the TIFF structure, which is
after the "Exif\0" *and* the extra byte after "Exif\0".

Loop over all IFDs.

Sanity check the offset to the first IFD and the offset in each IFD to
the next IFD.

------------------------------------------------------------------------
r12423 | guy | 2004-10-27 20:52:05 -0500 (Wed, 27 Oct 2004) | 7 lines
Changed paths:
   M /trunk/file.c
   M /trunk/merge.c
   M /trunk/merge.h
   M /trunk/mergecap.c

Make "merge_files()" and "merge_append_files()" return a tri-state
indication - success, read failure, write failure - and have their
callers handle read failures by looking for the file that got the read
failure and reporting the failure in question.

Free up the err_info string returned by "wtap_read()" after using it.

------------------------------------------------------------------------
r12422 | guy | 2004-10-27 20:06:11 -0500 (Wed, 27 Oct 2004) | 9 lines
Changed paths:
   M /trunk/file.c
   M /trunk/merge.c
   M /trunk/merge.h
   M /trunk/mergecap.c

Remove all the verbose-mode code from merge.c, and put most of it in
mergecap.c (get rid of the verbose printing of information for each
packet).

Have "merge_append_files()" return FALSE only on a write error, as
"merge_files()" does.

Sort the routines in "merge.c" in the order from "merge.h".

------------------------------------------------------------------------
r12421 | guy | 2004-10-27 18:45:10 -0500 (Wed, 27 Oct 2004) | 3 lines
Changed paths:
   M /trunk/file.c
   M /trunk/file.h
   M /trunk/merge.c
   M /trunk/merge.h

Get rid of merge_n_files() - it's only called in one place now, and
absorbing its logic into "cf_merge_files()" simplifies things a bit.

------------------------------------------------------------------------
r12420 | guy | 2004-10-27 18:28:37 -0500 (Wed, 27 Oct 2004) | 10 lines
Changed paths:
   M /trunk/file.c
   M /trunk/file.h
   M /trunk/gtk/file_dlg.c
   M /trunk/gtk/main.c
   M /trunk/merge.c
   M /trunk/merge.h
   M /trunk/mergecap.c

Change some of the merge.c APIs to return more information on failure,
and use that information to provide better error messages.

Have "merge_open_outfile()" do all the work of filling in the
merge_out_file_t structure, with the values to use passed as arguments. 
Get rid of some structure members that used to be used solely to pass
information to "merge_open_outfile()".

Add a "cf_merge_files()" routine to do the merging and reporting of errors.

------------------------------------------------------------------------
r12419 | guy | 2004-10-27 16:16:18 -0500 (Wed, 27 Oct 2004) | 8 lines
Changed paths:
   M /trunk/asn1/MAP_Dialogue/packet-MAP-DialoguePDU-template.c
   M /trunk/asn1/MAP_Dialogue/packet-MAP-DialoguePDU-template.h
   M /trunk/epan/dissectors/packet-MAP_DialoguePDU.c
   M /trunk/epan/dissectors/packet-MAP_DialoguePDU.h

"dissect_MAP_Dialogue()" returns no value; declare its return value as
"void".

Fix a typo in the MAP Dialogue dissector template .h file.

Re-generate the MAP Dialogue dissector files and set svn:keywords to Id
and svn:eol-style to native for them.

------------------------------------------------------------------------
r12418 | guy | 2004-10-27 15:36:20 -0500 (Wed, 27 Oct 2004) | 2 lines
Changed paths:
   M /trunk/asn1/cms/CryptographicMessageSyntax.asn
   M /trunk/asn1/x509af/AuthenticationFramework.asn

Turn off execute permission on .asn files.

------------------------------------------------------------------------
r12417 | guy | 2004-10-27 15:34:21 -0500 (Wed, 27 Oct 2004) | 8 lines
Changed paths:
   A /trunk/asn1/MAP_Dialogue
   A /trunk/asn1/MAP_Dialogue/MAP_DialoguePDU.asn (from /trunk/asn1/MAP_Dialouge/MAP_DialoguePDU.asn:12416)
   A /trunk/asn1/MAP_Dialogue/MAP_DialoguePDU.cnf (from /trunk/asn1/MAP_Dialouge/MAP_DialoguePDU.cnf:12416)
   A /trunk/asn1/MAP_Dialogue/packet-MAP-DialoguePDU-template.c (from /trunk/asn1/MAP_Dialouge/packet-MAP-DialoguePDU-template.c:12416)
   A /trunk/asn1/MAP_Dialogue/packet-MAP-DialoguePDU-template.h (from /trunk/asn1/MAP_Dialouge/packet-MAP-DialoguePDU-template.h:12416)
   D /trunk/asn1/MAP_Dialouge

Fix a typo in the name of the directory for the MAP dialogue ASN.1
files.

Set svn:eol-style to native for those files, and get rid of trailing
CRs.

Set svn:keywords to Id for those files.

------------------------------------------------------------------------
r12416 | etxrab | 2004-10-27 15:17:38 -0500 (Wed, 27 Oct 2004) | 1 line
Changed paths:
   M /trunk/epan/dissectors/Makefile.common
   A /trunk/epan/dissectors/packet-MAP_DialoguePDU.c
   A /trunk/epan/dissectors/packet-MAP_DialoguePDU.h

Add a MapDialouge dissector ( can be tested with the file gsm-ss-01.snoop )
------------------------------------------------------------------------
r12415 | etxrab | 2004-10-27 15:08:44 -0500 (Wed, 27 Oct 2004) | 1 line
Changed paths:
   A /trunk/asn1/MAP_Dialouge/MAP_DialoguePDU.asn
   A /trunk/asn1/MAP_Dialouge/MAP_DialoguePDU.cnf
   A /trunk/asn1/MAP_Dialouge/packet-MAP-DialoguePDU-template.c
   A /trunk/asn1/MAP_Dialouge/packet-MAP-DialoguePDU-template.h

Add a MAPdialouge dissector
------------------------------------------------------------------------
r12414 | etxrab | 2004-10-27 15:06:45 -0500 (Wed, 27 Oct 2004) | 1 line
Changed paths:
   A /trunk/asn1/MAP_Dialouge

Add a MAPdialouge dissector
------------------------------------------------------------------------
r12413 | etxrab | 2004-10-27 15:04:56 -0500 (Wed, 27 Oct 2004) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-tcap.c

Improve OID dissection and make it possible to call an "OID" Dissector for Dialougedata parameter.
------------------------------------------------------------------------
r12412 | etxrab | 2004-10-27 14:59:44 -0500 (Wed, 27 Oct 2004) | 1 line
Changed paths:
   M /trunk/epan/dissectors/packet-ber.c
   M /trunk/epan/dissectors/packet-ber.h

Make it possible to register a string for an OID in the hash table.
------------------------------------------------------------------------
r12411 | guy | 2004-10-27 14:36:48 -0500 (Wed, 27 Oct 2004) | 2 lines
Changed paths:
   M /trunk/merge.c

Fix indentation.

------------------------------------------------------------------------
r12410 | guy | 2004-10-27 14:36:22 -0500 (Wed, 27 Oct 2004) | 5 lines
Changed paths:
   M /trunk/mergecap.c

Check whether any input files were specified, and print an error for
that - otherwise, you get a "No valid input files" message, which
perhaps doesn't make it clear enough that the problem is that there were
no input files, period.

------------------------------------------------------------------------
r12409 | guy | 2004-10-27 14:26:01 -0500 (Wed, 27 Oct 2004) | 2 lines
Changed paths:
   M /trunk/tools/Makefile.am

Add unix2dos.pl to the list of files to be distributed.

------------------------------------------------------------------------
r12408 | ulfl | 2004-10-27 14:12:51 -0500 (Wed, 27 Oct 2004) | 1 line
Changed paths:
   A /trunk/docbook/edg_graphics/ethereal-capture-normal.dia
   A /trunk/docbook/edg_graphics/ethereal-capture-normal.png
   A /trunk/docbook/edg_graphics/ethereal-capture-sync.dia
   A /trunk/docbook/edg_graphics/ethereal-capture-sync.png
   M /trunk/docbook/edg_graphics/ethereal-function-blocks.dia
   M /trunk/docbook/edg_graphics/ethereal-function-blocks.png

two more dia diagrams about Ethereals capture engine and updated the first one
------------------------------------------------------------------------
r12407 | ulfl | 2004-10-27 12:20:25 -0500 (Wed, 27 Oct 2004) | 1 line
Changed paths:
   A /trunk/docbook/edg_graphics
   A /trunk/docbook/edg_graphics/ethereal-function-blocks.dia
   A /trunk/docbook/edg_graphics/ethereal-function-blocks.png

a dia diagram about Ethereal development (hopefully later some more) 
------------------------------------------------------------------------
r12406 | guy | 2004-10-27 05:02:45 -0500 (Wed, 27 Oct 2004) | 9 lines
Changed paths:
   M /trunk/epan/dissectors/packet-h450.c
   M /trunk/epan/proto.c

Check to make sure we don't give a protocol tree item a negative length.

Clean up indentation.

If we dissect an octet string and then re-dissect it as a particular
type of data, don't use the end offset from the re-dissection as the
offset of the end of the octet string - just use the result of
"dissect_per_octet_string()".

------------------------------------------------------------------------
r12405 | ulfl | 2004-10-26 23:46:17 -0500 (Tue, 26 Oct 2004) | 1 line
Changed paths:
   M /trunk/doxygen.cfg.in
   M /trunk/doxygen_global.cfg

fix doxygen generation
------------------------------------------------------------------------
r12404 | ulfl | 2004-10-26 23:45:00 -0500 (Tue, 26 Oct 2004) | 1 line
Changed paths:
   M /trunk/epan/strutil.h
   M /trunk/gtk/help_dlg.h
   M /trunk/gtk/main.h

fix doxygen tags
------------------------------------------------------------------------
r12403 | ulfl | 2004-10-26 23:03:31 -0500 (Tue, 26 Oct 2004) | 1 line
Changed paths:
   A /trunk/doxygen.cfg.in
   M /trunk/epan/doxygen.cfg.in
   M /trunk/gtk/doxygen.cfg.in

fix doxygen generation
------------------------------------------------------------------------
r12402 | ulfl | 2004-10-26 22:59:02 -0500 (Tue, 26 Oct 2004) | 1 line
Changed paths:
   D /trunk/doxygen.cfg.in
   A /trunk/doxygen_global.cfg (from /trunk/doxygen.cfg.in:12400)

fix doxygen generation
------------------------------------------------------------------------
r12401 | ulfl | 2004-10-26 22:57:57 -0500 (Tue, 26 Oct 2004) | 1 line
Changed paths:
   M /trunk/color.h

fix doxygen tags
------------------------------------------------------------------------
r12400 | guy | 2004-10-26 21:52:40 -0500 (Tue, 26 Oct 2004) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-per.c

Don't have two variables, in different scopes in the same routine, have
the same name.

Fix up alignment.

------------------------------------------------------------------------
r12399 | guy | 2004-10-26 21:34:30 -0500 (Tue, 26 Oct 2004) | 8 lines
Changed paths:
   M /trunk/epan/dissectors/packet-per.c

Encapsulate into a macro the idiom

	if(offset&0x07){
		offset=(offset&0xfffffff8)+8;
	}

for byte-aligning a bit offset.

------------------------------------------------------------------------
r12398 | guy | 2004-10-26 18:30:33 -0500 (Tue, 26 Oct 2004) | 5 lines
Changed paths:
   M /trunk/doc/ethereal.pod

Document the personal capture and display filters list in the FILES
section, as is done for other files.  Just refer to those files in the
section for the "Save" button for the capture and display filter dialog
boxes.

------------------------------------------------------------------------
r12397 | guy | 2004-10-26 13:41:25 -0500 (Tue, 26 Oct 2004) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-tsp.c

Fix the file name in the initial comment.

------------------------------------------------------------------------
r12396 | gerald | 2004-10-26 11:08:16 -0500 (Tue, 26 Oct 2004) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bootp.c

Rename the "boolean" enum to "val_boolean" lest the Microsoft compiler let
its displeasure be known.

------------------------------------------------------------------------
r12395 | sahlberg | 2004-10-26 09:02:02 -0500 (Tue, 26 Oct 2004) | 3 lines
Changed paths:
   M /trunk/asn1/ns-cert-exts/ns_cert_exts.cnf
   M /trunk/asn1/ns-cert-exts/packet-ns_cert_exts-template.c

make the dissector use the nice #.REGISTER directive


------------------------------------------------------------------------
r12394 | sahlberg | 2004-10-26 08:54:09 -0500 (Tue, 26 Oct 2004) | 3 lines
Changed paths:
   M /trunk/asn1/cms/cms.cnf
   M /trunk/asn1/cms/packet-cms-template.c

 use the nice #.REGISTER directive instead of handcoding it in teh template


------------------------------------------------------------------------
r12393 | sahlberg | 2004-10-26 08:53:30 -0500 (Tue, 26 Oct 2004) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-cms.c

new cms dissector based on updated and cleaned up conformance and template file.

use the nice #.REGISTER directive instead of doing it by hand.


------------------------------------------------------------------------
r12392 | sahlberg | 2004-10-26 08:04:09 -0500 (Tue, 26 Oct 2004) | 3 lines
Changed paths:
   M /trunk/asn1/x509af/packet-x509af-template.c
   M /trunk/asn1/x509af/x509af.cnf

Use the much better #.REGISTER directive instead of the #.PDU directive


------------------------------------------------------------------------
r12391 | guy | 2004-10-26 02:00:23 -0500 (Tue, 26 Oct 2004) | 13 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bootp.c

Add a "data" item to the opt_info structure, containing a "const void
*".  For val_u_byte, if non-null, it points to a "value_string" table to
be used to interpret the value.  Replace "toggle" and "yes_no" with
"boolean, and have the "data" pointer point to a "struct
true_false_string" to be used to interpret the value.

The NetBIOS-over-TCP/IP Node Type option can now be a regular val_u_byte
value, with the appropriate value_string table.

Construct the item for DHCP options by initializing it without the value
and appending the value to the item's string with
"proto_item_append_text()".

------------------------------------------------------------------------
r12390 | guy | 2004-10-25 18:25:59 -0500 (Mon, 25 Oct 2004) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bootp.c

Make yes_no work in "dissect_netware_ip_suboption()" the way it works
elsewhere, and replace "struct o63_opt_info" with "struct opt_info".

------------------------------------------------------------------------
r12389 | guy | 2004-10-25 04:31:13 -0500 (Mon, 25 Oct 2004) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bootp.c

"struct o43pxeclient_opt_info" and "struct o43cablelabs_opt_info" look
just like "struct opt_info", except for the name of the "enum
field_type" field; use "opt_info" instead of them.  Rename the
equivalent field in "struct o63_opt_info", as well, with an eye towards
changing "struct opt_info" to be able to replace "struct o63_opt_info"
as well.

------------------------------------------------------------------------
r12388 | guy | 2004-10-25 03:56:39 -0500 (Mon, 25 Oct 2004) | 12 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bootp.c

Remove val_s_long as it's unimplemented and unused - put it back if it's
ever necessary.

Make some options, that have only one IPv4 address, use ipv4 rather than
ipv4_list.

Add val_u_short_list, and have val_u_short accept one and only one
16-bit integer.  Give options the appropriate type.

Shuffle the types a bit in the enum, and shuffle the cases for types
around to match the order in the enum.

------------------------------------------------------------------------
r12387 | guy | 2004-10-25 03:33:39 -0500 (Mon, 25 Oct 2004) | 7 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bootp.c

Rename "ipv4" to "ipv4_list", as it's used for lists of IPv4 addresses,
and add a separate "ipv4"; use that in the dissector for Netware IP
options.

Add a "presence" option type, for options with no value whose presence
is significant; use that in the dissector for Netware IP options.

------------------------------------------------------------------------
r12386 | guy | 2004-10-25 03:17:11 -0500 (Mon, 25 Oct 2004) | 8 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bootp.c

Pass to the the routines that dissect suboption lists the offset of the
end of the option, and have them do bounds checking.  Also, in some
places, check the suboption length.

In "dissect_netware_ip_suboption()", process the suboption length
(which, according to RFC 2242, is present in all suboptions), and use
val_u_byte rather than val_u_short for 1-byte options.

------------------------------------------------------------------------
r12385 | guy | 2004-10-24 17:53:06 -0500 (Sun, 24 Oct 2004) | 6 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bootp.c

Restructure the DHCP option parsing a bit, to make it a bit clearer -
and fix some bugs that this made a bit more obvious.  Add checks of the
option length.

Clean up white space.

------------------------------------------------------------------------
r12384 | guy | 2004-10-24 05:30:03 -0500 (Sun, 24 Oct 2004) | 5 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bootp.c

Don't display the FQDN in the FQDN option if the length of the FQDN is
zero.

Clean up some field names and descriptions.

------------------------------------------------------------------------
r12383 | guy | 2004-10-24 05:18:16 -0500 (Sun, 24 Oct 2004) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-bootp.c

Fix the length used for the name in the FQDN option.

------------------------------------------------------------------------
r12382 | sahlberg | 2004-10-23 22:51:27 -0500 (Sat, 23 Oct 2004) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ber.c

make SEQUENCE OF and CHOICE handle indefinite length encodings


------------------------------------------------------------------------
r12381 | guy | 2004-10-23 20:29:03 -0500 (Sat, 23 Oct 2004) | 2 lines
Changed paths:
   M /trunk/epan/dissectors/packet-dcerpc-sysact.c

From Yaniv Kaul: name some more interface calls.

------------------------------------------------------------------------
r12380 | guy | 2004-10-23 04:20:39 -0500 (Sat, 23 Oct 2004) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-aim-buddylist.c
   M /trunk/epan/dissectors/packet-aim-chat.c
   M /trunk/epan/dissectors/packet-aim-generic.c

Remove the include of <epan/prefs.h> from files that don't call any
preference routines.

------------------------------------------------------------------------
r12379 | guy | 2004-10-23 03:37:21 -0500 (Sat, 23 Oct 2004) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-aim.c

Put the name, as well as the value, of the family and subfamily fields
into the protocol tree item that contains them.

------------------------------------------------------------------------
r12378 | guy | 2004-10-22 13:03:21 -0500 (Fri, 22 Oct 2004) | 3 lines
Changed paths:
   M /trunk/epan/dissectors/packet-ipdc.c

From Josh Bailey: fix the fetch of the IPDC payload length, it's only 10
bits long.

------------------------------------------------------------------------
r12377 | guy | 2004-10-22 12:40:58 -0500 (Fri, 22 Oct 2004) | 2 lines
Changed paths:
   M /trunk/AUTHORS

Add an item for DNS IPSECKEY RR support for David Fort.

------------------------------------------------------------------------
r12376 | ulfl | 2004-10-22 03:33:50 -0500 (Fri, 22 Oct 2004) | 1 line
Changed paths:
   M /trunk/docbook/eug_src/EUG_app_files.xml

add a section about "Windows folders"
------------------------------------------------------------------------
r12375 | guy | 2004-10-22 02:07:08 -0500 (Fri, 22 Oct 2004) | 7 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c
   M /trunk/gtk/file_dlg.c

Change some code that affects g_resolv_flags to set a flag if the check
box for the flag is active and clear it if it's inactive, rather than
clearing all but RESOLV_CONCURRENT and then setting flags if the check
box is active - or, in one case, not clearing any flags due to a typo
and then setting them, so they never get cleared.  This matches what's
done with theresolution flags in some other places.

------------------------------------------------------------------------
r12374 | guy | 2004-10-22 01:19:00 -0500 (Fri, 22 Oct 2004) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/Makefile.common
   M /trunk/epan/dissectors/packet-sdp.c
   M /trunk/epan/dissectors/packet-t38.c
   A /trunk/epan/dissectors/packet-t38.h

From Alejandro Vaquero: start T.38 conversations for SDP sessions.

"T38" -> "T.38" in the T.38 dissector.

------------------------------------------------------------------------
r12373 | guy | 2004-10-22 01:05:03 -0500 (Fri, 22 Oct 2004) | 4 lines
Changed paths:
   M /trunk/epan/dissectors/packet-mtp3.c

From Francisco Alcoba: declare the tap data as static, so it's still
there when the tap is called (which happens after dissection is
complete).

------------------------------------------------------------------------
r12372 | guy | 2004-10-21 21:09:35 -0500 (Thu, 21 Oct 2004) | 3 lines
Changed paths:
   M /trunk/doc/Makefile.am

For the .pod->.html rules, find the ".pod" files in $(srcdir),
just as we do for the .pod->.[1-9] rules.

------------------------------------------------------------------------
r12371 | guy | 2004-10-21 21:05:53 -0500 (Thu, 21 Oct 2004) | 8 lines
Changed paths:
   M /trunk/epan/dissectors/Makefile.am

Include "Makefile.common" in the list of files to put into the
distribution.

Don't use ":=" - not all versions of make necessarily support it, and,
even for those that do, it doesn't mean the same thing in all versions
(it means something different in Solaris make than in GNU make, for
example).

------------------------------------------------------------------------
r12370 | ulfl | 2004-10-21 16:43:37 -0500 (Thu, 21 Oct 2004) | 1 line
Changed paths:
   M /trunk/docbook/eug_src/EUG_chapter_advanced.xml

cleanup "Packet Reassembling" section
------------------------------------------------------------------------
r12369 | ulfl | 2004-10-21 16:09:28 -0500 (Thu, 21 Oct 2004) | 1 line
Changed paths:
   M /trunk/docbook/eug_src/EUG_app_protocols.xml
   D /trunk/docbook/protocols.xml
   M /trunk/docbook/user-guide.xml

removed the protocols list completely, as I don't want to update it to the current Ethereal features all the time and we also have a really good online version of that list available.
------------------------------------------------------------------------
r12368 | ulfl | 2004-10-21 15:22:21 -0500 (Thu, 21 Oct 2004) | 1 line
Changed paths:
   M /trunk/docbook/eug_src/EUG_app_files.xml

add info about temporary capture files and a section about "Windows NT/2000/XP roaming profiles"
------------------------------------------------------------------------
r12367 | guy | 2004-10-21 14:12:22 -0500 (Thu, 21 Oct 2004) | 4 lines
Changed paths:
   M /trunk/gtk/capture_dlg.c

The top-level window's list of capture filter expressions might not yet
exist if no filters have been remembered; don't set the popdown string
list for the filter combo box if the list is empty.

------------------------------------------------------------------------
r12363 | gerald | 2004-10-20 21:06:37 -0500 (Wed, 20 Oct 2004) | 7 lines
Changed paths:
   M /trunk/packaging/nsis/ethereal.nsi
   M /trunk/plugins/opsi/packet-opsi.c
   M /trunk/plugins/opsi/packet-opsi.h

From Laurent Rabret:

- enable Windows' ShellExecute command to call Ethereal without specifying
  the installation path (a new key added in the registry)
- decode 2 more options in the OPSI plugin.


------------------------------------------------------------------------
r12362 | guy | 2004-10-20 18:38:31 -0500 (Wed, 20 Oct 2004) | 11 lines
Changed paths:
   M /trunk/epan/dissectors/packet-rpc.c

At least some versions of the OS X NFS client (and possibly some if not
all other BSD NFS clients) retransmit on different ports from the port
on which the original request was set, so have the RPC "conversation"
for connectionless protocols use only the source address and destination
port.

Use NO_ADDR_B and NO_PORT_B when looking up the conversation in those
cases, and use NO_ADDR2 and NO_PORT2 when creating the conversation in
those cases, to make it clearer that we're only using one address and
port.

------------------------------------------------------------------------
r12361 | gerald | 2004-10-20 14:14:51 -0500 (Wed, 20 Oct 2004) | 2 lines
Changed paths:
   M /trunk/ChangeLog
   M /trunk/NEWS

Pull in versions from the 0.10.7 branch.

------------------------------------------------------------------------
