AMC: Wireless Analyzer Captured Data (AirMagnet)
------------------------------------------------
$Id$

This is just a braindump from looking at some Airmagnet capture files,
in one case having a look at a decoded display in Airmagnet itself.
Lots of things are still unknown.
This is NOT the intention to write a file importer in the forseeable
future.

Exact timestamp decoding still unknown:
From a diffrent decoded examplefile:
06 51 49 1b     Timestamp  (105990427)  =  03:30:27.497544
06 51 4a cd     Timestamp  (105990861)  =  03:30:27.497978  (+434)
06 51 4b ce     Timestamp  (105991118)  =  03:30:27.498235  (+257)

Timestamps this file:
Frame1: 15a5 2fb4	363147188	-
Frame2: 15a5 3a8e	363149966	+ 1778
Frame3: 15a5 3c50	363150416	+  550
Frame4: 15a5 487d	363153533
Frame5: 15a5 49d9	363153881
Frame6: 15a5 4bcf	363154383
Frame7: 15a5 53da	363156442
Frame8: 15a5 59e4	363157988
Frame9: 15cc 9da8	365731240
FrameA: 15db dd60	366730592
FrameB: 15dc 04f6	366740726
FrameC: 15df 5d29	366959913

Unknown stuff:
Header: 0000 0000 0002 | 3b93 d886
Frame1: da9d | 0000 0000 0002
Frame2: bf9c | 0000 0000 0002
Frame3: d59c | 0000 0000 0002
Frame4: c09c | 0000 0000 0002
Frame5: c09c | 0000 0000 0002
Frame6: d69c | 0000 0000 0002
Frame7: d79c | 0000 0000 0002
Frame8: c09c | 0000 0000 0002
Frame9: d79c | 0000 0000 0002
FrameA: d89c | 0000 0000 0002
FrameB: d69d | 0000 0000 0002
FrameC: d79c | 0000 0000 0002

Headerstructure:
 6 Bytes: 'N2GINC'
44 Bytes: unknown (0x0)
 6 Bytes: 'N2GINC'
 2 Bytes: unknown (0x0)
 2 Bytes: #Frames (BE)
 2 Bytes: unknown (0x0)
 2 Bytes: unknown (0x0002)
 4 Bytes: Timestamp
 4 Bytes: unknown (Timestamp date part ?)
28 Bytes: unknown (0x0)
==================
Total: 100 Bytes

Recordstructure:
 2 Bytes: unknown
 2 Bytes: Bytes "on wire" (BE)
 2 Bytes: LL Bytes in capturefile (BE)
 4 Bytes: unknown (0x0) (02 00 00 00 = Frame displayed in RED)
 2 Bytes: unknown (0x0002)
 4 Bytes: Timestamp
 1 Byte:  DataRate ((AND 7f) / 2 in Mbit/s)
 1 Byte:  Channel (1-13: Chan 1-13, 15: Chan 36, 16: Chan 40, ..., 19: Chan 52, ...)
 1 Byte:  SignalStrength (%)
 1 Byte:  NoiseLevel (%)
LL Bytes: Capturedata
 6 Bytes: unknown
 4 Bytes: 0x33333333
(1 Byte:  0x33) in case LL is an odd number

Filelength: 0x57e Bytes
12 Frames
============== Header ===================
0000000: 4e32 4749 4e43 0000 0000 0000 0000 0000
0000010: 0000 0000 0000 0000 0000 0000 0000 0000
0000020: 0000 0000 0000 0000 0000 0000 0000 0000
0000030: 0000 4e32 4749 4e43 0000 000c 0000 0002
0000040: 1545 5198 3b93 d886 0000 0000 0000 0000
0000050: 0000 0000 0000 0000 0000 0000 0000 0000
0000060: 0000 0000
============== Frame 1 ==================
Length: 0x36
-------- ???
0000064: da9d
0000066: 0026 0026
000006a: 0000 0000 0002
0000070: 15a5 2fb4		Timestamp
0000074: 02			DataRate
0000075: 06			Channel
0000076: 64			SignalStrength (%)
0000077: 01			NoiseLevel (%)
-------- ieee 802.11
0000078: b000			Type/Subtype/Frame Control
000007a: 3a01			Duration
000007c: 0040 9647 71a3		Destaddr
0000082: 0040 9631 d395		Sourceaddr
0000088: 0040 9647 71a3		BSS Id
000008e: b000			Fragment nr/Seq nr
-------- ???
0000090: 0000 0100 0000 3333 3333
============== Frame 2===================
Length: 0x36
-------- ???
000009a: bf9c 0026 0026
00000a0: 0000 0000 0002 15a5 3a8e 1606 3c00
-------- ieee 802.11
00000ae: b000			Type/Subtype/Frame Control
00000b0: 7500
00000b2: 0040 9631 d395
00000b8: 0040 9647 71a3
00000be: 0040 9647 71a3
00000c4: 806d
-------- ???
00000c6: 0000 0200 0000 3333 3333
============== Frame 3 ==================
Length: 0x62
-------- ???
00000d0: d59c 0051 0051
00000d6: 0000 0000 0002 15a5 3c50 0206 6400
-------- ieee 802.11
00000e4: 0000
00000e6: 3a01
00000e8: 0040 9647 71a3
00000ee: 0040 9631 d395
00000f4: 0040 9647 71a3
00000fa: c000
-------- ???
00000fc: 2100 c800
0000100: 0005 616c 616d 6f01 0402 040b 1685 1e00
0000110: 016d 0d1f 00ff 0318 0049 6e73 7472 7563
0000120: 746f 7200 0000 00
-------- ???
0000127: 00 0000 0000 2133 3333 3333
================= Frame 4 ===============
Length: 0x68
-------- ???
0000132: c09c 0058 0058
0000138: 0000 0000 0002 15a5 487d 1606 3e00
-------- ieee 802.11
000014a: 1000
000014c: 7500
000014e: 0040 9631 d395
0000154: 0040 9647 71a3
000015a: 0040 9647 71a3
000015c: 906d
-------- ???
000015e: 2100
0000160: 0000 1d00 0104 8284 8b96 851c 0000 4c0d
0000170: 0000 0000 0100 416c 616d 6f20 436c 6173
0000180: 7372 6f6f 6d20 0002 880c 80f3 0300 8137
-------- ???
0000190: 0300 0000 0000 3333 3333
=================== Frame 5 =============
-------- ???
000019a: c09c 005a 005a
00001a0: 0000 0000 0002 15a5 49d9 1606 3e00
-------- ieee 802.11
00001ae: 0802
00001b0: 7500 0040 9631 d395 0040 9647 71a3 0040
00001c0: 9647 71a3 a06d aaaa 0300 4096 0000 0032
00001d0: 4001 0040 9631 d395 0040 9647 71a3 0100
00001e0: 0000 0000 0000 0000 0000 0000 0000 0000
00001f0: 0000 0000 0000 0000 0000
-------- ???
00001fa: 0000 0000 0000 3333 3333
=================== Frame 6 =============
-------- ???
0000204: d69c 0072 0072
000020a: 0000 0000 0002 15a5 4bcf 0206 6400
-------- ieee 802.11
0000218: 0801 3a01 0040 9647
0000220: 71a3 0040 9631 d395 0040 9647 71a3 d000
0000230: aaaa 0300 4096 0000 004a 4081 0040 9647
0000240: 71a3 0040 9631 d395 016d 0004 1900 0040
0000250: 9647 71a3 0000 0000 0000 0000 0000 0000
0000260: 0000 001e 496e 7374 7275 6374 6f72 0000
0000270: 0000 0000 0000 0000 0000 0000
-------- ???
000027c: 0000 0000 0000 3333 3333
=================== Frame 7 =============
-------- ???
0000286: d79c 0039 0039
000028c: 0000 0000 0002 15a5 53da 0206 6400
-------- ieee 802.11
000029a: 0801 3a01 0040
00002a0: 9647 71a3 0040 9631 d395 0040 9647 71a3
00002b0: e000 aaaa 0300 4096 0000 0011 4001 0040
00002c0: 9647 71a3 00
00002c5: 40 9631 d395 0133 3333 3333
====================== Frame 8 ==========
-------- ???
00002d0: c09c 0072 0072
00002d6: 0000 0000 0002 15a5 59e4 1606 3e00
-------- ieee 802.11
00002e4: 0802 7500 0040 9631 d395 0040
00002f0: 9647 71a3 0040 9647 71a3 b06d aaaa 0300
0000300: 4096 0000 004a 4081 0040 9631 d395 0040
0000310: 9647 71a3 014c 030b 1500 0000 0000 0000
0000320: 0000 0000 0000 0002 0000 0a00 0001 0000
0000330: 416c 616d 6f20 436c 6173 7372 6f6f 6d00
0000340: 0000 0000 0000 0000
0000348: 0000 0000 2200 3333 3333
=================== Frame 9 =============
-------- ???
0000352: d79c 0170 00a0
0000358: 0020 0000 0002 15cc 9da8 1606 6400
-------- ieee 802.11
0000366: 0801 7500 0040 9647 71a3
0000370: 0040 9631 d395 ffff ffff ffff f000 aaaa
0000380: 0300 0000 0800 4500 0148 42a1 0000 8011
0000390: f704 0000 0000 ffff ffff 0044 0043 0134
00003a0: d991 0101 0600 7728 b62a 0000 0000 0000
00003b0: 0000 0000 0000 0000 0000 0000 0000 0040
00003c0: 9631 d395 0000 0000 0000 0000 0000 0000
00003d0: 0000 0000 0000 0000 0000 0000 0000 0000
00003e0: 0000 0000 0000 0000 0000 0000 0000 0000
00003f0: 0000 0000 0000 0000
-------- ???
00003f8: 0000 0000 0000 3333 3333
=================== Frame A =============
-------- ???
0000402: d89c 0182 00a0
0000408: 0020 0000 0002 15db dd60 1606 6400
-------- ieee 802.11
0000416: 0801 7500
000041a: 0040 9647 71a3
0000420: 0040 9631 d395
0000426: ffff ffff ffff
000042c: 0001
-------- LLC
000042e: aaaa 0300 0000 0800
-------- IP
0000436: 4500 015a 42a3 0000 8011 f6f0 0000 0000 ffff ffff
-------- UDP
000044a: 0044 0043 0146 57bc
-------- DHCP
0000452: 0101 0600 7728 b62a 0000 0000 0000
0000460: 0000 0000 0000 0000 0000 0000 0000 0040
0000470: 9631 d395 0000 0000 0000 0000 0000 0000
0000480: 0000 0000 0000 0000 0000 0000 0000 0000
0000490: 0000 0000 0000 0000 0000 0000 0000 0000
00004a0: 0000 0000 0000 0000
-------- ???
00004a8: 0000 0000 0000 3333 3333
=================== Frame B =============
-------- ???
00004b2: d69d 0056 0056
00004b8: 0000 0000 0002 15dc 04f6 1606 6401
-------- ieee 802.11
00004c6: 0801
00004c8: 7500
00004ca: 0040 9647 71a3
00004d0: 0040 9631 d395
00004d6: ffff ffff ffff
0000edc: 1001
-------- LLC
00004de: aaaa 0300 0000 0806
-------- ARP
00004e6: 0001 0800 0604 0001
00004ee: 0040 9631 d395 0a00 0065
00004f8: 0000 0000 0000 0a00 0065
-------- ???
0000502: 7b00 e097 7b00 e097 7b00 e097
000050e: 7b00 e097 7b00 3333 3333
=================== Frame C =============
-------- ???
0000518: d79c 0056 0056
000051e: 0000 0000 0002 15df 5d29 1606 6400
-------- ieee 802.11
000052c: 0801
000052e: 7500
0000530: 0040 9647 71a3
0000536: 0040 9631 d395
000053a: ffff ffff ffff
0000540: 2001
-------- LLC
0000542: aaaa 0300 0000 0806
-------- ARP
000054a: 0001			Hw
000054c: 0800			Protocol
0000550: 06			Hw-Size
0000551: 04			Protocolsize
0000552: 0001			Opcode
0000554: 0040 9631 d395		Sender MAC
000055a: 0a00 0065		Sender IP
000055e: 0000 0000 0000		Destination MAC
0000564: 0a00 0065		Destination IP
-------- ???
0000568: 0000 8602 0000 ffff ffff 0cc3
0000574: 4b82 58a1 1d82 3333 3333
=========================================
000057e: EOF
